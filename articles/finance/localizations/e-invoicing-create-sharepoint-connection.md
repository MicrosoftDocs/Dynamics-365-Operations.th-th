---
title: ตั้งค่าคอนฟิกการเชื่อมต่อ SharePoint
description: บทความนี้อธิบายวิธีการตั้งค่าคอนฟิกการเชื่อมต่อเพื่อให้การออกใบแจ้งหนี้อิเล็กทรอนิกส์สามารถเข้าถึงไซต์ Microsoft SharePoint ได้
author: gionoder
ms.date: 12/15/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: gionoder
ms.search.validFrom: ''
ms.dyn365.ops.version: ''
ms.custom: ''
ms.assetid: ''
ms.search.form: ''
ms.openlocfilehash: a2762178686d1f29c457b6de2a9b052fd048484b
ms.sourcegitcommit: 87e727005399c82cbb6509f5ce9fb33d18928d30
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 08/12/2022
ms.locfileid: "9284001"
---
# <a name="configure-a-sharepoint-connection"></a>ตั้งค่าคอนฟิกการเชื่อมต่อ SharePoint

[!include [banner](../includes/banner.md)]

บริการออกใบแจ้งหนี้อิเล็กทรอนิกส์สามารถอ่านไฟล์จากโฟลเดอร์ Microsoft SharePoint และอัปโหลดไฟล์ไปยัง SharePoint เพื่อให้แน่ใจว่าการออกใบแจ้งหนี้อิเล็กทรอนิกส์สามารถเข้าถึงไซต์ SharePoint เฉพาะได้ คุณต้องระบุข้อมูลประจำตัวของไซต์ไปยังบริการออกใบแจ้งหนี้อิเล็กทรอนิกส์ นอกจากนี้ เพื่อให้มั่นใจว่าข้อมูลประจำตัวจะถูกจัดเก็บอย่างปลอดภัย อย่าระบุข้อมูลประจำตัวโดยตรง แต่ให้จัดเก็บใน Azure Key Vault และระบุข้อมูลลับของ Azure Key Vault

## <a name="grant-access-to-a-sharepoint-folder"></a>ให้สิทธิ์เข้าถึงโฟลเดอร์ SharePoint

1. สร้างการลงทะเบียนแอปในผู้เช่าที่ติดตั้ง Regulatory Configuration Service (RCS) ไว้

    1. ลงชื่อเข้าใช้ [พอร์ทัล Azure](https://portal.azure.com/)
    2. ไปที่ **การลงทะเบียนแอป**
    3. เลือก **การลงทะเบียนใหม่**
    4. ป้อนชื่อ เช่น **แอป SharePoint สำหรับการออกใบแจ้งหนี้อิเล็กทรอนิกส์** และลงทะเบียนให้เสร็จสมบูรณ์
    5. เลือกการลงทะเบียนแอปใหม่
    6. บนแท็บ **การรับรองความถูกต้อง** ให้เปิดใช้งานตัวเลือก **อนุญาตขั้นตอนของไคลเอ็นต์สาธารณะ**
    4. บนแท็บ **ใบรับรองและข้อมูลลับ** ให้เลือก **ข้อมูลลับของไคลเอ็นต์ใหม่** เพื่อสร้างข้อมูลลับของไคลเอ็นต์
    5. คัดลอกค่าของข้อมูลลับที่สร้าง

    ทำตามแนวทางเหล่านี้:

    - อย่าใช้การลงทะเบียนแอปเดียวกันกับบริการต่างๆ
    - ทำตาม [คำแนะนำของนโยบายรหัสผ่าน](/microsoft-365/admin/misc/password-policy-recommendations?view=o365-worldwide)
    - ตั้งค่าการหมุนเวียนรหัสผ่าน ระหว่างการหมุนเวียน ให้สร้างข้อมูลลับของไคลเอ็นต์ใหม่สำหรับการลงทะเบียนแอป อัปเดต Key Vault แล้วลบข้อมูลลับของเก่า

2. บันทึกค่าของ **ข้อมูลลับของการลงทะเบียนแอป** และ **รหัสแอปพลิเคชัน (ไคลเอ็นต์)** เป็นรหัสใหม่สองค่าใน Key Vault ในการตั้งค่าสภาพแวดล้อมการออกใบแจ้งหนี้อิเล็กทรอนิกส์ของคุณ
3. เพิ่มข้อมูลลับที่คุณสร้างในพารามิเตอร์ Key Vault ในการตั้งค่าสภาพแวดล้อมการออกใบแจ้งหนี้อิเล็กทรอนิกส์ใน RCS
4. ในพอร์ทัล Azure ให้สิทธิ์เข้าถึง SharePoint ขั้นตอนนี้ควรดำเนินการให้เสร็จสมบูรณ์โดยผู้ดูแลระบบผู้เช่า

    1. เลือกการลงทะเบียนแอปที่คุณสร้างขึ้น
    2. บนแท็บ **สิทธิ์ของ API** ให้เลือก **เพิ่มสิทธิ์**
    3. เลือก **Microsoft Graph (สิทธิ์ของแอปพลิเคชัน)** \> **Sites.Selected**
    4. เลือก **ให้ความยินยอมของผู้ดูแลระบบสำหรับ \<user&nbsp;name\>**
    5. ตรวจสอบฟิลด์ **สถานะ** เพื่อให้แน่ใจว่าได้ให้สิทธิ์แล้ว

        ![สิทธิ์ที่ให้บนแท็บสิทธิ์ของ API](media/configured-permissions.jpg)

    6. เปิด [Graph Explorer - Microsoft Graph](https://developer.microsoft.com/graph/graph-explorer) และลงชื่อเข้าใช้
    7. ในบานหน้าต่างด้านซ้าย บนแท็บ **การสอบถามตัวอย่าง** ภายใต้ **ไซต์ SharePoint** เลือก **รับไซต์ SharePoint ตามพาธสัมพัทธ์ของไซต์**
    8. กรอกพารามิเตอร์ **\{host-name\}** และ **\{server-relative-path\}** ตัวอย่างเช่น กรอก `<domain>.sharepoint.com` สำหรับ **\{host-name\}** และ `sites/<siteName>` สำหรับ **\{server-relative-path\}**

        > [!NOTE]
        > สำหรับเว็บไซต์เริ่มต้น ให้ปล่อยพารามิเตอร์ **\{server-relative-path\}** เว้นว่างไว้

    9. เลือก **เรียกใช้การสอบถาม** และบันทึกผลลัพธ์
    10. ตั้งค่าคอนฟิกการสอบถามต่อไปนี้

        `POST https://graph.microsoft.com/v1.0/sites/{site-id}/permissions`

        ในการสอบถามนี้ **\{site-id\}** เป็นค่าของโหนด **id** จากการตอบสนองต่อการสอบถามก่อนหน้านี้

        ต่อไปนี้เป็นเนื้อความของคำขอ

        ```json
        {
            "roles": [
                "read",
                "write"
            ],
            "grantedToIdentities": [
                {
                    "application": {
                        "id": "{app-id}",
                        "displayName": "{app-name}"
                    }
                }
            ]
        }
        ```

        ในเนื้อความของคำขอนี้ **\{app-id\}** เป็นค่า **รหัสแอปพลิเคชัน (ไคลเอ็นต์)** และ **\{app-name\}** เป็นค่า **ชื่อแอปพลิเคชัน**

        ![การสอบถาม POST](media/app-id-query.jpg)

    11. บนแท็บ **แก้ไขสิทธิ์** ให้เลือก **เปิดแผงสิทธิ์** แล้วเลือก **ไซต์** \> **Sites.FullControl.All** \> **ความยินยอม**
    12. เลือก **เรียกใช้การสอบถาม**

ขณะนี้บริการออกใบแจ้งหนี้อิเล็กทรอนิกส์สามารถเข้าถึงไซต์ SharePoint ของคุณได้แล้ว
