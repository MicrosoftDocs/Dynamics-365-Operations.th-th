---
title: ตั้งค่า และรันการประมวลผลเพื่อเรียกรูปแบบ ER การส่งออกแบบง่าย เพื่อสร้างรายงาน Excel
description: บทความนี้แสดงตัวอย่างวิธีการตั้งค่าและใช้ข้อความอิเล็กทรอนิกส์
author: liza-golub
ms.date: 07/06/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: kfend
ms.custom: ''
ms.search.region: Global
ms.author: elgolu
ms.search.validFrom: 2021-06-24
ms.dyn365.ops.version: 10.0.21
ms.openlocfilehash: 9894aabde854189e6fc1b6bb62051747f190e3ec
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 06/03/2022
ms.locfileid: "8904599"
---
# <a name="set-up-and-run-processing-to-call-a-simple-exporting-er-format-to-generate-an-excel-report"></a>ตั้งค่า และรันการประมวลผลเพื่อเรียกรูปแบบ ER การส่งออกแบบง่าย เพื่อสร้างรายงาน Excel

[!include [banner](../includes/banner.md)]

หลังจากที่คุณได้สร้างรูปแบบ ER ของคุณ แม็ปกับแหล่งข้อมูล และทำเสร็จสมบูรณ์แล้ว คุณสามารถรันได้จากพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** หลังจากสร้างรายงาน คุณสามารถบันทึกไว้ภายในเครื่องได้

เพื่อควบคุมลักษณะต่อไปนี้ของกระบวนการรายงาน ให้ตั้งค่าการประมวลผลข้อความอิเล็กทรอนิกส์:

- ข้อมูลล็อกเกี่ยวกับผู้ที่สร้างรายงาน
- ข้อมูลล็อกเกี่ยวกับเวลาที่มีการสร้างรายงาน
- บันทึกรายงานที่สร้างขึ้นสำหรับรอบระยะเวลาก่อนหน้านี้

ตัวอย่างต่อไปนี้แสดงวิธีที่คุณสามารถตั้งค่าข้อความอิเล็กทรอนิกส์เพื่อสร้างรายงานที่เป็นไปตามรูปแบบ ER การส่งออกสำหรับ Microsoft Excel ถ้าคุณต้องการทำตามตัวอย่างนี้ รูปแบบ ER การส่งออกของ Excel ต้องถูกสร้าง ถูกแม็ปไปยังแหล่งข้อมูล และเสร็จสมบูรณ์แล้ว นอกจากนี้ ลำดับหมายเลขต้องถูกตั้งค่าสำหรับข้อความอิเล็กทรอนิกส์เรียบร้อยแล้ว

เมื่อคุณสร้างการประมวลผล จะมีประโยชน์ ถ้าคุณกำหนดการดำเนินการประมวลผลและสถานะที่จะตั้งค่าก่อน ภาพประกอบต่อไปนี้แสดงการประมวลผลสำหรับตัวอย่างนี้

![แผนงานการประมวลผล](media/processing-scheme.png)

## <a name="create-message-statuses"></a>สร้างสถานะข้อความ

1. ไปยัง **ภาษี** \> **ตั้งค่า** \> **ข้อความอิเล็กทรอนิกส์** \> **สถานะข้อความ**
2. สร้างสถานะข้อความต่อไปนี้:

    - ใหม่
    - จัดเตรียมไว้
    - สร้างแล้ว

    ![สถานะข้อความ](media/message-statuses.png)

3. บนบรรทัดสำหรับสถานะ **สร้าง** เลือกกล่องกาเครื่องหมาย **อนุญาตให้ลบ** เพื่อให้ผู้ใช้สามารถลบข้อความที่มีสถานะนี้ได้

## <a name="create-additional-fields"></a>สร้างฟิลด์เพิ่มเติม

1. ไปยัง **ภาษี** \> **ตั้งค่า** \> **ข้อความอิเล็กทรอนิกส์** \> **ฟิลด์เพิ่มเติม**
2. เพิ่มฟิลด์เพิ่มเติมและค่า
3. ตั้งค่าตัวเลือก **การแก้ไขโดยผู้ใช้** เป็น **ใช่** เพื่อให้ผู้ใช้สามารถแก้ไขฟิลด์ได้

![ฟิลด์เพิ่มเติม](media/additional-fields.png)

## <a name="create-message-processing-actions"></a>สร้างการดำเนินการประมวลผลข้อความ

ตัวอย่างนี้ คุณจะสร้างการดำเนินการประมวลผลข้อความต่อไปนี้:

- **สร้างข้อความ**
- **อัพเดตเป็นเตรียมการแล้ว**
- **สร้างรายงาน**
- **อัพเดตเป็นสถานะเริ่มต้น** (ไม่จำเป็น)

ทำตามขั้นตอนเหล่านี้เพื่อสร้างการดำเนินการ

1. ไปยัง **ภาษี** \> **ตั้งค่า** \> **ข้อความอิเล็กทรอนิกส์** \> **การดำเนินการประมวลผลข้อความ**
2. สร้างการดำเนินการที่ชื่อว่า **สร้างข้อความ** บน FastTab **ทั่วไป** ในฟิลด์ **ชนิดการดำเนินการ** เลือก **สร้างข้อความ**
3. สร้างการดำเนินการที่มีชื่อว่า **อัพเดตเป็นเตรียมการแล้ว** และตั้งค่าฟิลด์ต่อไปนี้:

    - บน FastTab **ทั่วไป** ในฟิลด์ **ชนิดการดำเนินการ** เลือก **การประมวลผลของผู้ใช้ที่ระดับข้อความ**
    - บน FastTab **สถานะเริ่มต้น** ในฟิลด์ **สถานะของข้อความ** เลือก **สร้าง**
    - บน FastTab **สถานะผลลัพธ์** ในฟิลด์ **สถานะของข้อความ** เลือก **เตรียมการแล้ว** ในฟิลด์ **ชนิดการตอบสนอง** ป้อน **ดำเนินการเสร็จเรียบร้อยแล้ว**

4. สร้างการดำเนินการที่มีชื่อว่า **สร้างรายงาน** และตั้งค่าฟิลด์ต่อไปนี้:

    - บน FastTab **ทั่วไป** ในฟิลด์ **ชนิดการดำเนินการ** เลือก **การส่งออกการรายงานทางอิเล็กทรอนิกส์** ในฟิลด์ **การแม็ปรูปแบบ** เลือกรูปแบบ ER ที่ส่งออก ตัวเลือกคือ **Excel** **XML** **JSON** **ข้อความ** และ **อื่นๆ**
    - บน FastTab **สถานะเริ่มต้น** ในฟิลด์ **สถานะของข้อความ** เลือก **เตรียมการแล้ว**
    - บน FastTab **สถานะผลลัพธ์** ในฟิลด์ **สถานะของข้อความ** เลือก **สร้างแล้ว** ในฟิลด์ **ชนิดการตอบสนอง** ป้อน **ดำเนินการเสร็จเรียบร้อยแล้ว**

    ![สร้างการดำเนินการรายงาน](media/generate-report-action.png)

5. ตัวเลือก: เพื่อให้ผู้ใช้สามารถสร้างรายงานใหม่ได้หลายครั้ง สร้างการดำเนินการที่ชื่อ **อัพเดตเป็นสถานะเริ่มต้น** และตั้งค่าฟิลด์ต่อไปนี้:

    - บน FastTab **ทั่วไป** ในฟิลด์ **ชนิดการดำเนินการ** เลือก **การประมวลผลของผู้ใช้ที่ระดับข้อความ**
    - บน FastTab **สถานะเริ่มต้น** ในฟิลด์ **สถานะของข้อความ** เลือก **สร้างแล้ว**
    - บน FastTab **สถานะของผลลัพธ์** เพิ่มรายการแยกต่างหากสำหรับแต่ละสถานะของสถานะข้อความสองสถานะ (**จัดเตรียมแล้ว** และ **สร้าง**) สำหรับรายการทั้งสองรายการ ตั้งค่าฟิลด์ **ชนิดการตอบสนอง** เป็น **ดำเนินการเสร็จเรียบร้อยแล้ว**

## <a name="electronic-message-processing"></a>การประมวลผลข้อความทางอิเล็กทรอนิกส์

สำหรับตัวอย่างนี้ การดำเนินการทั้งหมดควรถูกตั้งค่าเพื่อให้สามารถทำงานได้โดยแยกต่างหาก ข้อสมมติฐานคือ ผู้ใช้จะเริ่มต้นการดำเนินการทั้งหมด

1. ไปยัง **ภาษี** \> **ตั้งค่า** \> **ข้อความอิเล็กทรอนิกส์** \> **การประมวลผลข้อความอิเล็กทรอนิกส์**
2. เพิ่มเรกคอร์ดสำหรับการประมวลผลของคุณ และเพิ่มการดำเนินการที่กำหนดไว้ก่อนหน้านี้ทั้งหมดและฟิลด์เพิ่มเติม
3. ไม่จำเป็นต้องระบุ: บน FastTab **Security role** กำหนด Security role สำหรับการประมวลผลของคุณเพื่อจำกัดการเข้าถึงไปยังการรายงานเฉพาะ
4. ไปยัง **ภาษี** \> **การสอบถามและรายงาน** \> **ข้อความอิเล็กทรอนิกส์** \> **ข้อความอิเล็กทรอนิกส์**
5. เลือก **สร้าง** เพื่อสร้างข้อความ ณ จุดนี้ คุณสามารถเพิ่มวันที่และคำอธิบายได้ คุณยังสามารถปรับปรุงค่าของฟิลด์เพิ่มเติมได้ตามที่คุณต้องการ

    ![การสร้างข้อความอิเล็กทรอนิกส์](media/create-electronic-message.png)

    กริดบน FastTab **ล็อกการดำเนินการ** จะถูกเติมโดยอัตโนมัติ ด้วยล็อกของการดำเนินการทั้งหมดที่ถูกดำเนินการในข้อความ

    ขณะนี้ คุณสามารถลบ หรืออัพเดตสถานะข้อความได้ 

6. ในการอัพเดตสถานะข้อความ เลือก **อัพเดตสถานะ** ในฟิลด์ **สถานะใหม่** เลือก **จัดเตรียมแล้ว** แล้วจากนั้น เลือก **ตกลง**

    ![การอัพเดตสถานะข้อความ](media/update-status.png)

    สถานะของข้อความจะถูกอัพเดตเป็นสถานะ **จัดเตรียมไว้**

7. สร้างรายงานโดยการเลือก **สร้างรายงาน**

    มีการสร้างรายงาน และมีการอัพเดตล็อกการดำเนินการและสถานะของข้อความ

8. ในการดูรายงานที่สร้างขึ้น เลือกปุ่ม **เอกสารแนบ** (สัญลักษณ์คลิปหนีบกระดาษ) ในมุมขวาบนของหน้า

[!INCLUDE[footer-include](../../includes/footer-banner.md)]
