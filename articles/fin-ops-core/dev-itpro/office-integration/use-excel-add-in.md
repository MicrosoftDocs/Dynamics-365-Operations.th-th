---
title: ดูและอัพเดตข้อมูลเอนทิตีกับ Excel
description: หัวข้อนี้อธิบายวิธีการเปิดข้อมูลเอนทิตีใน Microsoft Excel และจากนั้นดู อัพเดต และแก้ไขข้อมูลโดยใช้ Add-in ของ Microsoft Dynamics  Excel
author: jasongre
manager: AnnBe
ms.date: 01/22/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: sericks
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 9b7da9867ed86921f3487077081ec63e8b44e92c
ms.sourcegitcommit: 6cb174d1ec8b55946dca4db03d6a3c3f4c6fa2df
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 03/09/2021
ms.locfileid: "5562560"
---
# <a name="view-and-update-entity-data-with-excel"></a><span data-ttu-id="62072-103">ดูและอัพเดตข้อมูลเอนทิตีกับ Excel</span><span class="sxs-lookup"><span data-stu-id="62072-103">View and update entity data with Excel</span></span> 

[!include [applies to](../includes/applies-to-commerce-finance-scm.md)]

[!include [banner](../includes/banner.md)]
[!include [preview banner](../includes/preview-banner.md)]

<span data-ttu-id="62072-104">หัวข้อนี้อธิบายวิธีการเปิดข้อมูลเอนทิตีใน Microsoft Excel และจากนั้นดู อัพเดต และแก้ไขข้อมูลโดยใช้ Add-in ของ Microsoft Dynamics  Excel</span><span class="sxs-lookup"><span data-stu-id="62072-104">This topic explains how to open entity data in Microsoft Excel, and then view, update, and edit the data by using the Microsoft Dynamics Excel add-in.</span></span> <span data-ttu-id="62072-105">เมื่อต้องการเอนทิตีข้อมูล คุณสามารถเริ่มจาก Excel หรือแอป Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="62072-105">To open entity data, you can start from either Excel or Finance and Operations apps.</span></span>

<span data-ttu-id="62072-106">โดยการเปิดข้อมูลเอนทิตีใน Excel คุณสามารถดูและแก้ไขข้อมูลได้อย่างรวดเร็วและอย่างง่ายดายโดยใช้ Add-in ของ Excel</span><span class="sxs-lookup"><span data-stu-id="62072-106">By opening entity data in Excel, you can quickly and easily view and edit the data by using the Excel add-in.</span></span> <span data-ttu-id="62072-107">Add-in นี้จำเป็นต้องมี Microsoft Excel 2016 หรือสูงกว่า</span><span class="sxs-lookup"><span data-stu-id="62072-107">This add-in requires Microsoft Excel 2016 or later.</span></span>

> [!NOTE]
> <span data-ttu-id="62072-108">หากผู้เช่า Microsoft Azure Active Directory (Azure AD) ของคุณถูกตั้งค่าคอนฟิกให้ใช้ Active Directory Federation Services (AD FS) คุณต้องแน่ใจว่ามีการใช้การอัพเดตเดือนพฤษภาคม 2016 สำหรับ Office เพื่อให้ Add-in ของ Excel สามารถนำคุณเข้าสู่ระบบได้อย่างถูกต้อง</span><span class="sxs-lookup"><span data-stu-id="62072-108">If your Microsoft Azure Active Directory (Azure AD) tenant is configured to use Active Directory Federation Services (AD FS), you must make sure that the May 2016 update for Office has been applied, so that the Excel add-in can correctly sign you in.</span></span>

<span data-ttu-id="62072-109">เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับการใช้ add-in ของ Excel ให้ดูวิดีโอ [สร้างแม่แบบ Excel สำหรับหัวข้อและรูปแบบรายการ](https://youtu.be/RTicLb-6dbI)</span><span class="sxs-lookup"><span data-stu-id="62072-109">To learn more about how to use the Excel add-in, watch the short [Create an Excel template for header and line patterns](https://youtu.be/RTicLb-6dbI) video.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-a-finance-and-operations-app"></a><span data-ttu-id="62072-110">เปิดข้อมูลเอนทิตีใน Excel เมื่อคุณเริ่มการทำงานจากแอป Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="62072-110">Open entity data in Excel when you start from a Finance and Operations app</span></span>
1. <span data-ttu-id="62072-111">บนหน้าในแอป Finance and Operations ให้เลือก **เปิดใน Microsoft Office**</span><span class="sxs-lookup"><span data-stu-id="62072-111">On a page in a Finance and Operations app, select **Open in Microsoft Office**.</span></span>

    <span data-ttu-id="62072-112">ถ้าแหล่งข้อมูลราก (ตาราง) สำหรับหน้าเหมือนกับแหล่งข้อมูลรากสำหรับเอนทิตีใดๆ ตัวเลือก **เปิดใน Excel** จะถูกสร้างขึ้นสำหรับหน้านั้น</span><span class="sxs-lookup"><span data-stu-id="62072-112">If the root data source (table) for the page is the same as the root data source for any entities, default **Open in Excel** options are generated for the page.</span></span> <span data-ttu-id="62072-113">สามารถดูตัวเลือก **เปิดใน Excel** ได้ในหน้าที่ใช้บ่อย เช่น **ผู้จัดจำหน่ายทั้งหมด** และ **ลูกค้าทั้งหมด**</span><span class="sxs-lookup"><span data-stu-id="62072-113">**Open in Excel** options can be found on frequently used pages, such as **All vendors** and **All customers**.</span></span>
 
2. <span data-ttu-id="62072-114">เลือกตัวเลือก **เปิดใน Excel** และเปิดสมุดงานที่สร้างขึ้น</span><span class="sxs-lookup"><span data-stu-id="62072-114">Select an **Open in Excel** option, and open the workbook that is generated.</span></span> <span data-ttu-id="62072-115">สมุดงานนี้มีข้อมูลการผูกข้อมูลสำหรับเอนทิตี ตัวชี้ไปยังสภาพแวดล้อมของคุณ และตัวชี้ไปยัง Add-in ของ Excel</span><span class="sxs-lookup"><span data-stu-id="62072-115">This workbook has binding information for the entity, a pointer to your environment, and a pointer to the Excel add-in.</span></span>
3. <span data-ttu-id="62072-116">ใน Excel เลือก **เปิดใช้งานการแก้ไข** เพื่อเปิดใช้งาน Add-in ของ Excel เพื่อให้รัน</span><span class="sxs-lookup"><span data-stu-id="62072-116">In Excel, select **Enable editing** to enable the Excel add-in to run.</span></span> <span data-ttu-id="62072-117">Add-in ของ Excel จะทำงานในบานหน้าต่างด้านขวาของหน้าต่าง Excel</span><span class="sxs-lookup"><span data-stu-id="62072-117">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="62072-118">ถ้าคุณกำลังเรียกใช้ Add-in ของ Excel เป็นครั้งแรก เลือก **เชื่อถือ Add-in นี้**</span><span class="sxs-lookup"><span data-stu-id="62072-118">If you're running the Excel add-in for the first time, select **Trust this Add-in**.</span></span>
5. <span data-ttu-id="62072-119">ถ้าคุณได้รับการพร้อมท์ให้เข้าสู่ระบบ เลือก **เข้าสู่ระบบ** และจากนั้นเข้าสู่ระบบโดยใช้ข้อมูลประจำตัวเดียวกับที่คุณใช้เพื่อเข้าสู่แอป Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="62072-119">If you're prompted to sign in, select **Sign in**, and then sign in by using the same credentials that you used to sign in to the Finance and Operations app.</span></span> <span data-ttu-id="62072-120">Add-in ของ Excel จะใช้บริบทการลงชื่อเข้าใช้ก่อนหน้าจากเบราว์เซอร์ และจะลงชื่อเข้าใช้ให้กับคุณโดยอัตโนมัติ ถ้าสามารถทำได้</span><span class="sxs-lookup"><span data-stu-id="62072-120">The Excel add-in will use a previous sign-in context from the browser and automatically sign you in, if it can.</span></span> <span data-ttu-id="62072-121">(หากต้องการทราบข้อมูลเกี่ยวกับเบราเซอร์ที่ใช้ระบบปฏิบัติการ โปรดดู [เบราเซอร์ที่ใช้โดย Add-in ของ Office](https://docs.microsoft.com/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.) เพื่อให้แน่ใจว่าการลงชื่อเข้าใช้ประสบความสําเร็จ ให้ตรวจสอบชื่อผู้ใช้ในมุมด้านขวาบนของ Add-in ของ Excel</span><span class="sxs-lookup"><span data-stu-id="62072-121">(For information about the browser that is used based on the operating system, see [Browsers used by Office add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.) To ensure that sign-in was successful, verify the user name in the upper-right corner of the Excel add-in.</span></span> 

<span data-ttu-id="62072-122">Add-in ของ Excel จะอ่านข้อมูลสำหรับเอนทิตีที่คุณเลือกโดยอัตโนมัติ</span><span class="sxs-lookup"><span data-stu-id="62072-122">The Excel add-in automatically reads the data for the entity that you selected.</span></span> <span data-ttu-id="62072-123">หมายเหตุว่าไม่มีข้อมูลใดๆ ในสมุดงานจนกระทั่ง Add-in ของ Excel มีการอ่าน</span><span class="sxs-lookup"><span data-stu-id="62072-123">Note that there will be no data in the workbook until the Excel add-in reads it in.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a><span data-ttu-id="62072-124">เปิดข้อมูลเอนทิตีใน Excel เมื่อคุณเริ่มการทำงานจาก Excel</span><span class="sxs-lookup"><span data-stu-id="62072-124">Open entity data in Excel when you start from Excel</span></span>
1. <span data-ttu-id="62072-125">ใน Excel บนแท็บ **แทรก** ในกลุ่ม **Add-in** เลือก **ร้านค้า** เพื่อเปิด Office Store</span><span class="sxs-lookup"><span data-stu-id="62072-125">In Excel, on the **Insert** tab, in the **Add-ins** group, select **Store** to open the Office Store.</span></span>
2. <span data-ttu-id="62072-126">ใน Office Store ค้นหาโดยใช้คำสำคัญ **Dynamics** และเลือก **เพิ่ม** ถัดจาก **Add-in ของ Microsoft Dynamics Office** (the Excel add-in)</span><span class="sxs-lookup"><span data-stu-id="62072-126">In the Office Store, search on the keyword **Dynamics**, and then select **Add** next to **Microsoft Dynamics Office Add-in** (the Excel add-in).</span></span>
3. <span data-ttu-id="62072-127">ถ้าคุณกำลังเรียกใช้ Add-in ของ Excel เป็นครั้งแรก เลือก **เชื่อถือ Add-in นี้** เพื่อเปิดใช้งาน Add-in ของ Excel เพื่อให้รัน</span><span class="sxs-lookup"><span data-stu-id="62072-127">If you're running the Excel add-in for the first time, select **Trust this Add-in** to enable the Excel add-in to run.</span></span> <span data-ttu-id="62072-128">Add-in ของ Excel จะทำงานในบานหน้าต่างด้านขวาของหน้าต่าง Excel</span><span class="sxs-lookup"><span data-stu-id="62072-128">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="62072-129">เลือก **เพิ่มข้อมูลเซิร์ฟเวอร์** เพื่อเปิดบานหน้าต่าง **ตัวเลือก**</span><span class="sxs-lookup"><span data-stu-id="62072-129">Select **Add server information** to open the **Options** pane.</span></span>
5. <span data-ttu-id="62072-130">ในเบราเซอร์ของคุณ คัดลอก URL ของอินสแตนซ์แอป Finance and Operations เป้าหมายของคุณ วางลงในฟิลด์ **URL ของเซิร์ฟเวอร์** และจากนั้นลบทุกอย่างหลังชื่อโฮสต์</span><span class="sxs-lookup"><span data-stu-id="62072-130">In your browser, copy the URL of your target Finance and Operations app instance, paste it into the **Server URL** field, and then delete everything after the host name.</span></span> <span data-ttu-id="62072-131">URL ที่เป็นผลลัพธ์ควรมีเพียงชื่อโฮสต์เดียว</span><span class="sxs-lookup"><span data-stu-id="62072-131">The resulting URL should have only the host name.</span></span>

    <span data-ttu-id="62072-132">ตัวอย่างเช่น ถ้า URL คือ `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage` ลบทุกอย่างยกเว้น `https://xxx.dynamics.com`</span><span class="sxs-lookup"><span data-stu-id="62072-132">For example, if the URL is `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`, delete everything except `https://xxx.dynamics.com`.</span></span>

6. <span data-ttu-id="62072-133">เลือก **ตกลง** แล้วเลือก **ใช่** เพื่อยืนยันการเปลี่ยนแปลง</span><span class="sxs-lookup"><span data-stu-id="62072-133">Select **OK**, and then select **Yes** to confirm the change.</span></span> <span data-ttu-id="62072-134">Add-in ของ Excel ถูกรีสตาร์ทและโหลดข้อมูลเมตา</span><span class="sxs-lookup"><span data-stu-id="62072-134">The Excel add-in is restarted and loads metadata.</span></span>

    <span data-ttu-id="62072-135">ปุ่ม **การออกแบบ** พร้อมใช้งานแล้วในขณะนี้</span><span class="sxs-lookup"><span data-stu-id="62072-135">The **Design** button is now available.</span></span> <span data-ttu-id="62072-136">ถ้า Add-in ของ Excel มีปุ่ม **โหลดแอปเพล็ต** คุณอาจไม่ได้เข้าสู่ระบบในฐานะผู้ใช้ที่ถูกต้อง</span><span class="sxs-lookup"><span data-stu-id="62072-136">If the Excel add-in has a **Load applets** button, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="62072-137">สำหรับข้อมูลเพิ่มเติม ดู "มีการแสดงปุ่มโหลดแอปเพล็ต" ในส่วน [การแก้ไขปัญหาเบื้องต้น](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting) ของหัวข้อนี้</span><span class="sxs-lookup"><span data-stu-id="62072-137">For more information, see "The Load applets button is shown" in the [Troubleshooting](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting) section of this topic.</span></span>

7. <span data-ttu-id="62072-138">เลือก **การออกแบบ**</span><span class="sxs-lookup"><span data-stu-id="62072-138">Select **Design**.</span></span> <span data-ttu-id="62072-139">Add-in ของ Excel ดึงข้อมูลเมตาของเอนทิตี</span><span class="sxs-lookup"><span data-stu-id="62072-139">The Excel add-in retrieves entity metadata.</span></span>
8. <span data-ttu-id="62072-140">เลือก **เพิ่มตาราง**</span><span class="sxs-lookup"><span data-stu-id="62072-140">Select **Add table**.</span></span> <span data-ttu-id="62072-141">รายการของเอนทิตีปรากฏขึ้น</span><span class="sxs-lookup"><span data-stu-id="62072-141">A list of entities appears.</span></span> <span data-ttu-id="62072-142">เอนทิตีจะแสดงรายการในรูปแบบ "ชื่อ - ป้ายชื่อ"</span><span class="sxs-lookup"><span data-stu-id="62072-142">The entities are listed in "Name - Label" format.</span></span>
9. <span data-ttu-id="62072-143">เลือกเอนทิตีในรายการ เช่น **ลูกค้า - ลูกค้า** แล้วเลือก **ถัดไป**</span><span class="sxs-lookup"><span data-stu-id="62072-143">Select an entity in the list, such as **Customer - Customers**, and then select **Next**.</span></span>
10. <span data-ttu-id="62072-144">เมื่อต้องการเพิ่มฟิลด์จากรายการ **ฟิลด์ที่มีพร้อมใช้งาน** ไปยังรายการ **ฟิลด์ที่เลือก** ให้เลือกฟิลด์ และจากนั้นเลือก **เพิ่ม**</span><span class="sxs-lookup"><span data-stu-id="62072-144">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="62072-145">อีกทางหนึ่งคือ ดับเบิลคลิกที่ฟิลด์ในรายการ **ฟิลด์ที่พร้อมใช้งาน**</span><span class="sxs-lookup"><span data-stu-id="62072-145">Alternatively, double-click the field in the **Available fields** list.</span></span>
11. <span data-ttu-id="62072-146">หลังจากที่คุณได้เพิ่มฟิลด์ไปยังรายการ **ฟิลด์ที่เลือก** แล้ว โปรดตรวจสอบให้แน่ใจว่าเคอร์เซอร์อยู่ในตำแหน่งที่ถูกต้องในแผ่นงาน (ตัวอย่างเช่น เซลล์ A1) และจากนั้นเลือก **เสร็จสิ้น**</span><span class="sxs-lookup"><span data-stu-id="62072-146">After you've finished adding fields to the **Selected fields** list, make sure that the cursor is in the correct place in the worksheet (for example, cell A1), and then select **Done**.</span></span> <span data-ttu-id="62072-147">แล้วเลือก **เสร็จสิ้น** เพื่อออกจากการออกแบบ</span><span class="sxs-lookup"><span data-stu-id="62072-147">Then select **Done** to exit the designer.</span></span>
12. <span data-ttu-id="62072-148">เลือก **รีเฟรช** เพื่อดึงชุดข้อมูล</span><span class="sxs-lookup"><span data-stu-id="62072-148">Select **Refresh** to pull in a set of data.</span></span>

## <a name="view-and-update-entity-data-in-excel"></a><span data-ttu-id="62072-149">ดูและอัพเดตข้อมูลเอนทิตีใน Excel</span><span class="sxs-lookup"><span data-stu-id="62072-149">View and update entity data in Excel</span></span>
<span data-ttu-id="62072-150">หลังจาก Add-in ของ Excel อ่านข้อมูลเอนทิตีลงในสมุดงาน คุณสามารถอัพเดตข้อมูลได้ตลอดเวลาโดยการเลือก **รีเฟรช** ใน Add-in ของ Excel</span><span class="sxs-lookup"><span data-stu-id="62072-150">After the Excel add-in reads entity data into the workbook, you can update the data at any time by selecting **Refresh** in the Excel add-in.</span></span>

## <a name="edit-entity-data-in-excel"></a><span data-ttu-id="62072-151">แก้ไขข้อมูลของเอนทิตีใน Excel</span><span class="sxs-lookup"><span data-stu-id="62072-151">Edit entity data in Excel</span></span>
<span data-ttu-id="62072-152">คุณสามารถเปลี่ยนแปลงข้อมูลเอนทิตีได้ตามที่คุณต้องการ แล้วเผยแพร่กลับมาแอป Finance and Operations โดยการเลือก **เผยแพร่** ใน Add-in ของ Excel</span><span class="sxs-lookup"><span data-stu-id="62072-152">You can change entity data as you require and then publish it back to Finance and Operations apps by selecting **Publish** in the Excel add-in.</span></span> <span data-ttu-id="62072-153">เมื่อต้องการแก้ไขเรกคอร์ด เลือกเซลล์ในแผ่นงาน และจากนั้นเปลี่ยนค่าในเซลล์</span><span class="sxs-lookup"><span data-stu-id="62072-153">To edit a record, select a cell in the worksheet, and then change the cell value.</span></span> <span data-ttu-id="62072-154">เมื่อต้องการเพิ่มเรกคอร์ดใหม่ ให้ทำตามขั้นตอนเหล่านี้:</span><span class="sxs-lookup"><span data-stu-id="62072-154">To add a new record, follow one of these steps:</span></span>

- <span data-ttu-id="62072-155">คลิกที่ใดก็ได้ในตารางแหล่งข้อมูล และจากนั้นเลือก **สร้าง** ใน Add-in ของ Excel</span><span class="sxs-lookup"><span data-stu-id="62072-155">Click anywhere in the data sources table, and then select **New** in the Excel add-in.</span></span>
- <span data-ttu-id="62072-156">คลิกที่ใดก็ได้ในแถวสุดท้ายของตารางแหล่งข้อมูล และจากนั้นกดแป้น Tab จนกว่าเคอร์เซอร์จะย้ายออกจากคอลัมน์สุดท้ายของแถวนั้น และแถวใหม่ถูกสร้างขึ้น</span><span class="sxs-lookup"><span data-stu-id="62072-156">Click anywhere in the last row of the data sources table, and then press the Tab key until the cursor moves out of the last column of that row and a new row is created.</span></span>
- <span data-ttu-id="62072-157">คลิกที่ใดก็ได้ในแถวโดยทันทีที่ด้านล่างตารางแหล่งข้อมูล และเริ่มป้อนข้อมูลในเซลล์</span><span class="sxs-lookup"><span data-stu-id="62072-157">Click anywhere in the row immediately below the data sources table, and start to enter data in a cell.</span></span> <span data-ttu-id="62072-158">เมื่อคุณย้ายโฟกัสออกจากเซลล์นั้น ตารางแหล่งข้อมูลจะขยายเพื่อรวมแถวใหม่</span><span class="sxs-lookup"><span data-stu-id="62072-158">When you move the focus out of that cell, the table expands to include the new row.</span></span>
- <span data-ttu-id="62072-159">สำหรับการผูกฟิลด์ของเรกคอร์ดหัวข้อ ให้เลือกฟิลด์ใดฟิลด์หนึ่ง และเลือก **สร้าง** ใน Add-in ของ Excel</span><span class="sxs-lookup"><span data-stu-id="62072-159">For field bindings of header records, select one of the fields, and then select **New** in the Excel add-in.</span></span>

<span data-ttu-id="62072-160">หมายเหตุว่าคุณสามารถสร้างเรกคอร์ดใหม่ได้ถ้าคีย์และฟิลด์บังคับทั้งหมดถูกผูกไว้ในแผ่นงาน หรือค่าเริ่มต้นถูกกรอกข้อมูลโดยใช้เงื่อนไขตัวกรองเท่านั้น</span><span class="sxs-lookup"><span data-stu-id="62072-160">Note that a new record can be created only if all the key and mandatory fields are bound in the worksheet, or if default values were filled in by using the filter condition.</span></span>

<span data-ttu-id="62072-161">เมื่อต้องการลบเรกคอร์ด ให้ทำตามขั้นตอนเหล่านี้:</span><span class="sxs-lookup"><span data-stu-id="62072-161">To delete a record, follow one of these steps:</span></span>

- <span data-ttu-id="62072-162">คลิกขวาที่หมายเลขแถวที่อยู่ถัดจากแถวของแผ่นงานที่ควรถูกลบ และจากนั้นเลือก **ลบ**</span><span class="sxs-lookup"><span data-stu-id="62072-162">Right-click the row number next to the worksheet row that should be deleted, and then select **Delete**.</span></span>
- <span data-ttu-id="62072-163">คลิกขวาที่ใดก็ได้ในแถวของแผ่นงานที่ควรถูกลบ และจากนั้นเลือก **ลบ** &gt; **แถวของตาราง**</span><span class="sxs-lookup"><span data-stu-id="62072-163">Right-click anywhere in the worksheet row that should be deleted, and then select **Delete** &gt; **Table Rows**.</span></span>

<span data-ttu-id="62072-164">ถ้าแหล่งข้อมูลถูกเพิ่มเป็นแหล่งข้อมูลที่เกี่ยวข้อง จะมีการเผยแพร่หัวข้อก่อนรายการ</span><span class="sxs-lookup"><span data-stu-id="62072-164">If data sources have been added as related data sources, the header is published before the lines.</span></span> <span data-ttu-id="62072-165">ถ้ามีการขึ้นต่อกันระหว่างแหล่งข้อมูลอื่นๆ คุณอาจต้องเปลี่ยนลำดับการเผยแพร่ค่าเริ่มต้น</span><span class="sxs-lookup"><span data-stu-id="62072-165">If there are dependencies between other data sources, you might have to change the default publishing order.</span></span> <span data-ttu-id="62072-166">เมื่อต้องการเปลี่ยนลำดับการเผยแพร่ ใน add-in ของ Excel เลือกปุ่ม **ตัวเลือก** (สัญลักษณ์เกียร์) และจากนั้น บน FastTab **ตัวเชื่อมต่อข้อมูล** เลือก **ตั้งค่าคอนฟิกการเผยแพร่ใบสั่ง**</span><span class="sxs-lookup"><span data-stu-id="62072-166">To change the publishing order, in the Excel add-in, select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Configure publish order**.</span></span>

## <a name="add-or-remove-columns"></a><span data-ttu-id="62072-167">เพิ่มหรือเอาคอลัมน์ออก</span><span class="sxs-lookup"><span data-stu-id="62072-167">Add or remove columns</span></span>
<span data-ttu-id="62072-168">คุณสามารถใช้ตัวออกแบบในการปรับปรุงคอลัมน์ที่ถูกเพิ่มไปยังแผ่นงานโดยอัตโนมัติ</span><span class="sxs-lookup"><span data-stu-id="62072-168">You can use the designer to adjust the columns that are automatically added to the worksheet.</span></span>

> [!NOTE]
> <span data-ttu-id="62072-169">ถ้าปุ่ม **ออกแบบ** ไม่ปรากฏด้านล่างของปุ่ม **ตัวกรอง** ใน add-in ของ Excel คุณต้องเปิดใช้งานตัวออกแบบแหล่งข้อมูล</span><span class="sxs-lookup"><span data-stu-id="62072-169">If the **Design** button doesn't appear below the **Filter** button in the Excel add-in, you must enable the data source designer.</span></span> <span data-ttu-id="62072-170">เลือกปุ่ม **ตัวเลือก** (สัญลักษณ์เกียร์) และจากนั้นเลือกกล่องกาเครื่องหมาย **เปิดใช้งานการออกแบบ**</span><span class="sxs-lookup"><span data-stu-id="62072-170">Select the **Options** button (the gear symbol), and then select the **Enable design** check box.</span></span>

1. <span data-ttu-id="62072-171">ใน Add-in ของ Excel เลือก **ออกแบบ**</span><span class="sxs-lookup"><span data-stu-id="62072-171">In the Excel add-in, select **Design**.</span></span> <span data-ttu-id="62072-172">แหล่งข้อมูลทั้งหมดมีแสดงรายการไว้</span><span class="sxs-lookup"><span data-stu-id="62072-172">All the data sources are listed.</span></span>
2. <span data-ttu-id="62072-173">ถัดจากแหล่งข้อมูล เลือกปุ่ม **แก้ไข** (สัญลักษณ์ดินสอ)</span><span class="sxs-lookup"><span data-stu-id="62072-173">Next to the data source, select the **Edit** button (the pencil symbol).</span></span>
3. <span data-ttu-id="62072-174">ในรายการ **ฟิลด์ที่เลือก** ปรับรายการของฟิลด์ตามที่คุณต้องการ:</span><span class="sxs-lookup"><span data-stu-id="62072-174">In the **Selected fields** list, adjust the list of fields as you require:</span></span>

    - <span data-ttu-id="62072-175">เมื่อต้องการเพิ่มฟิลด์จากรายการ **ฟิลด์ที่มีพร้อมใช้งาน** ไปยังรายการ **ฟิลด์ที่เลือก** ให้เลือกฟิลด์ และจากนั้นเลือก **เพิ่ม**</span><span class="sxs-lookup"><span data-stu-id="62072-175">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="62072-176">อีกทางหนึ่งคือ ดับเบิลคลิกที่ฟิลด์ในรายการ **ฟิลด์ที่พร้อมใช้งาน**</span><span class="sxs-lookup"><span data-stu-id="62072-176">Alternatively, double-click the field in the **Available fields** list.</span></span>
    - <span data-ttu-id="62072-177">เมื่อต้องการเอาฟิลด์ออกจากรายการ **ฟิลด์ที่เลือก** เลือกฟิลด์ และจากนั้นเลือก **เอาออก**</span><span class="sxs-lookup"><span data-stu-id="62072-177">To remove a field from the **Selected fields** list, select the field, and then select **Remove**.</span></span> <span data-ttu-id="62072-178">อีกวิธีหนึ่งคือ คลิกที่ฟิลด์สองครั้ง</span><span class="sxs-lookup"><span data-stu-id="62072-178">Alternatively, double-click the field.</span></span>
    - <span data-ttu-id="62072-179">เมื่อต้องการเปลี่ยนลำดับของฟิลด์ในรายการ **ฟิลด์ที่เลือก** เลือกฟิลด์ และจากนั้นเลือก **ขึ้น** หรือ **ลง**</span><span class="sxs-lookup"><span data-stu-id="62072-179">To change the order of fields in the **Selected fields** list, select a field, and then select **Up** or **Down**.</span></span>

4. <span data-ttu-id="62072-180">เมื่อต้องการนำการเปลี่ยนแปลงของคุณไปใช้กับแหล่งข้อมูล เลือก **อัพเดต**</span><span class="sxs-lookup"><span data-stu-id="62072-180">To apply your changes to the data source, select **Update**.</span></span> <span data-ttu-id="62072-181">แล้วเลือก **เสร็จสิ้น** เพื่อออกจากการออกแบบ</span><span class="sxs-lookup"><span data-stu-id="62072-181">Then select **Done** to exit the designer.</span></span>
5. <span data-ttu-id="62072-182">ถ้าคุณเพิ่มฟิลด์ (คอลัมน์) แล้ว ให้เลือก **รีเฟรช** เพื่อดึงชุดข้อมูลที่อัพเดตแล้ว</span><span class="sxs-lookup"><span data-stu-id="62072-182">If you added a field (column), select **Refresh** to pull in an updated set of data.</span></span>

## <a name="change-the-publish-batch-size"></a><span data-ttu-id="62072-183">เปลี่ยนขนาดชุดงานการเผยแพร่</span><span class="sxs-lookup"><span data-stu-id="62072-183">Change the publish batch size</span></span>
<span data-ttu-id="62072-184">เมื่อผู้ใช้เผยแพร่การเปลี่ยนแปลงที่เรกคอร์ดข้อมูลโดยใช้ Add-in ของ Excel การอัปเดตจะถูกส่งในชุดงาน</span><span class="sxs-lookup"><span data-stu-id="62072-184">When users publish changes to data records by using the Excel add-in, the updates are submitted in batches.</span></span> <span data-ttu-id="62072-185">ขนาดชุดงานการเผยแพร่เริ่มต้นคือ 100 แถว</span><span class="sxs-lookup"><span data-stu-id="62072-185">The default publish batch size is 100 rows.</span></span> <span data-ttu-id="62072-186">ในรุ่น 10.0.17 และรุ่นต่อมา คุณลักษณะ **อนุญาตให้การตั้งค่าคอนฟิกของขนาดชุดงานที่เผยแพร่ใน Add-in ของ Excel** ช่วยให้คุณสามารถควบคุมขนาดชุดงานการเผยแพร่แบบยืดหยุ่นได้</span><span class="sxs-lookup"><span data-stu-id="62072-186">In version 10.0.17 and later, the **Allow configuration of the publish batch size in the Excel add-in** feature gives you flexible control over the publish batch size.</span></span>

<span data-ttu-id="62072-187">ผู้ดูแลระบบสามารถระบุขีดจํากัดของขนาดชุดงานที่เผยแพร่ทั่วทั้งระบบในสมุดงาน "เปิดใน Excel" โดยการตั้งค่าฟิลด์ **เผยแพร่ขีดจํากัดชุดงาน** ในส่วน **พารามิเตอร์แอป** ของหน้า **พารามิเตอร์แอป Office**</span><span class="sxs-lookup"><span data-stu-id="62072-187">System administrators can specify a system-wide limit on the publish batch size for "Open in Excel" workbooks by setting the **Publish batch limit** field in the **App parameters** section of the **Office app parameters** page.</span></span>

<span data-ttu-id="62072-188">นอกจากนี้ คุณยังสามารถเปลี่ยนขนาดชุดงานการเผยแพร่ของสมุดงานแต่ละสมุดงานได้โดยใช้ Add-in ของ Excel</span><span class="sxs-lookup"><span data-stu-id="62072-188">The publish batch size can also be changed for an individual workbook by using the Excel add-in.</span></span>

1. <span data-ttu-id="62072-189">เปิดสมุดงานใน Excel</span><span class="sxs-lookup"><span data-stu-id="62072-189">Open the workbook in Excel.</span></span>
2. <span data-ttu-id="62072-190">เลือกปุ่ม **ตัวเลือก** (เกียร์) ที่มุมขวาบนของ Add-in ของ Excel</span><span class="sxs-lookup"><span data-stu-id="62072-190">Select the **Option** (gear) button in the upper right of the Excel add-in.</span></span>
3. <span data-ttu-id="62072-191">ตั้งค่าฟิลด์ **เผยแพร่ขนาดชุดงาน** ตามต้องการ</span><span class="sxs-lookup"><span data-stu-id="62072-191">Set the **Publish batch size** field as desired.</span></span> <span data-ttu-id="62072-192">ค่าที่คุณตั้งค่าต้องน้อยกว่าขีดจํากัดของชุดงานการเผยแพร่ทั่วทั้งระบบ</span><span class="sxs-lookup"><span data-stu-id="62072-192">The value that you set must be less than the system-wide publish batch limit.</span></span>
4. <span data-ttu-id="62072-193">เลือก **ตกลง**</span><span class="sxs-lookup"><span data-stu-id="62072-193">Select **OK**.</span></span>
5. <span data-ttu-id="62072-194">บันทึกสมุดงาน</span><span class="sxs-lookup"><span data-stu-id="62072-194">Save the workbook.</span></span> <span data-ttu-id="62072-195">ถ้าคุณไม่ได้บันทึกสมุดงานหลังจากที่คุณเปลี่ยนแปลงการตั้งค่า Add-in การเปลี่ยนแปลงเหล่านั้นจะไม่ยังคงอยู่เมื่อเปิดสมุดงานอีกครั้ง</span><span class="sxs-lookup"><span data-stu-id="62072-195">If you don't save the workbook after you make changes to the add-in settings, those changes won't persist when the workbook is reopened.</span></span>

<span data-ttu-id="62072-196">ผู้สร้างแม่แบบสมุดงาน Excel สามารถใช้ขั้นตอนเดียวกันเพื่อตั้งค่าขนาดชุดงานการเผยแพร่ของแม่แบบก่อนที่จะอัปโหลดไปยังระบบ</span><span class="sxs-lookup"><span data-stu-id="62072-196">Excel workbook template authors can use the same procedure to set the publish batch size for templates before they upload them into the system.</span></span>

## <a name="copy-environment-data"></a><span data-ttu-id="62072-197">คัดลอกข้อมูลสภาพแวดล้อม</span><span class="sxs-lookup"><span data-stu-id="62072-197">Copy environment data</span></span>

<span data-ttu-id="62072-198">ข้อมูลที่ถูกอ่านลงในสมุดงานจากสภาพแวดล้อมเดียว สามารถถูกคัดลอกไปยังสภาพแวดล้อมอื่นได้</span><span class="sxs-lookup"><span data-stu-id="62072-198">The data that is read into the workbook from one environment can be copied to another environment.</span></span> <span data-ttu-id="62072-199">อย่างไรก็ตาม คุณไม่สามารถเพียงแค่เปลี่ยน URL การเชื่อมต่อ เนื่องจากแคชข้อมูลในสมุดงานจะดำเนินต่อเพื่อจัดการข้อมูลในฐานะข้อมูลที่มีอยู่</span><span class="sxs-lookup"><span data-stu-id="62072-199">However, you can't just change the connection URL, because the data cache in the workbook will continue to treat the data as existing data.</span></span> <span data-ttu-id="62072-200">คุณต้องใช้ฟังก์ชัน Copy Environment Data เพื่อการเผยแพร่ข้อมูลไปยังสภาพแวดล้อมใหม่ในฐานะข้อมูลใหม่แทน</span><span class="sxs-lookup"><span data-stu-id="62072-200">Instead, you must use the Copy Environment Data functionality to publish the data to a new environment as new data.</span></span>

1. <span data-ttu-id="62072-201">เลือกปุ่ม **ตัวเลือก** (สัญลักษณ์เกียร์) จากนั้นบน FastTab **ตัวเชื่อมต่อข้อมูล** เลือก **Copy Environment Data**</span><span class="sxs-lookup"><span data-stu-id="62072-201">Select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Copy Environment Data**.</span></span> 
2. <span data-ttu-id="62072-202">ป้อนเซิร์ฟเวอร์ URL สำหรับสภาพแวดล้อมใหม่</span><span class="sxs-lookup"><span data-stu-id="62072-202">Enter the server URL for the new environment.</span></span> 
3. <span data-ttu-id="62072-203">เลือก **ตกลง** แล้วเลือก **ใช่** เพื่อยืนยันการดำเนินการ</span><span class="sxs-lookup"><span data-stu-id="62072-203">Select **OK**, and then select **Yes** to confirm the action.</span></span> <span data-ttu-id="62072-204">add-in ของ Excel จะถูกรีสตาร์ท และเชื่อมต่อกับสภาพแวดล้อมใหม่</span><span class="sxs-lookup"><span data-stu-id="62072-204">The Excel add-in is restarted and connects to the new environment.</span></span> <span data-ttu-id="62072-205">ข้อมูลที่มีอยู่ใดๆ ในสมุดงานจะถือเป็นข้อมูลใหม่</span><span class="sxs-lookup"><span data-stu-id="62072-205">Any existing data in the workbook is treated as new data.</span></span>

    <span data-ttu-id="62072-206">หลังจาก add-in ของ Excel ถูกรีสตาร์ท กล่องข้อความแจ้งว่า สมุดงานอยู่ในโหมดสำเนาสภาพแวดล้อม</span><span class="sxs-lookup"><span data-stu-id="62072-206">After the Excel add-in is restarted, a message box states that the workbook is in Environment copy mode.</span></span>

4. <span data-ttu-id="62072-207">เมื่อต้องการคัดลอกข้อมูลไปยังสภาพแวดล้อมใหม่ในฐานะข้อมูลใหม่ เลือก **เผยแพร่**</span><span class="sxs-lookup"><span data-stu-id="62072-207">To copy the data into the new environment as new data, select **Publish**.</span></span> <span data-ttu-id="62072-208">เพื่อยกเลิกการดำเนินการคัดลอกสภาพแวดล้อม และตรวจทานข้อมูลที่มีอยู่ในสภาพแวดล้อมใหม่ เลือก **รีเฟรช**</span><span class="sxs-lookup"><span data-stu-id="62072-208">To cancel the environment copy operation and review the existing data in the new environment, select **Refresh**.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="62072-209">การแก้ไขปัญหา</span><span class="sxs-lookup"><span data-stu-id="62072-209">Troubleshooting</span></span>
<span data-ttu-id="62072-210">มีปัญหาบางอย่างที่สามารถแก้ไขได้ผ่านขั้นตอนง่ายๆ</span><span class="sxs-lookup"><span data-stu-id="62072-210">There are a few issues that can be resolved through some easy steps.</span></span>

- <span data-ttu-id="62072-211">**มีการแสดงปุ่มโหลดแอปเพล็ต** – ถ้า Add-in ของ Excel มีปุ่ม **โหลดแอปเพล็ต** หลังจากที่คุณเข้าสู่ระบบ คุณอาจไม่ได้เข้าสู่ระบบในฐานะผู้ใช้ที่ถูกต้อง</span><span class="sxs-lookup"><span data-stu-id="62072-211">**The Load applets button is shown** – If the Excel add-in has a **Load applets** button after sign-in, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="62072-212">เมื่อต้องการแก้ไขปัญหานี้ โปรดตรวจสอบว่าชื่อผู้ใช้ที่ถูกต้องปรากฏอยู่ในมุมขวาด้านบนของ Add-in ของ Excel หรือไม่</span><span class="sxs-lookup"><span data-stu-id="62072-212">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="62072-213">ถ้าชื่อผู้ใช้ที่ไม่ถูกต้องปรากฏขึ้น ให้เลือก ลงชื่อออก และจากนั้นลงชื่อเข้าใช้กลับเข้าไป</span><span class="sxs-lookup"><span data-stu-id="62072-213">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="62072-214">**คุณได้รับข้อความ "ไม่ได้รับอนุญาต"** – ถ้าคุณได้รับข้อความ "ไม่ได้รับอนุญาต" ในขณะที่ Add-in ของ Excel กำลังโหลดข้อมูลเมตา บัญชีผู้ใช้ที่มีการลงชื่อเข้าใช้ไปยัง Add-in ของ Excel จะไม่มีสิทธิ์ในการใช้บริการ อินสแตนซ์ หรือฐานข้อมูลที่เป็นเป้าหมาย</span><span class="sxs-lookup"><span data-stu-id="62072-214">**You receive a "Forbidden" message** – If you receive a "Forbidden" message while the Excel add-in is loading metadata, the account that is signed in to the Excel add-in doesn't have permission to use the targeted service, instance, or database.</span></span> <span data-ttu-id="62072-215">เมื่อต้องการแก้ไขปัญหานี้ โปรดตรวจสอบว่าชื่อผู้ใช้ที่ถูกต้องปรากฏอยู่ในมุมขวาด้านบนของ Add-in ของ Excel หรือไม่</span><span class="sxs-lookup"><span data-stu-id="62072-215">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="62072-216">ถ้าชื่อผู้ใช้ที่ไม่ถูกต้องปรากฏขึ้น ให้เลือก ลงชื่อออก และจากนั้นลงชื่อเข้าใช้กลับเข้าไป</span><span class="sxs-lookup"><span data-stu-id="62072-216">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="62072-217">**เว็บเพจที่ว่างเปล่าที่ถูกแสดงขึ้นเหนือ Excel** – ถ้าเว็บเพจที่ว่างเปล่าถูกเปิดขึ้นในระหว่างกระบวนการเข้าสู่ระบบ บัญชีนั้นจำเป็นต้องมี AD FS แต่รุ่นของ Excel ที่กำลังเรียกใช้ Add-in ของ Excel ไม่ใช่รุ่นที่ใหม่พอที่จะโหลดกล่องโต้ตอบการเข้าสู่ระบบได้</span><span class="sxs-lookup"><span data-stu-id="62072-217">**A blank webpage is shown over Excel** – If a blank webpage is opened during the sign-in process, the account requires AD FS, but the version of Excel that is running the Excel add-in isn't recent enough to load the sign-in dialog box.</span></span> <span data-ttu-id="62072-218">เมื่อต้องการแก้ไขปัญหานี้ ให้อัพเดตรุ่นของ Excel ที่คุณใช้อยู่</span><span class="sxs-lookup"><span data-stu-id="62072-218">To resolve this issue, update the version of Excel that you're using.</span></span> <span data-ttu-id="62072-219">เมื่อต้องการอัพเดตรุ่นของ Excel เมื่อคุณอยู่ในองค์กรที่อยู่ในช่องทางรอการตัดบัญชี ใช้ [เครื่องมือการปรับใช้ Office](https://technet.microsoft.com/library/jj219422.aspx) เพื่อ [ย้ายจากช่องทางรอการตัดบัญชีไปยังช่องทางปัจจุบัน](https://technet.microsoft.com/library/mt455210.aspx)</span><span class="sxs-lookup"><span data-stu-id="62072-219">To update the version of Excel when you're in an enterprise that is on the deferred channel, use the [Office deployment tool](https://technet.microsoft.com/library/jj219422.aspx) to [move from the deferred channel to the current channel](https://technet.microsoft.com/library/mt455210.aspx).</span></span>
- <span data-ttu-id="62072-220">**คุณจะได้รับการหมดเวลาขณะที่คุณเผยแพร่การเปลี่ยนแปลงข้อมูล** – ถ้าคุณได้รับข้อความหมดเวลาขณะคุณพยายามเผยแพร่การเปลี่ยนแปลงข้อมูลไปยังเอนทิตี ให้พิจารณาการลดขนาดชุดงานการเผยแพร่ของสมุดงานที่ได้รับผลกระทบ</span><span class="sxs-lookup"><span data-stu-id="62072-220">**You receive a time-out while you publish data changes** – If you receive time-out messages while you're trying to publish data changes to an entity, consider reducing the publish batch size for the affected workbook.</span></span> <span data-ttu-id="62072-221">เอนทิตีที่ทริกเกอร์จํานวนตรรกะที่มากกว่าในการเปลี่ยนแปลงเรกคอร์ด อาจต้องมีการส่งการอัปเดตในชุดงานที่เล็กลงเพื่อช่วยป้องกันการหมดเวลา</span><span class="sxs-lookup"><span data-stu-id="62072-221">Entities that trigger larger amounts of logic on record changes might require updates to be sent in smaller batches to help prevent time-outs.</span></span>


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]