---
title: ออกแบบการตั้งค่าคอนฟิก ER เพื่อกรอกข้อมูลในเทมเพลต PDF
description: บทความนี้จะให้ข้อมูลเกี่ยวกับวิธีการออกแบบรูปแบบการรายงานทางอิเล็กทรอนิกส์ (ER) ที่จะกรอกข้อมูลในเทมเพลต PDF
author: kfend
ms.date: 03/18/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.region: Global
ms.author: filatovm
ms.search.validFrom: ''
ms.dyn365.ops.version: 10.0.1
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.openlocfilehash: 4056c2b9442e26a0e1c99e6155a3cd605d222974
ms.sourcegitcommit: 87e727005399c82cbb6509f5ce9fb33d18928d30
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 08/12/2022
ms.locfileid: "9283327"
---
# <a name="design-er-configurations-to-fill-in-pdf-templates"></a>ออกแบบการตั้งค่าคอนฟิก ER เพื่อกรอกข้อมูลในเทมเพลต PDF

[!include[banner](../includes/banner.md)]

กระบวนงานในบทความนี้คือตัวอย่างที่แสดงวิธีที่ผู้ใช้ในบทบาท **ผู้ดูแลระบบ** หรือ **นักพัฒนาของการรายงานทางอิเล็กทรอนิกส์** สามารถตั้งค่าคอนฟิกรูปแบบการรายงานทางอิเล็กทรอนิกส์ (ER) ที่สร้างรายงานเป็นไฟล์ PDF โดยใช้เอกสาร PDF ที่สามารถเติมข้อมูลได้เป็นเทมเพลตรายงาน ขั้นตอนเหล่านี้สามารถดำเนินการได้ในบริษัทใดๆ ของ Dynamics 365 Finance หรือ Regulatory Configuration Services (RCS)

## <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น

ก่อนที่คุณจะเริ่มต้น คุณต้องมีหนึ่งในชนิดการเข้าถึงต่อไปนี้โดยขึ้นอยู่กับบริการที่คุณใช้เพื่อดำเนินการกระบวนงานในบทความนี้ให้เสร็จสมบูรณ์:

- การเข้าถึง Finance สำหรับหนึ่งในบทบาทต่อไปนี้:

    - นักพัฒนาการรายงานทางอิเล็กทรอนิกส์
    - ที่ปรึกษาด้านการทำงานของการรายงานทางอิเล็กทรอนิกส์
    - ผู้ดูแลระบบ

- การเข้าถึง RCS สำหรับหนึ่งในบทบาทต่อไปนี้:

    - นักพัฒนาการรายงานทางอิเล็กทรอนิกส์
    - ที่ปรึกษาด้านการทำงานของการรายงานทางอิเล็กทรอนิกส์
    - ผู้ดูแลระบบ

นอกจากนี้ คุณต้องดำเนินการกระบวนงาน [สร้างตัวให้บริการการตั้งค่าคอนฟิก และทำเครื่องหมายเป็นใช้งานอยู่](tasks/er-configuration-provider-mark-it-active-2016-11.md) ให้เสร็จสมบูรณ์

ในขั้นสุดท้าย ดาวน์โหลดไฟล์ต่อไปนี้

| คำอธิบายเนื้อหา                       | ชื่อไฟล์                                     |
|-------------------------------------------|-----------------------------------------------|
| เทมเพลตสำหรับหน้าแรกของรายงาน | [IntrastatReportTemplate1.pdf](https://download.microsoft.com/download/0/8/3/0832c82b-4448-4562-afbf-01e0efc8d999/IntrastatReportTemplate1.pdf)                  |
| เทมเพลตสำหรับหน้าอื่นๆ ของรายงาน    | [IntrastatReportTemplate2.pdf](https://download.microsoft.com/download/c/7/a/c7a8a806-2192-4034-9052-e8b84b527d5e/IntrastatReportTemplate2.pdf)                  |
| รูปแบบ ER ตัวอย่าง - PDF                          | [รายงานอินทราสแทต (PDF) รุ่น 1.1.xml](https://download.microsoft.com/download/a/8/7/a87aea3e-3f60-404c-8899-c471d20e7ea9/IntrastatreportPDFversion1.1.xml)        |
| รูปแบบ ER ตัวอย่าง - Excel                          | [อินทราสแทต (นำเข้าจาก Excel) รุ่น 1.1.xml](https://download.microsoft.com/download/a/2/c/a2c0c145-d989-4e55-9d47-9647c02e4ee4/IntrastatimportfromExcelversion1.1.xml) |
| ชุดข้อมูลตัวอย่าง                            | [ข้อมูลตัวอย่างอินทราสแทต.xlsx](https://download.microsoft.com/download/9/f/1/9f1c5b96-3800-475f-8cf6-1ddd42873758/Intrastatsampledata.xlsx)                    |

## <a name="design-the-format-configuration"></a>ออกแบบการตั้งค่าคอนฟิกรูปแบบ

### <a name="get-access-to-the-list-of-configurations-provided-by-microsoft"></a>เข้าถึงรายการของการตั้งค่าคอนฟิกที่จัดเตรียมให้โดย Microsoft

1. ไปที่ **การจัดการองค์กร \> พื้นที่ทำงาน \> การรายงานทางอิเล็กทรอนิกส์**
2. ตรวจสอบให้แน่ใจว่าผู้ให้บริการ **Litware, Inc.** พร้อมใช้งาน และถูกทำเครื่องหมายไว้เป็น เปิดใช้งาน
3. บนไทล์สำหรับผู้ให้บริการ **Microsoft** ให้เลือก **ที่เก็บ**

    > [!NOTE]
    > ถ้ามีที่เก็บของชนิด **LCS** อยู่แล้ว ให้ข้ามขั้นตอนที่เหลือของกระบวนงานนี้

4. เลือก **เพิ่ม**
5. ในกล่องโต้ตอบแบบหล่นลง ในกลุ่มฟิลด์ **ชนิดของที่เก็บการตั้งค่าคอนฟิก** เลือกตัวเลือก **LCS**
6. เลือก **สร้างที่เก็บ**
7. เลือก **ตกลง**

### <a name="get-the-model-configurations-provided-by-microsoft"></a>รับการตั้งค่าคอนฟิกแบบจำลองที่จัดเตรียมให้โดย Microsoft

1. ที่ด้านซ้ายของหน้า **ที่จัดเก็บการตั้งค่าคอนฟิก** เลือกปุ่ม **แสดงตัวกรอง** (สัญลักษณ์รูปกรวย)
2. เพิ่มตัวกรองสำหรับค่าของ **LCS** ในฟิลด์ **ชนิด** และใช้ตัวดำเนินการ **เริ่มต้นด้วย**
3. เลือก **นำไปใช้**
4. เลือก **เปิด**
5. ในแผนภูมิ เลือก **แบบจำลองอินทราสแทต**
6. บน FastTab **รุ่น** เลือกรุ่น **1**

    > [!NOTE]
    > ถ้าปุ่ม **นำเข้า** บน FastTab **รุ่น** ไม่พร้อมใช้งาน ให้ข้ามขั้นตอนที่เหลือของกระบวนงานนี้

7. เลือก **นำเข้า**
8. เลือก **ใช่** เพื่อยืนยันการนำเข้าของรุ่นที่เลือกของการตั้งค่าคอนฟิกแบบจำลอง **แบบจำลองอินทราสแทต**

### <a name="create-a-new-format-configuration"></a>สร้างการตั้งค่าคอนฟิกรูปแบบใหม่

1. ในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** เลือกไทล์ **การตั้งค่าคอนฟิกการรายงาน**
2. ในแผนภูมิ เลือก **แบบจำลองอินทราสแทต**
3. เลือก **สร้างการตั้งค่าคอนฟิก**

    > [!NOTE]
    > ถ้าปุ่ม **สร้างการตั้งค่าคอนฟิก** ไม่พร้อมใช้งาน คุณต้องเปิดโหมดการออกแบบบนหน้า **พารามิเตอร์การรายงานทางอิเล็กทรอนิกส์** ที่สามารถเปิดได้จากพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์**

4. ในกล่องโต้ตอบแบบหล่นลง ในกลุ่มฟิลด์ **ใหม่** ให้เลือกตัวเลือก **รูปแบบที่ขึ้นอยู่กับอินทราสแทตแบบจำลองข้อมูล**
5. ในฟิลด์ **ชื่อ** ให้ป้อน **รายงานอินทราสแทต (PDF)**
6. ในฟิลด์ **คำอธิบาย** ให้ป้อน **รายงานอินทราสแทตในรูปแบบ PDF**

    > [!NOTE]
    > ตัวให้บริการการตั้งค่าคอนฟิกที่ใช้งานอยู่จะถูกป้อนโดยอัตโนมัติ ผู้ให้บริการนี้จะสามารถรักษาการตั้งค่าคอนฟิกนี้ ถึงแม้ว่าผู้ให้บริการอื่นๆ จะสามารถใช้การตั้งค่าคอนฟิกนี้ได้ แต่พวกเขาจะไม่สามารถรักษาไว้ได้

7. ไม่จำเป็นต้องระบุ: ในฟิลด์ **ชนิดรูปแบบ** คุณสามารถเลือกรูปแบบที่เฉพาะเจาะจงของเอกสารอิเล็กทรอนิกส์ ถ้าคุณเลือก **PDF** ในเวลาที่ออกแบบ ตัวออกแบบการดำเนินงาน ER จะเสนอเฉพาะองค์ประกอบรูปแบบที่ใช้ได้กับเฉพาะเอกสารที่สร้างขึ้นในรูปแบบ PDF (**PDF\ไฟล์** **PDF\ตัวผสาน PDF** เป็นต้น) ถ้าคุณปล่อยฟิลด์นี้ว่างไว้ จะมีการระบุรูปแบบของเอกสารอิเล็กทรอนิกส์ในเวลาที่ออกแบบในตัวออกแบบการดำเนินงาน ER เมื่อองค์ประกอบรูปแบบแรกจะถูกเพิ่ม ตัวอย่างเช่น ถ้าคุณเพิ่ม **Excel\ไฟล์** เป็นองค์ประกอบรูปแบบแรก ตัวออกแบบการดำเนินงาน ER จะเสนอเฉพาะองค์ประกอบรูปแบบที่ใช้ได้กับเฉพาะเอกสารที่สร้างขึ้นในรูปแบบ Excel (**Excel\เซลล์** **Excel\ช่วง** เป็นต้น) รูปแบบ
8. เลือก **สร้างการตั้งค่าคอนฟิก**

มีการสร้างการตั้งค่าคอนฟิกรูปแบบ ER ใหม่ คุณสามารถใช้รุ่นแบบร่างของการตั้งค่าคอนฟิกนี้เพื่อจัดเก็บคอมโพเนนต์รูปแบบ ER ซึ่งได้รับการออกแบบมาเพื่อสร้างเอกสารอิเล็กทรอนิกส์ในรูปแบบไฟล์ PDF

### <a name="design-the-format-of-an-electronic-document"></a>ออกแบบรูปแบบของเอกสารทางอิเล็กทรอนิกส์

ถัดไป ในการตั้งค่าคอนฟิกรูปแบบ ER ที่คุณสร้างขึ้น คุณจะออกแบบรูปแบบ ER ที่สร้างรายงาน **การควบคุมอินทราสแทต** ในรูปแบบ PDF หน้าแรกของรายงานนี้ต้องแสดงสรุปของรายงานและรายละเอียดของธุรกรรมการค้าต่างประเทศที่มีการรายงาน หน้าอื่นๆ ต้องแสดงรายละเอียดของธุรกรรมการค้าต่างประเทศที่มีการรายงานเท่านั้น เนื่องจากหน้ารายงานที่สร้างขึ้นต้องมีโครงร่างแตกต่างกัน เทมเพลตสองเทมเพลตที่แตกต่างกันในรูปแบบ PDF จะถูกใช้ในรูปแบบ ER

ในตัวแสดง PDF ใดๆ ให้เปิดเทมเพลต PDF ที่คุณดาวน์โหลด โปรดสังเกตว่าแต่ละเทมเพลตจะประกอบด้วยฟิลด์หลายฟิลด์ที่ต้องกรอกข้อมูล ในแต่ละเทมเพลต รายละเอียดของธุรกรรมการค้าต่างประเทศจะแสดงเป็น 42 แถว แต่ละแถวมี 9 ฟิลด์ หมายเลขแถวจะปรากฏที่จุดสิ้นสุดของชื่อฟิลด์แต่ละชื่อ (ตัวอย่างเช่น **วันที่ 1**...**วันที่ 42** และ **โภคภัณฑ์ 1**...**โภคภัณฑ์ 42**)

ภาพประกอบต่อไปนี้แสดงเทมเพลต PDF สำหรับหน้าแรกของรายงาน

![เทมเพลต 1](media/rcs-ger-filloutpdf-template1.png)

ภาพประกอบต่อไปนี้แสดงเทมเพลต PDF สำหรับหน้าอื่นๆ ของรายงาน

![เทมเพลต 2](media/rcs-ger-filloutpdf-template2.png)

1. ในหน้า **การตั้งค่าคอนฟิก** เลือก **ตัวออกแบบ**
2. เลือก **เพิ่มราก**
3. ในกล่องโต้ตอบแบบหล่นลง ในแผนภูมิ ให้เลือก **PDF \> ตัวผสาน PDF**

    เมื่อคุณเลือกองค์ประกอบ **ตัวผสาน PDF** เป็นองค์ประกอบรากของรูปแบบ เอกสาร PDF ทั้งหมดที่สร้างขึ้นในเวลาที่ใช้จะถูกผสานเป็นเอกสาร PDF เดียวขั้นสุดท้าย ถ้าคุณจำเป็นต้องใช้เทมเพลต PDF เพียงหนึ่งเทมเพลตเพื่อสร้างเอกสารที่จำเป็นทั้งหมดโดยใช้รูปแบบ ER ที่คุณออกแบบ คุณสามารถเลือก **ไฟล์ PDF** เป็นองค์ประกอบราก

4. ในฟิลด์ **ชื่อ** ให้ป้อน **เอาท์พุท**
5. ในฟิลด์ **การกำหนดลักษณะภาษา** ให้เลือก **การกำหนดลักษณะผู้ใช้** รายงานจะถูกสร้างขึ้นในภาษาที่ต้องการของผู้ใช้ที่รัน
6. ในฟิลด์ **การกำหนดลักษณะวัฒนธรรม** ให้เลือก **การกำหนดลักษณะผู้ใช้** ค่าและวันที่ที่แสดงบนหน้าของรายงานจะได้รับการจัดรูปแบบตามตำแหน่งที่ตั้งที่ต้องการของผู้ใช้ที่รันรายงาน
7. เลือก **ตกลง**
8. บนบานหน้าต่างการดำเนินการ บนแท็บ **นำเข้า** เลือก **นำเข้าจาก PDF**

    เมื่อมีการนำเข้าเอกสาร PDF ที่เติมข้อมูลได้เป็นเทมเพลตสำหรับรูปแบบER นี้ องค์ประกอบรูปแบบ er ที่จำเป็นทั้งหมด (**ไฟล์ PDF** **กลุ่มฟิลด์** และองค์ประกอบ **ฟิลด์**) จะถูกสร้างขึ้นโดยอัตโนมัติในรูปแบบที่ออกแบบไว้ ตามโครงสร้างของเอกสาร PDF ที่มีการนำเข้า

9. เลือก **เรียกดู** นำทางไปยัง และเลือกไฟล์ **IntrastatReportTemplate1.pdf** ที่คุณดาวน์โหลดก่อนหน้านี้เป็นข้อกำหนดเบื้องต้น
10. เลือก **ตกลง**

    ไฟล์ที่เลือกถูกโหลดและฟิลด์ **เทมเพลต** ในกล่องโต้ตอบ **นำเข้าจาก PDF** จะถูกกรอกข้อมูล

11. ตั้งค่าตัวเลือก **จัดกลุ่มฟิลด์** เป็น **ใช่** ถ้าเอกสาร PDF ที่เลือกมีกลุ่มฟิลด์ใดๆ รายการเหล่านั้นจะถูกใช้เพื่อจัดกลุ่มองค์ประกอบรูปแบบ ER ซึ่งถูกสร้างขึ้น องค์ประกอบรูปแบบ **กลุ่มฟิลด์** จะถูกสร้างขึ้นสำหรับวัตถุประสงค์นี้

    ถ้ามีการตั้งค่าตัวเลือกนี้เป็น **ไม่** องค์ประกอบรูปแบบ ER ที่จำเป็นจะถูกสร้างเป็นรายการแบบคงที่ขององค์ประกอบที่ซ้อนกันภายใต้องค์ประกอบรูปแบบ **ไฟล์ PDF** ที่ถูกสร้างขึ้น

12. เลือก **ตกลง**

    ![นำเข้าจากกล่องโต้ตอบ PDF](media/rcs-ger-filloutpdf-importtemplate.png)

13. ในแผนภูมิ ให้ขยาย **เอาท์พุท**

    โปรดสังเกตว่า มีการสร้างคอมโพเนนต์ **ไฟล์ PDF** โดยอัตโนมัติ เพื่อจัดการการสร้างของหน้าแรกของรายงานที่สร้างขึ้นในขณะที่ดำเนินการ

14. ในแผนภูมิ ให้ขยาย **เอาท์พุท \> ไฟล์ PDF**

    โปรดสังเกตว่ารายการที่จัดโครงสร้างขององค์ประกอบรูปแบบได้รับการสร้างขึ้นโดยอัตโนมัติในรูปแบบ ER นี้ ตามโครงสร้างของเอกสาร PDF ที่เติมข้อมูลได้ที่คุณนำเข้าก่อนหน้านี้

15. ในแผนภูมิ ให้เลือก **เอาท์พุท \> ไฟล์ PDF**
16. ในฟิลด์ **ชื่อ** ให้ป้อน **หน้า 1**

    องค์ประกอบรูปแบบนี้จะใช้ในการสร้างหน้าแรกของรายงาน **การควบคุมอินทราสแทต** หน้าดังกล่าวจะแสดงสรุปของรายงานและรายละเอียดของธุรกรรมการค้าต่างประเทศ

    ถ้าคุณปล่อยให้ฟิลด์ **การกำหนดลักษณะภาษา** ให้ว่างเปล่า การตั้งค่า **การกำหนดลักษณะภาษา** ขององค์ประกอบ **ตัวผสาน PDF** หลัก จะกำหนดภาษาของรายงานที่สร้างขึ้นโดยใช้องค์ประกอบรูปแบบนี้ คุณสามารถเลือกค่าอื่นเพื่อแทนที่การตั้งค่าขององค์ประกอบหลักได้

    ถ้าคุณปล่อยให้ฟิลด์ **การกำหนดลักษณะวัฒนธรรม** ให้ว่างเปล่า การตั้งค่า **การกำหนดลักษณะวัฒนธรรม** ขององค์ประกอบ **ตัวผสาน PDF** หลัก จะกำหนดที่ตั้งของรายงานที่สร้างขึ้นโดยใช้องค์ประกอบรูปแบบนี้ ตำแหน่งที่ตั้งจะกำหนดรูปแบบของค่าและวันที่บนหน้าของรายงาน คุณสามารถเลือกค่าอื่นเพื่อแทนที่การตั้งค่าขององค์ประกอบหลักได้

17. บนบานหน้าต่างการดำเนินการ ให้เลือกแท็บ **นำเข้า** โปรดสังเกตว่าปุ่ม **การปรับปรุงจาก PDF** จะพร้อมใช้งานสำหรับองค์ประกอบรูปแบบที่เลือก **ไฟล์ PDF**

    คุณสามารถใช้ปุ่มนี้เพื่อนำเข้าเทมเพลต PDF ที่ปรับปรุงแล้วไปยังรูปแบบที่แก้ไข เมื่อมีการนำเข้าเทมเพลต PDF ที่ปรับปรุงแล้ว รายการขององค์ประกอบรูปแบบจะถูกเปลี่ยนให้สอดคล้องกัน:

    - สำหรับฟิลด์ใหม่ใดๆ ในเทมเพลต PDF ที่ปรับปรุงแล้ว องค์ประกอบรูปแบบใหม่จะถูกสร้างขึ้นในรูปแบบ ER ที่แก้ไข
    - ถ้าเทมเพลต PDF ที่ปรับปรุงไม่มีฟิลด์ที่สอดคล้องกับองค์ประกอบรูปแบบที่มีอยู่ใดๆ ในรูปแบบ ER ที่แก้ไขอีกต่อไป องค์ประกอบรูปแบบเหล่านั้นจะถูกลบออกจากรูปแบบ ER

18. บนแท็บ **รูปแบบ** ให้เลือก **เอกสารแนบ**

    โปรดสังเกตว่าเอกสาร PDF ที่นำเข้าถูกแนบอยู่กับรูปแบบ ER ที่แก้ไข

    ![การแสดงตัวอย่างเอกสารแนบ PDF](media/rcs-ger-filloutpdf-attachedtemplate.png)

19. ดำเนินการต่อเพื่อออกแบบรูปแบบนี้โดยการนำเข้าเทมเพลต PDF ที่สอง การเพิ่มการรวมที่จำเป็นกับแหล่งข้อมูล และอื่นๆ
20. เลือก **บันทึก**
21. ปิดหน้า
22. เลือก **ลบ**
23. เลือก **ใช่**

เพื่อเรียนรู้เพิ่มเติมเกี่ยวกับวิธีการที่องค์ประกอบรูปแบบ **ตัวผสาน PDF** **ไฟล์ PDF** **กลุ่มฟิลด์** และ **ฟิลด์** สามารถใช้ในการสร้างเอกสารในรูปแบบ PDF คุณสามารถนำเข้าและวิเคราะห์รูปแบบ ER ตัวอย่างได้

### <a name="import-the-format-configuration"></a>นำเข้าการตั้งค่าคอนฟิกรูปแบบ

ถัดไป คุณจะนำเข้ารูปแบบ ER ตัวอย่างที่คุณดาวน์โหลดไว้ก่อนหน้านี้เพื่อสร้างรายงาน **การควบคุมอินทราสแทต** ในรูปแบบ PDF หน้าแรกของรายงานต้องแสดงสรุปของรายงานและรายละเอียดของธุรกรรมการค้าต่างประเทศที่มีการรายงาน หน้าอื่นๆ ต้องแสดงรายละเอียดของธุรกรรมการค้าต่างประเทศที่มีการรายงานเท่านั้น

1. ในหน้า **การตั้งค่าคอนฟิก** เลือก **แลกเปลี่ยน \> โหลดจากไฟล์ XML**
2. เลือก **เรียกดู** นำทางไปยัง และเลือกไฟล์ **Intrastat report (PDF).version.1.1.xml** ที่คุณดาวน์โหลดก่อนหน้านี้เป็นข้อกำหนดเบื้องต้น
3. เลือก **ตกลง**

## <a name="analyze-the-format-configuration"></a>วิเคราะห์การตั้งค่าคอนฟิกรูปแบบ

### <a name="format-layout"></a>โครงร่างรูปแบบ

1. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิ ให้เลือก **แบบจำลองอินทราสแทต \> รายงานอินทราสแทต (PDF)**
2. เลือก **ตัวออกแบบ**
3. เลือก **แสดงรายละเอียด**
4. ในแผนภูมิ ให้ขยาย **เอาท์พุท: ตัวผสาน PDF**

    โปรดสังเกตว่ารูปแบบ ER นี้มีองค์ประกอบ **ไฟล์ PDF** สององค์ประกอบ แต่ละองค์ประกอบใช้เทมเพลต PDF ที่แตกต่างกัน มีการใช้เทมเพลตหนึ่งรายการเพื่อสร้างหน้าแรกของรายงานในรูปแบบ PDF และมีการใช้เทมเพลตอื่นเพื่อสร้างหน้าอื่นๆ

5. ในแผนภูมิ ให้ขยาย **เอาท์พุท: ตัวผสาน PDF \> หน้า 1: ไฟล์ PDF (IntrastatReportTemplate1)**
6. ในแผนภูมิ ให้ขยาย **เอาท์พุท: ตัวผสาน PDF \> หน้า N: ไฟล์ PDF (IntrastatReportTemplate2)**

    โปรดสังเกตว่า เนื่องจากเนื้อหาของเทมเพลต PDF สองรายการแตกต่างกัน โครงสร้างขององค์ประกอบรูปแบบที่ซ้อนกันสำหรับองค์ประกอบ **ไฟล์ PDF** สององค์ประกอบยังแตกต่างกันอีกด้วย

### <a name="format-mapping"></a>การแมปรูปแบบ

1. บนหน้า **ตัวออกแบบรูปแบบ** ให้เลือกแท็บ **การแมป**
2. ในแผนภูมิ ให้ขยาย **การแบ่งหน้า \> หน้า**

    ![หน้าตัวออกแบบสูตรที่ซึ่งมีการขยายแผนภูมิแบบจำลอง](media/rcs-ger-filloutpdf-reviewformat.png)

    บันทึกรายละเอียดต่อไปนี้:

    - องค์ประกอบรูปแบบ **องค์ประกอบรูปแบบ \> หน้า 1** ของชนิด **ไฟล์ PDF** ไม่ได้ผูกกับแหล่งข้อมูลใดๆ และนิพจน์ **ที่เปิดใช้งาน** ขององค์ประกอบรูปแบบนี้ว่างเปล่า ดังนั้น ในขณะที่ดำเนินการ เทมเพลต PDF **IntrastatReportTemplate1** จะถูกเติมข้อมูลเพียงครั้งเดียว เมื่อมีการสร้างเอกสาร PDF แต่ละฉบับ
    - องค์ประกอบรูปแบบ **เอาท์พุท \> หน้า N** ของชนิด **ไฟล์ PDF** ถูกผูกไว้กับแหล่งข้อมูล **Paging.PageN** ของชนิด **รายการเรกคอร์ด** และนิพจน์ **ที่เปิดใช้งาน** ขององค์ประกอบรูปแบบนี้ว่างเปล่า ดังนั้น ในขณะที่ดำเนินการ เทมเพลต PDF **IntrastatReportTemplate2** จะถูกเติมข้อมูลเพียงสำหรับแต่ละเรกคอร์ดจากรายการเรกคอร์ดที่ผูกไว้ เมื่อมีการสร้างเอกสาร PDF แต่ละฉบับ
    - เนื่องจากองค์ประกอบรูปแบบ **หน้า 1: ไฟล์ PDF** และ **หน้า N: ไฟล์ PDF** เป็นรายการรองขององค์ประกอบรูปแบบ **เอาท์พุท: ตัวผสาน PDF** เอกสาร PDF ทั้งหมดที่ถูกกรอกข้อมูลจะถูกผสานเป็นเอกสาร PDF เดียวขั้นสุดท้าย
    - แหล่งข้อมูล **Paging.Page1** และ **Paging.PageN** ถูกตั้งค่าคอนฟิกเป็นตัวกรองของเรกคอร์ดจากแหล่งข้อมูล **Paging.Pages** แหล่งข้อมูลนี้ได้รับการตั้งค่าคอนฟิกเพื่อแบ่งชุดทั้งหมดของธุรกรรมการค้าต่างประเทศลงในชุดงาน ชุดงานแต่ละชุดประกอบด้วยเรกคอร์ดได้มากถึง 42 รายการ นิพจน์ ER ต่อไปนี้จะใช้ในการแบ่งธุรกรรมออกเป็นชุดงาน:

        SPLITLIST(Totals.CommodityRecord,42)

    - แหล่งข้อมูล **Paging.Pages** มีองค์ประกอบ **Paging.Pages.Enumerated** ซึ่งส่งคืนรายละเอียดของแต่ละเรกคอร์ดที่รวมอยู่ในชุดงาน รายละเอียดเหล่านี้รวมถึงลำดับของเรกคอร์ดในชุดงานปัจจุบัน (ฟิลด์ **Paging.Pages.Enumerated.Number**) ฟิลด์ **Paging.Pages.Enumerated.Number** ถูกใช้ในนิพจน์ **ชื่อ** ขององค์ประกอบรูปแบบ **ฟิลด์ PDF**  เพื่อสร้างชื่อฟิลด์แบบไดนามิกที่ขึ้นกับหมายเลขธุรกรรมในชุดงาน จากนั้น ชื่อฟิลด์ที่สร้างขึ้นจะถูกใช้เพื่อกรอกข้อมูลในฟิลด์ PDF ที่ถูกต้องในเทมเพลต PDF ที่ใช้
    - องค์ประกอบของรูปแบบ **เอาท์พุท \> หน้า N \> รายละเอียด 2** ของชนิด **กลุ่ม PDF** ถูกผูกไว้กับแหล่งข้อมูล **Paging.PageN.Enumerated** (หรือ **\@.Enumerated** ถ้าโหมดมุมมอง **พาธสัมพัทธ์** ถูกใช้) ของชนิด **รายการเรกคอร์ด** ดังนั้น ขณะรันไทม์ องค์ประกอบที่ซ้อนกันของกลุ่ม PDF นี้จะถูกเติมข้อมูลสำหรับแต่ละเรกคอร์ดจากรายการเรกคอร์ดที่ผูกไว้ ด้วยวิธีนี้ รายการ PDF แต่ละรายการจะถูกสร้างขึ้น เมื่อสำหรับแต่ละลำดับที่ N ของ 42 เรกคอร์ดของรายการ **Paging.PageN.Enumerated** ฟิลด์ PDF ต่อไปนี้จะถูกเติมข้อมูล: วันที่ N ทิศทาง N โภคภัณฑ์ N เป็นต้น ดังนั้น ด้วยเหตุนี้ ลักษณะการทำงานขององค์ประกอบรูปแบบ **กลุ่มฟิลด์** นี้จะคล้ายกับลักษณะการทำงานขององค์ประกอบรูปแบบ **XML \> ลำดับ** และ **ข้อความ \> ลำดับ**

3. ในแผนภูมิ ให้ขยาย **เอาต์พุท \> หน้า N \> รายละเอียด2**
4. ในแผนภูมิ ให้เลือก **เอาต์พุท \> หน้า N \> รายละเอียด2 \>ข้อความท้ายหน้า**

    โปรดสังเกตว่า แอตทริบิวต์ **ชื่อ** ขององค์ประกอบรูปแบบนี้จะถูกกำหนดเป็น **ข้อความท้ายหน้า** นอกจากนี้ โปรดสังเกตสังเกต **ชื่อ** ขององค์ประกอบรูปแบบจะว่างเปล่า

5. ในแผนภูมิ ให้เลือก **เอาต์พุท \> หน้า N \> รายละเอียด2 \>การแก้ไข 1**

    โปรดสังเกตว่า แอตทริบิวต์ **ชื่อ** ขององค์ประกอบรูปแบบนี้ถูกกำหนดเป็น **การแก้ไข 1** นอกจากนี้ โปรดสังเกตว่านิพจน์ **ชื่อ** ขององค์ประกอบรูปแบบถูกกำหนดเป็น **Paging.FldName("Correction",\@.Number)**

![ตัวออกแบบรูปแบบที่มีการเลือกการแมป](media/rcs-ger-filloutpdf-reviewformat2.png)

โปรดสังเกตว่า มีการใช้องค์ประกอบรูปแบบ **ฟิลด์** เพื่อกรอกข้อมูลในฟิลด์แต่ละฟิลด์ของเอกสาร PDF ที่เติมข้อมูลได้ ซึ่งถูกกำหนดเป็นเทมเพลตขององค์ประกอบรูปแบบ **ไฟล์ PDF** หลัก การรวมกันขององค์ประกอบรูปแบบ **ไฟล์ PDF** หรือองค์ประกอบที่ซ้อนกัน ถ้ามีองค์ประกอบที่ซ้อนกันใดๆ ให้ระบุค่าที่ป้อนไว้ในฟิลด์ PDF ที่สอดคล้องกัน สามารถใช้คุณสมบัติที่แตกต่างกันขององค์ประกอบรูปแบบ **ฟิลด์** เพื่อระบุว่าฟิลด์ PDF ใดถูกกรอกข้อมูลโดยองค์ประกอบรูปแบบแต่ละองค์ประกอบ:

- บนแท็บ **รูปแบบ** แอตทริบิวต์ **ชื่อ** ของชื่อขององค์ประกอบรูปแบบ
- บนแท็บ **การแมป** นิพจน์ **ชื่อ** ของชื่อขององค์ประกอบรูปแบบ

เนื่องจากไม่จำเป็นต้องระบุคุณสมบัติทั้งสองอย่างสำหรับองค์ประกอบรูปแบบ **ฟิลด์** กฎต่อไปนี้จะถูกนำไปใช้เพื่อระบุฟิลด์ PDF เป้าหมาย:

- ถ้าแอตทริบิวต์ **ชื่อ** ว่างเปล่า และนิพจน์ **ชื่อ** ส่งคืนสตริงที่ว่างเปล่าในเวลาที่ใช้งาน ข้อยกเว้นจะเกิดขึ้นในเวลาที่ใช้เพื่อแจ้งเตือนผู้ใช้ว่าไม่พบฟิลด์ PDF ในเทมเพลต PDF ที่ใช้ในการกรอกข้อมูลในเอกสาร PDF
- ถ้ามีการกำหนดแอตทริบิวต์ **ชื่อ** และนิพจน์ **ชื่อ** ว่างเปล่า ฟิลด์ PDF ที่มีชื่อเดียวกันกับแอตทริบิวต์ **ชื่อ** ขององค์ประกอบรูปแบบจะถูกกรอกข้อมูล
- ถ้ามีการกำหนดแอตทริบิวต์ **ชื่อ** และนิพจน์ **ชื่อ** ถูกตั้งค่าคอนฟิก ฟิลด์ PDF ที่มีชื่อเดียวกันกับค่าที่ถูกส่งคืนโดยนิพจน์ **ชื่อ** ขององค์ประกอบรูปแบบจะถูกกรอกข้อมูล

> [!NOTE]
> เมื่อกล่องกาเครื่องหมายในเทมเพลต PDF ไม่ได้อยู่ในกลุ่มของกล่องกาเครื่องหมาย กล่องกาเครื่องหมายนั้นจะแสดงในรูปแบบ ER ที่แก้ไขได้เป็นองค์ประกอบ **ฟิลด์** ที่ซ้อนภายใต้องค์ประกอบ **ไฟล์ PDF** กล่องกาเครื่องหมาย PDF ชนิดนี้สามารถตั้งค่าได้ตามที่เลือกไว้ในลักษณะต่อไปนี้:
>
> - องค์ประกอบรูปแบบ **ฟิลด์** ที่สอดคล้องกันถูกผูกไว้กับฟิลด์แหล่งข้อมูลของชนิดข้อมูล *[บูลีน](er-formula-supported-data-types-primitive.md#boolean)* ที่มีค่าเป็น **จริง**
> - องค์ประกอบรูปแบบ **ฟิลด์** ที่สอดคล้องกัน มีองค์ประกอบรูปแบบ **สตริง** ที่ซ้อนกันซึ่งผูกอยู่กับฟิลด์แหล่งที่มาข้อมูลซึ่งมีค่าข้อความเป็น **1** **จริง** หรือ **ใช่**
>
> เทมเพลตของคุณอาจประกอบด้วยกลุ่มกล่องกาเครื่องหมายที่สามารถเลือกกล่องกาเครื่องหมายได้ครั้งละหนึ่งกล่องเท่านั้น กล่องกาเครื่องหมายเหล่านั้นจะแสดงในเทมเพลต PDF เป็นฟิลด์แบบฟอร์มต่างๆ ของชนิด *กล่องกาเครื่องหมาย* แต่ละฟิลด์จะมีชื่อเดียวกันแต่เป็นค่าการส่งออกต่างกัน เมื่อคุณนำเข้าเทมเพลตลงในรูปแบบ ER ที่แก้ไขได้ กล่องกาเครื่องหมายแต่ละกล่องจะแสดงในโครงสร้างลำดับชั้นของรูปแบบเป็นองค์ประกอบ **รายการกลุ่มกล่องกาเครื่องหมาย** ที่ซ้อนภายใต้องค์ประกอบ **กลุ่มกล่องกาเครื่องหมาย** เดียวกัน ชื่อขององค์ประกอบ **กลุ่มกล่องกาเครื่องหมาย** จะเท่ากับชื่อของฟิลด์กล่องกาเครื่องหมายในเทมเพลต PDF ชื่อขององค์ประกอบ **รายการกลุ่มกล่องกาเครื่องหมาย** แต่ละรายการจะเท่ากับค่าการส่งออกของฟิลด์กล่องกาเครื่องหมายที่สอดคล้องกันในเทมเพลต PDF
>
> คุณสามารถผูกองค์ประกอบ **รายการกลุ่มกล่องกาเครื่องหมาย** กับฟิลด์แหล่งข้อมูลของชนิดข้อมูล *แบบบูลีน* เท่านั้น

## <a name="run-the-format-configuration"></a>รันการตั้งค่าคอนฟิกรูปแบบ

### <a name="import-the-format-configuration"></a>นำเข้าการตั้งค่าคอนฟิกรูปแบบ

ถัดไป คุณจะโหลดรูปแบบ ER ของตัวอย่าง **อินทราสแทต (นำเข้าจาก Excel)** รูปแบบนี้ได้รับการออกแบบมาเพื่อแยกวิเคราะห์สมุดงาน Microsoft Excel ที่เลือกโดยผู้ใช้ ซึ่งจำลองการทำธุรกรรมการค้าต่างประเทศ

1. ในหน้า **การตั้งค่าคอนฟิก** เลือก **แลกเปลี่ยน \> โหลดจากไฟล์ XML**
2. เลือก **เรียกดู** นำทางไปยัง และเลือกไฟล์ **Intrastat (import from Excel).version.1.1.xml** ที่คุณดาวน์โหลดก่อนหน้านี้เป็นข้อกำหนดเบื้องต้น
3. เลือก **ตกลง**
4. ในแผนภูมิ เลือก **แบบจำลองอินทราสแทต \> อินทราสแทต (นำเข้าจากExcel)**
5. เลือก **แก้ไข**
6. ตั้งค่าตัวเลือก **ค่าเริ่มต้นสำหรับการแมปแบบจำลอง** เป็น **ใช่**

    > [!NOTE]
    > ถ้าคุณตั้งค่าตัวเลือก **ค่าเริ่มต้นสำหรับการแมปแบบจำลอง** เป็น **ใช่** สำหรับการตั้งค่าคอนฟิก **แบบจำลองอินทราสแทต** หรือการตั้งค่าคอนฟิกอื่นที่ซ้อนกันภายใต้การตั้งค่าคอนฟิก **แบบจำลองอินทราสแทต** ให้ตั้งค่าตัวเลือกนี้เป็น **ไม่**

    เมื่อตัวเลือก **ค่าเริ่มต้นสำหรับการแมปแบบจำลอง** ถูกตั้งค่าเป็น **ใช่** รูปแบบ ER **อินทราสแทต (นำเข้าจาก Excel)** ที่นำเข้า จะถูกกำหนดให้เป็นแหล่งข้อมูลเริ่มต้นสำหรับการตั้งค่าคอนฟิกรูปแบบ **รายงานอินทราสแทต (PDF)** จากนั้น เมื่อมีการรันการตั้งค่าคอนฟิกรูปแบบ **รายงานอินทราสแทต (PDF)** เนื้อหาของสมุดงาน Excel ที่แยกวิเคราะห์โดยรูปแบบ ER **อินทราสแทต (นำเข้าจาก Excel)** จะจำลองธุรกรรมการค้าต่างประเทศที่ต้องมีการรายงาน ในแผนภาพต่อไปนี้แสดงตัวอย่างของสมุดงาน Excel

    ![สมุดงาน Excel ที่มีข้อมูลตัวอย่าง](media/rcs-ger-filloutpdf-excelworkbook.png)

### <a name="run-the-format-configuration"></a>รันการตั้งค่าคอนฟิกรูปแบบ

1. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิ ให้เลือก **แบบจำลองอินทราสแทต \> รายงานอินทราสแทต (PDF)**
2. เลือก **รัน**
3. เลือก **เรียกดู** นำทางไปยัง และเลือกไฟล์ **Intrastat sample data.xlsx** ที่คุณดาวน์โหลดก่อนหน้านี้เป็นข้อกำหนดเบื้องต้น
4. เลือก **ตกลง**
5. ในฟิลด์ **แนวทางรายงาน** ให้เลือก **ทั้งสองอย่าง** เพื่อกรอกข้อมูลในธุรกรรมทั้งหมดจากสมุดงาน Excel ที่นำเข้าในรายงาน PDF ที่ถูกสร้างขึ้น
6. เลือก **ตกลง**
7. ตรวจทานเอกสาร PDF ที่ถูกสร้าง

ภาพประกอบการติดตามแสดงตัวอย่างของหน้าแรกของรายงานที่ถูกสร้าง

![หน้าแรกของรายงานที่ถูกสร้าง](media/rcs-ger-filloutpdf-generatedreport.png)

ภาพประกอบการติดตามแสดงตัวอย่างของหน้าอื่นของรายงานที่ถูกสร้าง

![หน้าอื่นของรายงานที่ถูกสร้าง](media/rcs-ger-filloutpdf-generatedreport2.png)

## <a name="limitations"></a>การจำกัด

ชื่อของฟิลด์ที่สามารถกรอกข้อมูลได้ควรไม่ซ้ำกันในแบบฟอร์ม PDF ที่คุณวางแผนจะใช้เป็นเทมเพลตรายงาน ฟิลด์ดังกล่าวทั้งหมด องค์ประกอบรูปแบบแต่ละอย่างที่มีชื่อที่ตรงกันจะถูกสร้างขึ้นในรูปแบบ ER ที่แก้ไขได้เมื่อมีการนําเข้าแบบฟอร์ม PDF ถ้าแบบฟอร์ม PDF มีฟิลด์ที่มีชื่อเดียวกันหลายฟิลด์ จะมีการสร้างองค์ประกอบรูปแบบเดียวให้กับฟิลด์ที่ไม่อนุญาตให้กรอกข้อมูลในฟิลด์ทีละฟิลด์เมื่อรันไทม์

## <a name="frequently-asked-questions"></a>คำถามที่ถามบ่อย

### <a name="when-i-run-the-er-format-to-generate-a-report-in-pdf-format-why-do-i-get-the-following-errors--cannot-handle-iref-streams-the-current-implementation-of-pdfsharp-cannot-handle-this-pdf-feature-introduced-with-acrobat-6-and-a-pdf-name-must-start-with-a-slash-"></a>เมื่อฉันเรียกใช้รูปแบบ ER เพื่อสร้างรายงานในรูปแบบ PDF เหตุใดฉันจึงได้รับข้อผิดพลาดต่อไปนี้: **ไม่สามารถจัดการสตรีม iref การใช้งาน PDFSharp ในปัจจุบันไม่สามารถจัดการคุณลักษณะ PDF นี้ที่มีการใช้โดย Acrobat 6** และ **ชื่อ PDF ต้องขึ้นต้นด้วยเครื่องหมายทับ (/)**

กรอบงาน ER ใช้ไลบรารี PDFSharp รุ่น 1.5 เพื่อสร้างรายงาน PDF เหล่านี้ คุณลักษณะบางอย่างของ PDF 1.5 (Adobe Reader 6.0) ยังไม่ได้ใช้งานในไลบรารีนี้ ดังนั้น PDFSharp จึงไม่สามารถเปิดไฟล์บางไฟล์ที่ระบุว่าเป็น **PDF 1.5 หรือสูงกว่า** และทำให้เกิดข้อผิดพลาดที่ได้รับ ใช้วิธีการใดวิธีการหนึ่งต่อไปนี้เพื่อแก้ไขปัญหา:

-   เมื่อคุณใช้เทมเพลต PDF ของคุณเอง: ดาวน์เกรดเทมเพลตเป็น Adobe รุ่นก่อนหน้าและเริ่มต้นใช้เทมเพลตใหม่ในรูปแบบ ER ของคุณ
-   เมื่อคุณใช้เทมเพลตรูปแบบ ER ที่ใช้ร่วมกันระหว่างคุณโดยตัวให้บริการการตั้งค่าคอนฟิกอื่นเป็นส่วนหนึ่งของโซลูชัน ER: ติดต่อเจ้าของโซลูชัน ER นี้และระบุคำอธิบายปัญหา
-   เมื่อคุณใช้โซลูชัน ISV ที่มีรุ่นก่อนหน้าของไลบรารี PDFSharp: โปรดติดต่อเจ้าของโซลูชันและแนะนำการอัปเกรดเป็น PDFSharp รุ่นที่ใหม่กว่า

## <a name="additional-resources"></a>ทรัพยากรเพิ่มเติม

- [ออกแบบการตั้งค่าคอนฟิกสำหรับการสร้างรายงานในรูปแบบ OPENXML ของ ER (พฤศจิกายน 2016)](tasks/er-design-reports-openxml-2016-11.md)
- [ออกแบบการตั้งค่าคอนฟิก ER เพื่อสร้างรายงานในรูปแบบ Word](tasks/er-design-configuration-word-2016-11.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
