---
title: โปรแกรมออกแบบสูตรในการรายงานทางอิเล็กทรอนิกส์ (ER)
description: หัวข้อนี้แสดงข้อมูลเกี่ยวกับวิธีการใช้โปรแกรมออกแบบสูตรในการรายงานทางอิเล็กทรอนิกส์ (ER)
author: NickSelin
manager: kfend
ms.date: 12/05/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ERDataModelDesigner, ERExpressionDesignerFormula, ERMappedFormatDesigner, ERModelMappingDesigner
audience: Application User, IT Pro
ms.reviewer: kfend
ms.custom: 58771
ms.assetid: 24223e13-727a-4be6-a22d-4d427f504ac9
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: d96fe041fd0ffb292909c1e724068efebe0184b9
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 12/05/2020
ms.locfileid: "4682660"
---
# <a name="formula-designer-in-electronic-reporting-er"></a><span data-ttu-id="1d5cd-103">โปรแกรมออกแบบสูตรในการรายงานทางอิเล็กทรอนิกส์ (ER)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-103">Formula designer in Electronic reporting (ER)</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="1d5cd-104">หัวข้อนี้อธิบายวิธีการใช้โปรแกรมออกแบบสูตรในรายงานอิเล็กทรอนิกส์ (ER)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-104">This topic explains how to use the formula designer in Electronic reporting (ER).</span></span> <span data-ttu-id="1d5cd-105">เมื่อคุณออกแบบรูปแบบสำหรับเอกสารอิเล็กทรอนิกส์เฉพาะใน ER คุณสามารถใช้สูตรเพื่อแปลงข้อมูล เพื่อให้ตรงกับความต้องการสำหรับการเติมสินค้าและการจัดรูปแบบของเอกสาร</span><span class="sxs-lookup"><span data-stu-id="1d5cd-105">When you design a format for a specific electronic document in ER, you can use formulas to transform data so that it meets the requirements for the document's fulfillment and formatting.</span></span> <span data-ttu-id="1d5cd-106">สูตรเหล่านี้คล้ายกับสูตรใน Microsoft Excel</span><span class="sxs-lookup"><span data-stu-id="1d5cd-106">These formulas resemble formulas in Microsoft Excel.</span></span> <span data-ttu-id="1d5cd-107">ฟังก์ชันชนิดต่างๆ ได้รับการสนับสนุนในสูตร: ข้อความ วันที่และเวลา เชิงคณิตศาสตร์ เชิงตรรกะ ข้อมูล และฟังก์ชันการแปลงชนิดข้อมูล และฟังก์ชันเฉพาะโดเมนธุรกิจอื่นๆ อีกด้วย</span><span class="sxs-lookup"><span data-stu-id="1d5cd-107">Various types of functions are supported in the formulas: text, date and time, mathematical, logical, information, and data type conversion functions, and also other, business domain–specific functions.</span></span>

## <a name="formula-designer-overview"></a><span data-ttu-id="1d5cd-108">ภาพรวมผู้ออกแบบสูตร</span><span class="sxs-lookup"><span data-stu-id="1d5cd-108">Formula designer overview</span></span>

<span data-ttu-id="1d5cd-109">ER สนับสนุนผู้ออกแบบสูตร</span><span class="sxs-lookup"><span data-stu-id="1d5cd-109">ER supports the formula designer.</span></span> <span data-ttu-id="1d5cd-110">ดังนั้น ในขณะออกแบบ คุณสามารถตั้งค่าคอนฟิกนิพจน์ที่สามารถใช้สำหรับงานต่อไปนี้ขณะรันไทม์ได้:</span><span class="sxs-lookup"><span data-stu-id="1d5cd-110">Therefore, at design time, you can configure expressions that can be used for the following tasks at runtime:</span></span>

- <span data-ttu-id="1d5cd-111">แปลงข้อมูลที่ได้รับจากฐานข้อมูลของแอพลิเคชั่น และที่ควรถูกป้อนลงในแบบจำลองข้อมูล ER ที่ถูกออกแบบให้เป็นแหล่งข้อมูลสำหรับรูปแบบ ER</span><span class="sxs-lookup"><span data-stu-id="1d5cd-111">Transform data that is received from an application database and that should be entered in an ER data model that is designed to be a data source for ER formats.</span></span> <span data-ttu-id="1d5cd-112">(ตัวอย่างเช่น การแปลงเหล่านี้อาจมีการกรอง การจัดกลุ่ม และการแปลงชนิดข้อมูล)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-112">(For example, these transformations might include filtering, grouping, and data type conversion.)</span></span>
- <span data-ttu-id="1d5cd-113">ข้อมูลรูปแบบที่ต้องส่งให้เอกสารอิเล็กทรอนิกส์ที่สร้างสอดคล้องกับโครงร่างและเงื่อนไขของรูปแบบ ER ที่ระบุ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-113">Format data that must be sent to a generating electronic document in accordance with the layout and conditions of a specific ER format.</span></span> <span data-ttu-id="1d5cd-114">(ตัวอย่างเช่น การจัดรูปแบบอาจถูกทำให้สอดคล้องกับภาษาหรือวัฒนธรรมที่ร้องขอ หรือการเข้ารหัส)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-114">(For example, the formatting might be done in accordance with the requested language or culture, or the encoding).</span></span>
- <span data-ttu-id="1d5cd-115">ควบคุมกระบวนการสร้างเอกสารอิเล็กทรอนิกส์</span><span class="sxs-lookup"><span data-stu-id="1d5cd-115">Control the process of creating electronic documents.</span></span> <span data-ttu-id="1d5cd-116">(ตัวอย่างเช่น นิพจน์สามารถเปิดหรือปิดใช้งานการแสดงผลขององค์ประกอบที่เฉพาะเจาะจงของรูปแบบ โดยขึ้นอยู่กับข้อมูลการประมวลผล</span><span class="sxs-lookup"><span data-stu-id="1d5cd-116">(For example, the expressions can enable or disable the output of specific elements of the format, depending on processing data.</span></span> <span data-ttu-id="1d5cd-117">พวกเขายังสามารถขัดจังหวะกระบวนการสร้างเอกสาร หรือส่งข้อความไปยังผู้ใช้ได้ด้วย)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-117">They can also interrupt the document creation process or throw messages to users.)</span></span>

<span data-ttu-id="1d5cd-118">คุณสามารถเปิดหน้า **โปรแกรมออกแบบสูตร** ได้ เมื่อคุณทำการดำเนินการอย่างใดอย่างหนึ่งต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="1d5cd-118">You can open the **Formula designer** page when you perform any of the following actions:</span></span>

- <span data-ttu-id="1d5cd-119">ผูกรายการแหล่งข้อมูลให้ส่วนประกอบของแบบจำลองข้อมูล</span><span class="sxs-lookup"><span data-stu-id="1d5cd-119">Bind data source items to data model components.</span></span>
- <span data-ttu-id="1d5cd-120">ผูกรายการแหล่งข้อมูลให้ส่วนประกอบของรูปแบบ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-120">Bind data source items to format components.</span></span>
- <span data-ttu-id="1d5cd-121">ทำการบำรุงรักษาฟิลด์ที่คำนวณได้ซึ่งเป็นส่วนหนึ่งของแหล่งข้อมูลให้เสร็จสมบูรณ์</span><span class="sxs-lookup"><span data-stu-id="1d5cd-121">Complete maintenance of calculated fields that are part of data sources.</span></span>
- <span data-ttu-id="1d5cd-122">กำหนดเงื่อนไขที่มองเห็นได้สำหรับพารามิเตอร์การป้อนของผู้ใช้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-122">Define the visibility conditions for user input parameters.</span></span>
- <span data-ttu-id="1d5cd-123">ออกแบบการแปลงรูปแบบ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-123">Design a format's transformations.</span></span>
- <span data-ttu-id="1d5cd-124">กำหนดการเปิดใช้งานเงื่อนไขสำหรับส่วนประกอบของรูปแบบ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-124">Define the enabling conditions for the format's components.</span></span>
- <span data-ttu-id="1d5cd-125">กำหนดชื่อไฟล์สำหรับส่วนประกอบรูปแบบ FILE</span><span class="sxs-lookup"><span data-stu-id="1d5cd-125">Define the file names for the format's FILE components.</span></span>
- <span data-ttu-id="1d5cd-126">กำหนดเงื่อนไขสำหรับการตรวจสอบการควบคุมกระบวนการ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-126">Define the conditions for process control validations.</span></span>
- <span data-ttu-id="1d5cd-127">กำหนดข้อความอักษรสำหรับการตรวจสอบการควบคุมกระบวนการ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-127">Define the message text for process control validations.</span></span>

## <a name="data-binding"></a><a name="Binding"></a><span data-ttu-id="1d5cd-128">การรวมข้อมูล</span><span class="sxs-lookup"><span data-stu-id="1d5cd-128">Data binding</span></span>

<span data-ttu-id="1d5cd-129">โปรแกรมออกแบบสูตร ER สามารถถูกใช้เพื่อกำหนดนิพจน์ที่แปลงข้อมูลที่ได้รับจากแหล่งข้อมูลได้ เพื่อให้สามารถป้อนข้อมูลในผู้ใช้ข้อมูลในวิธีต่อไปนี้ที่รันไทม์:</span><span class="sxs-lookup"><span data-stu-id="1d5cd-129">The ER formula designer can be used to define an expression that transforms data that is received from data sources, so that the data can be entered in the data consumer in the following ways at runtime:</span></span>

- <span data-ttu-id="1d5cd-130">จากแหล่งข้อมูลของแอพพลิเคชั่นและเวลาการดำเนินงานของพารามิเตอร์เป็นแบบจำลองข้อมูล ER</span><span class="sxs-lookup"><span data-stu-id="1d5cd-130">From application data sources and runtime parameters to an ER data model</span></span>
- <span data-ttu-id="1d5cd-131">จากแบบจำลองข้อมูล ER เป็นรูปแบบ ER</span><span class="sxs-lookup"><span data-stu-id="1d5cd-131">From an ER data model to an ER format</span></span>
- <span data-ttu-id="1d5cd-132">จากแหล่งข้อมูลของแอพพลิเคชั่นและเวลาการดำเนินงานของพารามิเตอร์เป็นรูปแบบ ER</span><span class="sxs-lookup"><span data-stu-id="1d5cd-132">From application data sources and runtime parameters to an ER format</span></span>

<span data-ttu-id="1d5cd-133">ภาพต่อไปนี้แสดงการออกแบบนิพจน์ชนิดนี้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-133">The following illustration shows the design of an expression of this type.</span></span> <span data-ttu-id="1d5cd-134">ในตัวอย่างนี้ นิพจน์ปัดเศษค่าของฟิลด์ **Intrastat.AmountMST** ในตาราง Intrastat เป็นทศนิยมสองตำแหน่ง และจากนั้น ส่งคืนค่าที่ถูกปัดเศษ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-134">In this example, the expression rounds the value of the **Intrastat.AmountMST** field in the Intrastat table to two decimal places and then returns the rounded value.</span></span>

<span data-ttu-id="1d5cd-135">[![นิพจน์การผูกข้อมูล](./media/picture-expression-binding.jpg)](./media/picture-expression-binding.jpg)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-135">[![Data binding expression](./media/picture-expression-binding.jpg)](./media/picture-expression-binding.jpg)</span></span>

<span data-ttu-id="1d5cd-136">ภาพต่อไปนี้แสดงวิธีการใช้นิพจน์ของชนิดนี้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-136">The following illustration shows how an expression of this type can be used.</span></span> <span data-ttu-id="1d5cd-137">ในตัวอย่างนี้ ผลลัพธ์ของนิพจน์ที่ได้รับการออกแบบจะถูกป้อนในส่วนประกอบ **Transaction.InvoicedAmount** ของแบบจำลองข้อมูล **แบบจำลองการรายงานภาษี**</span><span class="sxs-lookup"><span data-stu-id="1d5cd-137">In this example, the result of the designed expression is entered in the **Transaction.InvoicedAmount** component of the **Tax reporting model** data model.</span></span>

<span data-ttu-id="1d5cd-138">[![มีการใช้นิพจน์การผูกข้อมูล](./media/picture-expression-binding2.jpg)](./media/picture-expression-binding2.jpg)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-138">[![Data binding expression being used](./media/picture-expression-binding2.jpg)](./media/picture-expression-binding2.jpg)</span></span>

<span data-ttu-id="1d5cd-139">ในช่วงรันไทม์ สูตรที่ได้รับการออกแบบ `ROUND (Intrastat.AmountMST, 2)` ปัดเศษค่าของฟิลด์ **AmountMST** สำหรับแต่ละเรกคอร์ดในตารางอินทราสแทตเป็นทศนิยมสองตำแหน่ง</span><span class="sxs-lookup"><span data-stu-id="1d5cd-139">At runtime, the designed formula, `ROUND (Intrastat.AmountMST, 2)`, rounds the value of the **AmountMST** field for each record in the Intrastat table to two decimal places.</span></span> <span data-ttu-id="1d5cd-140">จากนั้นจะป้อนค่าที่ปัดเศษในส่วนประกอบ **Transaction.InvoicedAmount** ของแบบจำลองข้อมูล **การรายงานภาษี**</span><span class="sxs-lookup"><span data-stu-id="1d5cd-140">It then enters the rounded value in the **Transaction.InvoicedAmount** component of the **Tax reporting** data model.</span></span>

## <a name="data-formatting"></a><a name="Transformation"></a><span data-ttu-id="1d5cd-141">การจัดรูปแบบข้อมูล</span><span class="sxs-lookup"><span data-stu-id="1d5cd-141">Data formatting</span></span>

<span data-ttu-id="1d5cd-142">ผู้ออกแบบสูตร ER สามารถใช้เพื่อกำหนดนิพจน์ที่แปลงรูปแบบข้อมูลที่ได้รับจากแหล่งข้อมูล เพื่อให้สามารถส่งข้อมูลเป็นเอกสารอิเล็กทรอนิกส์</span><span class="sxs-lookup"><span data-stu-id="1d5cd-142">The ER formula designer can be used to define an expression that formats data that is received from data sources, so that the data can be sent as part of the generating electronic document.</span></span> <span data-ttu-id="1d5cd-143">คุณอาจมีการจัดรูปแบบที่ต้องใช้ ตามกฎทั่วไปที่ควรนำมาใช้ใหม่สำหรับรูปแบบ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-143">You might have formatting that must be applied as a typical rule that should be reused for a format.</span></span> <span data-ttu-id="1d5cd-144">ในกรณีนี้ คุณสามารถแนะนำให้การจัดรูปแบบครั้งเดียวในการตั้งค่าคอนฟิกรูปแบบ เป็นการแปลงที่มีการตั้งชื่อที่มีนิพจน์การจัดรูปแบบ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-144">In this case, you can introduce that formatting one time in the format configuration, as a named transformation that has a formatting expression.</span></span> <span data-ttu-id="1d5cd-145">การแปลงข้อมูลที่มีการตั้งชื่อนี้สามารถเชื่อมโยงกับองค์ประกอบรูปแบบหลายองค์ประกอบ ที่ซึ่งผลลัพธ์ต้องถูกจัดรูปแบบตามนิพจน์การจัดรูปแบบทีคุณสร้างไว้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-145">This named transformation can then be linked to many format components where the output must be formatted according to the formatting expression that you created.</span></span>

<span data-ttu-id="1d5cd-146">ภาพต่อไปนี้แสดงการออกแบบการแปลงชนิดนี้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-146">The following illustration shows the design of a transformation of this type.</span></span> <span data-ttu-id="1d5cd-147">ในตัวอย่างนี้ การแปลง **TrimmedString** ตัดทอนข้อมูลขาเข้าของชนิดข้อมูล *สตริง* โดยการลบช่องว่างนำหน้าและต่อท้าย</span><span class="sxs-lookup"><span data-stu-id="1d5cd-147">In this example, the **TrimmedString** transformation truncates incoming data of the *String* data type by removing leading and trailing spaces.</span></span> <span data-ttu-id="1d5cd-148">จากนั้น จะส่งกลับค่าสตริงที่ถูกตัดทอนแล้ว</span><span class="sxs-lookup"><span data-stu-id="1d5cd-148">It then returns the truncated string value.</span></span>

<span data-ttu-id="1d5cd-149">[![การแปลงข้อมูล](./media/picture-transformation-design.jpg)](./media/picture-transformation-design.jpg)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-149">[![Transformation](./media/picture-transformation-design.jpg)](./media/picture-transformation-design.jpg)</span></span>

<span data-ttu-id="1d5cd-150">ภาพต่อไปนี้แสดงการใช้การแปลงชนิดนี้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-150">The following illustration shows how a transformation of this type can be used.</span></span> <span data-ttu-id="1d5cd-151">ในตัวอย่างนี้ ส่วนประกอบของรูปแบบต่างๆ ส่งข้อความเป็นเอาท์พุตไปยังเอกสารอิเล็กทรอนิกส์ที่สร้างในช่วงรันไทม์</span><span class="sxs-lookup"><span data-stu-id="1d5cd-151">In this example, several format components send text as output to the generating electronic document at runtime.</span></span> <span data-ttu-id="1d5cd-152">ส่วนประกอบรูปแบบเหล่านี้ทั้งหมดอ้างอิงถึงการแปลง **TrimmedString** ตามชื่อ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-152">All these format components refer to the **TrimmedString** transformation by name.</span></span>

<span data-ttu-id="1d5cd-153">[![มีการใช้การแปลง](./media/picture-transformation-usage.jpg)](./media/picture-transformation-usage.jpg)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-153">[![Transformation being used](./media/picture-transformation-usage.jpg)](./media/picture-transformation-usage.jpg)</span></span>

<span data-ttu-id="1d5cd-154">เมื่อส่วนประกอบของรูปแบบ เช่น ส่วนประกอบ **partyName** ในแผนภาพก่อนหน้านี้ อ้างอิงถึงการแปลง **TrimmedString** การแปลงจะส่งข้อความเป็นเอาท์พุตไปยังเอกสารอิเล็กทรอนิกส์ที่มีการสร้าง</span><span class="sxs-lookup"><span data-stu-id="1d5cd-154">When format components, such as the **partyName** component in the preceding illustration, refer to the **TrimmedString** transformation, the transformation sends text as output to the generating electronic document.</span></span> <span data-ttu-id="1d5cd-155">ข้อความนี้ไม่รวมช่องว่างนำหน้าและต่อท้าย</span><span class="sxs-lookup"><span data-stu-id="1d5cd-155">This text doesn't include leading and trailing spaces.</span></span>

<span data-ttu-id="1d5cd-156">ถ้าคุณมีการจัดรูปแบบที่จำเป็นต้องใช้แต่ละรายการ คุณสามารถนำรูปแบบไปใช้เพื่อเป็นนิพจน์ของการผูกข้อมูลของส่วนประกอบรูปเฉพาะแบบแต่ละรายการได้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-156">If you have formatting that must be applied individually, you can introduce that formatting as an individual expression of a binding of a specific format component.</span></span> <span data-ttu-id="1d5cd-157">ภาพต่อไปนี้แสดงนิพจน์ชนิดนี้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-157">The following illustration shows an expression of this type.</span></span> <span data-ttu-id="1d5cd-158">ในตัวอย่างนี้ ส่วนประกอบรูปแบบ **partyType** ถูกผูกไว้กับแหล่งข้อมูลผ่านนิพจน์ที่แปลงข้อมูลขาเข้าจากฟิลด์ **Model.Company.RegistrationType** ในแหล่งข้อมูลเป็นข้อความตัวพิมพ์ใหญ่</span><span class="sxs-lookup"><span data-stu-id="1d5cd-158">In this example, the **partyType** format component is bound to the data source via an expression that converts incoming data from the **Model.Company.RegistrationType** field in the data source to uppercase text.</span></span> <span data-ttu-id="1d5cd-159">แล้วนิพจน์จะส่งข้อความนั้นเป็นเอาท์พุตไปยังเอกสารอิเล็กทรอนิกส์</span><span class="sxs-lookup"><span data-stu-id="1d5cd-159">The expression then sends that text as output to the electronic document.</span></span>

<span data-ttu-id="1d5cd-160">[![การใช้การจัดรูปแบบกับส่วนประกอบแต่ละรายการ](./media/picture-binding-with-formula.jpg)](./media/picture-binding-with-formula.jpg)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-160">[![Applying formatting to an individual component](./media/picture-binding-with-formula.jpg)](./media/picture-binding-with-formula.jpg)</span></span>

## <a name="process-flow-control"></a><a name="Validation"></a><span data-ttu-id="1d5cd-161">กระบวนการควบคุมขั้นตอน</span><span class="sxs-lookup"><span data-stu-id="1d5cd-161">Process flow control</span></span>

<span data-ttu-id="1d5cd-162">โปรแกรมออกแบบสูตร ER สามารถใช้เพื่อกำหนดนิพจน์ที่ควบคุมขั้นตอนกระบวนการของเอกสารอิเล็กทรอนิกส์ที่สร้าง:</span><span class="sxs-lookup"><span data-stu-id="1d5cd-162">The ER formula designer can be used to define expressions that control the process flow of generating electronic documents.</span></span> <span data-ttu-id="1d5cd-163">คุณสามารถจัดการงานต่อไปนี้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-163">You can perform the following tasks:</span></span>

- <span data-ttu-id="1d5cd-164">เงื่อนไขที่กำหนดเมื่อกระบวนการสร้างเอกสารต้องถูกหยุด</span><span class="sxs-lookup"><span data-stu-id="1d5cd-164">Define conditions that determine when a document creation process must be stopped.</span></span>
- <span data-ttu-id="1d5cd-165">ระบุนิพจน์ที่จะสร้างข้อความสำหรับผู้ใช้เกี่ยวกับกระบวนการที่หยุด หรือส่งข้อความล็อกการดำเนินการเกี่ยวกับกระบวนการสร้างรายงานต่อเนื่อง อย่างใดอย่างหนึ่ง</span><span class="sxs-lookup"><span data-stu-id="1d5cd-165">Specify expressions that either create messages for the user about stopped processes or throw execution log messages about the continuing process of report generation.</span></span>
- <span data-ttu-id="1d5cd-166">ระบุชื่อไฟล์ของการสร้างเอกสารอิเล็กทรอนิกส์ และควบคุมเงื่อนไขของการสร้างของพวกเขา</span><span class="sxs-lookup"><span data-stu-id="1d5cd-166">Specify the file names of generating electronic documents, and control the conditions of their creation.</span></span>

<span data-ttu-id="1d5cd-167">กฏแต่ละกฏของการควบคุมขั้นตอนการประมวลผลถูกออกแบบให้เป็นการตรวจสอบเดี่ยว</span><span class="sxs-lookup"><span data-stu-id="1d5cd-167">Each rule of the process flow control is designed as an individual validation.</span></span> <span data-ttu-id="1d5cd-168">ภาพต่อไปนี้แสดงการตรวจสอบความถูกต้องชนิดนี้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-168">The following illustration shows a validation of this type.</span></span> <span data-ttu-id="1d5cd-169">นี่เป็นคำอธิบายเกี่ยวกับการตั้งค่าคอนฟิกในตัวอย่างนี้:</span><span class="sxs-lookup"><span data-stu-id="1d5cd-169">Here is an explanation of the configuration in this example:</span></span>

- <span data-ttu-id="1d5cd-170">การตรวจสอบถูกประเมิน เมื่อโหนด **INSTAT** ถูกสร้างในระหว่างการสร้างไฟล์ XML</span><span class="sxs-lookup"><span data-stu-id="1d5cd-170">The validation is evaluated when the **INSTAT** node is created during generation of the XML file.</span></span>
- <span data-ttu-id="1d5cd-171">เมื่อรายการธุรกรรมว่างเปล่าs การการประมวลผลจะหยุดการดำเนินและส่งกลับค่า **FALSE**</span><span class="sxs-lookup"><span data-stu-id="1d5cd-171">If the list of transactions is empty, the validation stops the execution process and returns **FALSE**.</span></span>
- <span data-ttu-id="1d5cd-172">การตรวจสอบส่งคืนข้อผิดพลาดที่มีข้อความของป้ายชื่อ SYS70894 ในภาษาที่ผู้ใช้ต้องการ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-172">The validation returns an error message that includes the text of label SYS70894 in the user's preferred language.</span></span>

<span data-ttu-id="1d5cd-173">[![การตรวจสอบความถูกต้อง](./media/picture-validation.jpg)](./media/picture-validation.jpg)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-173">[![Validation](./media/picture-validation.jpg)](./media/picture-validation.jpg)</span></span>

<span data-ttu-id="1d5cd-174">นอกจากนี้ โปรแกรมออกแบบสูตร ER ยังสามารถใช้เพื่อสร้างชื่อไฟล์สำหรับเอกสารทางอิเล็กทรอนิกส์ที่สร้าง และเพื่อควบคุมกระบวนการสร้างไฟล์อีกด้วย</span><span class="sxs-lookup"><span data-stu-id="1d5cd-174">The ER formula designer can also be used to generate a file name for a generating electronic document and to control the file creation process.</span></span> <span data-ttu-id="1d5cd-175">ภาพต่อไปนี้แสดงกฏของการควบคุมขั้นตอนการประมวลผลชนิดนี้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-175">The following illustration shows the design of a process flow control of this type.</span></span> <span data-ttu-id="1d5cd-176">นี่เป็นคำอธิบายเกี่ยวกับการตั้งค่าคอนฟิกในตัวอย่างนี้:</span><span class="sxs-lookup"><span data-stu-id="1d5cd-176">Here is an explanation of the configuration in this example:</span></span>

- <span data-ttu-id="1d5cd-177">รายการของเรกคอร์ดจากแหล่งข้อมูล **แบบจำลอง.อินทราสแทต** ถูกแบ่งออกเป็นชุดงาน</span><span class="sxs-lookup"><span data-stu-id="1d5cd-177">The list of records from the **model.Intrastat** data source is divided into batches.</span></span> <span data-ttu-id="1d5cd-178">ชุดงานแต่ละชุดประกอบด้วยเรกคอร์ดได้มากถึง 1000 รายการ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-178">Each batch contains up to 1,000 records.</span></span>
- <span data-ttu-id="1d5cd-179">ผลลัพธ์สร้างไฟล์ zip ที่ประกอบด้วยไฟล์หนึ่งไฟล์ในรูปแบบ XML สำหรับชุดงานทั้งหมดที่สร้างขึ้น</span><span class="sxs-lookup"><span data-stu-id="1d5cd-179">The output creates a zip file that contains one file in XML format for every batch that was created.</span></span>
- <span data-ttu-id="1d5cd-180">นิพจน์ส่งกลับชื่อไฟล์สำหรับการสร้างเอกสารอิเล็กทรอนิกส์โดยการเชื่อมชื่อไฟล์และนามสกุลไฟล์</span><span class="sxs-lookup"><span data-stu-id="1d5cd-180">An expression returns a file name for generating electronic documents by concatenating the file name and the file name extension.</span></span> <span data-ttu-id="1d5cd-181">สำหรับชุดงานที่สองและชุดงานในลำดับต่อมาทั้งหมด ชื่อไฟล์จะประกอบด้วยรหัสชุดงานเป็นคำต่อท้าย</span><span class="sxs-lookup"><span data-stu-id="1d5cd-181">For the second batch and all subsequent batches, the file name contains the batch ID as a suffix.</span></span>
- <span data-ttu-id="1d5cd-182">นิพจน์เปิดใช้งาน (โดยการคืนค่า **จริง**) กระบวนการสร้างไฟล์ สำหรับชุดงานซึ่งประกอบด้วยอย่างน้อยหนึ่งเรกคอร์ด</span><span class="sxs-lookup"><span data-stu-id="1d5cd-182">An expression enables (by returning **TRUE**) the file creation process for batches that contain at least one record.</span></span>

<span data-ttu-id="1d5cd-183">[![กระบวนการควบคุมขั้นตอน](./media/picture-file-control.jpg)](./media/picture-file-control.jpg)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-183">[![Process flow control](./media/picture-file-control.jpg)](./media/picture-file-control.jpg)</span></span>

## <a name="document-content-control"></a><a name="Enabled"></a> <span data-ttu-id="1d5cd-184">การควบคุมเนื้อหาเอกสาร</span><span class="sxs-lookup"><span data-stu-id="1d5cd-184">Document content control</span></span>

<span data-ttu-id="1d5cd-185">โปรแกรมออกแบบสูตร ER สามารถใช้เพื่อตั้งค่าคอนฟิกนิพจน์ซึ่งควบคุมว่าข้อมูลจะถูกวางในเอกสารอิเล็กทรอนิกส์ที่สร้างในขณะรันไทม์</span><span class="sxs-lookup"><span data-stu-id="1d5cd-185">The ER formula designer can be used to configure expressions that control what data will be put into generated electronic documents at runtime.</span></span> <span data-ttu-id="1d5cd-186">นิพจน์สามารถเปิด หรือปิดใช้งานกผลลัพธ์ขององค์ประกอบเฉพาะของรูปแบบ ขึ้นอยู่กับการประมวลผลข้อมูล เเละตรรกะคอนฟิก</span><span class="sxs-lookup"><span data-stu-id="1d5cd-186">The expressions can enable or disable the output of specific elements of the format, depending on processing data and configured logic.</span></span> <span data-ttu-id="1d5cd-187">นิพจน์เหล่านี้สามารถป้อนสำหรับองค์ประกอบรูปแบบเดียวในฟิล์ด์ **ที่เปิดใช้งาน** บนเเท็บ **การเเม็บ** ของหน้า **ผู้ออกเเบบการดำเนินการ**</span><span class="sxs-lookup"><span data-stu-id="1d5cd-187">These expressions can be entered for a single format element in the **Enabled** field on the **Mapping** tab of the **Operations designer** page.</span></span> <span data-ttu-id="1d5cd-188">คุณสามารถป้อนนิพจน์เป็นเงื่อนไขตรรกะที่ส่งกลับค่า *บูลีน*:</span><span class="sxs-lookup"><span data-stu-id="1d5cd-188">You can enter the expressions as a logic condition that returns a *Boolean* value:</span></span>

- <span data-ttu-id="1d5cd-189">ถ้าเงื่อนไขส่งกลับค่า **จริง** องค์ประกอบรูปแบบปัจจุบันจะถูกเรียกใช้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-189">If the condition returns **True**, the current format element is run.</span></span>
- <span data-ttu-id="1d5cd-190">ถ้าเงื่อนไขส่งกลับค่า **เท็จ** องค์ประกอบรูปแบบปัจจุบันจะถูกข้าม</span><span class="sxs-lookup"><span data-stu-id="1d5cd-190">If the condition returns **False**, the current format element is skipped.</span></span>

<span data-ttu-id="1d5cd-191">ภาพประกอบต่อไปนี้แสดงนิพจน์ของชนิดนี้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-191">The following illustration shows expressions of this type.</span></span> <span data-ttu-id="1d5cd-192">(รุ่น11.12.11 ของการตั้งค่าคอนฟิกรูปแบบ **ISO20022 การโอนย้ายเครดิต (ไม่)** ที่ให้ไว้โดย Microsoft จะถูกใช้เป็นตัวอย่าง) ส่วนประกอบรูปแบบ **XMLHeader** ถูกตั้งค่าคอนฟิกเพื่ออธิบายโครงสร้างของข้อความการโอนย้ายเครดิตตามมาตรฐาน ISO 20022 ข้อความ XML</span><span class="sxs-lookup"><span data-stu-id="1d5cd-192">(Version 11.12.11 of the **ISO20022 Credit transfer (NO)** format configuration that is provided by Microsoft is used as an example.) The **XMLHeader** format component is configured to describe the structure of the credit transfer message according to the ISO 20022 XML message standards.</span></span> <span data-ttu-id="1d5cd-193">ส่วนประกอบของรูปแบบ **XMLHeader/Document/CstmrCdtTrfInitn/PmtInf/CdtTrfTxInf/RmtInf/Ustrd** ถูกตั้งค่าคอนฟิกเพื่อเพิ่มองค์ประกอบ XML **Ustrd** ไปยังข้อความที่สร้าง เเละวางข้อมูลการชำระเงินในรูปแบบที่ไม่มีโครงสร้างเป็นข้อความขององค์ประกอบ XML ต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="1d5cd-193">The **XMLHeader/Document/CstmrCdtTrfInitn/PmtInf/CdtTrfTxInf/RmtInf/Ustrd** format component is configured to add the **Ustrd** XML element to the generated message and to put the remittance information in an unstructured format as text of the following XML elements:</span></span>

- <span data-ttu-id="1d5cd-194">ส่วนประกอบ **PaymentNotes** ถูกใช้ในการสร้างข้อความของบันทึกการชำระเงิน</span><span class="sxs-lookup"><span data-stu-id="1d5cd-194">The **PaymentNotes** component is used to generate the text of payment notes.</span></span>
- <span data-ttu-id="1d5cd-195">ส่วนประกอบ **DelimitedSequence** สร้างหมายเลขใบเเจ้งหนี้ที่แบ่งด้วยเครื่องหมายจุลภาค ซึ่งถูกใช้ในการชำระการโอนย้ายเครดิตปัจจุบัน</span><span class="sxs-lookup"><span data-stu-id="1d5cd-195">The **DelimitedSequence** component generates comma-separated invoice numbers that are used to settle the current credit transfer.</span></span>

<span data-ttu-id="1d5cd-196">[![ส่วนประกอบของ PaymentNotes และ DelimitedSequence](./media/GER-FormulaEditor-ControlContent-1.png)](./media/GER-FormulaEditor-ControlContent-1.png)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-196">[![PaymentNotes and DelimitedSequence components](./media/GER-FormulaEditor-ControlContent-1.png)](./media/GER-FormulaEditor-ControlContent-1.png)</span></span>

> [!NOTE]
> <span data-ttu-id="1d5cd-197">ส่วนประกอบ **PaymentNotes** เเละ **DelimitedSequence** จะมีการกำกับชื่อโดยใช้เครื่องหมายคำถาม</span><span class="sxs-lookup"><span data-stu-id="1d5cd-197">The **PaymentNotes** and **DelimitedSequence** components are labeled by using a question mark.</span></span> <span data-ttu-id="1d5cd-198">เครื่องหมายคำถามบ่งชี้ว่าการใช้ส่วนประกอบมีเงื่อนไข</span><span class="sxs-lookup"><span data-stu-id="1d5cd-198">A question mark indicates that the use of a component is conditional.</span></span> <span data-ttu-id="1d5cd-199">ในกรณีนี้ การใช้ส่วนประกอบจะขึ้นอยู่กับเงื่อนไขต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="1d5cd-199">In this case, use of the components is based on the following criteria:</span></span>
>
> - <span data-ttu-id="1d5cd-200">นิพจน์ `@.PaymentsNotes <> ""` ที่ถูกกำหนดสำหรับส่วนประกอบของ **PaymentNotes** เปิดใช้งาน (โดยส่งคืนค่า **จริง**) องค์ประกอบ XML ของ **Ustrd** ที่จะถูกเติมข้อมูลด้วยข้อความของบันทึกการชำระเงิน ถ้าข้อความนั้นไม่ว่างเปล่าสำหรับการโอนย้ายเครดิตปัจจุบัน</span><span class="sxs-lookup"><span data-stu-id="1d5cd-200">The `@.PaymentsNotes <> ""` expression that is defined for the **PaymentNotes** component enables (by returning **TRUE**) the **Ustrd** XML element to be filled with the text of payment notes, if that text isn't blank for the current credit transfer.</span></span>
>
>    <span data-ttu-id="1d5cd-201">[![นิพจน์สำหรับส่วนประกอบของ PaymentNotes](./media/GER-FormulaEditor-ControlContent-2.png)](./media/GER-FormulaEditor-ControlContent-2.png)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-201">[![Expression for the PaymentNotes component](./media/GER-FormulaEditor-ControlContent-2.png)](./media/GER-FormulaEditor-ControlContent-2.png)</span></span>
>
> - <span data-ttu-id="1d5cd-202">นิพจน์ `@.PaymentsNotes = ""` ที่ถูกกำหนดสำหรับส่วนประกอบของ **DelimitedSequence** เปิดใช้งาน (โดยส่งคืนค่า **จริง**) องค์ประกอบ XML ของ **Ustrd** ที่จะถูกเติมข้อมูลด้วยรายการที่คั่นด้วยเครื่องหมายจุลภาคของหมายเลขใบแจ้งหนี้ที่ถูกใช้ในการชำระการโอนย้ายเครดิตปัจจุบัน ถ้าข้อความของบันทึกการชำระเงินสำหรับการโอนย้ายเครดิตนั้นว่างเปล่า</span><span class="sxs-lookup"><span data-stu-id="1d5cd-202">The `@.PaymentsNotes = ""` expression that is defined for the **DelimitedSequence** component enables (by returning **TRUE**) the **Ustrd** XML element to be filled with a comma-separated list of the invoice numbers that are used to settle the current credit transfer, if the text of payment notes for that credit transfer is blank.</span></span>
>
>    <span data-ttu-id="1d5cd-203">[![นิพจน์สำหรับส่วนประกอบของ DelimitedSequence](./media/GER-FormulaEditor-ControlContent-3.png)](./media/GER-FormulaEditor-ControlContent-3.png)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-203">[![Expression for the DelimitedSequence component](./media/GER-FormulaEditor-ControlContent-3.png)](./media/GER-FormulaEditor-ControlContent-3.png)</span></span>
> 
> <span data-ttu-id="1d5cd-204">ตามการตั้งค่านี้ มีการสร้างข้อความสำหรับการชำระของลูกหนี้เเต่ละรายการ องค์ประกอบ XML ของ **Ustrd** จะมีข้อความของบันทึกการชำระเงิน หรือเมื่อข้อความดังกล่าวว่างเปล่า รายการที่คั่นด้วยเครื่องหมายจุลภาคของหมายเลขใบแจ้งหนี้ที่ถูกใช้เพื่อชำระเงิน</span><span class="sxs-lookup"><span data-stu-id="1d5cd-204">Based on this setup, the message that is generated for each debtor payment, the **Ustrd** XML element, will contain either the text of payment notes or, when that text is blank, a comma-separated list of the invoice numbers that are used to settle the payment.</span></span>

## <a name="validation-of-configured-formulas"></a><a name="TestFormula"></a> <span data-ttu-id="1d5cd-205">การตรวจสอบความถูกต้องของสูตรที่ตั้งค่าคอนฟิก</span><span class="sxs-lookup"><span data-stu-id="1d5cd-205">Validation of configured formulas</span></span>

<span data-ttu-id="1d5cd-206">บนหน้า **โปรแกรมออกแบบสูตร** ให้เลือก **การทดสอบ** เพื่อตรวจสอบความถูกต้องของวิธ๊ที่สูตรที่ตั้งค่าคอนฟิกทำงาน</span><span class="sxs-lookup"><span data-stu-id="1d5cd-206">On the **Formula designer** page, select **Test** to validate how the configured formula works.</span></span>

<span data-ttu-id="1d5cd-207">[![การเลือกการทดสอบเพื่อตรวจสอบความถูกต้องของสูตร](./media/ER-FormulaTest-Start.png)](./media/ER-FormulaTest-Start.png)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-207">[![Selecting Test to validate a forumula](./media/ER-FormulaTest-Start.png)](./media/ER-FormulaTest-Start.png)</span></span>

<span data-ttu-id="1d5cd-208">เมื่อจำเป็นต้องใช้ค่าของอาร์กิวเมนต์สูตร คุณสามารถเปิดกล่องโต้ตอบ **นิพจน์การทดสอบ** จากหน้า **โปรแกรมออกแบบสูตร**</span><span class="sxs-lookup"><span data-stu-id="1d5cd-208">When the values of formula arguments are required, you can open the **Test expression** dialog box from the **Formula designer** page.</span></span> <span data-ttu-id="1d5cd-209">ในกรณีส่วนใหญ่ อาร์กิวเมนต์เหล่านี้ต้องถูกกำหนดด้วยตนเอง เนื่องจากการผูกข้อมูลที่ถูกตั้งค่าคอนฟิกไว้ไม่ทำงานในขณะออกแบบ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-209">In most cases, these arguments must be manually defined, because the configured bindings aren't run at design time.</span></span> <span data-ttu-id="1d5cd-210">แท็บ **ผลการทดสอบ** บนหน้า **โปรแกรมออกแบบสูตร** แสดงผลลัพธ์จากการดำเนินการของสูตรที่ตั้งค่าคอนฟิก</span><span class="sxs-lookup"><span data-stu-id="1d5cd-210">The **Test result** tab on the **Formula designer** page shows the result from execution of the configured formula.</span></span>

<span data-ttu-id="1d5cd-211">ตัวอย่างต่อไปนี้แสดงให้เห็นว่าคุณสามารถทดสอบสูตรที่ถูกตั้งค่าคอนฟิกสำหรับโดเมนการค้าในต่างประเทศ เพื่อให้แน่ใจว่ารหัสโภคภัณฑ์อินทราสแทตมีเฉพาะตัวเลขเท่านั้น</span><span class="sxs-lookup"><span data-stu-id="1d5cd-211">The following example shows how you can test the formula that is configured for the foreign trade domain to make sure that the Intrastat commodity code contains only digits.</span></span>

<span data-ttu-id="1d5cd-212">เมื่อคุณทดสอบสูตรนี้ คุณสามารถใช้กล่องโต้ตอบ **นิพจน์การทดสอบ** เพื่อระบุค่าของรหัสโภคภัณฑ์อินทราสแทตสำหรับการทดสอบ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-212">When you test this formula, you can use the **Test expression** dialog box to specify the value of the Intrastat commodity code for testing.</span></span>

<span data-ttu-id="1d5cd-213">[![การระบุรหัสโภคภัณฑ์อินทราสแทตสำหรับการทดสอบ](./media/ER-FormulaTest-Start-EnterArguments.png)](./media/ER-FormulaTest-Start-EnterArguments.png)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-213">[![Specifying the Intrastat commodity code for testing](./media/ER-FormulaTest-Start-EnterArguments.png)](./media/ER-FormulaTest-Start-EnterArguments.png)</span></span>

<span data-ttu-id="1d5cd-214">หลังจากที่คุณระบุรหัสโภคภัณฑ์อินทราสแทต และเลือก **ตกลง** แท็บ **ผลการทดสอบ** บนหน้า **โปรแกรมออกแบบสูตร** แสดงผลลัพธ์ของการดำเนินการของสูตรที่ตั้งค่าคอนฟิก</span><span class="sxs-lookup"><span data-stu-id="1d5cd-214">After you specify the Intrastat commodity code and select **OK**, the **Test result** tab on the **Formula designer** page shows the result of execution of the configured formula.</span></span> <span data-ttu-id="1d5cd-215">จากนั้น คุณสามารถประเมินได้ว่าผลลัพธ์เป็นที่ยอมรับหรือไม่</span><span class="sxs-lookup"><span data-stu-id="1d5cd-215">You can then evaluate whether the result is acceptable.</span></span> <span data-ttu-id="1d5cd-216">ถ้าไม่สามารถยอมรับผลลัพธ์ได้ คุณสามารถปรับปรุงสูตรและทดสอบอีกครั้ง</span><span class="sxs-lookup"><span data-stu-id="1d5cd-216">If the result isn't acceptable, you can update the formula and test it again.</span></span>

<span data-ttu-id="1d5cd-217">[![ผลการทดสอบ](./media/ER-FormulaTest-Result.png)](./media/ER-FormulaTest-Result.png)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-217">[![Test result](./media/ER-FormulaTest-Result.png)](./media/ER-FormulaTest-Result.png)</span></span>

<span data-ttu-id="1d5cd-218">ไม่สามารถทดสอบสูตรบางอย่างในขณะออกแบบ</span><span class="sxs-lookup"><span data-stu-id="1d5cd-218">Some formulas can't be tested at design time.</span></span> <span data-ttu-id="1d5cd-219">ตัวอย่างเช่น สูตรอาจส่งกลับผลลัพธ์ของชนิดข้อมูลที่ไม่สามารถแสดงบนแท็บ **ผลการทดสอบ** ในกรณีนี้ คุณได้รับข้อความแสดงข้อผิดพลาดที่ระบุว่าไม่สามารถทดสอบสูตรได้</span><span class="sxs-lookup"><span data-stu-id="1d5cd-219">For example, a formula might return a result of a data type that can't be shown on the **Test result** tab. In this case, you receive an error message that states that the formula can't be tested.</span></span>

<span data-ttu-id="1d5cd-220">[![ข้อความแสดงข้อผิดพลาด](./media/ER-FormulaTest-Error.png)](./media/ER-FormulaTest-Error.png)</span><span class="sxs-lookup"><span data-stu-id="1d5cd-220">[![Error message](./media/ER-FormulaTest-Error.png)](./media/ER-FormulaTest-Error.png)</span></span>

## <a name="additional-resources"></a><span data-ttu-id="1d5cd-221">แหล่งข้อมูลเพิ่มเติม</span><span class="sxs-lookup"><span data-stu-id="1d5cd-221">Additional resources</span></span>

- [<span data-ttu-id="1d5cd-222">ภาพรวมการรายงานทางอิเล็กทรอนิกส์</span><span class="sxs-lookup"><span data-stu-id="1d5cd-222">Electronic Reporting overview</span></span>](general-electronic-reporting.md)
- [<span data-ttu-id="1d5cd-223">ภาษาสูตรในการรายงานทางอิเล็กทรอนิกส์</span><span class="sxs-lookup"><span data-stu-id="1d5cd-223">Electronic reporting formula language</span></span>](er-formula-language.md)
