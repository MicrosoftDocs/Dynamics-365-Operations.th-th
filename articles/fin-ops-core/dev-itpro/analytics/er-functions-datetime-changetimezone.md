---
title: ฟังก์ชัน CHANGETIMEZONE ER
description: บทความนี้แสดงข้อมูลเกี่ยวกับวิธีการใช้ฟังก์ชันการรายงานทางอิเล็กทรอนิกส์ (ER) CHANGETIMEZONE
author: kfend
ms.date: 09/09/2021
ms.prod: ''
ms.technology: ''
audience: Application User, IT Pro
ms.reviewer: kfend
ms.search.region: Global
ms.author: filatovm
ms.search.validFrom: 2021-09-01
ms.dyn365.ops.version: AX 10.0.23
ms.custom: 58771
ms.assetid: ''
ms.search.form: ERDataModelDesigner, ERExpressionDesignerFormula, ERMappedFormatDesigner, ERModelMappingDesigner
ms.openlocfilehash: d732fd8bd44c4c131f376919b2546a7ecf668495
ms.sourcegitcommit: 87e727005399c82cbb6509f5ce9fb33d18928d30
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 08/12/2022
ms.locfileid: "9286133"
---
# <a name="changetimezone-er-function"></a>ฟังก์ชัน CHANGETIMEZONE ER

[!include [banner](../includes/banner.md)]

ฟังก์ชัน `CHANGETIMEZONE` ส่งคืนค่า *[DateTime](er-formula-supported-data-types-primitive.md#datetime)* ใน Coordinated Universal Time (Greenwich Mean Time \[GMT\]) ที่ถูกแปลงจากค่า วันที่/เวลา ที่กำหนดให้ในหนึ่งโซนเวลา เป็นค่าวันที่/เวลา ในอีกโซนเวลา

## <a name="syntax"></a>ไวยากรณ์

```vb
CHANGETIMEZONE (datetime, base time zone, target time zone)
```

## <a name="arguments"></a>อาร์กิวเมนต์

`datetime`: *DateTime*

ค่าวันที่/เวลาในโซนเวลา Coordinated Universal Time ที่แสดงถึงค่าวันที่/เวลาที่จะแปลง

`base time zone`: *[สตริง](er-formula-supported-data-types-primitive.md#string)*

ชื่อของโซนเวลาที่ค่าวันที่/เวลาที่ระบุ ถูกเลื่อนเป็นก่อนการแปลง

`target time zone`: *สตริง*

ชื่อของโซนเวลาที่ค่าวันที่/เวลาที่แปลงถูกเลื่อนระหว่างการแปลง

## <a name="return-values"></a>ค่าที่ส่งคืน

*วันที่และเวลา*

ค่าวันที่/เวลาผลลัพธ์ในโซนเวลามาตรฐานสากล

## <a name="usage-notes"></a>บันทึกย่อการใช้งาน

เมื่อต้องการระบุโซนเวลาต้นทางและเป้าหมาย คุณสามารถใช้ชื่อโซนเวลาที่ [มีให้](https://data.iana.org/time-zones/releases/) โดย [Internet Assigned Numbers Authority (IANA)](https://www.iana.org/) หรือที่ได้รับ [การสนับสนุน](/windows-hardware/manufacture/desktop/default-time-zones) โดย Microsoft Windows

เมื่อรันไทม์ ข้อยกเว้น "โซนเวลา '\<time zone name\>' ไม่มีอยู่" ถ้าไม่พบชื่อที่ระบุในรายการ IANA หรือในรีจิสทรี Windows

สำหรับโซนเวลาที่มีการปรับเวลาตามฤดูกาล การแปลงจะพิจารณา Coordinated Universal Time ออฟเซ็ตการปรับเวลาตามฤดูกาล ข้อมูลที่พร้อมใช้งานล่าสุดเกี่ยวกับออฟเซ็ตนี้จะใช้ในระหว่างการแปลง

## <a name="example-1"></a>ตัวอย่างที่ 1

ในตัวอย่างนี้ มีการใช้ชื่อโซนเวลาของ Windows

คุณกำหนดค่าแหล่งข้อมูล **DSX** ของชนิดของ **ฟิลด์ที่คำนวณได้** ซึ่งประกอบด้วยนิพจน์ต่อไปนี้

```vb
CONCATENATE(
    DATETIMEFORMAT( DSY, "O"), 
    " -> ", 
    DATETIMEFORMAT( CHANGETIMEZONE(DSY, "E. Europe Standard Time", "Hawaiian Standard Time"), "O")
)
```

ถ้าคุณตั้งค่าคอนฟิกนิพจน์ของแหล่งข้อมูล **DSY** ของชนิด **ฟิลด์ที่คํานวณได้** เป็น `DATETIMEVALUE ("01-Jun-2021 12:55:00", "dd-MMM-yyyy HH:mm:ss", "EN")` แหล่งข้อมูล **DSX** จะส่งคืนข้อความ **2021-06-01T12:55:00.0000000+00:00 -> 2021-05-31T23:55:00.0000000+00:00** ข้อความนี้แสดงว่าความแตกต่างของเวลาระหว่างโซนเวลาสองโซน ที่ให้ไว้ในวันที่ 1 มิถุนายน มากกว่า 24 ชั่วโมง ดังนั้น ค่าวันที่/เวลาที่แปลงแล้วคือก่อนหน้าค่าวันที่/เวลาที่ระบุหนึ่งวัน เนื่องจากโซนเวลาพื้นฐานอยู่ก่อนโซนเวลาเป้าหมาย

ถ้าคุณตั้งค่าคอนฟิกนิพจน์ของแหล่งข้อมูล **DSY** ของชนิด **ฟิลด์ที่คํานวณได้** เป็น `DATETIMEVALUE ("01-Dec-2021 12:55:00", "dd-MMM-yyyy HH:mm:ss", "EN")` แหล่งข้อมูล **DSX** จะส่งคืนข้อความ **2021-12-01T12:55:00.0000000+00:00 -> 2021-12-01T00:55:00.0000000+00:00** ข้อความนี้แสดงว่าความแตกต่างของเวลาระหว่างโซนเวลาสองโซน ที่ให้ไว้ในวันที่ 1 ธันวาคม น้อยกว่า 24 ชั่วโมง ดังนั้น ค่าวันที่/เวลาที่แปลงจะเท่ากับค่าวันที่/เวลาที่ระบุ

> [!NOTE]
> นิพจน์เดียวกันจะส่งคืนผลต่างที่แตกต่างกันระหว่างค่าวันที่/เวลาที่ให้ไว้ และที่แปลงค่าไว้ของโซนเวลาคู่เดียวกัน เนื่องจากออฟเซ็ตเวลาการปรับเวลาตามฤดูกาลที่ประสานงานแตกต่างจากเขตเวลาที่ระบุในวันที่/เวลาที่ระบุ

## <a name="example-2"></a>ตัวอย่างที่ 2

ในตัวอย่างนี้ มีการใช้ชื่อโซนเวลาของ IANA

คุณกำหนดค่าแหล่งข้อมูล **DSX** ของชนิดของ **ฟิลด์ที่คำนวณได้** ซึ่งประกอบด้วยนิพจน์ต่อไปนี้

```vb
CONCATENATE(
    DATETIMEFORMAT( DSY, "O"), 
    " -> ", 
    DATETIMEFORMAT( CHANGETIMEZONE(DSY, "Europe/Athens", "US/Hawaii"), "O")
)
```

ถ้าคุณตั้งค่าคอนฟิกนิพจน์ของแหล่งข้อมูล **DSY** ของชนิด **ฟิลด์ที่คํานวณได้** เป็น `DATETIMEVALUE ("01-Jun-2021 12:55:00", "dd-MMM-yyyy HH:mm:ss", "EN")` แหล่งข้อมูล **DSX** จะส่งคืนข้อความ **2021-06-01T12:55:00.0000000+00:00 -> 2021-05-31T23:55:00.0000000+00:00** ข้อความนี้แสดงว่าความแตกต่างของเวลาระหว่างโซนเวลาสองโซน ที่ให้ไว้ในวันที่ 1 มิถุนายน มากกว่า 24 ชั่วโมง ดังนั้น ค่าวันที่/เวลาที่แปลงแล้วคือก่อนหน้าค่าวันที่/เวลาที่ระบุหนึ่งวัน เนื่องจากโซนเวลาพื้นฐานอยู่ก่อนโซนเวลาเป้าหมาย

ถ้าคุณตั้งค่าคอนฟิกนิพจน์ของแหล่งข้อมูล **DSY** ของชนิด **ฟิลด์ที่คํานวณได้** เป็น `DATETIMEVALUE ("01-Dec-2021 12:55:00", "dd-MMM-yyyy HH:mm:ss", "EN")` แหล่งข้อมูล **DSX** จะส่งคืนข้อความ **2021-12-01T12:55:00.0000000+00:00 -> 2021-12-01T00:55:00.0000000+00:00** ข้อความนี้แสดงว่าความแตกต่างของเวลาระหว่างโซนเวลาสองโซน ที่ให้ไว้ในวันที่ 1 ธันวาคม น้อยกว่า 24 ชั่วโมง ดังนั้น ค่าวันที่/เวลาที่แปลงจะเท่ากับค่าวันที่/เวลาที่ระบุ

## <a name="example-3"></a>ตัวอย่างที่ 3

คุณกำหนดค่าแหล่งข้อมูล **DSX** ของชนิดของ **ฟิลด์ที่คำนวณได้** ซึ่งประกอบด้วยนิพจน์ต่อไปนี้

```vb
CONCATENATE(
    DATETIMEFORMAT( DSY, "O"), 
    " -> ", 
    DATETIMEFORMAT( CHANGETIMEZONE(DSY, "US/Hawaii", "Europe/Athens"), "O")
)
```

ถ้าคุณตั้งค่าคอนฟิกนิพจน์ของแหล่งข้อมูล **DSY** ของชนิด **ฟิลด์ที่คํานวณได้** เป็น `DATETIMEVALUE ("01-Jun-2021 12:55:00", "dd-MMM-yyyy HH:mm:ss", "EN")` แหล่งข้อมูล **DSX** จะส่งคืนข้อความ **2021-06-01T12:55:00.0000000+00:00 -> 2021-06-02T01:55:00.0000000+00:00'** ข้อความนี้แสดงว่าความแตกต่างของเวลาระหว่างโซนเวลาสองโซน ที่ให้ไว้ในวันที่ 1 มิถุนายน มากกว่า 24 ชั่วโมง ดังนั้น ค่าวันที่/เวลาที่แปลงแล้วคือหลังค่าวันที่/เวลาที่ระบุหนึ่งวัน เนื่องจากโซนเวลาเป้าหมายอยู่ก่อนโซนเวลาพื้นฐาน

## <a name="example-4"></a>ตัวอย่างที่ 4

คุณอาจได้รับการลงวันที่/เวลาจากแหล่งข้อมูลภายนอก เป็นข้อความที่ไม่มีข้อมูลโซนเวลา อย่างไรก็ตาม คุณอาจทราบโซนเวลาที่แหล่งข้อมูลดําเนินงานอยู่ ตัวอย่างเช่น คุณได้รับการลงวันที่/เวลา **01/12/2021 12:55:00** จากบริการที่ดําเนินการในประเทศสเปน เมื่อต้องการบันทึกค่าวันที่/เวลานี้ลงในฐานข้อมูลอย่างถูกต้อง ให้แปลงดังต่อไปนี้:

- ตั้งค่าคอนฟิกแหล่งข้อมูล **DSY** ของชนิด **ฟิลด์ที่คํานวณได้** เพื่อแปลงการลงวันที่/เวลาจากข้อความ เป็นค่าวันที่/เวลาของ Coordinated Universal Time

    `DATETIMEVALUE ("01/12/2021 12:55:00", "dd/MM/yyyy HH:mm:ss", "ES")`

- ตั้งค่าคอนฟิกแหล่งข้อมูล **DSX** ของชนิด **ฟิลด์ที่คํานวณได้** เพื่อเลื่อนค่าวันที่/เวลาที่แปลงไปเป็น Coordinated Universal Time เป็นค่าวันที่/เวลาของโซนเวลาของแหล่งข้อมูลภายนอก

    `CHANGETIMEZONE(DSY, "Romance Standard Time", "GMT Standard Time")`

> [!NOTE]
> เมื่อคุณใช้ฟังก์ชัน `CHANGETIMEZONE` ในการแปลงวันที่/เวลา โปรดทราบว่าค่าวันที่/เวลาใดๆ จะจัดเก็บอยู่ในฐานข้อมูล เป็นค่าในโซนเวลา Coordinated Universal Time ก่อนที่ค่านี้จะสามารถแสดงบนหน้าแอพลิเคชันได้ จะต้องแปลง การแปลงจะพิจารณาโซนเวลาที่ [ตั้งค่า](../../fin-ops/organization-administration/tasks/set-users-preferred-time-zone.md) เป็นโซนที่ต้องการของผู้ใช้แอพลิเคชันที่ลงชื่อเข้าใช้ในปัจจุบัน

## <a name="additional-resources"></a>ทรัพยากรเพิ่มเติม

[ฟังก์ชันวันที่และเวลา](er-functions-category-datetime.md)

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
