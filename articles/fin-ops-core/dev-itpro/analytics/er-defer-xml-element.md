---
title: เลื่อนการดำเนินการขององค์ประกอบ XML ในรูปแบบ ER
description: หัวข้อนี้จะอธิบายวิธีการเลื่อนการดำเนินการขององค์ประกอบ XML ในรูปแบบการรายงานทางอิเล็กทรอนิกส์ (ER)
author: NickSelin
ms.date: 03/17/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: EROperationDesigner
audience: Application User, IT Pro
ms.reviewer: kfend
ms.custom: 58771
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: AX 10.0.9
ms.openlocfilehash: 84c8c782b917850267c34696f3b2afa607118d84
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 03/31/2021
ms.locfileid: "5753635"
---
# <a name="defer-the-execution-of-xml-elements-in-er-formats"></a><span data-ttu-id="79b02-103">เลื่อนการดำเนินการขององค์ประกอบ XML ในรูปแบบ ER</span><span class="sxs-lookup"><span data-stu-id="79b02-103">Defer the execution of XML elements in ER formats</span></span>

[!include [banner](../includes/banner.md)]

## <a name="overview"></a><span data-ttu-id="79b02-104">ภาพรวม</span><span class="sxs-lookup"><span data-stu-id="79b02-104">Overview</span></span>

<span data-ttu-id="79b02-105">คุณสามารถใช้ผู้ออกแบบการดำเนินการของ [กรอบงานการรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md) เพื่อ [กำหนดค่า](./tasks/er-format-configuration-2016-11.md) [ส่วนประกอบรูปแบบ](general-electronic-reporting.md#FormatComponentOutbound) ของโซลูชัน ER ซึ่งใช้ในการสร้างเอกสารขาออกในรูปแบบ XML</span><span class="sxs-lookup"><span data-stu-id="79b02-105">You can use the Operations designer of the [Electronic reporting (ER)](general-electronic-reporting.md) framework to [configure](./tasks/er-format-configuration-2016-11.md) the [format component](general-electronic-reporting.md#FormatComponentOutbound) of an ER solution that is used to generate outbound documents in XML format.</span></span> <span data-ttu-id="79b02-106">โครงสร้างลำดับชั้นของส่วนประกอบรูปแบบที่ตั้งค่าคอนฟิกประกอบด้วยองค์ประกอบรูปแบบของชนิดต่างๆ</span><span class="sxs-lookup"><span data-stu-id="79b02-106">The hierarchical structure of the configured format component consists of format elements of various types.</span></span> <span data-ttu-id="79b02-107">องค์ประกอบรูปแบบเหล่านี้ใช้ในการกรอกเอกสารที่สร้างขึ้นโดยมีข้อมูลที่จำเป็นในขณะใช้งานจริง</span><span class="sxs-lookup"><span data-stu-id="79b02-107">These format elements are used to fill generated documents with the required information at runtime.</span></span> <span data-ttu-id="79b02-108">โดยค่าเริ่มต้น เมื่อคุณรันรูปแบบ ER จะมีการรันใช้องค์ประกอบรูปแบบในลำดับเดียวกับที่แสดงในลำดับชั้นรูปแบบ: ทีละรายการจากบนลงล่าง</span><span class="sxs-lookup"><span data-stu-id="79b02-108">By default, when you run an ER format, the format elements are run in the same order as they are presented in the format hierarchy: one by one, from top to bottom.</span></span> <span data-ttu-id="79b02-109">อย่างไรก็ตาม คุณสามารถเปลี่ยนลำดับการดำเนินการสำหรับองค์ประกอบลำดับ XML ใดๆ ของส่วนประกอบรูปแบบที่กำหนดค่าคอนฟิกแล้วได้</span><span class="sxs-lookup"><span data-stu-id="79b02-109">However, at design time, you can change the execution order for any XML elements of the configured format component.</span></span>

<span data-ttu-id="79b02-110">เมื่อเปิดใช้งานตัวเลือก <a name="DeferredXmlElementExecution"></a>**การดำเนินการที่เลื่อน** สำหรับองค์ประกอบ XML ในรูปแบบที่กำหนดไว้ คุณจะสามารถเลื่อน (เลื่อนออกไป) การดำเนินการขององค์ประกอบนั้นได้</span><span class="sxs-lookup"><span data-stu-id="79b02-110">By turning on the <a name="DeferredXmlElementExecution"></a>**Deferred execution** option for an XML element in the configured format, you can defer (postpone) the execution of that element.</span></span> <span data-ttu-id="79b02-111">ในกรณีนี้องค์ประกอบจะไม่รันจนกว่าจะมีการรันองค์ประกอบอื่นๆ ทั้งหมดของข้อมูลหลัก</span><span class="sxs-lookup"><span data-stu-id="79b02-111">In this case, the element isn't run until all other elements of its parent have been run.</span></span>

<span data-ttu-id="79b02-112">เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับคุณลักษณะนี้ ให้ดำเนินการตัวอย่างในหัวข้อนี้ให้เสร็จสมบูรณ์</span><span class="sxs-lookup"><span data-stu-id="79b02-112">To learn more about this feature, complete the example in this topic.</span></span>

## <a name="limitations"></a><span data-ttu-id="79b02-113">การจำกัด</span><span class="sxs-lookup"><span data-stu-id="79b02-113">Limitations</span></span>

<span data-ttu-id="79b02-114">ตัวเลือก **การดำเนินการที่เลื่อน** ได้รับการสนับสนุนเฉพาะสำหรับองค์ประกอบ XML ที่มีการตั้งค่าคอนฟิกสำหรับรูปแบบ ER ซึ่งใช้ในการสร้างเอกสาร **ขาออก** ในรูปแบบ XML</span><span class="sxs-lookup"><span data-stu-id="79b02-114">The **Deferred execution** option is supported only for XML elements that are configured for an ER format that is used to generate **outbound** documents in XML format.</span></span>

<span data-ttu-id="79b02-115">ตัวเลือก **การดำเนินการที่เลื่อน** ได้รับการสนับสนุนเฉพาะสำหรับองค์ประกอบ XML ที่อยู่ในองค์ประกอบ XML อื่นๆ เพียงหนึ่งองค์ประกอบเท่านั้น</span><span class="sxs-lookup"><span data-stu-id="79b02-115">The **Deferred execution** option is supported only for XML elements that reside in only one other XML element.</span></span> <span data-ttu-id="79b02-116">ดังนั้นจึงไม่สามารถใช้กับองค์ประกอบ XML ที่อยู่ในชนิดขององค์ประกอบรูปแบบอื่นๆ (ตัวอย่างเช่น องค์ประกอบ **ลำดับ XML**)</span><span class="sxs-lookup"><span data-stu-id="79b02-116">Therefore, it isn't applicable to XML elements that reside in other types of format elements (for example, in an **XML sequence** element).</span></span>

<span data-ttu-id="79b02-117">ตัวเลือก **การดำเนินการที่เลื่อน** ไม่ได้รับการสนับสนุนสำหรับองค์ประกอบ XML ที่อยู่ในองค์ประกอบรูปแบบ **ทั่วไป\\ไฟล์** เมื่อตัวเลือก **แบ่งไฟล์** ถูกตั้งค่าเป็น **ใช่**</span><span class="sxs-lookup"><span data-stu-id="79b02-117">The **Deferred execution** option isn't supported for XML elements that reside in the **Common\\File** format element when the **Split file** option is set to **Yes**.</span></span> <span data-ttu-id="79b02-118">สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการแบ่งไฟล์ XML ให้ดูที่ [แบ่งไฟล์ XML ที่สร้างตามขนาดไฟล์และปริมาณเนื้อหา](er-split-files.md)</span><span class="sxs-lookup"><span data-stu-id="79b02-118">For more information about how to split XML files, see [Split generated XML files based on file size and content quantity](er-split-files.md).</span></span>

## <a name="example-defer-the-execution-of-an-xml-element-in-an-er-format"></a><a name="Example"></a><span data-ttu-id="79b02-119">ตัวอย่าง: เลื่อนการดำเนินการขององค์ประกอบ XML ในรูปแบบ ER</span><span class="sxs-lookup"><span data-stu-id="79b02-119">Example: Defer the execution of an XML element in an ER format</span></span>

<span data-ttu-id="79b02-120">ขั้นตอนต่อไปนี้อธิบายวิธีการที่ผู้ใช้ในผู้ดูแลระบบหรือที่ปรึกษาด้านการทำงานของการรายงานทางอิเล็กทรอนิกส์ [บทบาท](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/sysadmin/tasks/assign-users-security-roles) สามารถตั้งค่าคอนฟิกรูปแบบ ER ที่มีองค์ประกอบ XML ซึ่งลำดับการดำเนินการแตกต่างจากใบสั่งในลำดับชั้นของรูปแบบ</span><span class="sxs-lookup"><span data-stu-id="79b02-120">The following steps explain how a user in the System administrator or Electronic reporting functional consultant [role](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/sysadmin/tasks/assign-users-security-roles) can configure an ER format that contains an XML element where the order of execution differs from the order in the format hierarchy.</span></span>

<span data-ttu-id="79b02-121">ขั้นตอนเหล่านี้สามารถถูกดำเนินการได้ในบริษัท **USMF** ใน Microsoft Dynamics 365 Finance</span><span class="sxs-lookup"><span data-stu-id="79b02-121">These steps can be performed in the **USMF** company in Microsoft Dynamics 365 Finance.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="79b02-122">ข้อกำหนดเบื้องต้น</span><span class="sxs-lookup"><span data-stu-id="79b02-122">Prerequisites</span></span>

<span data-ttu-id="79b02-123">เมื่อต้องการทำให้ตัวอย่างนี้เสร็จสมบูรณ์ คุณต้องเข้าถึงบริษัท **USMF** ในการเงินสำหรับหนึ่งในบทบาทต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="79b02-123">To complete this example, you must have access to the **USMF** company in Finance for one of the following roles:</span></span>

- <span data-ttu-id="79b02-124">ที่ปรึกษาด้านการทำงานของการรายงานทางอิเล็กทรอนิกส์</span><span class="sxs-lookup"><span data-stu-id="79b02-124">Electronic reporting functional consultant</span></span>
- <span data-ttu-id="79b02-125">ผู้ดูแลระบบ</span><span class="sxs-lookup"><span data-stu-id="79b02-125">System administrator</span></span>

<span data-ttu-id="79b02-126">ถ้าคุณยังไม่ได้ทำให้ตัวอย่างเสร็จสมบูรณ์ในหัวข้อ [การเลื่อนการดำเนินการขององค์ประกอบลำดับในรูปแบบ ER](er-defer-sequence-element.md#Example) ให้ดาวน์โหลด [การกำหนดค่าคอนฟิก](general-electronic-reporting.md#Configuration) ต่อไปนี้ของโซลูชัน ER ตัวอย่าง</span><span class="sxs-lookup"><span data-stu-id="79b02-126">If you haven't yet completed the example in the [Defer the execution of sequence elements in ER formats](er-defer-sequence-element.md#Example) topic, download the following [configurations](general-electronic-reporting.md#Configuration) of the sample ER solution.</span></span>

| <span data-ttu-id="79b02-127">คำอธิบายเนื้อหา</span><span class="sxs-lookup"><span data-stu-id="79b02-127">Content description</span></span>            | <span data-ttu-id="79b02-128">ชื่อไฟล์</span><span class="sxs-lookup"><span data-stu-id="79b02-128">File name</span></span> |
|--------------------------------|-----------|
| <span data-ttu-id="79b02-129">การตั้งค่าคอนฟิกแบบจำลองข้อมูล ER</span><span class="sxs-lookup"><span data-stu-id="79b02-129">ER data model configuration</span></span>    | [<span data-ttu-id="79b02-130">แบบจำลองเพื่อเรียนรู้องค์ประกอบที่เลื่อน.เวอร์ชั่น.1.xml</span><span class="sxs-lookup"><span data-stu-id="79b02-130">Model to learn deferred elements.version.1.xml</span></span>](https://mbs.microsoft.com/customersource/Global/AX/downloads/hot-fixes/365optelecrepeg) |
| <span data-ttu-id="79b02-131">การตั้งค่าคอนฟิกการแม็ปแบบจำลอง ER</span><span class="sxs-lookup"><span data-stu-id="79b02-131">ER model mapping configuration</span></span> | [<span data-ttu-id="79b02-132">การแม็ปเพื่อเรียนรู้องค์ประกอบที่เลื่อน.เวอร์ชั่น.1.1.xml</span><span class="sxs-lookup"><span data-stu-id="79b02-132">Mapping to learn deferred elements.version.1.1.xml</span></span>](https://mbs.microsoft.com/customersource/Global/AX/downloads/hot-fixes/365optelecrepeg) |

<span data-ttu-id="79b02-133">ก่อนที่คุณจะเริ่มต้น คุณต้องดาวน์โหลดและบันทึกการตั้งค่าคอนฟิกต่อไปนี้ของโซลูชัน ER ตัวอย่างไปยังเครื่องคอมพิวเตอร์เฉพาะที่ของคุณ</span><span class="sxs-lookup"><span data-stu-id="79b02-133">Before you begin, you must also download and save the following configuration of the sample ER solution to your local computer.</span></span>

| <span data-ttu-id="79b02-134">คำอธิบายเนื้อหา</span><span class="sxs-lookup"><span data-stu-id="79b02-134">Content description</span></span>     | <span data-ttu-id="79b02-135">ชื่อไฟล์</span><span class="sxs-lookup"><span data-stu-id="79b02-135">File name</span></span> |
|-------------------------|-----------|
| <span data-ttu-id="79b02-136">การตั้งค่าคอนฟิกรูปแบบ ER</span><span class="sxs-lookup"><span data-stu-id="79b02-136">ER format configuration</span></span> | [<span data-ttu-id="79b02-137">จัดรูปแบบเพื่อเรียนรู้องค์ประกอบ XML ที่เลื่อน.เวอร์ชั่น.1.1.xml</span><span class="sxs-lookup"><span data-stu-id="79b02-137">Format to learn deferred XML elements.version.1.1.xml</span></span>](https://mbs.microsoft.com/customersource/Global/AX/downloads/hot-fixes/365optelecrepeg) |

### <a name="import-the-sample-er-configurations"></a><span data-ttu-id="79b02-138">นำเข้าการกำหนดค่า ER ตัวอย่าง</span><span class="sxs-lookup"><span data-stu-id="79b02-138">Import the sample ER configurations</span></span>

1. <span data-ttu-id="79b02-139">ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**</span><span class="sxs-lookup"><span data-stu-id="79b02-139">Go to **Organization administration** \> **Workspaces** \> **Electronic reporting**.</span></span>
2. <span data-ttu-id="79b02-140">เลือก **การตั้งค่าคอนฟิกการรายงาน**</span><span class="sxs-lookup"><span data-stu-id="79b02-140">Select **Reporting configurations**.</span></span>
3. <span data-ttu-id="79b02-141">ในหน้า **การตั้งค่าคอนฟิก** ถ้าการตั้งค่าคอนฟิก **แบบจำลองเพื่อการเรียนรู้องค์ประกอบที่เลื่อน** ไม่พร้อมใช้งานในแผนภูมิการตั้งค่าคอนฟิก ให้นำเข้าการตั้งค่าคอนฟิกแบบจำลองข้อมูล ER</span><span class="sxs-lookup"><span data-stu-id="79b02-141">On the **Configurations** page, if the **Model to learn deferred elements** configuration isn't available in the configuration tree, import the ER data model configuration:</span></span>

    1. <span data-ttu-id="79b02-142">เลือก **แลกเปลี่ยน** แล้วเลือก **โหลดจากไฟล์ XML**</span><span class="sxs-lookup"><span data-stu-id="79b02-142">Select **Exchange**, and then select **Load from XML file**.</span></span>
    2. <span data-ttu-id="79b02-143">เลือก **เรียกดู** ค้นหาและเลือกไฟล์ **แบบจำลองเพื่อเรียนรู้องค์ประกอบที่เลื่อน.1.xml** แล้วเลือก **ตกลง**</span><span class="sxs-lookup"><span data-stu-id="79b02-143">Select **Browse**, find and select the **Model to learn deferred elements.1.xml** file, and then select **OK**.</span></span>

4. <span data-ttu-id="79b02-144">หากการตั้งค่าคอนฟิก **การแม็ปเพื่อเรียนรู้องค์ประกอบที่เลื่อน** ไม่พร้อมใช้งานในแผนภูมิการตั้งค่าคอนฟิก ให้นำเข้าการตั้งค่าคอนฟิกการแม็ปแบบจำลอง ER</span><span class="sxs-lookup"><span data-stu-id="79b02-144">If the **Mapping to learn deferred elements** configuration isn't available in the configuration tree, import the ER model mapping configuration:</span></span>

    1. <span data-ttu-id="79b02-145">เลือก **แลกเปลี่ยน** แล้วเลือก **โหลดจากไฟล์ XML**</span><span class="sxs-lookup"><span data-stu-id="79b02-145">Select **Exchange**, and then select **Load from XML file**.</span></span>
    2. <span data-ttu-id="79b02-146">เลือก **เรียกดู** ค้นหาและเลือกไฟล์ **การแม็ปเพื่อเรียนรู้องค์ประกอบที่เลื่อน.1.1.xml** แล้วเลือก **ตกลง**</span><span class="sxs-lookup"><span data-stu-id="79b02-146">Select **Browse**, find and select the **Mapping to learn deferred elements.1.1.xml** file, and then select **OK**.</span></span>

5. <span data-ttu-id="79b02-147">นำเข้าการตั้งค่าคอนฟิกรูปแบบ ER:</span><span class="sxs-lookup"><span data-stu-id="79b02-147">Import the ER format configuration:</span></span>

    1. <span data-ttu-id="79b02-148">เลือก **แลกเปลี่ยน** แล้วเลือก **โหลดจากไฟล์ XML**</span><span class="sxs-lookup"><span data-stu-id="79b02-148">Select **Exchange**, and then select **Load from XML file**.</span></span>
    2. <span data-ttu-id="79b02-149">เลือก **เรียกดู** ค้นหาและเลือกไฟล์ **จัดรูปแบบเพื่อเรียนรู้องค์ประกอบ XML ที่เลื่อน.1.1.xml** แล้วเลือก **ตกลง**</span><span class="sxs-lookup"><span data-stu-id="79b02-149">Select **Browse**, find and select the **Format to learn deferred XML elements.1.1.xml** file, and then select **OK**.</span></span>

6. <span data-ttu-id="79b02-150">ในแผนภูมิการตั้งค่าคอนฟิก ให้ขยาย **แบบจำลองเพื่อเรียนรู้องค์ประกอบที่เลื่อน**</span><span class="sxs-lookup"><span data-stu-id="79b02-150">In the configuration tree, expand **Model to learn deferred elements**.</span></span>
7. <span data-ttu-id="79b02-151">ตรวจทานรายการของการตั้งค่าคอนฟิก ER ที่นำเข้าในแผนภูมิการตั้งค่าคอนฟิก</span><span class="sxs-lookup"><span data-stu-id="79b02-151">Review the list of imported ER configurations in the configuration tree.</span></span>

    ![การตั้งค่าคอนฟิก ER ที่นำเข้าในหน้าการตั้งค่าคอนฟิก](./media/ER-DeferredXml-Configurations.png)

### <a name="activate-a-configuration-provider"></a><span data-ttu-id="79b02-153">เรียกใช้ผู้ให้บริการการกำหนดค่า</span><span class="sxs-lookup"><span data-stu-id="79b02-153">Activate a configuration provider</span></span>

1. <span data-ttu-id="79b02-154">ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**</span><span class="sxs-lookup"><span data-stu-id="79b02-154">Go to **Organization administration** \> **Workspaces** \> **Electronic reporting**.</span></span>
2. <span data-ttu-id="79b02-155">ในหน้า **การกำหนดค่าการแปลเป็นภาษาท้องถิ่น** ในส่วน **ผู้ให้บริการการกำหนดค่า** ตรวจสอบให้แน่ใจว่า [ผู้ให้บริการการกำหนดค่า](general-electronic-reporting.md#Provider) สำหรับบริษัทตัวอย่าง Litware, Inc. (`http://www.litware.com`) ถูกแสดงและมีการทำเครื่องหมายเป็นใช้งานอยู่</span><span class="sxs-lookup"><span data-stu-id="79b02-155">On the **Localization configurations** page, in the **Configuration providers** section, make sure that the [configuration provider](general-electronic-reporting.md#Provider) for the Litware, Inc. (`http://www.litware.com`) sample company is listed, and that it's marked as active.</span></span> <span data-ttu-id="79b02-156">ถ้าผู้ให้บริการการตั้งค่าคอนฟิกนี้ไม่มีอยู่ในรายการหรือถ้าไม่ได้ทำเครื่องหมายเป็นใช้งานอยู่ ให้ทำตามขั้นตอนในหัวข้อ [สร้างผู้ให้บริการการตั้งค่าคอนฟิกและทำเครื่องหมายเป็นใช้งานอยู่](./tasks/er-configuration-provider-mark-it-active-2016-11.md)</span><span class="sxs-lookup"><span data-stu-id="79b02-156">If this configuration provider isn't listed, or if it isn't marked as active, follow the steps in the [Create a configuration provider and mark it as active](./tasks/er-configuration-provider-mark-it-active-2016-11.md) topic.</span></span>

    ![Litware, Inc. บริษัทตัวอย่างในหน้าการตั้งค่าคอนฟิกการแปลเป็นภาษาท้องถิ่น](./media/ER-DeferredXml-ElectronicReportingWorkspace.png)

### <a name="review-the-imported-model-mapping"></a><span data-ttu-id="79b02-158">ตรวจทานการแม็ปแบบจำลองที่นำเข้า</span><span class="sxs-lookup"><span data-stu-id="79b02-158">Review the imported model mapping</span></span>

<span data-ttu-id="79b02-159">ตรวจสอบการตั้งค่าของส่วนประกอบการแม็ปแบบจำลอง ER ที่มีการตั้งค่าคอนฟิกให้เข้าถึงธุรกรรมภาษีและเปิดเผยข้อมูลที่เข้าถึงเมื่อมีการร้องขอ</span><span class="sxs-lookup"><span data-stu-id="79b02-159">Review the settings of the ER model mapping component that is configured to access tax transactions and expose accessed data on request.</span></span>

1. <span data-ttu-id="79b02-160">ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**</span><span class="sxs-lookup"><span data-stu-id="79b02-160">Go to **Organization administration** \> **Workspaces** \> **Electronic reporting**.</span></span>
2. <span data-ttu-id="79b02-161">เลือก **การตั้งค่าคอนฟิกการรายงาน**</span><span class="sxs-lookup"><span data-stu-id="79b02-161">Select **Reporting configurations**.</span></span>
3. <span data-ttu-id="79b02-162">บนหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก ให้ขยาย **แบบจำลองเพื่อเรียนรู้องค์ประกอบที่เลื่อน**</span><span class="sxs-lookup"><span data-stu-id="79b02-162">On the **Configurations** page, in the configuration tree, expand **Model to learn deferred elements**.</span></span>
4. <span data-ttu-id="79b02-163">เลือกการตั้งค่าคอนฟิก **การแม็ปเพื่อเรียนรู้องค์ประกอบที่เลื่อน**</span><span class="sxs-lookup"><span data-stu-id="79b02-163">Select the **Mapping to learn deferred elements** configuration.</span></span>
5. <span data-ttu-id="79b02-164">เลือก **ตัวออกแบบ** เพื่อเปิดรายการของการแม็ป</span><span class="sxs-lookup"><span data-stu-id="79b02-164">Select **Designer** to open the list of mappings.</span></span>
6. <span data-ttu-id="79b02-165">เลือก **ตัวออกแบบ** เพื่อตรวจทานรายละเอียดการแม็ป</span><span class="sxs-lookup"><span data-stu-id="79b02-165">Select **Designer** to review the mapping details.</span></span>
7. <span data-ttu-id="79b02-166">เลือก **แสดงรายละเอียด**</span><span class="sxs-lookup"><span data-stu-id="79b02-166">Select **Show details**.</span></span>
8. <span data-ttu-id="79b02-167">ตรวจทานแหล่งข้อมูลที่มีการตั้งค่าคอนฟิกสำหรับการเข้าถึงธุรกรรมภาษี:</span><span class="sxs-lookup"><span data-stu-id="79b02-167">Review the data sources that are configured to access tax transactions:</span></span>

    - <span data-ttu-id="79b02-168">แหล่งข้อมูล **ธุรกรรม** ของชนิด *เรกคอร์ดตาราง* ถูกตั้งค่าคอนฟิกให้เข้าถึงเรกคอร์ดของตารางแอปพลิเคชัน **TaxTrans**</span><span class="sxs-lookup"><span data-stu-id="79b02-168">The **Transactions** data source of the *Table record* type is configured to access records of the **TaxTrans** application table.</span></span>
    - <span data-ttu-id="79b02-169">แหล่งข้อมูล **ใบสำคัญ** ของชนิด *ฟิลด์ที่คำนวณได้* ถูกตั้งค่าคอนฟิกให้ส่งคืนรหัสใบสำคัญที่จำเป็น (**INV-10000349** และ **INV-10000350**) เป็นรายการของเรกคอร์ด</span><span class="sxs-lookup"><span data-stu-id="79b02-169">The **Vouchers** data source of the *Calculated field* type is configured to return the required voucher codes (**INV-10000349** and **INV-10000350**) as a list of records.</span></span>
    - <span data-ttu-id="79b02-170">แหล่งข้อมูล **ที่ถูกกรอง** ของชนิด *ฟิลด์ที่คำนวณได้* ถูกตั้งค่าคอนฟิกให้เลือก จากแหล่งข้อมูล **ธุรกรรม** เฉพาะธุรกรรมภาษีของใบสำคัญที่จำเป็นเท่านั้น</span><span class="sxs-lookup"><span data-stu-id="79b02-170">The **Filtered** data source of the *Calculated field* type is configured to select, from the **Transactions** data source, only tax transactions of the required vouchers.</span></span>
    - <span data-ttu-id="79b02-171">ฟิลด์ **\$TaxAmount** ของชนิด *ฟิลด์ที่คำนวณได้* ถูกเพิ่มสำหรับแหล่งข้อมูล **ที่ถูกกรอง** เพื่อเปิดเผยมูลค่าภาษีที่มีเครื่องหมายตรงข้าม</span><span class="sxs-lookup"><span data-stu-id="79b02-171">The **\$TaxAmount** field of the *Calculated field* type is added for the **Filtered** data source to expose the tax value that has the opposite sign.</span></span>
    - <span data-ttu-id="79b02-172">แหล่งข้อมูล **ที่มีการจัดกลุ่ม** ของชนิด *กลุ่มตามชนิด* ถูกตั้งค่าเพื่อจัดกลุ่มธุรกรรมภาษีที่ถูกกรองของแหล่งข้อมูล **ที่ถูกกรอง**</span><span class="sxs-lookup"><span data-stu-id="79b02-172">The **Grouped** data source of the *Group By* type is configured to group filtered tax transactions of the **Filtered** data source.</span></span>
    - <span data-ttu-id="79b02-173">ฟิลด์การรวม **TotalSum** ของแหล่งข้อมูล **ที่มีการจัดกลุ่ม** ถูกตั้งค่าคอนฟิกเพื่อสรุปค่าของฟิลด์ **\$TaxAmount** ของแหล่งข้อมูล **ที่ถูกกรอง** สำหรับธุรกรรมภาษีที่กรองทั้งหมดของแหล่งข้อมูลนั้น</span><span class="sxs-lookup"><span data-stu-id="79b02-173">The **TotalSum** aggregation field of the **Grouped** data source is configured to summarize values of the **\$TaxAmount** field of the **Filtered** data source for all filtered tax transactions of that data source.</span></span>

        ![ฟิลด์การรวม TotalSum บนหน้าพารามิเตอร์แก้ไข 'GroupBy'](./media/ER-DeferredXml-GroupByParameters.png)

9. <span data-ttu-id="79b02-175">ตรวจสอบวิธีการผูกแหล่งข้อมูลที่ตั้งค่าคอนฟิกกับแบบจำลองข้อมูลและวิธีการที่จะเปิดเผยข้อมูลที่เข้าถึงเพื่อให้มีอยู่ในรูปแบบ ER:</span><span class="sxs-lookup"><span data-stu-id="79b02-175">Review how the configured data sources are bound to the data model, and how they expose accessed data to make it available in an ER format:</span></span>

    - <span data-ttu-id="79b02-176">แหล่งข้อมูล **ที่ถูกกรอง** ถูกผูกไว้กับฟิลด์ **Data.List** ของแบบจำลองข้อมูล</span><span class="sxs-lookup"><span data-stu-id="79b02-176">The **Filtered** data source is bound to the **Data.List** field of the data model.</span></span>
    - <span data-ttu-id="79b02-177">ฟิลด์ **\$TaxAmount** ของแหล่งข้อมูล **ที่ถูกกรอง** ที่ผูกไว้กับฟิลด์ **Data.List.Value** ของแบบจำลองข้อมูล</span><span class="sxs-lookup"><span data-stu-id="79b02-177">The **\$TaxAmount** field of the **Filtered** data source is bound to the **Data.List.Value** field of the data model.</span></span>
    - <span data-ttu-id="79b02-178">ฟิลด์ **TotalSum** ของแหล่งข้อมูล **ที่มีการจัดกลุ่ม** ที่ผูกไว้กับฟิลด์ **Data.Summary.Total** ของแบบจำลองข้อมูล</span><span class="sxs-lookup"><span data-stu-id="79b02-178">The **TotalSum** field of the **Grouped** data source is bound to the **Data.Summary.Total** field of the data model.</span></span>

    ![หน้าตัวออกแบบการแม็ปแบบจำลอง](./media/ER-DeferredXml-ModelMapping.png)

10. <span data-ttu-id="79b02-180">ปิดหน้า **ตัวออกแบบการแม็ปแบบจำลอง** และ **การแม็ปแบบจำลอง**</span><span class="sxs-lookup"><span data-stu-id="79b02-180">Close the **Model mapping designer** and **Model mappings** pages.</span></span>

### <a name="review-the-imported-format"></a><span data-ttu-id="79b02-181">ตรวจทานรูปแบบที่นำเข้า</span><span class="sxs-lookup"><span data-stu-id="79b02-181">Review the imported format</span></span>

1. <span data-ttu-id="79b02-182">ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก ให้เลือกการตั้งค่าคอนฟิก **จัดรูปแบบเพื่อเรียนรู้องค์ประกอบ XML ที่เลื่อน**</span><span class="sxs-lookup"><span data-stu-id="79b02-182">On the **Configurations** page, in the configuration tree, select the **Format to learn deferred XML elements** configuration.</span></span>
2. <span data-ttu-id="79b02-183">เลือก **ตัวออกแบบ** เพื่อตรวจทานรายละเอียดการจัดรูปแบบ</span><span class="sxs-lookup"><span data-stu-id="79b02-183">Select **Designer** to review the format details.</span></span>
3. <span data-ttu-id="79b02-184">เลือก **แสดงรายละเอียด**</span><span class="sxs-lookup"><span data-stu-id="79b02-184">Select **Show details**.</span></span>
4. <span data-ttu-id="79b02-185">ตรวจทานการตั้งค่าส่วนประกอบของรูปแบบ ER ที่มีการตั้งค่าคอนฟิกเพื่อสร้างเอกสารขาออกในรูปแบบ XML ที่มีรายละเอียดของธุรกรรมภาษีดังนี้:</span><span class="sxs-lookup"><span data-stu-id="79b02-185">Review the settings of the ER format components that are configured to generate an outbound document in XML format that includes details of the tax transactions:</span></span>

    - <span data-ttu-id="79b02-186">องค์ประกอบ **รายงาน\\ข้อความ** มีการตั้งค่าคอนฟิกให้กรอกข้อมูลเอกสารขาออกที่มีโหนดเดียวซึ่งรวมองค์ประกอบ XML ที่ซ้อนกัน (**ส่วนหัว** **เรกคอร์ด** และ **สรุป**)</span><span class="sxs-lookup"><span data-stu-id="79b02-186">The **Report\\Message** XML element is configured to fill the outbound document with a single node that includes the nested XML elements (**Header**, **Record**, and **Summary**).</span></span>
    - <span data-ttu-id="79b02-187">องค์ประกอบ XML **รายงาน\\ข้อความ\\หัวข้อ** มีการตั้งค่าคอนฟิกให้กรอกเอกสารขาออกด้วยโหนดส่วนหัวเดียวที่แสดงวันที่และเวลาที่การดำเนินการเริ่มต้น</span><span class="sxs-lookup"><span data-stu-id="79b02-187">The **Report\\Message\\Header** XML element is configured to fill the outbound document with a single header node that shows the date and time when the processing starts.</span></span>
    - <span data-ttu-id="79b02-188">องค์ประกอบ XML **รายงาน\\ข้อความ\\เรกคอร์ด** มีการตั้งค่าคอนฟิกให้กรอกข้อมูลเอกสารขาออกด้วยโหนดเรกคอร์ดเดียวที่แสดงรายละเอียดของธุรกรรมภาษีรายการเดียว</span><span class="sxs-lookup"><span data-stu-id="79b02-188">The **Report \\Message\\Record** XML element is configured to fill the outbound document with a single record node that shows the details of a single tax transaction.</span></span>
    - <span data-ttu-id="79b02-189">องค์ประกอบ XML **รายงาน\\ข้อความ\\สรุป** มีการตั้งค่าคอนฟิกให้เติมข้อมูลเอกสารขาออกด้วยโหนดสรุปเดียวที่มีผลรวมของมูลค่าภาษีจากธุรกรรมภาษีที่ประมวลผล</span><span class="sxs-lookup"><span data-stu-id="79b02-189">The **Report\\Message\\Summary** XML element is configured to fill the outbound document with a single summary node that includes the sum of the tax values from the processed tax transactions.</span></span>

    ![องค์ประกอบ XML ข้อความและองค์ประกอบที่ซ้อนกันบนหน้าตัวออกแบบรูปแบบ](./media/ER-DeferredXml-Format.png)

5. <span data-ttu-id="79b02-191">บนแท็บ **การแม็ป** ให้ตรวจทานรายละเอียดต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="79b02-191">On the **Mapping** tab, review the following details:</span></span>

    - <span data-ttu-id="79b02-192">องค์ประกอบ **รายงาน\\ข้อความ\\หัวข้อ** ไม่จำเป็นต้องผูกกับแหล่งที่มาเพื่อสร้างโหนดเดียวในเอกสารขาออก</span><span class="sxs-lookup"><span data-stu-id="79b02-192">The **Report\\Message\\Header** element doesn't have to be bound to a source to generate a single node in an outbound document.</span></span>
    - <span data-ttu-id="79b02-193">แอททริบิวต์ **ExecutionDateTime** สร้างวันที่และเวลา (รวมถึงมิลลิวินาที) เมื่อมีการเพิ่มโหนดส่วนหัว</span><span class="sxs-lookup"><span data-stu-id="79b02-193">The **ExecutionDateTime** attribute generates the date and time (including milliseconds) when the header node is added.</span></span>
    - <span data-ttu-id="79b02-194">องค์ประกอบ **รายงาน\\ข้อความ\\เรกคอร์ด** ถูกผูกไว้กับรายการ **model.Data.List** เพื่อสร้างโหนดเรกคอร์ดเดียวสำหรับเรกคอร์ดทั้งหมดจากรายการที่ผูกไว้</span><span class="sxs-lookup"><span data-stu-id="79b02-194">The **Report\\Message\\Record** element is bound to the **model.Data.List** list to generate a single record node for every record from the bound list.</span></span>
    - <span data-ttu-id="79b02-195">แอททริบิวต์ **TaxAmount** ถูกผูกไว้กับ **model.Data.List.Value** (ซึ่งแสดงเป็น **\@.Value** ในมุมมองพาธสัมพัทธ์) เพื่อสร้างมูลค่าภาษีของธุรกรรมภาษีปัจจุบัน</span><span class="sxs-lookup"><span data-stu-id="79b02-195">The **TaxAmount** attribute is bound to **model.Data.List.Value** (which is shown as **\@.Value** in the relative path view) to generate the tax value of the current tax transaction.</span></span>
    - <span data-ttu-id="79b02-196">แอททริบิวต์ **RunningTotal** เป็นตัวยึดสำหรับผลรวมการรันของมูลค่าภาษี</span><span class="sxs-lookup"><span data-stu-id="79b02-196">The **RunningTotal** attribute is a placeholder for the running total of the tax values.</span></span> <span data-ttu-id="79b02-197">ในปัจจุบันแอททริบิวต์นี้ไม่มีผลลัพธ์ เนื่องจากไม่ได้ตั้งค่าคอนฟิกการรวมหรือค่าเริ่มต้นไว้</span><span class="sxs-lookup"><span data-stu-id="79b02-197">Currently, this attribute has no output, because neither a binding nor a default value is configured for it.</span></span>
    - <span data-ttu-id="79b02-198">แอททริบิวต์ **ExecutionDateTime** สร้างวันที่และเวลา (รวมถึงมิลลิวินาที) เมื่อมีการประมวลผลธุรกรรมปัจจุบันในรายงานนี้</span><span class="sxs-lookup"><span data-stu-id="79b02-198">The **ExecutionDateTime** attribute generates the date and time (including milliseconds) when the current transaction is processed in this report.</span></span>
    - <span data-ttu-id="79b02-199">องค์ประกอบ **รายงาน\\ข้อความ\\สรุป** ไม่จำเป็นต้องผูกกับแหล่งข้อมูลเพื่อสร้างโหนดเดียวในเอกสารขาออก</span><span class="sxs-lookup"><span data-stu-id="79b02-199">The **Report\\Message\\Summary** element doesn't have to be bound to a data source to generate a single node in an outbound document.</span></span>
    - <span data-ttu-id="79b02-200">แอททริบิวต์ **TotalTaxAmount** ถูกผูกไว้กับ **model.Data.Summary.Total** เพื่อสร้างผลรวมของมูลค่าภาษีของธุรกรรมภาษีที่ประมวลผล</span><span class="sxs-lookup"><span data-stu-id="79b02-200">The **TotalTaxAmount** attribute is bound to **model.Data.Summary.Total** to generate the sum of the tax values of the processed tax transactions.</span></span>
    - <span data-ttu-id="79b02-201">แอททริบิวต์ **ExecutionDateTime** สร้างวันที่และเวลา (รวมถึงมิลลิวินาที) เมื่อมีการเพิ่มโหนดสรุป</span><span class="sxs-lookup"><span data-stu-id="79b02-201">The **ExecutionDateTime** attribute generates the date and time (including milliseconds) when the summary node is added.</span></span>

    ![แท็บการแม็ปบนตัวออกแบบรูปแบบ](./media/ER-DeferredXml-Format2.png)

### <a name="run-the-imported-format"></a><span data-ttu-id="79b02-203">รันรูปแบบที่นำเข้า</span><span class="sxs-lookup"><span data-stu-id="79b02-203">Run the imported format</span></span>

1. <span data-ttu-id="79b02-204">ในหน้า **ตัวออกแบบรูปแบบ** เลือก **รัน**</span><span class="sxs-lookup"><span data-stu-id="79b02-204">On the **Format designer** page, select **Run**.</span></span>
2. <span data-ttu-id="79b02-205">ดาวน์โหลดไฟล์ที่เว็บเบราเซอร์นำเสนอและเปิดสำหรับการตรวจทาน</span><span class="sxs-lookup"><span data-stu-id="79b02-205">Download the file that the web browser offers, and open it for review.</span></span>

    ![ไฟล์ที่ดาวน์โหลด](./media/ER-DeferredXml-Run.png)

<span data-ttu-id="79b02-207">โปรดสังเกตว่าโหนดสรุปแสดงผลรวมของมูลค่าภาษีสำหรับธุรกรรมที่ประมวลผล</span><span class="sxs-lookup"><span data-stu-id="79b02-207">Notice that the summary node presents the sum of the tax values for the processed transactions.</span></span> <span data-ttu-id="79b02-208">เนื่องจากมีการตั้งค่าคอนฟิกรูปแบบให้ใช้ **model.Data.Summary.Total** ที่ผูกไว้เพื่อส่งคืนยอดรวมนี้ ยอดรวมจะถูกคำนวณโดยการเรียกการรวม **TotalSum** ของแหล่งข้อมูล **ที่มีการจัดกลุ่ม** ของชนิด *GroupBy* ที่ใช้ในการแม็ปแบบจำลอง</span><span class="sxs-lookup"><span data-stu-id="79b02-208">Because the format is configured to use the **model.Data.Summary.Total** binding to return this sum, the sum is calculated by calling the **TotalSum** aggregation of the **Grouped** data source of the *GroupBy* type in the model mapping.</span></span> <span data-ttu-id="79b02-209">เมื่อต้องการคำนวณการรวมนี้ การแม็ปแบบจำลองซ้ำธุรกรรมทั้งหมดที่เลือกในแหล่งข้อมูล **ที่ถูกกรองไว้แล้ว**</span><span class="sxs-lookup"><span data-stu-id="79b02-209">To calculate this aggregation, the model mapping iterates over all transactions that have been selected in the **Filtered** data source.</span></span> <span data-ttu-id="79b02-210">โดยการเปรียบเทียบเวลาที่ใช้ในการดำเนินการของโหนดสรุปและโหนดของเรกคอร์ดล่าสุด คุณสามารถกำหนดว่าการคำนวณของผลรวมใช้เวลา 12 มิลลิวินาที (ms)</span><span class="sxs-lookup"><span data-stu-id="79b02-210">By comparing the execution times of the summary node and the last record node, you can determine that calculation of the sum took 12 milliseconds (ms).</span></span> <span data-ttu-id="79b02-211">โดยการเปรียบเทียบเวลาที่ใช้ในการดำเนินการของโหนดแรกโหนดเรกคอร์ดสุดท้าย คุณสามารถกำหนดว่าการสร้างของโหนดเรกคอร์ดทั้งหมดใช้เวลา 9 มิลลิวินาที</span><span class="sxs-lookup"><span data-stu-id="79b02-211">By comparing the execution times of the first and last record nodes, you can determine that generation of all record nodes took 9 ms.</span></span> <span data-ttu-id="79b02-212">ดังนั้น จำเป็นต้องใช้เวลารวมทั้งหมด 21 มิลลิวินาที</span><span class="sxs-lookup"><span data-stu-id="79b02-212">Therefore, a total of 21 ms was required.</span></span>

### <a name="modify-the-format-so-that-the-calculation-is-based-on-generated-output"></a><span data-ttu-id="79b02-213">แก้ไขรูปแบบเพื่อให้การคำนวณเป็นไปตามผลลัพธ์ที่สร้าง</span><span class="sxs-lookup"><span data-stu-id="79b02-213">Modify the format so that the calculation is based on generated output</span></span>

<span data-ttu-id="79b02-214">ถ้าปริมาณของธุรกรรมมีขนาดใหญ่กว่าปริมาณในตัวอย่างปัจจุบัน เวลาการคำนวณอาจเพิ่มขึ้นและทำให้เกิดปัญหาประสิทธิภาพการทำงาน</span><span class="sxs-lookup"><span data-stu-id="79b02-214">If the volume of transaction is much larger than the volume in the current example, the calculation time might increase and cause performance issues.</span></span> <span data-ttu-id="79b02-215">ด้วยการเปลี่ยนแปลงการตั้งค่าของรูปแบบ คุณสามารถช่วยป้องกันปัญหาประสิทธิภาพการทำงานเหล่านี้ได้</span><span class="sxs-lookup"><span data-stu-id="79b02-215">By changing the setting of the format, you can help prevent these performance issues.</span></span> <span data-ttu-id="79b02-216">เนื่องจากคุณเข้าถึงมูลค่าภาษีเพื่อรวมไว้ในรายงานที่สร้างขึ้น คุณสามารถนำข้อมูลนี้มาใช้อีกครั้งในการคำนวณมูลค่าภาษีได้</span><span class="sxs-lookup"><span data-stu-id="79b02-216">Because you access tax values to include them in the generated report, you can reuse this information to calculate tax values.</span></span> <span data-ttu-id="79b02-217">สำหรับข้อมูลเพิ่มเติม ให้ดูที่ [ตั้งค่าคอนฟิกรูปแบบที่จะทำการตรวจนับและการรวม](./tasks/er-format-counting-summing-1.md)</span><span class="sxs-lookup"><span data-stu-id="79b02-217">For more information, see [Configure format to do counting and summing](./tasks/er-format-counting-summing-1.md).</span></span>

1. <span data-ttu-id="79b02-218">บนหน้า **ตัวออกแบบรูปแบบ** บนแท็บ **รูปแบบ** ให้เลือกองค์ประกอบของไฟล์ **รายงาน** ในแผนภูมิรูปแบบ</span><span class="sxs-lookup"><span data-stu-id="79b02-218">On the **Format designer** page, on the **Format** tab, select the **Report** file element in the format tree.</span></span>
2. <span data-ttu-id="79b02-219">ตั้งค่าตัวเลือก **รวบรวมรายละเอียดผลลัพธ์** เป็น **ใช่**</span><span class="sxs-lookup"><span data-stu-id="79b02-219">Set the **Collect output details** option to **Yes**.</span></span> <span data-ttu-id="79b02-220">ขณะนี้คุณสามารถตั้งค่าคอนฟิกรูปแบบนี้ได้โดยใช้เนื้อหาของรายงานที่สร้างขึ้นเป็นแหล่งข้อมูลที่สามารถเข้าถึงได้โดยใช้ฟังก์ชัน ER ที่มีอยู่แล้วในประเภท [การรวบรวมข้อมูล](er-functions-category-data-collection.md)</span><span class="sxs-lookup"><span data-stu-id="79b02-220">You can now configure this format by using the content of a generated report as a data source that can be accessed by using the built-in ER functions in the [Data collection](er-functions-category-data-collection.md) category.</span></span>
3. <span data-ttu-id="79b02-221">บนแท็บ **การแม็ป** ให้เลือกองค์ประกอบ XML **รายงาน\\ข้อความ\\เรกคอร์ด**</span><span class="sxs-lookup"><span data-stu-id="79b02-221">On the **Mapping** tab, select the **Report\\Message\\Record** XML element.</span></span>
4. <span data-ttu-id="79b02-222">ตั้งค่าคอนฟิกนิพจน์ **ชื่อคีย์ข้อมูลที่รวบรวมไว้** เป็น `WsColumn`</span><span class="sxs-lookup"><span data-stu-id="79b02-222">Configure the **Collected data key name** expression as `WsColumn`.</span></span>
5. <span data-ttu-id="79b02-223">ตั้งค่าคอนฟิกนิพจน์ **ค่าคีย์ข้อมูลที่รวบรวมไว้** เป็น `WsRow`</span><span class="sxs-lookup"><span data-stu-id="79b02-223">Configure the **Collected data key value** expression as `WsRow`.</span></span>

    ![องค์ประกอบ XML เรกคอร์ดบนหน้าตัวออกแบบรูปแบบ](./media/ER-DeferredXml-Format3.png)

6. <span data-ttu-id="79b02-225">เลือกแอททริบิวต์ **รายงาน\\ข้อความ\\เรกคอร์ด\\TaxAmount**</span><span class="sxs-lookup"><span data-stu-id="79b02-225">Select the **Report\\Message\\Record\\TaxAmount** attribute.</span></span>
7. <span data-ttu-id="79b02-226">ตั้งค่าคอนฟิกนิพจน์ **ชื่อคีย์ข้อมูลที่รวบรวมไว้** เป็น `SummingAmountKey`</span><span class="sxs-lookup"><span data-stu-id="79b02-226">Configure the **Collected data key name** expression as `SummingAmountKey`.</span></span>

    ![แอททริบิวต์ TaxAmount บนหน้าตัวออกแบบรูปแบบ](./media/ER-DeferredXml-Format4.png)

    <span data-ttu-id="79b02-228">คุณสามารถพิจารณาการตั้งค่านี้ของการเติมสินค้าของแผ่นงานเสมือน โดยที่ค่าของเซลล์ A1 ถูกผนวกเข้ากับมูลค่าของยอดภาษีจากธุรกรรมภาษีที่ประมวลผลทุกธุรกรรม</span><span class="sxs-lookup"><span data-stu-id="79b02-228">You can consider this setting the fulfillment of a virtual worksheet, where the value of cell A1 is appended with the value of the tax amount from every processed tax transaction.</span></span>

8. <span data-ttu-id="79b02-229">เลือกแอททริบิวต์ **รายงาน\\ข้อความ\\เรกคอร์ด\\RunningTotal** แล้วเลือก **แก้ไขสูตร**</span><span class="sxs-lookup"><span data-stu-id="79b02-229">Select the **Report\\Message\\Record\\RunningTotal** attribute, and then select **Edit formula**.</span></span>
9. <span data-ttu-id="79b02-230">ตั้งค่าคอนฟิกนิพจน์ `SUMIF(SummingAmountKey, WsColumn, WsRow)` โดยใช้ฟังก์ชัน ER [SUMIF](er-functions-datacollection-sumif.md) ที่มีอยู่แล้วในตัว แล้วเลือก **เซฟ**</span><span class="sxs-lookup"><span data-stu-id="79b02-230">Configure the `SUMIF(SummingAmountKey, WsColumn, WsRow)` expression by using the built-in [SUMIF](er-functions-datacollection-sumif.md) ER function, and then select **Save**.</span></span>

    ![นิพจน์ SUMIF](./media/ER-DeferredXml-FormulaDesigner.png)

10. <span data-ttu-id="79b02-232">ปิดหน้า **ตัวออกแบบสูตร**</span><span class="sxs-lookup"><span data-stu-id="79b02-232">Close the **Formula designer** page.</span></span>
11. <span data-ttu-id="79b02-233">เลือก **บันทึก** แล้วจากนั้น เลือก **รัน**</span><span class="sxs-lookup"><span data-stu-id="79b02-233">Select **Save**, and then select **Run**.</span></span>
12. <span data-ttu-id="79b02-234">ดาวน์โหลดแและตรวจทานไฟล์ที่เว็บเบราว์เซอร์นำเสนอ</span><span class="sxs-lookup"><span data-stu-id="79b02-234">Download and review the file that the web browser offers.</span></span>

    ![ไฟล์ที่ดาวน์โหลด](./media/ER-DeferredXml-Run1.png)

    <span data-ttu-id="79b02-236">โหนดเรกคอร์ดสุดท้ายมีการรันผลรวมของมูลค่าภาษีที่คำนวณได้สำหรับธุรกรรมที่ประมวลผลทั้งหมด โดยใช้ผลลัพธ์ที่สร้างขึ้นเป็นแหล่งข้อมูล</span><span class="sxs-lookup"><span data-stu-id="79b02-236">The last record node contains the running total of tax values that is calculated for all processed transactions by using the generated output as a data source.</span></span> <span data-ttu-id="79b02-237">แหล่งข้อมูลนี้เริ่มต้นจากจุดเริ่มต้นของรายงานและดำเนินการต่อไปผ่านทางธุรกรรมภาษีครั้งล่าสุด</span><span class="sxs-lookup"><span data-stu-id="79b02-237">This data source starts from the beginning of the report and continues through the last tax transaction.</span></span> <span data-ttu-id="79b02-238">โหนดสรุปมีผลรวมของมูลค่าภาษีสำหรับธุรกรรมที่ประมวลผลทั้งหมดที่มีการคำนวณในการแม็ปแบบจำลอง โดยใช้แหล่งข้อมูลของชนิด *GroupBy*</span><span class="sxs-lookup"><span data-stu-id="79b02-238">The summary node contains the sum of the tax values for all processed transactions that are calculated in the model mapping by using the data source of the *GroupBy* type.</span></span> <span data-ttu-id="79b02-239">โปรดสังเกตว่าค่าเหล่านี้เท่ากัน</span><span class="sxs-lookup"><span data-stu-id="79b02-239">Notice that these values are equal.</span></span> <span data-ttu-id="79b02-240">ดังนั้นการรวมตามผลลัพธ์สามารถใช้แทนที่ **GroupBy**</span><span class="sxs-lookup"><span data-stu-id="79b02-240">Therefore, the output-based summing can be used instead of **GroupBy**.</span></span> <span data-ttu-id="79b02-241">โดยการเปรียบเทียบเวลาที่ใช้ในการดำเนินการของโหนดเรกคอร์ดแรกและโหนดสรุปสุดท้าย คุณสามารถกำหนดว่าการสร้างของโหนดเรกคอร์ดและการรวมยอดใช้เวลา 11 มิลลิวินาที</span><span class="sxs-lookup"><span data-stu-id="79b02-241">By comparing the execution times of the first record node and the summary node, you can determine that generation of all the record nodes and summing took 11 ms.</span></span> <span data-ttu-id="79b02-242">ดังนั้น หากต้องมีการสร้างรายโหนดเรกคอร์ดและการรวมของมูลค่าภาษีเข้ามาเกี่ยวข้อง รูปแบบที่ถูกปรับเปลี่ยนจะมีความเร็วประมาณสองเท่าของรูปแบบดั้งเดิม</span><span class="sxs-lookup"><span data-stu-id="79b02-242">Therefore, as far as the generation of record nodes and the summing of tax values are concerned, the modified format is approximately two times faster than the original format.</span></span>

13. <span data-ttu-id="79b02-243">เลือกแอททริบิวต์ **รายงาน\\ข้อความ\\สรุป\\TotalTaxAmount** แล้วเลือก **แก้ไขสูตร**</span><span class="sxs-lookup"><span data-stu-id="79b02-243">Select the **Report\\Message\\Summary\\TotalTaxAmount** attribute, and then select **Edit formula**.</span></span>
14. <span data-ttu-id="79b02-244">ป้อนนิพจน์ `SUMIF(SummingAmountKey, WsColumn, WsRow)` แทนนิพจน์ที่มีอยู่</span><span class="sxs-lookup"><span data-stu-id="79b02-244">Enter the `SUMIF(SummingAmountKey, WsColumn, WsRow)` expression instead of the existing expression.</span></span>
15. <span data-ttu-id="79b02-245">เลือก **บันทึก** แล้วจากนั้น เลือก **รัน**</span><span class="sxs-lookup"><span data-stu-id="79b02-245">Select **Save**, and then select **Run**.</span></span>
16. <span data-ttu-id="79b02-246">ดาวน์โหลดแและตรวจทานไฟล์ที่เว็บเบราว์เซอร์นำเสนอ</span><span class="sxs-lookup"><span data-stu-id="79b02-246">Download and review the file that the web browser offers.</span></span>

    ![ไฟล์ที่ดาวน์โหลด](./media/ER-DeferredXml-Run2.png)

    <span data-ttu-id="79b02-248">โปรดสังเกตว่ายอดรวมการรันของมูลค่าภาษีในรายการโหนดเรกคอร์ดล่าสุดตอนนี้เท่ากับผลรวมในโหนดสรุป</span><span class="sxs-lookup"><span data-stu-id="79b02-248">Notice that the running total of tax values in the last record node now equals the sum in the summary node.</span></span>

### <a name="put-values-of-output-based-summing-in-the-report-header"></a><span data-ttu-id="79b02-249">ใส่มูลค่าของการรวมที่ยึดตามผลลัพธ์ในส่วนหัวของรายงาน</span><span class="sxs-lookup"><span data-stu-id="79b02-249">Put values of output-based summing in the report header</span></span>

<span data-ttu-id="79b02-250">ตัวอย่างเช่น ถ้าคุณต้องแสดงผลรวมของมูลค่าภาษีในส่วนหัวของรายงานของคุณ คุณสามารถแก้ไขรูปแบบของคุณได้</span><span class="sxs-lookup"><span data-stu-id="79b02-250">If, for example, you must present the sum of tax values in the header of your report, you can modify your format.</span></span>

1. <span data-ttu-id="79b02-251">บนหน้า **ตัวออกแบบรูปแบบ** บนแท็บ **รูปแบบ** ให้เลือกองค์ประกอบ XML ของ **รายงาน\\ข้อความ\\สรุป**</span><span class="sxs-lookup"><span data-stu-id="79b02-251">On the **Format designer** page, on the **Format** tab, select the **Report\\Message\\Summary** XML element.</span></span>
2. <span data-ttu-id="79b02-252">เลือก **เลื่อนขึ้น**</span><span class="sxs-lookup"><span data-stu-id="79b02-252">Select **Move up**.</span></span>
3. <span data-ttu-id="79b02-253">เลือก **บันทึก** แล้วจากนั้น เลือก **รัน**</span><span class="sxs-lookup"><span data-stu-id="79b02-253">Select **Save**, and then select **Run**.</span></span>
4. <span data-ttu-id="79b02-254">ดาวน์โหลดแและตรวจทานไฟล์ที่เว็บเบราว์เซอร์นำเสนอ</span><span class="sxs-lookup"><span data-stu-id="79b02-254">Download and review the file that the web browser offers.</span></span>

    ![ไฟล์ที่ดาวน์โหลด](./media/ER-DeferredXml-Run3.png)

    <span data-ttu-id="79b02-256">โปรดสังเกตว่าผลรวมของมูลค่าภาษีในโหนดสรุปตอนนี้เท่ากับ 0 (ศูนย์) เนื่องจากมีการคำนวณผลรวมนี้ตามลัพธ์ที่สร้างขึ้นแล้วในขณะนี้</span><span class="sxs-lookup"><span data-stu-id="79b02-256">Notice that the sum of tax values in the summary node now equals 0 (zero), because this sum is now calculated based on the generated output.</span></span> <span data-ttu-id="79b02-257">เมื่อมีการสร้างโหนดเรกคอร์ดแรกขึ้น ผลลัพธ์ที่สร้างขึ้นยังไม่มีโหนดเรกคอร์ดที่มีรายละเอียดธุรกรรม</span><span class="sxs-lookup"><span data-stu-id="79b02-257">When the first record node is generated, the generated output doesn't yet contain record nodes that have transaction details.</span></span> <span data-ttu-id="79b02-258">คุณสามารถตั้งค่าคอนฟิกรูปแบบนี้เพื่อเลื่อนการดำเนินการขององค์ประกอบ **รายงาน\\ข้อความ\\สรุป** จนกว่าจะมีการรันองค์ประกอบ **รายงาน\\ข้อความ\\เรกคอร์ด** สำหรับธุรกรรมภาษีทั้งหมด</span><span class="sxs-lookup"><span data-stu-id="79b02-258">You can configure this format to defer the execution of the **Report\\Message\\Summary** element until the **Report\\Message\\Record** element has been run for all tax transactions.</span></span>

### <a name="defer-the-execution-of-the-summary-xml-element-so-that-the-calculated-total-is-used"></a><span data-ttu-id="79b02-259">เลื่อนการดำเนินการขององค์ประกอบ XML สรุป เพื่อให้สามารถใช้ยอดรวมที่คำนวณได้</span><span class="sxs-lookup"><span data-stu-id="79b02-259">Defer the execution of the summary XML element so that the calculated total is used</span></span>

1. <span data-ttu-id="79b02-260">บนหน้า **ตัวออกแบบรูปแบบ** บนแท็บ **รูปแบบ** ให้เลือกองค์ประกอบ XML ของ **รายงาน\\ข้อความ\\สรุป**</span><span class="sxs-lookup"><span data-stu-id="79b02-260">On the **Format designer** page, on the **Format** tab, select the **Report\\Message\\Summary** XML element.</span></span>
2. <span data-ttu-id="79b02-261">ตั้งค่าตัวเลือก **การดำเนินการที่เลื่อน** เป็น **ใช่**</span><span class="sxs-lookup"><span data-stu-id="79b02-261">Set the **Deferred execution** option to **Yes**.</span></span>

    ![ตัวเลือกการดำเนินการที่เลื่อนขององค์ประกอบ XML สรุปบนหน้าตัวออกแบบรูปแบบ](./media/ER-DeferredXml-Format5.png)

3. <span data-ttu-id="79b02-263">เลือก **บันทึก** แล้วจากนั้น เลือก **รัน**</span><span class="sxs-lookup"><span data-stu-id="79b02-263">Select **Save**, and then select **Run**.</span></span>
4. <span data-ttu-id="79b02-264">ดาวน์โหลดแและตรวจทานไฟล์ที่เว็บเบราว์เซอร์นำเสนอ</span><span class="sxs-lookup"><span data-stu-id="79b02-264">Download and review the file that the web browser offers.</span></span>

    ![ไฟล์ที่ดาวน์โหลด](./media/ER-DeferredXml-Run4.png)

    <span data-ttu-id="79b02-266">ขณะนี้องค์ประกอบ **รายงาน\\ข้อความ\\สรุป** รันหลังจากสินค้าอื่นๆ ทั้งหมดที่ซ้อนกันภายใต้องค์ประกอบหลัก **รายงาน\\ข้อความ** ที่มีการรันแล้วเท่านั้น</span><span class="sxs-lookup"><span data-stu-id="79b02-266">The **Report\\Message\\Summary** element is now run only after all other items that are nested under its parent element, **Report\\Message**, have been run.</span></span> <span data-ttu-id="79b02-267">ดังนั้นจึงรันหลังจากที่องค์ประกอบ **รายงาน\\ข้อความ\\เรกคอร์ด** มีการรันสำหรับธุรกรรมภาษีทั้งหมดของแหล่งข้อมูล **model.Data.List**</span><span class="sxs-lookup"><span data-stu-id="79b02-267">Therefore, it's run after the **Report\\Message\\Record** element has been run for all tax transactions of the **model.Data.List** data source.</span></span> <span data-ttu-id="79b02-268">เวลาที่ใช้ในการดำเนินการของโหนดของเรกคอร์ดแรกและเรกคอร์ดล่าสุด และของส่วนหัวและโหนดสรุป เผยให้เห็นถึงข้อเท็จจริงนี้</span><span class="sxs-lookup"><span data-stu-id="79b02-268">The execution times of the first and last record nodes, and of the header and summary nodes, reveal this fact.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="79b02-269">แหล่งข้อมูลเพิ่มเติม</span><span class="sxs-lookup"><span data-stu-id="79b02-269">Additional resources</span></span>

- [<span data-ttu-id="79b02-270">ตั้งค่าคอนฟิกรูปแบบเพื่อทำการตรวจนับและการรวม</span><span class="sxs-lookup"><span data-stu-id="79b02-270">Configure format to do counting and summing</span></span>](./tasks/er-format-counting-summing-1.md)
- [<span data-ttu-id="79b02-271">การดำเนินการติดตามของรูปแบบ ER เพื่อแก้ไขปัญหาประสิทธิภาพการทำงาน</span><span class="sxs-lookup"><span data-stu-id="79b02-271">Trace execution of ER format to troubleshoot performance issues</span></span>](trace-execution-er-troubleshoot-perf.md)
- [<span data-ttu-id="79b02-272">เลื่อนการดำเนินการขององค์ประกอบลำดับในรูปแบบ ER</span><span class="sxs-lookup"><span data-stu-id="79b02-272">Defer the execution of sequence elements in ER formats</span></span>](er-defer-sequence-element.md#Example)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]