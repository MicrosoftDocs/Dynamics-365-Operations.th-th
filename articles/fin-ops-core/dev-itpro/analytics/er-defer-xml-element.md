---
title: เลื่อนการดำเนินการขององค์ประกอบ XML ในรูปแบบ ER
description: หัวข้อนี้จะอธิบายวิธีการเลื่อนการดำเนินการขององค์ประกอบ XML ในรูปแบบการรายงานทางอิเล็กทรอนิกส์ (ER)
author: NickSelin
ms.date: 04/23/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: EROperationDesigner
audience: Application User, IT Pro
ms.reviewer: kfend
ms.custom: 58771
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: AX 10.0.9
ms.openlocfilehash: 07b1d95572fb0b6bbfd34756bf1ecded7b9ff35c
ms.sourcegitcommit: ab3f5d0da6eb0177bbad720e73c58926d686f168
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 04/26/2021
ms.locfileid: "5944496"
---
# <a name="defer-the-execution-of-xml-elements-in-er-formats"></a>เลื่อนการดำเนินการขององค์ประกอบ XML ในรูปแบบ ER

[!include [banner](../includes/banner.md)]

## <a name="overview"></a>ภาพรวม

คุณสามารถใช้ผู้ออกแบบการดำเนินการของ [กรอบงานการรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md) เพื่อ [กำหนดค่า](./tasks/er-format-configuration-2016-11.md) [ส่วนประกอบรูปแบบ](general-electronic-reporting.md#FormatComponentOutbound) ของโซลูชัน ER ซึ่งใช้ในการสร้างเอกสารขาออกในรูปแบบ XML โครงสร้างลำดับชั้นของส่วนประกอบรูปแบบที่ตั้งค่าคอนฟิกประกอบด้วยองค์ประกอบรูปแบบของชนิดต่างๆ องค์ประกอบรูปแบบเหล่านี้ใช้ในการกรอกเอกสารที่สร้างขึ้นโดยมีข้อมูลที่จำเป็นในขณะใช้งานจริง โดยค่าเริ่มต้น เมื่อคุณรันรูปแบบ ER จะมีการรันใช้องค์ประกอบรูปแบบในลำดับเดียวกับที่แสดงในลำดับชั้นรูปแบบ: ทีละรายการจากบนลงล่าง อย่างไรก็ตาม คุณสามารถเปลี่ยนลำดับการดำเนินการสำหรับองค์ประกอบลำดับ XML ใดๆ ของส่วนประกอบรูปแบบที่กำหนดค่าคอนฟิกแล้วได้

เมื่อเปิดใช้งานตัวเลือก <a name="DeferredXmlElementExecution"></a>**การดำเนินการที่เลื่อน** สำหรับองค์ประกอบ XML ในรูปแบบที่กำหนดไว้ คุณจะสามารถเลื่อน (เลื่อนออกไป) การดำเนินการขององค์ประกอบนั้นได้ ในกรณีนี้องค์ประกอบจะไม่รันจนกว่าจะมีการรันองค์ประกอบอื่นๆ ทั้งหมดของข้อมูลหลัก

เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับคุณลักษณะนี้ ให้ดำเนินการตัวอย่างในหัวข้อนี้ให้เสร็จสมบูรณ์

## <a name="limitations"></a>การจำกัด

ตัวเลือก **การดำเนินการที่เลื่อน** ได้รับการสนับสนุนเฉพาะสำหรับองค์ประกอบ XML ที่มีการตั้งค่าคอนฟิกสำหรับรูปแบบ ER ซึ่งใช้ในการสร้างเอกสาร **ขาออก** ในรูปแบบ XML

ตัวเลือก **การดำเนินการที่เลื่อน** ได้รับการสนับสนุนเฉพาะสำหรับองค์ประกอบ XML ที่อยู่ในองค์ประกอบ XML อื่นๆ เพียงหนึ่งองค์ประกอบเท่านั้น ดังนั้นจึงไม่สามารถใช้กับองค์ประกอบ XML ที่อยู่ในชนิดขององค์ประกอบรูปแบบอื่นๆ (ตัวอย่างเช่น องค์ประกอบ **ลำดับ XML**)

ตัวเลือก **การดำเนินการที่เลื่อน** ไม่ได้รับการสนับสนุนสำหรับองค์ประกอบ XML ที่อยู่ในองค์ประกอบรูปแบบ **ทั่วไป\\ไฟล์** เมื่อตัวเลือก **แบ่งไฟล์** ถูกตั้งค่าเป็น **ใช่** สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการแบ่งไฟล์ XML ให้ดูที่ [แบ่งไฟล์ XML ที่สร้างตามขนาดไฟล์และปริมาณเนื้อหา](er-split-files.md)

## <a name="example-defer-the-execution-of-an-xml-element-in-an-er-format"></a><a name="Example"></a>ตัวอย่าง: เลื่อนการดำเนินการขององค์ประกอบ XML ในรูปแบบ ER

ขั้นตอนต่อไปนี้อธิบายวิธีการที่ผู้ใช้ในผู้ดูแลระบบหรือที่ปรึกษาด้านการทำงานของการรายงานทางอิเล็กทรอนิกส์ [บทบาท](../sysadmin/tasks/assign-users-security-roles.md) สามารถตั้งค่าคอนฟิกรูปแบบ ER ที่มีองค์ประกอบ XML ซึ่งลำดับการดำเนินการแตกต่างจากใบสั่งในลำดับชั้นของรูปแบบ

ขั้นตอนเหล่านี้สามารถถูกดำเนินการได้ในบริษัท **USMF** ใน Microsoft Dynamics 365 Finance

### <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น

เมื่อต้องการทำให้ตัวอย่างนี้เสร็จสมบูรณ์ คุณต้องเข้าถึงบริษัท **USMF** ในการเงินสำหรับหนึ่งในบทบาทต่อไปนี้:

- ที่ปรึกษาด้านการทำงานของการรายงานทางอิเล็กทรอนิกส์
- ผู้ดูแลระบบ

ถ้าคุณยังไม่ได้ทำให้ตัวอย่างเสร็จสมบูรณ์ในหัวข้อ [การเลื่อนการดำเนินการขององค์ประกอบลำดับในรูปแบบ ER](er-defer-sequence-element.md#Example) ให้ดาวน์โหลด [การกำหนดค่าคอนฟิก](general-electronic-reporting.md#Configuration) ต่อไปนี้ของโซลูชัน ER ตัวอย่าง

| คำอธิบายเนื้อหา            | ชื่อไฟล์ |
|--------------------------------|-----------|
| การตั้งค่าคอนฟิกแบบจำลองข้อมูล ER    | [แบบจำลองเพื่อเรียนรู้องค์ประกอบที่เลื่อน.เวอร์ชั่น.1.xml](https://download.microsoft.com/download/7/6/0/760933ca-4ac3-4f50-bc0c-c35e596ee066/Modeltolearndeferredelements.version.1.xml) |
| การตั้งค่าคอนฟิกการแม็ปแบบจำลอง ER | [การแม็ปเพื่อเรียนรู้องค์ประกอบที่เลื่อน.เวอร์ชั่น.1.1.xml](https://download.microsoft.com/download/c/9/c/c9c4b9dd-b700-4385-a087-a84ce9fc1d0f/Mappingtolearndeferredelements.version.1.1.xml) |

ก่อนที่คุณจะเริ่มต้น คุณต้องดาวน์โหลดและบันทึกการตั้งค่าคอนฟิกต่อไปนี้ของโซลูชัน ER ตัวอย่างไปยังเครื่องคอมพิวเตอร์เฉพาะที่ของคุณ

| คำอธิบายเนื้อหา     | ชื่อไฟล์ |
|-------------------------|-----------|
| การตั้งค่าคอนฟิกรูปแบบ ER | [จัดรูปแบบเพื่อเรียนรู้องค์ประกอบ XML ที่เลื่อน.เวอร์ชั่น.1.1.xml](https://download.microsoft.com/download/4/7/8/478fa846-22e9-4fa0-89b1-d3aeae660067/FormattolearndeferredXMLelements.version.1.1.xml) |

### <a name="import-the-sample-er-configurations"></a>นำเข้าการกำหนดค่า ER ตัวอย่าง

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. เลือก **การตั้งค่าคอนฟิกการรายงาน**
3. ในหน้า **การตั้งค่าคอนฟิก** ถ้าการตั้งค่าคอนฟิก **แบบจำลองเพื่อการเรียนรู้องค์ประกอบที่เลื่อน** ไม่พร้อมใช้งานในแผนภูมิการตั้งค่าคอนฟิก ให้นำเข้าการตั้งค่าคอนฟิกแบบจำลองข้อมูล ER

    1. เลือก **แลกเปลี่ยน** แล้วเลือก **โหลดจากไฟล์ XML**
    2. เลือก **เรียกดู** ค้นหาและเลือกไฟล์ **แบบจำลองเพื่อเรียนรู้องค์ประกอบที่เลื่อน.1.xml** แล้วเลือก **ตกลง**

4. หากการตั้งค่าคอนฟิก **การแม็ปเพื่อเรียนรู้องค์ประกอบที่เลื่อน** ไม่พร้อมใช้งานในแผนภูมิการตั้งค่าคอนฟิก ให้นำเข้าการตั้งค่าคอนฟิกการแม็ปแบบจำลอง ER

    1. เลือก **แลกเปลี่ยน** แล้วเลือก **โหลดจากไฟล์ XML**
    2. เลือก **เรียกดู** ค้นหาและเลือกไฟล์ **การแม็ปเพื่อเรียนรู้องค์ประกอบที่เลื่อน.1.1.xml** แล้วเลือก **ตกลง**

5. นำเข้าการตั้งค่าคอนฟิกรูปแบบ ER:

    1. เลือก **แลกเปลี่ยน** แล้วเลือก **โหลดจากไฟล์ XML**
    2. เลือก **เรียกดู** ค้นหาและเลือกไฟล์ **จัดรูปแบบเพื่อเรียนรู้องค์ประกอบ XML ที่เลื่อน.1.1.xml** แล้วเลือก **ตกลง**

6. ในแผนภูมิการตั้งค่าคอนฟิก ให้ขยาย **แบบจำลองเพื่อเรียนรู้องค์ประกอบที่เลื่อน**
7. ตรวจทานรายการของการตั้งค่าคอนฟิก ER ที่นำเข้าในแผนภูมิการตั้งค่าคอนฟิก

    ![การตั้งค่าคอนฟิก ER ที่นำเข้าในหน้าการตั้งค่าคอนฟิก](./media/ER-DeferredXml-Configurations.png)

### <a name="activate-a-configuration-provider"></a>เรียกใช้ผู้ให้บริการการกำหนดค่า

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. ในหน้า **การกำหนดค่าการแปลเป็นภาษาท้องถิ่น** ในส่วน **ผู้ให้บริการการกำหนดค่า** ตรวจสอบให้แน่ใจว่า [ผู้ให้บริการการกำหนดค่า](general-electronic-reporting.md#Provider) สำหรับบริษัทตัวอย่าง Litware, Inc. (`http://www.litware.com`) ถูกแสดงและมีการทำเครื่องหมายเป็นใช้งานอยู่ ถ้าผู้ให้บริการการตั้งค่าคอนฟิกนี้ไม่มีอยู่ในรายการหรือถ้าไม่ได้ทำเครื่องหมายเป็นใช้งานอยู่ ให้ทำตามขั้นตอนในหัวข้อ [สร้างผู้ให้บริการการตั้งค่าคอนฟิกและทำเครื่องหมายเป็นใช้งานอยู่](./tasks/er-configuration-provider-mark-it-active-2016-11.md)

    ![Litware, Inc. บริษัทตัวอย่างในหน้าการตั้งค่าคอนฟิกการแปลเป็นภาษาท้องถิ่น](./media/ER-DeferredXml-ElectronicReportingWorkspace.png)

### <a name="review-the-imported-model-mapping"></a>ตรวจทานการแม็ปแบบจำลองที่นำเข้า

ตรวจสอบการตั้งค่าของส่วนประกอบการแม็ปแบบจำลอง ER ที่มีการตั้งค่าคอนฟิกให้เข้าถึงธุรกรรมภาษีและเปิดเผยข้อมูลที่เข้าถึงเมื่อมีการร้องขอ

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. เลือก **การตั้งค่าคอนฟิกการรายงาน**
3. บนหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก ให้ขยาย **แบบจำลองเพื่อเรียนรู้องค์ประกอบที่เลื่อน**
4. เลือกการตั้งค่าคอนฟิก **การแม็ปเพื่อเรียนรู้องค์ประกอบที่เลื่อน**
5. เลือก **ตัวออกแบบ** เพื่อเปิดรายการของการแม็ป
6. เลือก **ตัวออกแบบ** เพื่อตรวจทานรายละเอียดการแม็ป
7. เลือก **แสดงรายละเอียด**
8. ตรวจทานแหล่งข้อมูลที่มีการตั้งค่าคอนฟิกสำหรับการเข้าถึงธุรกรรมภาษี:

    - แหล่งข้อมูล **ธุรกรรม** ของชนิด *เรกคอร์ดตาราง* ถูกตั้งค่าคอนฟิกให้เข้าถึงเรกคอร์ดของตารางแอปพลิเคชัน **TaxTrans**
    - แหล่งข้อมูล **ใบสำคัญ** ของชนิด *ฟิลด์ที่คำนวณได้* ถูกตั้งค่าคอนฟิกให้ส่งคืนรหัสใบสำคัญที่จำเป็น (**INV-10000349** และ **INV-10000350**) เป็นรายการของเรกคอร์ด
    - แหล่งข้อมูล **ที่ถูกกรอง** ของชนิด *ฟิลด์ที่คำนวณได้* ถูกตั้งค่าคอนฟิกให้เลือก จากแหล่งข้อมูล **ธุรกรรม** เฉพาะธุรกรรมภาษีของใบสำคัญที่จำเป็นเท่านั้น
    - ฟิลด์ **\$TaxAmount** ของชนิด *ฟิลด์ที่คำนวณได้* ถูกเพิ่มสำหรับแหล่งข้อมูล **ที่ถูกกรอง** เพื่อเปิดเผยมูลค่าภาษีที่มีเครื่องหมายตรงข้าม
    - แหล่งข้อมูล **ที่มีการจัดกลุ่ม** ของชนิด *กลุ่มตามชนิด* ถูกตั้งค่าเพื่อจัดกลุ่มธุรกรรมภาษีที่ถูกกรองของแหล่งข้อมูล **ที่ถูกกรอง**
    - ฟิลด์การรวม **TotalSum** ของแหล่งข้อมูล **ที่มีการจัดกลุ่ม** ถูกตั้งค่าคอนฟิกเพื่อสรุปค่าของฟิลด์ **\$TaxAmount** ของแหล่งข้อมูล **ที่ถูกกรอง** สำหรับธุรกรรมภาษีที่กรองทั้งหมดของแหล่งข้อมูลนั้น

        ![ฟิลด์การรวม TotalSum บนหน้าพารามิเตอร์แก้ไข 'GroupBy'](./media/ER-DeferredXml-GroupByParameters.png)

9. ตรวจสอบวิธีการผูกแหล่งข้อมูลที่ตั้งค่าคอนฟิกกับแบบจำลองข้อมูลและวิธีการที่จะเปิดเผยข้อมูลที่เข้าถึงเพื่อให้มีอยู่ในรูปแบบ ER:

    - แหล่งข้อมูล **ที่ถูกกรอง** ถูกผูกไว้กับฟิลด์ **Data.List** ของแบบจำลองข้อมูล
    - ฟิลด์ **\$TaxAmount** ของแหล่งข้อมูล **ที่ถูกกรอง** ที่ผูกไว้กับฟิลด์ **Data.List.Value** ของแบบจำลองข้อมูล
    - ฟิลด์ **TotalSum** ของแหล่งข้อมูล **ที่มีการจัดกลุ่ม** ที่ผูกไว้กับฟิลด์ **Data.Summary.Total** ของแบบจำลองข้อมูล

    ![หน้าตัวออกแบบการแม็ปแบบจำลอง](./media/ER-DeferredXml-ModelMapping.png)

10. ปิดหน้า **ตัวออกแบบการแม็ปแบบจำลอง** และ **การแม็ปแบบจำลอง**

### <a name="review-the-imported-format"></a>ตรวจทานรูปแบบที่นำเข้า

1. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก ให้เลือกการตั้งค่าคอนฟิก **จัดรูปแบบเพื่อเรียนรู้องค์ประกอบ XML ที่เลื่อน**
2. เลือก **ตัวออกแบบ** เพื่อตรวจทานรายละเอียดการจัดรูปแบบ
3. เลือก **แสดงรายละเอียด**
4. ตรวจทานการตั้งค่าส่วนประกอบของรูปแบบ ER ที่มีการตั้งค่าคอนฟิกเพื่อสร้างเอกสารขาออกในรูปแบบ XML ที่มีรายละเอียดของธุรกรรมภาษีดังนี้:

    - องค์ประกอบ **รายงาน\\ข้อความ** มีการตั้งค่าคอนฟิกให้กรอกข้อมูลเอกสารขาออกที่มีโหนดเดียวซึ่งรวมองค์ประกอบ XML ที่ซ้อนกัน (**ส่วนหัว** **เรกคอร์ด** และ **สรุป**)
    - องค์ประกอบ XML **รายงาน\\ข้อความ\\หัวข้อ** มีการตั้งค่าคอนฟิกให้กรอกเอกสารขาออกด้วยโหนดส่วนหัวเดียวที่แสดงวันที่และเวลาที่การดำเนินการเริ่มต้น
    - องค์ประกอบ XML **รายงาน\\ข้อความ\\เรกคอร์ด** มีการตั้งค่าคอนฟิกให้กรอกข้อมูลเอกสารขาออกด้วยโหนดเรกคอร์ดเดียวที่แสดงรายละเอียดของธุรกรรมภาษีรายการเดียว
    - องค์ประกอบ XML **รายงาน\\ข้อความ\\สรุป** มีการตั้งค่าคอนฟิกให้เติมข้อมูลเอกสารขาออกด้วยโหนดสรุปเดียวที่มีผลรวมของมูลค่าภาษีจากธุรกรรมภาษีที่ประมวลผล

    ![องค์ประกอบ XML ข้อความและองค์ประกอบที่ซ้อนกันบนหน้าตัวออกแบบรูปแบบ](./media/ER-DeferredXml-Format.png)

5. บนแท็บ **การแม็ป** ให้ตรวจทานรายละเอียดต่อไปนี้:

    - องค์ประกอบ **รายงาน\\ข้อความ\\หัวข้อ** ไม่จำเป็นต้องผูกกับแหล่งที่มาเพื่อสร้างโหนดเดียวในเอกสารขาออก
    - แอททริบิวต์ **ExecutionDateTime** สร้างวันที่และเวลา (รวมถึงมิลลิวินาที) เมื่อมีการเพิ่มโหนดส่วนหัว
    - องค์ประกอบ **รายงาน\\ข้อความ\\เรกคอร์ด** ถูกผูกไว้กับรายการ **model.Data.List** เพื่อสร้างโหนดเรกคอร์ดเดียวสำหรับเรกคอร์ดทั้งหมดจากรายการที่ผูกไว้
    - แอททริบิวต์ **TaxAmount** ถูกผูกไว้กับ **model.Data.List.Value** (ซึ่งแสดงเป็น **\@.Value** ในมุมมองพาธสัมพัทธ์) เพื่อสร้างมูลค่าภาษีของธุรกรรมภาษีปัจจุบัน
    - แอททริบิวต์ **RunningTotal** เป็นตัวยึดสำหรับผลรวมการรันของมูลค่าภาษี ในปัจจุบันแอททริบิวต์นี้ไม่มีผลลัพธ์ เนื่องจากไม่ได้ตั้งค่าคอนฟิกการรวมหรือค่าเริ่มต้นไว้
    - แอททริบิวต์ **ExecutionDateTime** สร้างวันที่และเวลา (รวมถึงมิลลิวินาที) เมื่อมีการประมวลผลธุรกรรมปัจจุบันในรายงานนี้
    - องค์ประกอบ **รายงาน\\ข้อความ\\สรุป** ไม่จำเป็นต้องผูกกับแหล่งข้อมูลเพื่อสร้างโหนดเดียวในเอกสารขาออก
    - แอททริบิวต์ **TotalTaxAmount** ถูกผูกไว้กับ **model.Data.Summary.Total** เพื่อสร้างผลรวมของมูลค่าภาษีของธุรกรรมภาษีที่ประมวลผล
    - แอททริบิวต์ **ExecutionDateTime** สร้างวันที่และเวลา (รวมถึงมิลลิวินาที) เมื่อมีการเพิ่มโหนดสรุป

    ![แท็บการแม็ปบนตัวออกแบบรูปแบบ](./media/ER-DeferredXml-Format2.png)

### <a name="run-the-imported-format"></a>รันรูปแบบที่นำเข้า

1. ในหน้า **ตัวออกแบบรูปแบบ** เลือก **รัน**
2. ดาวน์โหลดไฟล์ที่เว็บเบราเซอร์นำเสนอและเปิดสำหรับการตรวจทาน

    ![ไฟล์ที่ดาวน์โหลดของรูปแบบที่นําเข้า](./media/ER-DeferredXml-Run.png)

โปรดสังเกตว่าโหนดสรุปแสดงผลรวมของมูลค่าภาษีสำหรับธุรกรรมที่ประมวลผล เนื่องจากมีการตั้งค่าคอนฟิกรูปแบบให้ใช้ **model.Data.Summary.Total** ที่ผูกไว้เพื่อส่งคืนยอดรวมนี้ ยอดรวมจะถูกคำนวณโดยการเรียกการรวม **TotalSum** ของแหล่งข้อมูล **ที่มีการจัดกลุ่ม** ของชนิด *GroupBy* ที่ใช้ในการแม็ปแบบจำลอง เมื่อต้องการคำนวณการรวมนี้ การแม็ปแบบจำลองซ้ำธุรกรรมทั้งหมดที่เลือกในแหล่งข้อมูล **ที่ถูกกรองไว้แล้ว** โดยการเปรียบเทียบเวลาที่ใช้ในการดำเนินการของโหนดสรุปและโหนดของเรกคอร์ดล่าสุด คุณสามารถกำหนดว่าการคำนวณของผลรวมใช้เวลา 12 มิลลิวินาที (ms) โดยการเปรียบเทียบเวลาที่ใช้ในการดำเนินการของโหนดแรกโหนดเรกคอร์ดสุดท้าย คุณสามารถกำหนดว่าการสร้างของโหนดเรกคอร์ดทั้งหมดใช้เวลา 9 มิลลิวินาที ดังนั้น จำเป็นต้องใช้เวลารวมทั้งหมด 21 มิลลิวินาที

### <a name="modify-the-format-so-that-the-calculation-is-based-on-generated-output"></a>แก้ไขรูปแบบเพื่อให้การคำนวณเป็นไปตามผลลัพธ์ที่สร้าง

ถ้าปริมาณของธุรกรรมมีขนาดใหญ่กว่าปริมาณในตัวอย่างปัจจุบัน เวลาการคำนวณอาจเพิ่มขึ้นและทำให้เกิดปัญหาประสิทธิภาพการทำงาน ด้วยการเปลี่ยนแปลงการตั้งค่าของรูปแบบ คุณสามารถช่วยป้องกันปัญหาประสิทธิภาพการทำงานเหล่านี้ได้ เนื่องจากคุณเข้าถึงมูลค่าภาษีเพื่อรวมไว้ในรายงานที่สร้างขึ้น คุณสามารถนำข้อมูลนี้มาใช้อีกครั้งในการคำนวณมูลค่าภาษีได้ สำหรับข้อมูลเพิ่มเติม ให้ดูที่ [ตั้งค่าคอนฟิกรูปแบบที่จะทำการตรวจนับและการรวม](./tasks/er-format-counting-summing-1.md)

1. บนหน้า **ตัวออกแบบรูปแบบ** บนแท็บ **รูปแบบ** ให้เลือกองค์ประกอบของไฟล์ **รายงาน** ในแผนภูมิรูปแบบ
2. ตั้งค่าตัวเลือก **รวบรวมรายละเอียดผลลัพธ์** เป็น **ใช่** ขณะนี้คุณสามารถตั้งค่าคอนฟิกรูปแบบนี้ได้โดยใช้เนื้อหาของรายงานที่สร้างขึ้นเป็นแหล่งข้อมูลที่สามารถเข้าถึงได้โดยใช้ฟังก์ชัน ER ที่มีอยู่แล้วในประเภท [การรวบรวมข้อมูล](er-functions-category-data-collection.md)
3. บนแท็บ **การแม็ป** ให้เลือกองค์ประกอบ XML **รายงาน\\ข้อความ\\เรกคอร์ด**
4. ตั้งค่าคอนฟิกนิพจน์ **ชื่อคีย์ข้อมูลที่รวบรวมไว้** เป็น `WsColumn`
5. ตั้งค่าคอนฟิกนิพจน์ **ค่าคีย์ข้อมูลที่รวบรวมไว้** เป็น `WsRow`

    ![องค์ประกอบ XML เรกคอร์ดบนหน้าตัวออกแบบรูปแบบ](./media/ER-DeferredXml-Format3.png)

6. เลือกแอททริบิวต์ **รายงาน\\ข้อความ\\เรกคอร์ด\\TaxAmount**
7. ตั้งค่าคอนฟิกนิพจน์ **ชื่อคีย์ข้อมูลที่รวบรวมไว้** เป็น `SummingAmountKey`

    ![แอททริบิวต์ TaxAmount บนหน้าตัวออกแบบรูปแบบ](./media/ER-DeferredXml-Format4.png)

    คุณสามารถพิจารณาการตั้งค่านี้ของการเติมสินค้าของแผ่นงานเสมือน โดยที่ค่าของเซลล์ A1 ถูกผนวกเข้ากับมูลค่าของยอดภาษีจากธุรกรรมภาษีที่ประมวลผลทุกธุรกรรม

8. เลือกแอททริบิวต์ **รายงาน\\ข้อความ\\เรกคอร์ด\\RunningTotal** แล้วเลือก **แก้ไขสูตร**
9. ตั้งค่าคอนฟิกนิพจน์ `SUMIF(SummingAmountKey, WsColumn, WsRow)` โดยใช้ฟังก์ชัน ER [SUMIF](er-functions-datacollection-sumif.md) ที่มีอยู่แล้วในตัว แล้วเลือก **เซฟ**

    ![นิพจน์ SUMIF](./media/ER-DeferredXml-FormulaDesigner.png)

10. ปิดหน้า **ตัวออกแบบสูตร**
11. เลือก **บันทึก** แล้วจากนั้น เลือก **รัน**
12. ดาวน์โหลดแและตรวจทานไฟล์ที่เว็บเบราว์เซอร์นำเสนอ

    ![รายการมูลค่าภาษีที่สร้างขึ้นพร้อมกับผลรวมการรัน](./media/ER-DeferredXml-Run1.png)

    โหนดเรกคอร์ดสุดท้ายมีการรันผลรวมของมูลค่าภาษีที่คำนวณได้สำหรับธุรกรรมที่ประมวลผลทั้งหมด โดยใช้ผลลัพธ์ที่สร้างขึ้นเป็นแหล่งข้อมูล แหล่งข้อมูลนี้เริ่มต้นจากจุดเริ่มต้นของรายงานและดำเนินการต่อไปผ่านทางธุรกรรมภาษีครั้งล่าสุด โหนดสรุปมีผลรวมของมูลค่าภาษีสำหรับธุรกรรมที่ประมวลผลทั้งหมดที่มีการคำนวณในการแม็ปแบบจำลอง โดยใช้แหล่งข้อมูลของชนิด *GroupBy* โปรดสังเกตว่าค่าเหล่านี้เท่ากัน ดังนั้นการรวมตามผลลัพธ์สามารถใช้แทนที่ **GroupBy** โดยการเปรียบเทียบเวลาที่ใช้ในการดำเนินการของโหนดเรกคอร์ดแรกและโหนดสรุปสุดท้าย คุณสามารถกำหนดว่าการสร้างของโหนดเรกคอร์ดและการรวมยอดใช้เวลา 11 มิลลิวินาที ดังนั้น หากต้องมีการสร้างรายโหนดเรกคอร์ดและการรวมของมูลค่าภาษีเข้ามาเกี่ยวข้อง รูปแบบที่ถูกปรับเปลี่ยนจะมีความเร็วประมาณสองเท่าของรูปแบบดั้งเดิม

13. เลือกแอททริบิวต์ **รายงาน\\ข้อความ\\สรุป\\TotalTaxAmount** แล้วเลือก **แก้ไขสูตร**
14. ป้อนนิพจน์ `SUMIF(SummingAmountKey, WsColumn, WsRow)` แทนนิพจน์ที่มีอยู่
15. เลือก **บันทึก** แล้วจากนั้น เลือก **รัน**
16. ดาวน์โหลดแและตรวจทานไฟล์ที่เว็บเบราว์เซอร์นำเสนอ

    ![รายการมูลค่าภาษีที่สร้างขึ้นโดยใช้สูตรที่แก้ไข](./media/ER-DeferredXml-Run2.png)

    โปรดสังเกตว่ายอดรวมการรันของมูลค่าภาษีในรายการโหนดเรกคอร์ดล่าสุดตอนนี้เท่ากับผลรวมในโหนดสรุป

### <a name="put-values-of-output-based-summing-in-the-report-header"></a>ใส่มูลค่าของการรวมที่ยึดตามผลลัพธ์ในส่วนหัวของรายงาน

ตัวอย่างเช่น ถ้าคุณต้องแสดงผลรวมของมูลค่าภาษีในส่วนหัวของรายงานของคุณ คุณสามารถแก้ไขรูปแบบของคุณได้

1. บนหน้า **ตัวออกแบบรูปแบบ** บนแท็บ **รูปแบบ** ให้เลือกองค์ประกอบ XML ของ **รายงาน\\ข้อความ\\สรุป**
2. เลือก **เลื่อนขึ้น**
3. เลือก **บันทึก** แล้วจากนั้น เลือก **รัน**
4. ดาวน์โหลดแและตรวจทานไฟล์ที่เว็บเบราว์เซอร์นำเสนอ

    ![ไฟล์ที่ดาวน์โหลดของมูลค่าภาษีในส่วนหัวของรายงาน](./media/ER-DeferredXml-Run3.png)

    โปรดสังเกตว่าผลรวมของมูลค่าภาษีในโหนดสรุปตอนนี้เท่ากับ 0 (ศูนย์) เนื่องจากมีการคำนวณผลรวมนี้ตามลัพธ์ที่สร้างขึ้นแล้วในขณะนี้ เมื่อมีการสร้างโหนดเรกคอร์ดแรกขึ้น ผลลัพธ์ที่สร้างขึ้นยังไม่มีโหนดเรกคอร์ดที่มีรายละเอียดธุรกรรม คุณสามารถตั้งค่าคอนฟิกรูปแบบนี้เพื่อเลื่อนการดำเนินการขององค์ประกอบ **รายงาน\\ข้อความ\\สรุป** จนกว่าจะมีการรันองค์ประกอบ **รายงาน\\ข้อความ\\เรกคอร์ด** สำหรับธุรกรรมภาษีทั้งหมด

### <a name="defer-the-execution-of-the-summary-xml-element-so-that-the-calculated-total-is-used"></a>เลื่อนการดำเนินการขององค์ประกอบ XML สรุป เพื่อให้สามารถใช้ยอดรวมที่คำนวณได้

1. บนหน้า **ตัวออกแบบรูปแบบ** บนแท็บ **รูปแบบ** ให้เลือกองค์ประกอบ XML ของ **รายงาน\\ข้อความ\\สรุป**
2. ตั้งค่าตัวเลือก **การดำเนินการที่เลื่อน** เป็น **ใช่**

    ![ตัวเลือกการดำเนินการที่เลื่อนขององค์ประกอบ XML สรุปบนหน้าตัวออกแบบรูปแบบ](./media/ER-DeferredXml-Format5.png)

3. เลือก **บันทึก** แล้วจากนั้น เลือก **รัน**
4. ดาวน์โหลดแและตรวจทานไฟล์ที่เว็บเบราว์เซอร์นำเสนอ

    ![ไฟล์ที่ดาวน์โหลดของการดำเนินการที่เลื่อน](./media/ER-DeferredXml-Run4.png)

    ขณะนี้องค์ประกอบ **รายงาน\\ข้อความ\\สรุป** รันหลังจากสินค้าอื่นๆ ทั้งหมดที่ซ้อนกันภายใต้องค์ประกอบหลัก **รายงาน\\ข้อความ** ที่มีการรันแล้วเท่านั้น ดังนั้นจึงรันหลังจากที่องค์ประกอบ **รายงาน\\ข้อความ\\เรกคอร์ด** มีการรันสำหรับธุรกรรมภาษีทั้งหมดของแหล่งข้อมูล **model.Data.List** เวลาที่ใช้ในการดำเนินการของโหนดของเรกคอร์ดแรกและเรกคอร์ดล่าสุด และของส่วนหัวและโหนดสรุป เผยให้เห็นถึงข้อเท็จจริงนี้

## <a name="additional-resources"></a>แหล่งข้อมูลเพิ่มเติม

- [ตั้งค่าคอนฟิกรูปแบบเพื่อทำการตรวจนับและการรวม](./tasks/er-format-counting-summing-1.md)
- [การดำเนินการติดตามของรูปแบบ ER เพื่อแก้ไขปัญหาประสิทธิภาพการทำงาน](trace-execution-er-troubleshoot-perf.md)
- [เลื่อนการดำเนินการขององค์ประกอบลำดับในรูปแบบ ER](er-defer-sequence-element.md#Example)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
