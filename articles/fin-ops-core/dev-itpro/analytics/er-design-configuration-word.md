---
title: ออกแบบการตั้งค่าคอนฟิก ER ใหม่ เพื่อสร้างรายงานในรูปแบบ Word
description: หัวข้อนี้อธิบายวิธีการที่ผู้ใช้สามารถตั้งค่าคอนฟิกรูปแบบการรายงานทางอิเล็กทรอนิกส์ (ER) เพื่อสร้างรายงานเป็นเอกสาร Microsoft Word
author: NickSelin
ms.date: 12/17/2020
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, EROperationDesigner,  LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: Version 10.0.6
ms.openlocfilehash: 4885caf017fa0f9d36d293fa32aad53c21d3f162
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 03/31/2021
ms.locfileid: "5753587"
---
# <a name="design-a-new-er-configuration-to-generate-reports-in-word-format"></a><span data-ttu-id="46974-103">ออกแบบการตั้งค่าคอนฟิก ER ใหม่ เพื่อสร้างรายงานในรูปแบบ Word</span><span class="sxs-lookup"><span data-stu-id="46974-103">Design a new ER configuration to generate reports in Word format</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="46974-104">หากต้องการสร้างรายงานเป็นเอกสาร Microsoft Word คุณต้องออกแบบเท็มเพลตให้กับรายงาน โดยการใช้ ตัวอย่างเช่น แอพลิเคชันบนเดสก์ท็อปของ Word เป็นต้น</span><span class="sxs-lookup"><span data-stu-id="46974-104">To generate reports as Microsoft Word documents, you must design a template for the reports by using, for example, the Word desktop application.</span></span> <span data-ttu-id="46974-105">รูปภาพประกอบต่อไปนี้จะแสดงเท็มเพลตตัวอย่างของรายงานการควบคุม ที่สามารถสร้างขึ้นเพื่อแสดงรายละเอียดของการชำระเงินให้แก่ผู้จัดจำหน่ายที่ประมวลผลแล้ว</span><span class="sxs-lookup"><span data-stu-id="46974-105">The following illustration shows the sample template for the control report that can be generated to show details of processed vendor payments.</span></span>

![เท็มเพลตตัวอย่างเกี่ยวกับรายงานการควบคุมในแอพลิเคชันบนเดสก์ท็อปของ Word](./media/er-design-configuration-word-image1.png)

<span data-ttu-id="46974-107">หากต้องการใช้เอกสาร Word เป็นเท็มเพลตของรายงานในรูปแบบ Word คุณสามารถตั้งค่าคอนฟิก [การรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md) [โซลูชัน](er-quick-start1-new-solution.md) ใหม่ได้</span><span class="sxs-lookup"><span data-stu-id="46974-107">To use a Word document as a template for reports in Word format, you can configure a new [Electronic reporting (ER)](general-electronic-reporting.md) [solution](er-quick-start1-new-solution.md).</span></span> <span data-ttu-id="46974-108">โซลูชันนี้ต้องมี [การตั้งค่าคอนฟิก](general-electronic-reporting.md#Configuration) ของ ER ที่มีส่วนประกอบ [รูปแบบ](general-electronic-reporting.md#FormatComponentOutbound) ของ ER</span><span class="sxs-lookup"><span data-stu-id="46974-108">This solution must include an ER [configuration](general-electronic-reporting.md#Configuration) that contains an ER [format](general-electronic-reporting.md#FormatComponentOutbound) component.</span></span>

> [!NOTE]
> <span data-ttu-id="46974-109">เมื่อคุณสร้างการตั้งค่าคอนฟิกรูปแบบ ER ใหม่ เพื่อสร้างรายงานในรูปแบบ Word คุณต้องเลือก **Word** เป็นชนิดรูปแบบ ในกล่องโต้ตอบแบบหล่นลง **สร้างการตั้งค่าคอนฟิก** หรือปล่อยฟิลด์ **ชนิดรูปแบบ** ให้ว่างไว้</span><span class="sxs-lookup"><span data-stu-id="46974-109">When you create a new ER format configuration to generate reports in Word format, you must either select **Word** as the format type in the **Create configuration** drop-down dialog box or leave the **Format type** field blank.</span></span>

![การสร้างการตั้งค่าคอนฟิกรูปแบบในหน้าการตั้งค่าคอนฟิก](./media/er-design-configuration-word-image2.gif)

<span data-ttu-id="46974-111">ส่วนประกอบรูปแบบ ER ของโซลูชัน ต้องมีองค์ประกอบรูปแบบ **Excel\\ไฟล์** และองค์ประกอบรูปแบบนั้นต้องเชื่อมโยงกับเอกสาร Word ที่จะใช้เป็นเท็มเพลตสำหรับรายงานที่สร้างขณะรันไทม์</span><span class="sxs-lookup"><span data-stu-id="46974-111">The ER format component of the solution must contain the **Excel\\File** format element, and that format element must be linked to the Word document that will be used as the template for generated reports at runtime.</span></span> <span data-ttu-id="46974-112">เมื่อต้องการตั้งค่าคอนฟิกส่วนประกอบรูปแบบ ER คุณต้องเปิดเวอร์ชัน [แบบร่าง](general-electronic-reporting.md#component-versioning) ของการตั้งค่าคอนฟิก ER ที่สร้างขึ้นในโปรแกรมออกแบบรูปแบบ ER</span><span class="sxs-lookup"><span data-stu-id="46974-112">To configure the ER format component, you must open the [draft](general-electronic-reporting.md#component-versioning) version of the created ER configuration in the ER format designer.</span></span> <span data-ttu-id="46974-113">แล้วเพิ่มองค์ประกอบของ **Excel\\ไฟล์** ให้แนบเท็มเพลต Word ของคุณเข้ากับรูปแบบ ER ที่แก้ไขได้ และเชื่อมโยงเท็มเพลตนั้นกับองค์ประกอบ **Excel\\File** ที่คุณเพิ่ม</span><span class="sxs-lookup"><span data-stu-id="46974-113">Then add the **Excel\\File** element, attach your Word template to the editable ER format, and link that template to the **Excel\\File** element that you added.</span></span>

> [!NOTE]
> <span data-ttu-id="46974-114">เมื่อคุณแนบเท็มเพลต คุณต้องใช้ [ชนิดเอกสาร](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) ที่ได้รับการ [ตั้งค่าคอนฟิก](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) ก่อนหน้านี้ ในพารามิเตอร์ ER เพื่อเก็บเท็มเพลตของรูปแบบ ER</span><span class="sxs-lookup"><span data-stu-id="46974-114">When you attach a template, you must use a [document type](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) that has previously been [configured](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) in the ER parameters to store templates of ER formats.</span></span>

![การแนบเท็มเพลตบนหน้าโปรแกรมออกแบบรูปแบบ](./media/er-design-configuration-word-image3.gif)

<span data-ttu-id="46974-116">คุณสามารถเพิ่มส่วนประกอบ **Excel\\ช่วง** และ **Excel\\เซลล์** ที่ซ้อนกันสำหรับองค์ประกอบ **Excel\\ไฟล์** เพื่อระบุโครงสร้างของข้อมูลที่จะป้อนในรายงานที่สร้างขึ้นในขณะรันไทม์</span><span class="sxs-lookup"><span data-stu-id="46974-116">You can add **Excel\\Range** and **Excel\\Cell** nested elements for the **Excel\\File** element to specify the structure of data that will be entered in generated reports at runtime.</span></span> <span data-ttu-id="46974-117">จากนั้นคุณต้องผูกองค์ประกอบเหล่านั้นกับแหล่งข้อมูลของรูปแบบ ER ที่แก้ไขได้ เพื่อระบุข้อมูลจริงที่จะป้อนในรายงานที่สร้างขึ้นขณะรันไทม์</span><span class="sxs-lookup"><span data-stu-id="46974-117">You must then bind those elements to data sources of the editable ER format to specify the actual data that will be entered in generated reports at runtime.</span></span>

![การเพิ่มองค์ประกอบที่ซ้อนกันบนหน้าตัวออกแบบรูปแบบ](./media/er-design-configuration-word-image4.gif)

<span data-ttu-id="46974-119">เมื่อคุณบันทึกการเปลี่ยนแปลงของคุณไปยังรูปแบบ ER ณ เวลาการออกแบบ โครงสร้างรูปแบบตามลำดับจะจัดเก็บอยู่ในเท็มเพลต Word ที่แนบ เป็น [ส่วน XML แบบกำหนดเอง](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) ที่ชื่อ **รายงาน**</span><span class="sxs-lookup"><span data-stu-id="46974-119">When you save your changes to the ER format at design time, the hierarchical format structure is stored in the attached Word template as a [custom XML part](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) that is named **Report**.</span></span> <span data-ttu-id="46974-120">คุณต้องเข้าถึงเท็มเพลตที่แก้ไข ดาวน์โหลดจาก Finance จัดเก็บภายในเครือง และเปิดเท็มเพลตนั้นในแอพลิเคชันบนเดสก์ท็อปของ Word</span><span class="sxs-lookup"><span data-stu-id="46974-120">You must access the modified template, download it from Finance, store it locally, and open it in the Word desktop application.</span></span> <span data-ttu-id="46974-121">ภาพต่อไปนี้จะแสดงเท็มเพลตตัวอย่างที่จัดเก็บภายในเครืองของรายงานการควบคุมที่มีส่วน XML แบบกำหนดเองของ **รายงาน**</span><span class="sxs-lookup"><span data-stu-id="46974-121">The following illustration shows the locally stored sample template for the control report that contains the **Report** custom XML part.</span></span>

![การแสดงตัวอย่างของเท็มเพลตรายงานตัวอย่าง ในแอพลิเคชันบนเดสก์ท็อปของ Word](./media/er-design-configuration-word-image5.gif)

<span data-ttu-id="46974-123">เมื่อผูกข้อมูลขององค์ประกอบรูปแบบ **Excel\\ช่วง** และ **Excel\\เซลล์** จะรันในขณะรันไทม์ ข้อมูลที่การจัดส่งที่ผูกไว้ทุกรายการจะมาจากเอกสาร Word ที่สร้างขึ้นเป็นแต่ละฟิลด์ของส่วน XML แบบกำหนดเองของ **รายงาน**</span><span class="sxs-lookup"><span data-stu-id="46974-123">When bindings of **Excel\\Range** and **Excel\\Cell** format elements are run at runtime, the data that every binding delivers comes into the generated Word document as an individual field of the **Report** custom XML part.</span></span> <span data-ttu-id="46974-124">หากต้องการป้อนค่าในฟิลด์ของส่วน XML ที่กำหนดเองในเอกสารที่สร้างขึ้น คุณต้องเพิ่ม [ตัวควบคุมเนื้อหา](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) Word ที่เหมาะสม ลงในเท็มเพลต Word ของคุณ เพื่อใช้เป็นตัวยึดข้อมูลซึ่งจะถูกเติมขณะรันไทม์</span><span class="sxs-lookup"><span data-stu-id="46974-124">To enter the values from the fields of the custom XML part in a generated document, you must add the appropriate Word [content controls](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) to your Word template to serve as placeholders for data that will be filled in at runtime.</span></span> <span data-ttu-id="46974-125">หากต้องการระบุวิธีการกรอกข้อมูลตัวควบคุมเนื้อหา ให้แม็ปตัวควบคุมเนื้อหาทุกรายการกับฟิลด์ที่เหมาะสมของส่วน XML ที่กำหนดเองของ **รายงาน**</span><span class="sxs-lookup"><span data-stu-id="46974-125">To specify how content controls are filled in, map every content control to the appropriate field of the **Report** custom XML part.</span></span>

![การเพิ่มและการแม็ปตัวควบคุมเนื้อหาในแอพลิเคชันบนเดสก์ทอปของ Word](./media/er-design-configuration-word-image6.gif)

<span data-ttu-id="46974-127">จากนั้นคุณต้องแทนที่เท็มเพลต Word ดั้งเดิมของรูปแบบ ER ที่แก้ไขได้ ด้วยเท็มเพลตที่แก้ไข ซึ่งขณะนี้มีตัวควบคุมเนื้อหา Word ที่ถูกแม็ปไปยังฟิลด์ของส่วน XML ที่กำหนดเองของ **รายงาน**</span><span class="sxs-lookup"><span data-stu-id="46974-127">You must then replace the original Word template of the editable ER format with the modified template that now contains Word content controls that were mapped to the fields of the **Report** custom XML part.</span></span>

![การแทนที่เท็มเพลตบนหน้าโปรแกรมออกแบบรูปแบบ](./media/er-design-configuration-word-image7.gif)

<span data-ttu-id="46974-129">เมื่อคุณรันรูปแบบ ER ที่ตั้งค่าคอนฟิก ระบบจะใช้เท็มเพลต Word ที่แนบเพื่อสร้างรายงานใหม่</span><span class="sxs-lookup"><span data-stu-id="46974-129">When you run the configured ER format, the attached Word template is used to generate a new report.</span></span> <span data-ttu-id="46974-130">ข้อมูลจริงจะจัดเก็บอยู่ในรายงาน Word เป็นส่วน XML ที่กำหนดเอง ชื่อว่า **รายงาน**</span><span class="sxs-lookup"><span data-stu-id="46974-130">The actual data is stored in the Word report as a custom XML part that is named **Report**.</span></span> <span data-ttu-id="46974-131">เมื่อเปิดรายงานที่สร้างขึ้น ตัวควบคุมเนื้อหาของ Word จะเติมข้อมูลจากส่วน XML ที่กำหนดเองของ **รายงาน**</span><span class="sxs-lookup"><span data-stu-id="46974-131">When the generated report is opened, the Word content controls are filled in with data from the **Report** custom XML part.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="46974-132">คำถามที่ถามบ่อย</span><span class="sxs-lookup"><span data-stu-id="46974-132">Frequently asked questions</span></span>

<span data-ttu-id="46974-133">**คําถาม:** ฉันตั้งค่าคอนฟิกรูปแบบ ER ให้พิมพ์เอกสาร Word ที่มีที่อยู่บริษัท</span><span class="sxs-lookup"><span data-stu-id="46974-133">**Question:** I configured an ER format to print a Word document that contains a company address.</span></span> <span data-ttu-id="46974-134">ในเท็มเพลต Word ให้กับรูปแบบ ER นี้ ฉันแทรกตัวควบคุมเนื้อหารูปแบบ rich text เพื่อแสดงที่อยู่ของบริษัท</span><span class="sxs-lookup"><span data-stu-id="46974-134">In the Word template for this ER format, I inserted a rich text content control to present a company address.</span></span> <span data-ttu-id="46974-135">ใน Finance ฉันป้อนที่อยู่บริษัทเป็นข้อความแบบหลายบรรทัด และเลือก **ป้อน** เพื่อเพิ่มการส่งคืนสินค้าให้กับทุกบรรทัดที่ฉันป้อน</span><span class="sxs-lookup"><span data-stu-id="46974-135">In Finance, I entered the company address as multiline text and selected **Enter** to add a carriage return for every line that I entered.</span></span> <span data-ttu-id="46974-136">ดังนั้น ฉันคาดว่าที่อยู่บริษัทจะปรากฏเป็นข้อความแบบหลายบรรทัดในเอกสารที่สร้าง</span><span class="sxs-lookup"><span data-stu-id="46974-136">Therefore, I expect the company address to appear as multiline text in generated documents.</span></span> <span data-ttu-id="46974-137">แต่ ที่อยู่ปรากฏเป็นข้อความบรรทัดเดียว ที่มีสัญลักษณ์พิเศษแทนการส่งคืนสินค้า</span><span class="sxs-lookup"><span data-stu-id="46974-137">However, the address appears as a single line of text that contains special symbols instead of carriage returns.</span></span> <span data-ttu-id="46974-138">การตั้งค่าของฉันมีอะไรที่ไม่ถูกต้อง</span><span class="sxs-lookup"><span data-stu-id="46974-138">What is wrong with my settings?</span></span>

<span data-ttu-id="46974-139">**คําตอบ:** แทนที่จะใช้ตัวควบคุมเนื้อหาข้อความแบบ Rich Text คุณต้องใช้ตัวควบคุมเนื้อหาข้อความธรรมดา และเลือกกล่องกาเครื่องหมาย **อนุญาตการส่งคืนสินค้า (หลายย่อหน้า)** ในคุณสมบัติของตัวควบคุม</span><span class="sxs-lookup"><span data-stu-id="46974-139">**Answer:** Instead of using a rich text content control, you must use a plain text content control and select the **Allow carriage returns (multiple paragraphs)** check box in the control's properties.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="46974-140">ทรัพยากรเพิ่มเติม</span><span class="sxs-lookup"><span data-stu-id="46974-140">Additional resources</span></span>

- [<span data-ttu-id="46974-141">ใช้การตั้งค่าคอนฟิก ER กับเท็มเพลต Excel มาใช้ใหม่เพื่อสร้างรายงานในรูปแบบ Word</span><span class="sxs-lookup"><span data-stu-id="46974-141">Reuse ER configurations with Excel templates to generate reports in Word format</span></span>](./tasks/er-design-configuration-word-2016-11.md)
- [<span data-ttu-id="46974-142">ฝังข้อมูลและรูปร่างในเอกสารที่คุณสร้างโดยใช้ ER</span><span class="sxs-lookup"><span data-stu-id="46974-142">Embed images and shapes in documents that you generate by using ER</span></span>](electronic-reporting-embed-images-shapes.md#embed-an-image-in-a-word-document)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]