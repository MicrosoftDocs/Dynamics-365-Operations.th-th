---
title: การใช้แหล่งข้อมูลบาร์โค้ดเพื่อสร้างรูปภาพของบาร์โค้ด
description: หัวข้อนี้จะอธิบายวิธีการใช้แหล่งข้อมูลบาร์โค้ดเพื่อสร้างรูปภาพของบาร์โค้ด
author: NickSelin
manager: AnnBe
ms.date: 10/21/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, ERModelMappingDesigner, EROperationDesigner
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-05-01
ms.dyn365.ops.version: Version 10.0.13
ms.openlocfilehash: 3fb754267de1120bc3c086d49cb7c63028183bda
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 12/05/2020
ms.locfileid: "4681435"
---
# <a name="use-barcode-data-sources-to-generate-bar-code-images"></a>การใช้แหล่งข้อมูลบาร์โค้ดเพื่อสร้างรูปภาพของบาร์โค้ด

[!include[banner](../includes/banner.md)]

คุณสามารถใช้กรอบงาน [การรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md) เพื่อออกแบบ [ส่วนประกอบของรูปแบบ ER](general-electronic-reporting.md#FormatComponentOutbound) ซึ่งคุณสามารถรันเพื่อสร้างเอกสารขาออกอิเล็กทรอนิกส์และแบบพิมพ์ได้ที่คุณต้องการ เมื่อต้องการสร้างเอกสารขาออกในรูปแบบ Microsoft Office คุณต้องระบุโครงร่างของรายงานโดยใช้เอกสาร Microsoft Excel หรือเอกสาร Microsoft Word เป็นเท็มเพลตรายงาน [ตัวออกแบบการดำเนินงาน ER](general-electronic-reporting.md#building-a-format-that-uses-a-data-model-as-a-base) ช่วยให้คุณสามารถแนบเอกสาร Excel หรือ Word เป็นเท็มเพลตสำหรับรูปแบบ ER องค์ประกอบที่มีชื่อต่อไปนี้ในเท็มเพลตที่แนบจะเชื่อมโยงกับองค์ประกอบของส่วนประกอบรูปแบบที่ตั้งค่าคอนฟิก:

- ตัวควบคุมเนื้อหาใน Word
- แผ่นงานที่มีชื่อ ช่วง เซลล์ รูปร่าง และรูปภาพใน Excel

องค์ประกอบที่มีการระบุชื่อเหล่านี้จะใช้เป็นตัวยึดสำหรับข้อมูลที่ถูกป้อนในเอกสารที่สร้างขึ้น เมื่อมีการรันรูปแบบ ER องค์ประกอบของรูปแบบ ER ถูกเชื่อมโยงไปยังแหล่งข้อมูล แหล่งข้อมูลเหล่านี้จะระบุข้อมูลที่จะถูกป้อนลงในเอกสารที่สร้างขึ้นในขณะทำงาน สำหรับข้อมูลเพิ่มเติม ให้ดูที่ [ฝังรูปภาพและรูปร่างในเอกสารที่คุณสร้างโดยใช้ ER](electronic-reporting-embed-images-shapes.md)

ปัจจุบัน ER สนับสนุนชนิดแหล่งข้อมูล **บาร์โค้ด** ดังนั้น ตอนนี้คุณจึงสามารถสร้างรูปภาพที่แสดงถึงบาร์โค้ดสำหรับข้อความที่ระบุได้ เมื่อคุณตั้งค่าคอนฟิกรูปแบบ ER คุณสามารถระบุแหล่งข้อมูลของชนิด **บาร์โค้ด** เพื่อสร้างรูปภาพของบาร์โค้ด จากนั้น คุณสามารถเพิ่มรูปภาพเหล่านั้นลงในเอกสารทางธุรกิจที่สร้างขึ้น เช่น ใบสั่ง ใบแจ้งหนี้ บันทึกการจัดส่ง และใบเสร็จรับเงิน นอกจากนี้ คุณยังสามารถเพิ่มในป้ายชื่อชนิดต่างๆ เช่น ป้ายชื่อผลิตภัณฑ์และชั้นวางสินค้า และป้ายชื่อบรรจุภัณฑ์และการจัดส่งสินค้า

สามารถใช้ตัวยึดตำแหน่งต่อไปนี้ในเท็มเพลตรายงานเพื่อป้อนรูปภาพบาร์โค้ด:

- ตัวควบคุมเนื้อหา [รูปภาพ](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) สำหรับ Word
- ออบเจ็กต์ [รูปภาพ](https://support.office.com/article/insert-pictures-3c51edf4-22e1-460a-b372-9329a8724344) ใน Excel

โดยใช้แหล่งข้อมูลของชนิด **บาร์โค้ด** คุณสามารถสร้างบาร์โค้ดในรูปแบบต่อไปนี้:

- บาร์โค้ดหนึ่งมิติ:

    - Codabar
    - Code 39
    - Code 93
    - Code 128
    - EAN-8
    - EAN-13
    - ITF-14
    - จดหมายอัจฉริยะ
    - MSI
    - Plessey
    - PDF417
    - UPC-A
    - UPC-E

- บาร์โค้ดสองมิติ:

    - Aztec
    - เมทริกซ์ข้อมูล
    - รหัส QR

เมื่อคุณตั้งค่าคอนฟิกแหล่งข้อมูล **บาร์โค้ด** คุณสามารถกำหนดพารามิเตอร์การแสดงภาพเฉพาะที่ใช้ในการสร้างรูปภาพ:

- **ความกว้าง** – ระบุความกว้างของบาร์โค้ดเป็นพิกเซล ค่าเป็น **0** (ศูนย์) บ่งชี้ว่ามีการใช้ความกว้างเริ่มต้น ความหมายอาจแตกต่างกันไปสำหรับรูปแบบที่แตกต่างกัน
- **ความสูง** – ระบุความสูงของบาร์โค้ดเป็นพิกเซล ค่าเป็น **0** (ศูนย์) บ่งชี้ว่ามีการใช้ความสูงเริ่มต้น ความหมายอาจแตกต่างกันไปสำหรับรูปแบบที่แตกต่างกัน
- **ระยะขอบ** – ระบุขนาดของระยะขอบของบาร์โค้ดเป็นพิกเซล ระยะขอบคือพื้นที่ในแต่ละด้านของบาร์โค้ดที่ต้องมีการเว้นไว้ (โซนเงียบ) ค่าเป็น **0** (ศูนย์) บ่งชี้ว่ามีการใช้ระยะขอบเริ่มต้น ความหมายอาจแตกต่างกันไปสำหรับรูปแบบที่แตกต่างกัน
- **เนื้อหาของเอาต์พุต** – ตั้งค่าเป็น **ใช่** เพื่อสร้างรูปบาร์โค้ดที่มีข้อมูลที่เข้ารหัสเป็นข้อความ ค่าเริ่มต้นคือ **ไม่**
- **การเข้ารหัส** – ระบุชนิดของอักขระที่ถูกเข้ารหัสในรูปของบาร์โค้ดที่สร้างขึ้น โดยค่าเริ่มต้น การเข้ารหัส **UTF-8** จะถูกใช้

> [!IMPORTANT]
> เมื่อคุณเพิ่มแหล่งข้อมูล **บาร์โค้ด** ใหม่ คุณต้องวางไว้ภายใต้สินค้าอื่น (คอนเทนเนอร์) เป็นองค์ประกอบที่ซ้อนกัน
>
> เมื่อคุณผูกแหล่งข้อมูล **บาร์โค้ด** เข้ากับองค์ประกอบเซลล์ในรูปแบบ และองค์ประกอบเซลล์แสดงตัวควบคุมเนื้อหาของ Word หรือรูปภาพ Excel แหล่งข้อมูลจะแสดงอยู่ในการผูกข้อมูลนั้นเป็นฟังก์ชันที่มีพารามิเตอร์เดียวของชนิด **สตริง** คุณต้องใช้พารามิเตอร์นี้เพื่อระบุข้อความที่ควรถูกแปลงเป็นรูปบาร์โค้ด และอ่านเมื่อมีการสแกนบาร์โค้ดที่สร้างขึ้น

สำหรับข้อมูลเพิ่มเติมเกี่ยวกับคุณลักษณะนี้ ให้ดำเนินการตัวอย่างในหัวข้อนี้ให้เสร็จสมบูรณ์

## <a name="example-generate-a-payment-check-that-contains-a-bar-code-that-encodes-the-payable-amount"></a>ตัวอย่าง: สร้างเช็คการชำระเงินที่มีบาร์โค้ดที่เข้ารหัสยอดเงินเจ้าหนี้

ตัวอย่างนี้แสดงให้เห็นถึงวิธีการที่ผู้ใช้ในบทบาท **ผู้ดูแลระบบ** หรือ **ที่ปรึกษาด้านการทำงานของการรายงานทางอิเล็กทรอนิกส์** สามารถตั้งค่าคอนฟิกรูปแบบ ER ซึ่งประกอบด้วยเท็มเพลตที่ใช้เพื่อสร้างเอกสารขาออกในรูปแบบ Excel ที่มีบาร์โค้ด ต่อไปนี้เป็นภาพรวมของขั้นตอนที่เกี่ยวข้อง

1. [ดำเนินการข้อกำหนดเบื้องต้นให้เสร็จสมบูรณ์](#ExamplePrerequisites)
2. [เรียกใช้ผู้ให้บริการการตั้งค่าคอนฟิก](#ExampleProvider)
3. [นำเข้าโซลูชัน ER ที่ระบุ](#ExampleImportSolution)
4. [สร้างเช็คการชำระเงิน](#ExampleGenerateCheque)
5. [รีวิวเช็คการชำระเงินที่สร้างขึ้น](#ExampleReviewGeneratedCheque)
6. [ปรับเปลี่ยนรูปแบบของโซลูชัน ER ที่ระบุ](#ExampleModifyFormat)

    1. [ใช้เท็มเพลตเช็คใหม่](#ExampleModifyFormatApplyTemplate)
    2. [เพิ่มแหล่งข้อมูลบาร์โค้ดใหม่](#ExampleModifyFormatAddDataSource)
    3. [ผูกองค์ประกอบรูปแบบใหม่](#ExampleModifyFormatBindFormatElement)
    4. [ทำให้รุ่นที่แก้ไขพร้อมใช้งานสำหรับการรันการทดสอบ](#ExampleModifyFormatMakeVersionAvailable)

        1. [ดำเนินการรุ่นของรูปแบบที่แก้ไขให้เสร็จสมบูรณ์](#CompleteToRun)
        2. [ทำให้รุ่นแบบร่างพร้อมสำหรับการใช้งาน](#MarkToRun)

7. [สร้างเช็คการชำระเงิน](#ExampleGenerateCheque2)
8. [แปลงเช็คที่สร้างขึ้นเป็น PDF](#ExampleConvertToPDF)

ในตัวอย่างนี้ คุณจะใช้โซลูชัน ER ที่ระบุซึ่งถูกตั้งค่าคอนฟิกไว้เพื่อสร้างเช็คการชำระเงิน โซลูชันนี้จะสร้างเช็คการชำระเงินที่มีการเขียนยอดเงินเจ้าหนี้ทั้งเป็นตัวเลขและเป็นข้อความ คุณจะปรับเปลี่ยนโซลูชัน ER นี้เพื่อให้เช็ครวมบาร์โค้ดที่สร้างขึ้นโดยที่มีการเข้ารหัสยอดเงินเจ้าหนี้และสามารถอ่านได้โดยใช้เครื่องสแกนบาร์โค้ดด้วย

ขั้นตอนสามารถถูกดำเนินการให้เสร็จสมบูรณ์ได้ในบริษัท **USMF** ใน Microsoft Dynamics 365 Finance

### <a name="complete-the-prerequisites"></a><a name="ExamplePrerequisites"></a>ดำเนินการข้อกำหนดเบื้องต้นให้เสร็จสมบูรณ์

เมื่อต้องการทำให้ตัวอย่างนี้เสร็จสมบูรณ์ คุณต้องเข้าถึงบริษัท USMF ในการเงินสำหรับหนึ่งในบทบาทต่อไปนี้:

- ที่ปรึกษาด้านการทำงานของการรายงานทางอิเล็กทรอนิกส์
- ผู้ดูแลระบบ

ถ้าคุณยังไม่ได้ทำให้ตัวอย่างเสร็จสมบูรณ์ในหัวข้อ [ฝังข้อมูลและรูปร่างในเอกสารที่คุณสร้างโดยใช้ ER](electronic-reporting-embed-images-shapes.md) ให้ดาวน์โหลดการตั้งค่าคอนฟิกต่อไปนี้ของโซลูชัน ER ตัวอย่าง

| คำอธิบายเนื้อหา         | ชื่อไฟล์                   |
|-----------------------------|-----------------------------|
| การตั้งค่าคอนฟิกแบบจำลองข้อมูล ER | Model for cheques.xml       |
| การตั้งค่าคอนฟิกรูปแบบ ER     | Cheques printing format.xml |

นอกจากนี้ ให้ดาวน์โหลดไฟล์ Excel ต่อไปนี้ที่มีเท็มเพลตที่แก้ไขสำหรับโซลูชัน ER ที่ระบุ

| คำอธิบายเนื้อหา | ชื่อไฟล์                 |
|---------------------|---------------------------|
| เท็มเพลตรายงาน     | Check template Excel.xlsx |

### <a name="activate-a-configuration-provider"></a><a name="ExampleProvider"></a>เรียกใช้ผู้ให้บริการการกำหนดค่า

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. ในหน้า **การตั้งค่าคอนฟิกการแปลเป็นภาษาท้องถิ่น** ในส่วน **ผู้ให้บริการการตั้งค่าคอนฟิก** ตรวจสอบให้แน่ใจว่า [ผู้ให้บริการการตั้งค่าคอนฟิก](general-electronic-reporting.md#Provider) สำหรับบริษัทตัวอย่าง **Litware, Inc.** ถูกแสดงรายการและมีการทำเครื่องหมายเป็นใช้งานอยู่ ถ้าไม่มีการแสดงรายการ หรือถ้าไม่ถูกทำเครื่องหมายเป็นใช้งานอยู่ ให้ทำตามขั้นตอนในหัวข้อ [สร้างผู้ให้บริการการตั้งค่าคอนฟิกและทำเครื่องหมายเป็นใช้งานอยู่](tasks/er-configuration-provider-mark-it-active-2016-11.md)

![การตั้งค่าบริษัทตัวอย่างเป็นใช้งานอยู่ในหน้าการตั้งค่าคอนฟิกการแปลเป็นภาษาท้องถิ่น](./media/er-barcode-data-source-active-provider.png)

### <a name="import-the-provided-er-solution"></a><a name="ExampleImportSolution"></a>นำเข้าโซลูชัน ER ที่ระบุ

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. บนหน้า **การตั้งค่าคอนฟิกการแปลเป็นภาษาท้องถิ่น** ในส่วน **การตั้งค่าคอนฟิก** เลือกไทล์ **การตั้งค่าคอนฟิกการรายงาน**
3. ในหน้า **การตั้งค่าคอนฟิก** ถ้าการตั้งค่าคอนฟิก **แบบจำลองสำหรับคิว** ไม่พร้อมใช้งานในแผนภูมิการตั้งค่าคอนฟิก ให้ทำตามขั้นตอนเหล่านี้เพื่อนำเข้าการตั้งค่าคอนฟิกแบบจำลองข้อมูล ER

    1. ในบานหน้าต่างการดำเนินการ เลือก **แลกเปลี่ยน** \> **โหลดจากไฟล์ XML**
    2. ในกล่องโต้ตอบ เลือก **เรียกดู** ค้นหา และเลือกไฟล์ **Model for cheques.xml** และจากนั้น เลือก **ตกลง**

4. ถ้าการตั้งค่าคอนฟิก **รูปแบบการพิมพ์เช็ค** ไม่พร้อมใช้งานในแผนภูมิการตั้งค่าคอนฟิก ให้ทำตามขั้นตอนเหล่านี้เพื่อนำเข้าการตั้งค่าคอนฟิกรูปแบบ ER

    1. ในบานหน้าต่างการดำเนินการ เลือก **แลกเปลี่ยน** \> **โหลดจากไฟล์ XML**
    2. ในกล่องโต้ตอบ เลือก **เรียกดู** ค้นหา และเลือกไฟล์ **Cheques printing format.xml** และจากนั้น เลือก **ตกลง**

5. ในแผนภูมิการตั้งค่าคอนฟิก ขยาย **แบบจำลองสำหรับเช็ค**
6. ตรวจทานรายการของการตั้งค่าคอนฟิก ER ที่นำเข้าในแผนภูมิการตั้งค่าคอนฟิก

### <a name="generate-a-payment-check"></a><a name="ExampleGenerateCheque"></a>สร้างเช็คการชำระเงิน

1. ไปที่ **การจัดการเงินสดและธนาคาร** \> **บัญชีธนาคาร** \> **บัญชีธนาคาร**
2. บนหน้า **บัญชีธนาคาร** ให้เลือกบัญชี **USMF OPER**
3. ในหน้ารายละเอียดบัญชีธนาคาร บนบานหน้าต่างการดำเนินการ บนแท็บ **การตั้งค่า** ในกลุ่ม **โครงร่าง** เลือก **เช็ค**
4. บนหน้า **โครงร่างเช็ค** เลือก **แก้ไข**
5. บน FastTab **ทั่วไป** ให้ตั้งค่าตัวเลือก **รูปแบบการส่งออกทางอิเล็กทรอนิกส์ทั่วไป** เป็น **ใช่**
6. ในฟิลด์ **การตั้งค่าคอนฟิกส่งออกรูปแบบ** ให้เลือกรูปแบบ ER **รูปแบบการพิมพ์เช็ค** ที่คุณนำเข้าก่อนหน้านี้
7. ในบานหน้าต่างการดำเนินการ เลือก **การทดสอบการพิมพ์**
8. ในกล่องโต้ตอบ ให้ตั้งค่าตัวเลือก **รูปแบบเช็คที่เปลี่ยนมือได้** เป็น **ใช่** และจากนั้น เลือก **ตกลง**

    ![กล่องโต้ตอบโครงร่างเช็ค - การทดสอบการพิมพ์](./media/er-barcode-data-source-check-layout.png)

### <a name="review-the-generated-payment-check"></a><a name="ExampleReviewGeneratedCheque"></a>รีวิวเช็คการชำระเงินที่สร้างขึ้น

- เปิดเช็คที่สร้างขึ้นใน Excel
2. รีวิวเช็คที่สร้างขึ้น

    ![เช็คการชำระเงินที่สร้างขึ้นใน Excel](./media/er-barcode-data-source-cheque1.png)

### <a name="modify-the-format-of-the-provided-er-solution"></a><a name="ExampleModifyFormat"></a>ปรับเปลี่ยนรูปแบบของโซลูชัน ER ที่ระบุ

#### <a name="apply-a-new-check-template"></a><a name="ExampleModifyFormatApplyTemplate"></a>ใช้เท็มเพลตเช็คใหม่

คุณสามารถใช้แอปพลิเคชันบนเดสก์ท็อปของ Excel เพื่อเปิดไฟล์ **Cheque template Excel.xlsx** ที่คุณนำเข้ามาก่อนหน้านี้ โปรดสังเกตว่าเท็มเพลตนี้แตกต่างจากเท็มเพลตที่คุณใช้ในการสร้างเช็คการชำระเงินในโซลูชัน ER ที่ระบุ นอกจากนี้ ยังมีองค์ประกอบ **AmountBarcode** สำหรับรูปบาร์โค้ด

![องค์ประกอบ AmountBarcode ในเท็มเพลต Excel](./media/er-barcode-data-source-cheque2.png)

ขณะนี้คุณต้องปรับเปลี่ยนโซลูชัน ER แล้วจากนั้น [นำไปใช้อีกครั้ง](modify-electronic-reporting-format-reapply-excel-template.md) เท็มเพลตที่แก้ไขแล้ว

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. บนหน้า **การตั้งค่าคอนฟิกการแปลเป็นภาษาท้องถิ่น** ในส่วน **การตั้งค่าคอนฟิก** เลือก **การตั้งค่าคอนฟิกการรายงาน**
3. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก ขยาย **แบบจำลองสำหรับเช็ค** และเลือก **รูปแบบการพิมพ์เช็ค**
4. บนบานหน้าต่างการดำเนินการ เลือก **ตัวออกแบบ**
5. ในตัวออกแบบการดำเนินงาน ER เลือกแท็บ **การแม็ป** ทางด้านขวาของหน้า และจากนั้น ในบานหน้าต่างแผนภูมิรูปแบบทางด้านซ้าย ให้เลือก **ขยาย/ยุบ**
6. โปรดสังเกตว่าองค์ประกอบรูปแบบเซลล์ทั้งหมดจะถูกผูกไว้กับแหล่งข้อมูลที่เหมาะสม

    ![การผูกองค์ประกอบรูปแบบเซลล์กับแหล่งข้อมูลในตัวออกแบบการดำเนินการ ER](./media/er-barcode-data-source-cells-bound.png)

7. เลือกแท็บ **รูปแบบ** ทางด้านขวาของหน้า
8. ในบานหน้าต่างการดำเนินการ ให้เลือกจุดไข่ปลา (**...**) แล้วจากนั้น เลือก **นำเข้า**
9. ในกลุ่ม **นำเข้า** เลือก **ปรับปรุงจาก Excel** และจากนั้น เลือก **ปรับปรุงเท็มเพลต**
10. ในกล่องโต้ตอบ ให้เลือกดูไฟล์ **Cheque template Excel.xlsx** ที่บันทึกไว้บนคอมพิวเตอร์ของคุณ ให้เลือกไฟล์นั้น และจากนั้น เลือก **ตกลง** เพื่อยืนยันว่าควรใช้เท็มเพลตที่เลือก
11. เลือกแท็บ **การแม็ป** ทางด้านขวาของหน้า และจากนั้น ในบานหน้าต่างแผนภูมิรูปแบบทางด้านซ้าย ให้เลือก **ขยาย/ยุบ**
12. โปรดสังเกตว่ามีการเพิ่มองค์ประกอบเซลล์ **AmountBarcode** ลงในรูปแบบแล้ว องค์ประกอบนี้สัมพันธ์กับองค์ประกอบ **AmountBarcode** ซึ่งถูกเพิ่มลงในเท็มเพลต Excel ที่แก้ไขแล้วเป็นตัวยึดสำหรับรูปบาร์โค้ด

    ![มีการเพิ่มองค์ประกอบเซลล์ AmountBarcode ไปยังรูปแบบในตัวออกแบบการดำเนินการ ER](./media/er-barcode-data-source-cell-added.png)

#### <a name="add-a-new-barcode-data-source"></a><a name="ExampleModifyFormatAddDataSource"></a>เพิ่มแหล่งข้อมูลบาร์โค้ดใหม่

ถัดไป คุณต้องเพิ่มแหล่งข้อมูลใหม่ของชนิด **บาร์โค้ด**

1. ในตัวออกแบบการดำเนินการ ER บนแท็บ **การแม็ป** ทางด้านขวาของหน้า ให้เลือกแหล่งข้อมูล **พิมพ์**
2. เลือก **เพิ่ม** และจากนั้น ในกลุ่ม **ฟังก์ชัน** ให้เลือกชนิดแหล่งข้อมูลของ **บาร์โค้ด**

    ![การเลือกชนิดแหล่งข้อมูลของบาร์โค้ด](./media/er-barcode-data-source-add.png)

3. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ให้ป้อน **บาร์โค้ด**
4. ใน **รูปแบบบาร์โค้ด** เลือก **รหัส 128**
5. ในฟิลด์ **ความกว้าง** ป้อน **500**
6. เลือก **ตกลง**

    ![กล่องโต้ตอบคุณสมบัติแหล่งข้อมูล](./media/er-barcode-data-source-add2.png)

#### <a name="bind-a-new-format-element"></a><a name="ExampleModifyFormatBindFormatElement"></a>ผูกองค์ประกอบรูปแบบใหม่

ถัดไป คุณต้องผูกองค์ประกอบรูปแบบใหม่ไปยังแหล่งข้อมูลที่คุณเพิ่งเพิ่ม

1. ในตัวออกแบบการดำเนินการ ER บนแท็บ **การแม็ป** ทางด้านขวาของหน้า ให้เลือกแหล่งข้อมูล **พิมพ์\\บาร์โค้ด**
2. ในบานหน้าต่างแผนภูมิรูปแบบทางด้านซ้าย ให้เลือกองค์ประกอบเซลล์ **AmountBarcode** แล้วจากนั้น เลือก **ผูก**
3. บนบานหน้าต่างการดำเนินการ เลือก **แสดงรายละเอียด**
4. โปรดสังเกตว่า เนื่องจากแหล่งข้อมูล **บาร์โค้ด** แสดงอยู่ในการผูกข้อมูลเป็นฟังก์ชันที่มีพารามิเตอร์เดียว มีการใช้ชื่อขององค์ประกอบรูปแบบที่ผูกข้อมูลเป็นอาร์กิวเมนต์ของพารามิเตอร์ดังกล่าวโดยอัตโนมัติ

    ![รายละเอียดของแหล่งข้อมูลบาร์โค้ดในโปรแกรมออกแบบการดำเนินการ ER](./media/er-barcode-data-source-bind1.png)

5. เลือก **แก้ไขสูตร** เพื่อปรับปรุงการผูกข้อมูล

    คุณไม่ต้องการให้มีการส่งคืนชื่อขององค์ประกอบเซลล์ ดังนั้น คุณต้องตั้งค่าคอนฟิกนิพจน์ที่ส่งคืนข้อความที่มียอดเงินเจ้าหนี้ของเช็คปัจจุบัน เนื่องจากช่วง **ChequeLines** หลักถูกผูกไว้กับแหล่งข้อมูล **model.cheques** ยอดเงินเจ้าหนี้ของเช็คปัจจุบันจะพร้อมใช้งานในฟิลด์ **model.cheques.attributes.amount** ของชนิดข้อมูล **จริง**

6. ในฟิลด์ **สูตร** ให้ป้อน **print.barcode(NUMBERFORMAT(@.attributes.amount, "F2"))**
7. เลือก **บันทึก** และจากนั้น ปิด [ตัวออกแบบสูตร ER](general-electronic-reporting-formula-designer.md)
8. โปรดสังเกตว่ามีการปรับปรุงการผูกข้อมูลแล้ว

    ![การผูกข้อมูลที่ปรับปรุงในตัวออกแบบการดำเนินการ ER](./media/er-barcode-data-source-bind2.png)

9. เลือก **บันทึก** และจากนั้น ปิดตัวออกแบบการดำเนินการ ER

#### <a name="make-the-modified-version-available-for-test-runs"></a><a name="ExampleModifyFormatMakeVersionAvailable"></a>ทำให้รุ่นที่แก้ไขพร้อมใช้งานสำหรับการรันการทดสอบ

โดยค่าเริ่มต้น จะมีการใช้เฉพาะรุ่นที่มีสถานะเป็น **เสร็จสมบูรณ์** และ **ใช้ร่วมกัน** เมื่อคุณรันรูปแบบ ER

ถ้าคุณได้ทำการเปลี่ยนแปลงขั้นสุดท้ายแล้ว คุณสามารถทำงานของคุณให้เสร็จสมบูรณ์ได้โดยใช้รุ่นแบบร่างปัจจุบันและทำให้การเปลี่ยนแปลงของคุณพร้อมสำหรับการใช้งาน สำหรับคำแนะนำ ให้ดูที่ส่วน [ทำให้รุ่นของรูปแบบที่แก้ไขเสร็จสมบูรณ์](#CompleteToRun) ที่อยู่ในลำดับต่อมา

ถ้าคุณต้องการทำงานกับรุ่นแบบร่างปัจจุบันต่อไป แต่คุณต้องใช้ในการสร้างเช็ค คุณจะต้องระบุอย่างชัดแจ้งว่าคุณต้องการใช้รุ่นแบบร่างของรูปแบบสำหรับการดำเนินการ สำหรับคำแนะนำ ให้ดูที่ส่วน [ทำให้รุ่นแบบร่างพร้อมสำหรับการใช้งาน](#MarkToRun)

##### <a name="complete-the-modified-format-version"></a><a name="CompleteToRun"></a>ดำเนินการรุ่นของรูปแบบที่แก้ไขให้เสร็จสมบูรณ์

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. บนหน้า **การตั้งค่าคอนฟิกการแปลเป็นภาษาท้องถิ่น** ในส่วน **การตั้งค่าคอนฟิก** เลือก **การตั้งค่าคอนฟิกการรายงาน**
3. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก ขยาย **แบบจำลองสำหรับเช็ค** และเลือก **รูปแบบการพิมพ์เช็ค**
4. บน FastTab **รุ่น** ให้เลือกเรกคอร์ดที่มีสถานะเป็น **ร่าง**
5. เลือก **เปลี่ยนสถานะ** และจากนั้น เลือก **เสร็จสมบูรณ์**
6. ในกล่องโต้ตอบ ให้เลือก **ตกลง**

สถานะของรุ่นปัจจุบันถูกเปลี่ยนจาก **ร่าง** เป็น **เสร็จสมบูรณ์** และมีการสร้างรุ่นใหม่ที่มีสถานะเป็น **ร่าง** คุณสามารถใช้รุ่นแบบร่างใหม่นี้เพื่อใช้การเปลี่ยนแปลงเพิ่มเติมได้

##### <a name="make-the-draft-version-available-for-use"></a><a name="MarkToRun"></a>ทำให้รุ่นแบบร่างพร้อมสำหรับการใช้งาน

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. บนหน้า **การตั้งค่าคอนฟิกการแปลเป็นภาษาท้องถิ่น** ในส่วน **การตั้งค่าคอนฟิก** เลือก **การตั้งค่าคอนฟิกการรายงาน**
3. บนหน้า **การตั้งค่าคอนฟิก** บนบานหน้าต่างการดำเนินการ ในแท็บ **การตั้งค่าคอนฟิก** ในกลุ่ม **การตั้งค่าขั้นสูง** เลือก **พารามิเตอร์ผู้ใช้**
4. ในกล่องโต้ตอบ ให้ตั้งค่าตัวเลือก **เรียกใช้การตั้งค่า** เป็น **ใช่** และจากนั้น เลือก **ตกลง**
5. ในแผนภูมิการตั้งค่าคอนฟิก ขยาย **แบบจำลองสำหรับเช็ค** และเลือก **รูปแบบการพิมพ์เช็ค**
6. ตั้งค่าตัวเลือก **เรียกใช้แบบร่าง** เป็น **ใช่**
7. เลือก **บันทึก**

รุ่นแบบร่างของรูปแบบที่เลือกถูกทำเครื่องหมายเป็นพร้อมสำหรับการใช้งาน เมื่อมีการรันรูปแบบที่เลือก

### <a name="generate-a-payment-check"></a><a name="ExampleGenerateCheque2"></a>สร้างเช็คการชำระเงิน

1. ไปที่ **การจัดการเงินสดและธนาคาร** \> **บัญชีธนาคาร** \> **บัญชีธนาคาร**
2. บนหน้า **บัญชีธนาคาร** ให้เลือกบัญชี **USMF OPER**
3. ในหน้ารายละเอียดบัญชีธนาคาร บนบานหน้าต่างการดำเนินการ บนแท็บ **การตั้งค่า** ในกลุ่ม **โครงร่าง** เลือก **เช็ค**
4. บนหน้า **โครงร่างเช็ค** บนบานหน้าต่างการดำเนินการ ให้เลือก **การทดสอบการพิมพ์**
5. ในกล่องโต้ตอบ ให้ตั้งค่าตัวเลือก **รูปแบบเช็คที่เปลี่ยนมือได้** เป็น **ใช่**
6. เลือก **ตกลง**
7. รีวิวเช็คที่สร้างขึ้น โปรดสังเกตว่ามีการสร้างบาร์โค้ดเพื่อเข้ารหัสยอดเงินเจ้าหนี้ของเช็ค

    ![เช็คการชำระเงินที่สร้างโดยมีบาร์โค้ดใน Excel](./media/er-barcode-data-source-cheque3.png)

> [!IMPORTANT]
> ข้อยกเว้นแสดงขึ้น ถ้าอาร์กิวเมนต์ของแหล่งข้อมูล **บาร์โค้ด** ไม่สอดคล้องกับความต้องการที่เหมาะสมที่เฉพาะเจาะจงสำหรับรูปแบบบาร์โค้ด ตัวอย่างเช่น เมื่อมีการเรียกแหล่งข้อมูล **บาร์โค้ด** เพื่อสร้างบาร์โค้ด [EAN-8](https://wikipedia.org/wiki/EAN-8) สำหรับข้อความที่ระบุ ข้อยกเว้นจะแสดงขึ้น ถ้าความยาวของข้อความเกินเจ็ดอักขระ

### <a name="convert-the-generated-check-to-a-pdf"></a><a name="ExampleConvertToPDF"></a>แปลงเช็คที่สร้างขึ้นเป็น PDF

ตามที่อธิบายไว้ในหัวข้อ [สร้างฟอร์ม FTI ที่สามารถพิมพ์ได้](er-generate-printable-fti-forms.md#finland) คุณสามารถใช้แบบอักษรพิเศษในการผลิตบาร์โค้ดในเอกสารที่สร้างขึ้น ในกรณีนี้ การแปลงเพิ่มเติมของเอกสารที่สร้างขึ้นอาจขึ้นอยู่กับความพร้อมใช้งานของแบบอักษรดังกล่าวในสภาพแวดล้อมการแปลง ตัวอย่างเช่น ถ้าคุณพยายามแปลงเอกสารเป็นรูปแบบ PDF หรือพรีวิวในสภาพแวดล้อมที่ซึ่งแบบอักษรขาดหายไป บาร์โค้ดจะไม่ถูกแสดงอย่างถูกต้อง

อย่างไรก็ตาม เมื่อคุณใช้แหล่งข้อมูล **บาร์โค้ด** เพื่อผลิตบาร์โค้ด การแสดงภาพของบาร์โค้ดเหล่านั้นจะไม่ขึ้นอยู่กับแบบอักษรใดๆ ดังนั้น คุณจึงสามารถแปลงเอกสารที่มีบาร์โค้ดเป็นรูปแบบไฟล์ PDF ได้อย่างง่ายดาย ภาพประกอบต่อไปนี้แสดงพรีวิวของเช็คการชำระเงินที่สร้างขึ้น ซึ่งมีการ [แปลง](electronic-reporting-destinations.md#OutputConversionToPDF) เป็น PDF โดยยึดตามการตั้งค่าของ [ปลายทาง](electronic-reporting-destinations.md) ER ที่ตั้งค่าคอนฟิก

![พรีวิวของ PDF ของเช็คการชำระเงิน](./media/er-barcode-data-source-cheque4.png)

## <a name="limitations"></a>การจำกัด

> [!NOTE]
> บาร์โค้ดบางชนิดที่ถูกสร้างไว้ มีอัตราส่วนกว้างยาวคงที่ ลักษณะการทำงานเหมาะสม หากคุณได้เปิดใช้งานคุณลักษณะ **เปิดการใช้งานไลบรารี EPPlus ในกรอบงานการรายงานทางอิเล็กทรอนิกส์** เพื่อทำงานกับเอกสาร EXCEL ใน ER ในกรณีดังกล่าว จะมีการป้อนรูปภาพเป็นตัวยึดตำแหน่งที่มีอัตราส่วนกว้างยาวที่ถูกล็อค ดังนั้น เมื่อมิติของตัวยึดตำแหน่งในเท็มเพลตสอดคล้องกับอัตราส่วนของรูปภาพที่ป้อนไว้ ภาพจริงในเอกสารที่สร้างขึ้นอาจถูกปรับขนาดเพื่อรักษาอัตราส่วนกว้างยาวที่ต้องการ เมื่อต้องการป้องกันการปรับขนาดรูปภาพ ให้ใช้ตัวยึดตำแหน่งที่มีอัตราส่วนกว้างยาวที่คาดไว้

## <a name="additional-resources"></a>ทรัพยากรเพิ่มเติม

- [ภาพรวมการรายงานทางอิเล็กทรอนิกส์](general-electronic-reporting.md)
- [ปลายทางการรายงานทางอิเล็กทรอนิกส์](electronic-reporting-destinations.md)
- [ภาษาสูตรในการรายงานทางอิเล็กทรอนิกส์](er-formula-language.md)
- [ฟังก์ชัน NUMBERFORMAT](er-functions-text-numberformat.md)
