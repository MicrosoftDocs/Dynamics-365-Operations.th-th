---
title: ตั้งค่าคอนฟิกการนำเข้าข้อมูลจาก SharePoint
description: บทความนี้อธิบายวิธีการนำเข้าข้อมูลจาก Microsoft SharePoint
author: NickSelin
ms.date: 01/05/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: 0163ece2f61735073567b32a45d3dc6df8be1864
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 06/03/2022
ms.locfileid: "8864791"
---
# <a name="configure-data-import-from-sharepoint"></a>ตั้งค่าคอนฟิกการนำเข้าข้อมูลจาก SharePoint

[!include[banner](../includes/banner.md)]

ในการนำเข้าข้อมูลจากไฟล์ขาเข้าโดยใช้กรอบงานการรายงานทางอิเล็กทรอนิกส์ (ER) คุณต้องตั้งค่าคอนฟิกรูปแบบ ER ที่สนับสนุนการนำเข้า แล้วจากนั้น เรียกใช้การแมปแบบจำลองของชนิด **ปลายทาง** ที่ใช้รูปแบบนั้นเป็นแหล่งข้อมูล ในการนำเข้าข้อมูล คุณต้องนำทางไปยังไฟล์ที่คุณต้องการนำเข้า สามารถเลือกไฟล์ขาเข้าได้ด้วยตนเองโดยผู้ใช้ ด้วยความสามารถ ER ใหม่ในการสนับสนุนการนำเข้าข้อมูลจาก Microsoft SharePoint กระบวนการนี้ถูกตั้งค่าคอนฟิกเป็นแบบไม่ได้เข้าร่วม คุณสามารถใช้การตั้งค่าคอนฟิก ER เพื่อดำเนินการนำเข้าข้อมูลจากไฟล์ที่ถูกเก็บอยู่ในโฟลเดอร์ Microsoft SharePoint บทความนี้อธิบายวิธีทำให้การนำเข้าข้อมูลจาก SharePoint เสร็จสมบูรณ์ ตัวอย่างใช้ธุรกรรมผู้จัดจำหน่ายเป็นข้อมูลธุรกิจ

## <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น
เพื่อทำตัวอย่างในบทความนี้ให้เสร็จสมบูรณ์ คุณต้องมีการเข้าถึงต่อไปนี้:

- การเข้าถึงหนึ่งในบทบาทต่อไปนี้:

    - นักพัฒนาการรายงานทางอิเล็กทรอนิกส์
    - ที่ปรึกษาด้านการทำงานของการรายงานทางอิเล็กทรอนิกส์
    - ผู้ดูแลระบบ

- การเข้าถึงอินสแตนซ์ของ Microsoft SharePoint Server ที่ถูกตั้งค่าคอนฟิกสำหรับการใช้กับแอปลิเคชั่น
- รูปแบบและการตั้งค่าคอนฟิกแบบจำลอง ER สำหรับการชำระเงิน 1099

### <a name="create-required-er-configurations"></a>สร้างการตั้งค่าคอนฟิก ER ที่จำเป็น
เล่นคู่มืองาน **ER นำเข้าข้อมูลจากไฟล์ Microsoft Excel** ซึ่งเป็นส่วนหนึ่งของกระบวนการทางธุรกิจ **7.5.4.3 รับ/พัฒนาองค์ประกอบบริการ/โซลูชันด้าน IT (10677)** คู่มืองานเหล่านี้นำคุณไปสู่กระบวนการของการออกแบบและการใช้การตั้งค่าคอนฟิก ER เพื่อนำเข้าธุรกรรมผู้จัดจำหน่ายจากไฟล์ Microsoft Excel ในระหว่างกัน สำหรับข้อมูลเพิ่มเติม ดู [แยกวิเคราะห์เอกสารขาเข้าในรูปแบบ Excel](parse-incoming-documents-excel.md) หลังจากที่คุณเสร็จสิ้นคู่มืองาน คุณจะมีตั้งค่าต่อไปนี้

#### <a name="er-configurations"></a>การตั้งค่าคอนฟิก ER

- การตั้งค่าคอนฟิกแบบจำลอง ER **แบบจำลองการชำระเงิน 1099**
- การตั้งค่าคอนฟิกรูปแบบ ER **รูปแบบสำหรับการนำเข้าธุรกรรมของผู้จัดจำหน่ายจาก Excel**

![การตั้งค่าคอนฟิก ER สำหรับการนำเข้าข้อมูลจาก SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)

#### <a name="sample-of-the-incoming-file-for-data-import"></a>ตัวอย่างของไฟล์ขาเข้าสำหรับการนำเข้าข้อมูล

- ไฟล์ Excel **1099import-data.xlsx** ที่มีธุรกรรมผู้จัดจำหน่ายที่ควรถูกนำเข้า

![ไฟล์ Excel ตัวอย่างสำหรับการนำเข้าจาก SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)
    
> [!NOTE]
> รูปแบบสำหรับการนำเข้าธุรกรรมผู้จัดจำหน่ายถูกเลือกเป็นการแมปแบบจำลองเริ่มต้น ดังนั้น ถ้าคุณเรียกใช้การแมปแบบจำลองของ **แบบจำลองการชำระเงิน 1099** และการแมปแบบจำลองนั้นเป็นของชนิด **ไปยังปลายทาง** การแมปแบบจำลองจะเรียกใช้รูปแบบนี้เพื่อนำเข้าข้อมูลจากไฟล์ภายนอก จากนั้น จะใช้ข้อมูลดังกล่าวเพื่ออัปเดตตารางแอปพลิเคชัน

## <a name="configure-access-to-sharepoint-for-file-storage"></a>ตั้งค่าคอนฟิกการเข้าถึง SharePoint สำหรับที่เก็บไฟล์
เพื่อจัดเก็บไฟล์รายงานทางอิเล็กทรอนิกส์ในที่ตั้ง SharePoint คุณต้องตั้งค่าคอนฟิกการเข้าถึงไปยังอินสแตนซ์ SharePoint Server ที่จะถูกใช้โดยบริษัทปัจจุบัน ในตัวอย่างนี้ บริษัทคือ USMF สำหรับคำแนะนำ ดู [ตั้งค่าคอนฟิกที่จัดเก็บ SharePoint](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage)

1. ทำขั้นตอนต่างๆ ใน [ตั้งค่าคอนฟิกที่จัดเก็บ SharePoint](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage) ให้เสร็จเรียบร้อย
2. เปิดไซต์ SharePoint ที่ตั้งค่าคอนฟิก
3. สร้างโฟลเดอร์ต่อไปนี้ที่ซึ่งสามารถจัดเก็บไฟล์การรายงานทางอิเล็กทรอนิกส์ขาเข้า:

     - ต้นทางการนำเข้าไฟล์ (หลัก) (ตัวอย่างที่แสดงในภาพหน้าจอด้านล่าง)
     - ต้นทางการนำเข้าไฟล์ (สำรอง)

    ![แหล่งที่มาการนำเข้าไฟล์ (หลัก)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)

4. (ไม่จำเป็น) สร้างโฟลเดอร์ต่อไปนี้ที่ซึ่งสามารถจัดเก็บไฟล์ได้หลังจากการนำเข้า: 

    - โฟลเดอร์ที่เก็บถาวรของไฟล์ - โฟลเดอร์นี้สำหรับไฟล์ที่นำเข้าเสร็จเรียบร้อยแล้ว
    - โฟลเดอร์คำเตือนของไฟล์ - โฟลเดอร์นี้สำหรับไฟล์ที่นำเข้าพร้อมคำเตือน
    - โฟลเดอร์ข้อผิดพลาดของไฟล์ - โฟลเดอร์นี้สำหรับไฟล์ที่นำเข้าไม่สำเร็จ

4. ไปที่ **การจัดการองค์กร > การจัดการเอกสาร > ชนิดของเอกสาร**
5. สร้างชนิดเอกสารต่อไปนี้ที่จะถูกใช้เพื่อเข้าถึงโฟลเดอร์ SharePoint ที่คุณเพิ่งสร้าง สำหรับคำแนะนำ ดู [ตั้งค่าคอนฟิกชนิดเอกสาร](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types)

|ชนิดเอกสาร       | กลุ่ม              | ที่ตั้ง      | โฟลเดอร์ SharePoint      |
|--------------------|--------------------|---------------|------------------------|
|SP หลัก             |ไฟล์                |SharePoint     |ต้นทางการนำเข้าไฟล์ (หลัก)|
|SP สำรอง             |ไฟล์                |SharePoint     |ต้นทางการนำเข้าไฟล์ (สำรอง)|
|ที่เก็บถาวร SP             |ไฟล์                |SharePoint     |โฟลเดอร์ที่เก็บถาวรของไฟล์|
|คำเตือน SP             |ไฟล์                |SharePoint     |โฟลเดอร์คำเตือนของไฟล์|
|ข้อผิดพลาด SP             |ไฟล์                |SharePoint     |โฟลเดอร์ข้อฺผิดพลาดของไฟล์|

![การตั้งค่า SharePoint – ชนิดเอกสารใหม่](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)

## <a name="configure-er-sources-for-the-er-format"></a>ตั้งค่าคอนฟิกแหล่งที่มา ER สำหรับรูปแบบ ER
1. คลิก **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **แหล่งที่มาการรายงานทางอิเล็กทรอนิกส์**
2. ในหน้า **แหล่งที่มาการรายงานทางอิเล็กทรอนิกส์** ตั้งค่าคอนฟิกไฟล์ต้นทางสำหรับการนำเข้าข้อมูล โดยใช้รูปแบบ ER ที่ตั้งค่าคอนฟิก
3. กำหนดตัวพรางชื่อไฟล์ เพื่อให้มีการนำเข้าเฉพาะไฟล์ที่มีนามสกุล .xlsx ตัวพรางชื่อไฟล์ไม่จำเป็นต้องระบุ และจะใช้เฉพาะเมื่อมีการกำหนด คุณสามารถกำหนดตัวพรางได้เพียงหนึ่งตัวเท่านั้นสำหรับรูปแบบ ER แต่ละแบบ
4. เปลี่ยน **จัดเรียงแฟ้มก่อนที่จะนำเข้า** เป็น **ไม่จัดเรียง** ถ้ามีล็อตของไฟล์สำหรับการนำเข้า และใบสั่งนำเข้าไม่ใช่สิ่งสำคัญ
5. เลือกโฟลเดอร์ SharePoint ทั้งหมดที่คุณสร้างก่อนหน้า

    [![การตั้งค่าแหล่งที่มาไฟล์ ER](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)

> [!NOTE]
> - มีการกำหนด *แหล่งที่มา* ER สำหรับบริษัทแอปพลิเคชันแต่ละรายการ ในทางตรงกันข้าม *การตั้งค่าคอนฟิก* ER จะถูกใช้ร่วมกันระหว่างบริษัท
> - เมื่อคุณลบการตั้งค่าแหล่งที่มา ER สำหรับรูปแบบการ ER สถานะไฟล์ที่เชื่อมต่อทั้งหมด (ดูด้านล่าง) จะถูกลบออกด้วยเช่นกันโดยการยืนยัน

## <a name="review-the-files-states-for-the-er-format"></a>ตรวจทานสถานะของไฟล์สำหรับรูปแบบ ER
1. ในหน้า **แหล่งที่มาการรายงานทางอิเล็กทรอนิกส์** เลือก **สถานะของไฟล์สำหรับแหล่งที่มา** เพื่อตรวจทานเนื้อหาของแหล่งที่มาของไฟล์ที่ตั้งค่าคอนฟิกสำหรับรูปแบบ ER ปัจจุบัน
2. ในส่วน **ไฟล์** ตรวจทานรายการของไฟล์ รายการนี้แสดงต่อไปนี้:

    - ไฟล์ต้นทางที่เกี่ยวข้อง โดยขึ้นอยู่กับตัวพรางชื่อไฟล์ (ถ้ามีการกำหนดตัวพรางชื่อไฟล์) และที่พร้อมสำหรับการนำเข้าข้อมูล สำหรับไฟล์เหล่านี้ ส่วน **ล็อกแหล่งที่มาสำหรับรูปแบบการนำเข้า** จะว่างเปล่า
    - ไฟล์ที่นำเข้าก่อนหน้านี้ สำหรับไฟล์เหล่านี้แต่ละไฟล์ ในส่วน **ล็อกแหล่งที่มาสำหรับรูปแบบการนำเข้า** คุณสามารถทบทวนประวัติของการนำเข้าไฟล์นี้ได้

คุณยังสามารถเปิดหน้า **สถานะของไฟล์สำหรับแหล่งที่มา** ได้ด้วยการเลือก **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **สถานะของไฟล์สำหรับแหล่งที่มา** ในกรณีนี้ หน้าแสดงข้อมูลเกี่ยวกับแหล่งที่มาของไฟล์สำหรับรูปแบบ ER ทั้งหมด ที่แหล่งที่มาของไฟล์ได้ถูกตั้งค่าคอนฟิกสำหรับในบริษัทที่คุณกำลังลงชื่อเข้าใช้

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a>นำเข้าข้อมูลจากไฟล์ Excel ที่อยู่ในโฟลเดอร์ SharePoint
1. ใน SharePoint อัปโหลดไฟล์ Microsoft Excel **1099import-data.xlsx** ที่ประกอบด้วยธุรกรรมผู้จัดจำหน่ายไปยังโฟลเดอร์ **ต้นทางการนำเข้าไฟล์ (หลัก)** SharePoint ที่คุณสร้างก่อนหน้า

    [![SharePoint เนื้อหา – ไฟล์ Microsoft Excel สำหรับการนำเข้า](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)

2. ในหน้า **สถานะของไฟล์สำหรับแหล่งที่มา** เลือก **รีเฟรช** เพื่อรีเฟรชหน้า ไฟล์ Excel ที่ถูกอัปโหลดไปยัง SharePoint ปรากฎอยู่บนหน้านี้พร้อมกับสถานะ **พร้อม** สถานะต่อไปนี้ได้รับการสนับสนุนในขณะนี้:

    - **พร้อม** – ถูกมอบหมายโดยอัตโนมัติสำหรับไฟล์ใหม่แต่ละไฟล์ในโฟลเดอร์ SharePoint สถานะนี้หมายความว่า ไฟล์พร้อมสำหรับการนำเข้า
    - **การนำเข้า** – กำหนดโดยอัตโนมัติโดยรายงาน ER เมื่อไฟล์จะถูกล็อคโดยกระบวนการนำเข้า เพื่อป้องกันการใช้งานโดยกระบวนการอื่นๆ (หากมีค่าหลายค่ากำลังเรียกใช้พร้อมกัน)
    - **นำเข้า** – กำหนดโดยอัตโนมัติตามรายงาน ER เมื่อการนำเข้าไฟล์เสร็จเรียบร้อยแล้ว สถานะนี้หมายความว่า ไฟล์ที่นำเข้าได้ถูกลบจากต้นทางไฟล์ที่ตั้งค่าคอนฟิก (โฟลเดอร์ SharePoint)
    - **ล้มเหลว** – กำหนดโดยอัตโนมัติตามการรายงาน ER เมื่อการนำเข้าไฟล์เสร็จเรียบร้อยโดยมีข้อผิดพลาดหรือข้อยกเว้น
    - **ระงับ** – กำหนดด้วยตนเองโดยผู้ใช้บนหน้านี้ สถานะนี้หมายความว่า จะไม่สามารถนำเข้าไฟล์ได้ในขณะนี้ สถานะนี้สามารถใช้เพื่อเลื่อนเวลาการนำเข้าไฟล์บางรายการ

    [![หน้าสถานะของไฟล์ ER ที่รีเฟรชสำหรับแหล่งที่มาที่เลือก](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)

## <a name="import-data-from-sharepoint-files"></a>นำเข้าข้อมูลจากแฟ้ม SharePoint
1. เปิดแผนภูมิการตั้งค่าคอนฟิก ER เลือก **แบบจำลองการชำระเงิน 1099** และขยายรายการของส่วนประกอบของแบบจำลอง ER
2. เลือกชื่อของการแมปแบบจำลองเพื่อเปิดรายการของการแมปแบบจำลองของการตั้งค่าคอนฟิกแบบจำลอง ER ที่เลือก

    [![หน้าการตั้งค่าคอนฟิก](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)

3. เลือก **เรียกใช้** เพื่อเรียกใช้การแมปแบบจำลองที่เลือก เนื่องจากคุณตั้งค่าคอนฟิกแหล่งที่มาของไฟล์สำหรับรูปแบบ ER คุณสามารถเปลี่ยนการตั้งค่าของตัวเลือก **แหล่งที่มาของไฟล์** ได้ หากจำเป็น ถ้าคุณเก็บการตั้งค่าของตัวเลือกนี้ ไฟล์ .xslx จะถูกนำเข้าจากต้นทางที่ตั้งค่าคอนฟิก (โฟลเดอร์ SharePoint ในตัวอย่างนี้)

    ในตัวอย่างนี้ คุณกำลังนำเข้าไฟล์เดียวเท่านั้น อย่างไรก็ตาม ถ้ามีไฟล์หลายไฟล์ จะมีการเลือกสำหรับการนำเข้าตามลำดับที่ซึ่งได้ถูกเพิ่มลงในโฟลเดอร์ SharePoint การเรียกใช้ทุกของครั้งของรูปแบบ ER จะนำเข้าไฟล์ที่เลือกไฟล์เดียว

    [![นำเข้าจาก SharePoint และเรียกใช้การแมปแบบจำลอง ER](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)

4. การแมปแบบจำลองสามารถเรียกใช้ [แบบอัตโนมัติ](#limitations) ได้ในโหมดชุดงาน ในกรณีนี้ ทุกครั้งที่ชุดงานเรียกใช้ในรูปแบบ ER นี้ ไฟล์เดียวจะถูกนำเข้าจากแหล่งที่มาของไฟล์ที่ตั้งค่าคอนฟิก

    เมื่อไฟล์ถูกนำเข้าเสร็จสมบูรณ์แล้วจากโฟลเดอร์ SharePoint จะมีการลบออกจากโฟลเดอร์นั้นและถูกย้ายไปยังโฟลเดอร์สำหรับไฟล์ที่นำเข้าสำเร็จ หรือไปยังไฟล์ที่นำเข้าพร้อมคำเตือน มิฉะนั้น จะมีการย้ายไปยังโฟลเดอร์สำหรับไฟล์ที่ล้มเหลว หรือยังคงอยู่ในโฟลเดอร์นี้ ถ้าไม่ได้ติดตั้งโฟลเดอร์สำหรับไฟล์ที่ล้มเหลว 

5. ป้อนรหัสใบสำคัญ เช่น **V-00001** และจากนั้น เลือก **ตกลง**

    [![เรียกใช้การแมปแบบจำลอง ER](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)

6. ในหน้า **สถานะของไฟล์สำหรับแหล่งที่มา** เลือก **รีเฟรช** เพื่อรีเฟรชหน้า

    [![หน้าสถานะของไฟล์ ER สำหรับแหล่งที่มา](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)

7. ในส่วน **ไฟล์** ตรวจทานรายการของไฟล์ ส่วน **ล็อกแหล่งที่มาสำหรับรูปแบบการนำเข้า** แสดงประวัติของการนำเข้าไฟล์ Excel เนื่องจากไฟล์นี้ถูกนำเข้าเสร็จสมบูรณ์ จะมีการทำเครื่องหมายเป็น **ลบแล้ว** ในโฟลเดอร์ SharePoint
8. ตรวจทานโฟลเดอร์ SharePoint ของ **ต้นทางการนำเข้าไฟล์ (หลัก)** ไฟล์ Excel ซึ่งถูกนำเข้าสำเร็จแล้ว ได้ถูกลบออกจากโฟลเดอร์นี้
9. เลือก **บัญชีเจ้าหนี้** \> **งานประจำงวด** \> **ภาษี 1099** \> **การชำระเงินให้แก่ผู้จัดจำหน่ายสำหรับ 1099**
10. ในฟิลด์ **วันที่เริ่มต้น** และ **วันที่สิ้นสุด** ป้อนค่าที่เหมาะสม จากนั้น เลือก **ธุรกรรม 1099 แบบกำหนดเอง**

    ธุรกรรมผู้จัดจำหน่ายที่ถูกนำเข้าจากไฟล์ Excel ใน SharePoint สำหรับใบสำคัญ **V-00001** ถูกแสดงบนหน้า

    [![หน้าธุรกรรมของผู้จัดจำหน่าย 1099](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)

## <a name="prepare-an-excel-file-for-import"></a>เตรียมไฟล์ Excel สำหรับการนำเข้า
1. เปิดไฟล์ Excel ที่คุณใช้ก่อนหน้านี้ ในแถว 3 คอลัมน์ 1 เพิ่มรหัสผู้จัดจำหน่ายที่ไม่มีอยู่ในแอปพลิเคชัน เพิ่มข้อมูลผู้จัดจำหน่ายที่เป็นเท็จเพิ่มเติมในแถว

    [![ไฟล์ Microsoft Excel ตัวอย่างสำหรับการนำเข้าจาก SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)

2. อัปโหลดไฟล์ Excel ที่ปรับปรุงที่ประกอบด้วยธุรกรรมผู้จัดจำหน่ายไปยังโฟลเดอร์ SharePoint ของ **ต้นทางการนำเข้าไฟล์ (หลัก)**
3. เปิดแผนภูมิการตั้งค่าคอนฟิก ER เลือก **แบบจำลองการชำระเงิน 1099** และขยายรายการของส่วนประกอบของแบบจำลอง ER
4. เลือกชื่อของการแมปแบบจำลองเพื่อปรับปรุงการแมปแบบจำลอง เพื่อให้รหัสผู้จัดจำหน่ายที่ไม่ถูกต้องถือเป็นข้อผิดพลาดในระหว่างกระบวนการนำเข้าข้อมูล
5. เลือก **ตัวออกแบบ**
6. บนแท็บ **การตรวจสอบ** คุณต้องเปลี่ยนการดำเนินการหลังการตรวจสอบสำหรับกฎการตรวจสอบที่ถูกตั้งค่าคอนฟิก เพื่อประเมินว่ามีบัญชีผู้จัดจำหน่ายที่ถูกนำเข้าอยู่ในแอปพลิเคชันหรือไม่ อัปเดตค่าของฟิลด์ **การดำเนินการหลังการตรวจสอบ** ไปยัง **หยุดดำเนินการ** บันทึกการเปลี่ยนแปลง และปิดหน้า

    [![หน้าตัวออกแบบการแมปแบบจำลอง ER](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)

7. บันทึกการเปลี่ยนแปลงของคุณ และปิดตัวออกแบบการแมปแบบจำลอง ER
8. เลือก **เรียกใช้** เพื่อเรียกใช้การแมปแบบจำลอง ER ที่ปรับเปลี่ยน
9. ป้อนรหัสใบสำคัญ เช่น **V-00002** และจากนั้น เลือก **ตกลง**

    Infolog ประกอบด้วยการแจ้งเตือนที่มีไฟล์ในโฟลเดอร์ SharePoint ที่ประกอบด้วยลูกค้าองค์กรของผู้จัดจำหน่ายที่ไม่ถูกต้อง และไม่สามารถนำเข้าได้

    [![เรียกใช้การแมปแบบจำลอง ER ที่เสร็จสมบูรณ์](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)

10. ในหน้า **สถานะของไฟล์สำหรับแหล่งที่มา** เลือก **รีเฟรช** และจากนั้น ในส่วน **ไฟล์** ตรวจทานรายการของไฟล์

    [![หน้าสถานะของไฟล์ ER สำหรับแหล่งที่มาที่เลือก](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)

   ส่วน **บันทึกต้นทางสำหรับรูปแบบการนำเข้า** บ่งชี้ว่า กระบวนการนำเข้าล้มเหลวและไฟล์อยู่ในโฟลเดอร์ SharePoint ของข้อผิดพลาดของไฟล์ (ไม่มีการเลือกกล่องกาเครื่องหมาย **ถูกลบ**) ถ้าคุณแก้ไขไฟล์ใน SharePoint โดยการเพิ่มรหัสผู้จัดจำหน่ายที่เหมาะสม และจากนั้น ย้ายไปยังโฟลเดอร์ SharePoint ต้นทางการนำเข้าไฟล์ (หลัก) คุณสามารถนำเข้าไฟล์ได้อีกครั้ง

11. เลือก **บัญชีเจ้าหนี้** \> **งานประจำงวด** \> **ภาษี 1099** \> **การชำระเงินของผู้จัดจำหน่ายสำหรับ 1099** ป้อนค่าที่ถูกต้องในฟิลด์ **วันที่เริ่มต้น** และ **วันที่สิ้นสุด** และจากนั้นเลือก **ธุรกรรม 1099 แบบกำหนดเอง**

    เฉพาะธุรกรรมสำหรับใบสำคัญ V-00001 จะพร้อมใช้งาน ไม่มีธุรกรรมสำหรับใบสำคัญ V-00002 ที่พร้อมใช้งาน แม้ว่าจะมีการพบข้อผิดพลาดสำหรับธุรกรรมการนำเข้าครั้งล่าสุดในไฟล์ Excel

## <a name=""></a><a name="limitations">การจำกัด</a>

ใน Dynamics 365 Finance รุ่นก่อน 10.0.25 ส่วนติดต่อผู้ใช้ (UI) ของกรอบงาน ER ไม่มีความสามารถในการเริ่มต้นชุดงานใหม่ที่จะดำเนินการแมปแบบจำลองในโหมดการทำงานอัตโนมัติสำหรับการนำเข้าข้อมูล เมื่อต้องการทำเช่นนี้ คุณต้องพัฒนาตรรกะใหม่เพื่อให้สามารถเรียกการแมปแบบจำลอง ER ที่ตั้งค่าคอนฟิกจากส่วนติดต่อ (UI) ของแอปพลิเคชันเพื่อนำเข้าข้อมูลจากไฟล์ขาเข้า เพื่อพัฒนาตรรกะนี้ ต้องมีงานวิศวกรรมบางอย่าง 

สำหรับข้อมูลเพิ่มเติมเกี่ยวกับ ER API ที่เกี่ยวข้อง ให้ดูที่ส่วน [โค้ดที่จะเรียกใช้การแมปรูปแบบสำหรับการนำเข้าข้อมูล](er-apis-app73.md#code-to-run-a-format-mapping-for-data-import) ในหัวข้อ [การเปลี่ยนแปลง API ของกรอบงาน ER สำหรับการปรับปรุงแอปพลิเคชัน 7.3](er-apis-app73.md) ตรวจทานรหัสในคลาส `BankImport_RU` ของแบบจำลอง `Application Suite` เพื่อดูว่าคุณสามารถใช้ตรรกะแบบกำหนดเองของคุณได้อย่างไร คลาส `BankImport_RU` นี้ขยายคลาส `RunBaseBatch` โดยเฉพาะอย่างยิ่ง ให้ตรวจสอบวิธีการ `runER()` ที่ออบเจ็กต์ `ERIModelMappingDestinationRun` มีการสร้างเป็นตัวเรียกใช้การแมปแบบจำลอง ER

ในการเงินรุ่น 10.0.25 และที่ใหม่กว่า UI กรอบงาน ER work UI ไม่มีความสามารถในการเริ่มต้นชุดงานใหม่ที่จะเรียกใช้การแมปแบบจำลองในโหมดการทำงานอัตโนมัติสำหรับการนำเข้าข้อมูล สำหรับข้อมูลเพิ่มเติมเกี่ยวกับกระบวนการนี้ โปรดดูที่ [นําเข้าข้อมูลในโหมดชุดงานจากไฟล์ที่เลือกด้วยตนเอง](er-configure-data-import-batch.md)

## <a name="additional-resources"></a>ทรัพยากรเพิ่มเติม

[ภาพรวมการรายงานทางอิเล็กทรอนิกส์](general-electronic-reporting.md)

[การเปลี่ยนแปลง API กรอบงาน ER สำหรับการอัปเดตแอปพลิเคชัน 7.3](er-apis-app73.md)

[การเปลี่ยนแปลง API กรอบงาน ER สำหรับการอัปเดตแอปพลิเคชัน 10.0.23](er-apis-app10-0-23.md)

[การเปลี่ยนแปลง API กรอบงาน ER สำหรับการอัปเดตแอปพลิเคชัน 10.0.25](er-apis-app10-0-25.md)



[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
