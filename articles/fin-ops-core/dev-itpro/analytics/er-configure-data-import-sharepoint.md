---
title: ตั้งค่าคอนฟิกการนำเข้าข้อมูลจาก SharePoint
description: หัวข้อนี้อธิบายวิธีการนำเข้าข้อมูลจาก Microsoft SharePoint
author: NickSelin
ms.date: 11/19/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: 582a59f72e0e59f58191aeb00a7605b0ea08b2d3
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 03/31/2021
ms.locfileid: "5753803"
---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="35152-103">ตั้งค่าคอนฟิกการนำเข้าข้อมูลจาก SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="35152-104">ในการนำเข้าข้อมูลจากไฟล์ขาเข้าโดยใช้กรอบงานการรายงานทางอิเล็กทรอนิกส์ (ER) คุณต้องตั้งค่าคอนฟิกรูปแบบ ER ที่สนับสนุนการนำเข้า แล้วจากนั้น รันการแม็ปแบบจำลองของชนิด **ปลายทาง** ที่ใช้รูปแบบนั้นเป็นแหล่งข้อมูล</span><span class="sxs-lookup"><span data-stu-id="35152-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="35152-105">ในการนำเข้าข้อมูล คุณต้องนำทางไปยังไฟล์ที่คุณต้องการนำเข้า</span><span class="sxs-lookup"><span data-stu-id="35152-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="35152-106">สามารถเลือกไฟล์ขาเข้าได้ด้วยตนเองโดยผู้ใช้</span><span class="sxs-lookup"><span data-stu-id="35152-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="35152-107">ด้วยความสามารถ ER ใหม่ในการสนับสนุนการนำเข้าข้อมูลจาก Microsoft SharePoint กระบวนการนี้ถูกตั้งค่าคอนฟิกเป็นแบบไม่ได้เข้าร่วม</span><span class="sxs-lookup"><span data-stu-id="35152-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as unattended.</span></span> <span data-ttu-id="35152-108">คุณสามารถใช้การตั้งค่าคอนฟิก ER เพื่อดำเนินการนำเข้าข้อมูลจากไฟล์ที่ถูกเก็บอยู่ในโฟลเดอร์ Microsoft SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="35152-109">หัวข้อนี้อธิบายวิธีทำให้การนำเข้าข้อมูลจาก SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-109">This topic explains how to complete the import from SharePoint.</span></span> <span data-ttu-id="35152-110">ตัวอย่างใช้ธุรกรรมผู้จัดจำหน่ายเป็นข้อมูลธุรกิจ</span><span class="sxs-lookup"><span data-stu-id="35152-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="35152-111">ข้อกำหนดเบื้องต้น</span><span class="sxs-lookup"><span data-stu-id="35152-111">Prerequisites</span></span>
<span data-ttu-id="35152-112">เพื่อทำตัวอย่างในหัวข้อนี้ให้เสร็จสมบูรณ์ คุณต้องมีการเข้าถึงต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="35152-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="35152-113">การเข้าถึงหนึ่งในบทบาทต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="35152-113">Access one of the following roles:</span></span>

    - <span data-ttu-id="35152-114">นักพัฒนาการรายงานทางอิเล็กทรอนิกส์</span><span class="sxs-lookup"><span data-stu-id="35152-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="35152-115">ที่ปรึกษาด้านการทำงานของการรายงานทางอิเล็กทรอนิกส์</span><span class="sxs-lookup"><span data-stu-id="35152-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="35152-116">ผู้ดูแลระบบ</span><span class="sxs-lookup"><span data-stu-id="35152-116">System administrator</span></span>

- <span data-ttu-id="35152-117">การเข้าถึงอินสแตนซ์ของ Microsoft SharePoint Server ที่ถูกตั้งค่าคอนฟิกสำหรับการใช้กับแอพลิเคชั่น</span><span class="sxs-lookup"><span data-stu-id="35152-117">Access to the instance of Microsoft SharePoint Server that is configured for use with the application.</span></span>
- <span data-ttu-id="35152-118">รูปแบบและการตั้งค่าคอนฟิกแบบจำลอง ER สำหรับการชำระเงิน 1099</span><span class="sxs-lookup"><span data-stu-id="35152-118">ER format and model configurations for 1099 payments.</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="35152-119">สร้างการตั้งค่าคอนฟิก ER ที่จำเป็น</span><span class="sxs-lookup"><span data-stu-id="35152-119">Create required ER configurations</span></span>
<span data-ttu-id="35152-120">เล่นคู่มืองาน **ER นำเข้าข้อมูลจากไฟล์ Microsoft Excel** ซึ่งเป็นส่วนหนึ่งของกระบวนการทางธุรกิจ **7.5.4.3 รับ/พัฒนาองค์ประกอบบริการ/โซลูชันด้าน IT (10677)**</span><span class="sxs-lookup"><span data-stu-id="35152-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="35152-121">คู่มืองานเหล่านี้นำคุณไปสู่กระบวนการของการออกแบบและการใช้การตั้งค่าคอนฟิก ER เพื่อนำเข้าธุรกรรมผู้จัดจำหน่ายจากไฟล์ Microsoft Excel ในระหว่างกัน</span><span class="sxs-lookup"><span data-stu-id="35152-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from Microsoft Excel files.</span></span> <span data-ttu-id="35152-122">สำหรับข้อมูลเพิ่มเติม ดู [แยกวิเคราะห์เอกสารขาเข้าในรูปแบบ Excel](parse-incoming-documents-excel.md)</span><span class="sxs-lookup"><span data-stu-id="35152-122">For more information, see [Parse incoming documents in Excel format](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="35152-123">หลังจากที่คุณเสร็จสิ้นคู่มืองาน คุณจะมีตั้งค่าต่อไปนี้</span><span class="sxs-lookup"><span data-stu-id="35152-123">After you have completed the task guides, you will have the following setup.</span></span>

#### <a name="er-configurations"></a><span data-ttu-id="35152-124">การตั้งค่าคอนฟิก ER</span><span class="sxs-lookup"><span data-stu-id="35152-124">ER configurations</span></span>

- <span data-ttu-id="35152-125">การตั้งค่าคอนฟิกแบบจำลอง ER **แบบจำลองการชำระเงิน 1099**</span><span class="sxs-lookup"><span data-stu-id="35152-125">ER model configuration, **1099 Payments model**</span></span>
- <span data-ttu-id="35152-126">การตั้งค่าคอนฟิกรูปแบบ ER **รูปแบบสำหรับการนำเข้าธุรกรรมของผู้จัดจำหน่ายจาก Excel**</span><span class="sxs-lookup"><span data-stu-id="35152-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

![การตั้งค่าคอนฟิก ER สำหรับการนำเข้าข้อมูลจาก SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)

#### <a name="sample-of-the-incoming-file-for-data-import"></a><span data-ttu-id="35152-128">ตัวอย่างของไฟล์ขาเข้าสำหรับการนำเข้าข้อมูล</span><span class="sxs-lookup"><span data-stu-id="35152-128">Sample of the incoming file for data import</span></span>

- <span data-ttu-id="35152-129">ไฟล์ Excel **1099import-data.xlsx** ที่มีธุรกรรมผู้จัดจำหน่ายที่ควรถูกนำเข้า</span><span class="sxs-lookup"><span data-stu-id="35152-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported.</span></span>

![ไฟล์ Excel ตัวอย่างสำหรับการนำเข้าจาก SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)
    
> [!NOTE]
> <span data-ttu-id="35152-131">รูปแบบสำหรับการนำเข้าธุรกรรมผู้จัดจำหน่ายถูกเลือกเป็นการแม็ปแบบจำลองเริ่มต้น</span><span class="sxs-lookup"><span data-stu-id="35152-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="35152-132">ดังนั้น ถ้าคุณรันการแม็ปแบบจำลองของ **แบบจำลองการชำระเงิน 1099** และการแม็ปแบบจำลองนั้นเป็นของชนิด **ไปยังปลายทาง** การแม็ปแบบจำลองจะรันรูปแบบนี้เพื่อนำเข้าข้อมูลจากไฟล์ภายนอก</span><span class="sxs-lookup"><span data-stu-id="35152-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="35152-133">จากนั้น จะใช้ข้อมูลดังกล่าวเพื่ออัพเดตตารางแอพลิเคชัน</span><span class="sxs-lookup"><span data-stu-id="35152-133">It then uses that data to update application tables.</span></span>

## <a name="configure-access-to-sharepoint-for-file-storage"></a><span data-ttu-id="35152-134">ตั้งค่าคอนฟิกการเข้าถึง SharePoint สำหรับที่เก็บไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-134">Configure access to SharePoint for file storage</span></span>
<span data-ttu-id="35152-135">เพื่อจัดเก็บไฟล์รายงานทางอิเล็กทรอนิกส์ในที่ตั้ง SharePoint คุณต้องตั้งค่าคอนฟิกการเข้าถึงไปยังอินสแตนซ์ SharePoint Server ที่จะถูกใช้โดยบริษัทปัจจุบัน</span><span class="sxs-lookup"><span data-stu-id="35152-135">To store electronic report files in a SharePoint location, you must configure access to the SharePoint Server instance that will be used by the current company.</span></span> <span data-ttu-id="35152-136">ในตัวอย่างนี้ บริษัทคือ USMF</span><span class="sxs-lookup"><span data-stu-id="35152-136">In this example, the company is USMF.</span></span> <span data-ttu-id="35152-137">สำหรับคำแนะนำ ดู [ตั้งค่าคอนฟิกที่จัดเก็บ SharePoint](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage)</span><span class="sxs-lookup"><span data-stu-id="35152-137">For instructions, see [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>

1. <span data-ttu-id="35152-138">ทำขั้นตอนต่างๆ ใน [ตั้งค่าคอนฟิกที่จัดเก็บ SharePoint](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage) ให้เสร็จเรียบร้อย</span><span class="sxs-lookup"><span data-stu-id="35152-138">Complete the steps in [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>
2. <span data-ttu-id="35152-139">เปิดไซต์ SharePoint ที่ตั้งค่าคอนฟิก</span><span class="sxs-lookup"><span data-stu-id="35152-139">Open the configured SharePoint site.</span></span>
3. <span data-ttu-id="35152-140">สร้างโฟลเดอร์ต่อไปนี้ที่ซึ่งสามารถจัดเก็บไฟล์การรายงานทางอิเล็กทรอนิกส์ขาเข้า:</span><span class="sxs-lookup"><span data-stu-id="35152-140">Create the following folders where incoming electronic reporting files can be stored:</span></span>

     - <span data-ttu-id="35152-141">ต้นทางการนำเข้าไฟล์ (หลัก) (ตัวอย่างที่แสดงในภาพหน้าจอด้านล่าง)</span><span class="sxs-lookup"><span data-stu-id="35152-141">Files import source (main) (Example shown in screenshot below)</span></span>
     - <span data-ttu-id="35152-142">ต้นทางการนำเข้าไฟล์ (สำรอง)</span><span class="sxs-lookup"><span data-stu-id="35152-142">Files import source (alternative)</span></span>

    ![ต้นทางการนำเข้าไฟล์ (หลัก)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)

4. <span data-ttu-id="35152-144">(ไม่จำเป็น) สร้างโฟลเดอร์ต่อไปนี้ที่ซึ่งสามารถจัดเก็บไฟล์ได้หลังจากการนำเข้า:</span><span class="sxs-lookup"><span data-stu-id="35152-144">(Optional) Create the following folders where the files can be stored after import.</span></span> 

    - <span data-ttu-id="35152-145">โฟลเดอร์ที่เก็บถาวรของไฟล์ - โฟลเดอร์นี้สำหรับไฟล์ที่นำเข้าเสร็จเรียบร้อยแล้ว</span><span class="sxs-lookup"><span data-stu-id="35152-145">Files archive folder - This folder would be for successfully imported files.</span></span>
    - <span data-ttu-id="35152-146">โฟลเดอร์คำเตือนของไฟล์ - โฟลเดอร์นี้สำหรับไฟล์ที่นำเข้าพร้อมคำเตือน</span><span class="sxs-lookup"><span data-stu-id="35152-146">Files warning folder - This folder would be for files that were imported with a warning.</span></span>
    - <span data-ttu-id="35152-147">โฟลเดอร์ข้อผิดพลาดของไฟล์ - โฟลเดอร์นี้สำหรับไฟล์ที่นำเข้าไม่สำเร็จ</span><span class="sxs-lookup"><span data-stu-id="35152-147">Files error folder - This folder would be for files that failed to import.</span></span>

4. <span data-ttu-id="35152-148">ไปที่ **การจัดการองค์กร > การจัดการเอกสาร > ชนิดของเอกสาร**</span><span class="sxs-lookup"><span data-stu-id="35152-148">Go to **Organization administration > Document management > Document types**.</span></span>
5. <span data-ttu-id="35152-149">สร้างชนิดเอกสารต่อไปนี้ที่จะถูกใช้เพื่อเข้าถึงโฟลเดอร์ SharePoint ที่คุณเพิ่งสร้าง</span><span class="sxs-lookup"><span data-stu-id="35152-149">Create the following document types that will be used to access the SharePoint folders that you created.</span></span> <span data-ttu-id="35152-150">สำหรับคำแนะนำ ดู [ตั้งค่าคอนฟิกชนิดเอกสาร](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types)</span><span class="sxs-lookup"><span data-stu-id="35152-150">For instructions, see [Configure document types](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types).</span></span>

|<span data-ttu-id="35152-151">ชนิดเอกสาร</span><span class="sxs-lookup"><span data-stu-id="35152-151">Document type</span></span>       | <span data-ttu-id="35152-152">กลุ่ม</span><span class="sxs-lookup"><span data-stu-id="35152-152">Group</span></span>              | <span data-ttu-id="35152-153">ที่ตั้ง</span><span class="sxs-lookup"><span data-stu-id="35152-153">Location</span></span>      | <span data-ttu-id="35152-154">โฟลเดอร์ SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-154">SharePoint folder</span></span>      |
|--------------------|--------------------|---------------|------------------------|
|<span data-ttu-id="35152-155">SP หลัก</span><span class="sxs-lookup"><span data-stu-id="35152-155">SP Main</span></span>             |<span data-ttu-id="35152-156">ไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-156">File</span></span>                |<span data-ttu-id="35152-157">SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-157">SharePoint</span></span>     |<span data-ttu-id="35152-158">ต้นทางการนำเข้าไฟล์ (หลัก)</span><span class="sxs-lookup"><span data-stu-id="35152-158">Files import source (main)</span></span>|
|<span data-ttu-id="35152-159">SP สำรอง</span><span class="sxs-lookup"><span data-stu-id="35152-159">SP Alternative</span></span>             |<span data-ttu-id="35152-160">ไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-160">File</span></span>                |<span data-ttu-id="35152-161">SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-161">SharePoint</span></span>     |<span data-ttu-id="35152-162">ต้นทางการนำเข้าไฟล์ (สำรอง)</span><span class="sxs-lookup"><span data-stu-id="35152-162">Files import source (alternative)</span></span>|
|<span data-ttu-id="35152-163">ที่เก็บถาวร SP</span><span class="sxs-lookup"><span data-stu-id="35152-163">SP Archive</span></span>             |<span data-ttu-id="35152-164">ไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-164">File</span></span>                |<span data-ttu-id="35152-165">SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-165">SharePoint</span></span>     |<span data-ttu-id="35152-166">โฟลเดอร์ที่เก็บถาวรของไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-166">Files archive folder</span></span>|
|<span data-ttu-id="35152-167">คำเตือน SP</span><span class="sxs-lookup"><span data-stu-id="35152-167">SP Warning</span></span>             |<span data-ttu-id="35152-168">ไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-168">File</span></span>                |<span data-ttu-id="35152-169">SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-169">SharePoint</span></span>     |<span data-ttu-id="35152-170">โฟลเดอร์คำเตือนของไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-170">Files warning folder</span></span>|
|<span data-ttu-id="35152-171">ข้อผิดพลาด SP</span><span class="sxs-lookup"><span data-stu-id="35152-171">SP Error</span></span>             |<span data-ttu-id="35152-172">ไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-172">File</span></span>                |<span data-ttu-id="35152-173">SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-173">SharePoint</span></span>     |<span data-ttu-id="35152-174">โฟลเดอร์ข้อฺผิดพลาดของไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-174">Files error folder</span></span>|

![การตั้งค่า SharePoint – ชนิดเอกสารใหม่](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="35152-176">ตั้งค่าคอนฟิกแหล่งที่มา ER สำหรับรูปแบบ ER</span><span class="sxs-lookup"><span data-stu-id="35152-176">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="35152-177">คลิก **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **แหล่งที่มาการรายงานทางอิเล็กทรอนิกส์**</span><span class="sxs-lookup"><span data-stu-id="35152-177">Click **Organization administration** \> **Electronic reporting** \> **Electronic reporting source**.</span></span>
2. <span data-ttu-id="35152-178">ในหน้า **แหล่งที่มาการรายงานทางอิเล็กทรอนิกส์** ตั้งค่าคอนฟิกไฟล์ต้นทางสำหรับการนำเข้าข้อมูล โดยใช้รูปแบบ ER ที่ตั้งค่าคอนฟิก</span><span class="sxs-lookup"><span data-stu-id="35152-178">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="35152-179">กำหนดตัวพรางชื่อไฟล์ เพื่อให้มีการนำเข้าเฉพาะไฟล์ที่มีนามสกุล .xlsx</span><span class="sxs-lookup"><span data-stu-id="35152-179">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="35152-180">ตัวพรางชื่อไฟล์ไม่จำเป็นต้องระบุ และจะใช้เฉพาะเมื่อมีการกำหนด</span><span class="sxs-lookup"><span data-stu-id="35152-180">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="35152-181">คุณสามารถกำหนดตัวพรางได้เพียงหนึ่งตัวเท่านั้นสำหรับรูปแบบ ER แต่ละแบบ</span><span class="sxs-lookup"><span data-stu-id="35152-181">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="35152-182">เปลี่ยน **จัดเรียงแฟ้มก่อนที่จะนำเข้า** เป็น **ไม่จัดเรียง** ถ้ามีล็อตของไฟล์สำหรับการนำเข้า และใบสั่งนำเข้าไม่ใช่สิ่งสำคัญ</span><span class="sxs-lookup"><span data-stu-id="35152-182">Change **Sort files before import** to **Do not sort**, if there are several files for import and the import order is not important</span></span>
5. <span data-ttu-id="35152-183">เลือกโฟลเดอร์ SharePoint ทั้งหมดที่คุณสร้างก่อนหน้า</span><span class="sxs-lookup"><span data-stu-id="35152-183">Select all SharePoint folders that you created earlier.</span></span>

    <span data-ttu-id="35152-184">[![การตั้งค่าแหล่งที่มาไฟล์ ER](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="35152-184">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
> - <span data-ttu-id="35152-185">มีการกำหนด *แหล่งที่มา* ER สำหรับบริษัทแอพลิเคชันแต่ละรายการ</span><span class="sxs-lookup"><span data-stu-id="35152-185">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="35152-186">ในทางตรงกันข้าม *การตั้งค่าคอนฟิก* ER จะถูกใช้ร่วมกันระหว่างบริษัท</span><span class="sxs-lookup"><span data-stu-id="35152-186">By contrast, ER *configurations* are shared across companies.</span></span>
> - <span data-ttu-id="35152-187">เมื่อคุณลบการตั้งค่าแหล่งที่มา ER สำหรับรูปแบบการ ER สถานะไฟล์ที่เชื่อมต่อทั้งหมด (ดูด้านล่าง) จะถูกลบออกด้วยเช่นกันโดยการยืนยัน</span><span class="sxs-lookup"><span data-stu-id="35152-187">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted by confirmation.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="35152-188">ตรวจทานสถานะของไฟล์สำหรับรูปแบบ ER</span><span class="sxs-lookup"><span data-stu-id="35152-188">Review the files states for the ER format</span></span>
1. <span data-ttu-id="35152-189">ในหน้า **แหล่งที่มาการรายงานทางอิเล็กทรอนิกส์** เลือก **สถานะของไฟล์สำหรับแหล่งที่มา** เพื่อตรวจทานเนื้อหาของแหล่งที่มาของไฟล์ที่ตั้งค่าคอนฟิกสำหรับรูปแบบ ER ปัจจุบัน</span><span class="sxs-lookup"><span data-stu-id="35152-189">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="35152-190">ในส่วน **ไฟล์** ตรวจทานรายการของไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-190">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="35152-191">รายการนี้แสดงต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="35152-191">This list presents the following:</span></span>

    - <span data-ttu-id="35152-192">ไฟล์ต้นทางที่เกี่ยวข้อง โดยขึ้นอยู่กับตัวพรางชื่อไฟล์ (ถ้ามีการกำหนดตัวพรางชื่อไฟล์) และที่พร้อมสำหรับการนำเข้าข้อมูล</span><span class="sxs-lookup"><span data-stu-id="35152-192">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="35152-193">สำหรับไฟล์เหล่านี้ ส่วน **ล็อกแหล่งที่มาสำหรับรูปแบบการนำเข้า** จะว่างเปล่า</span><span class="sxs-lookup"><span data-stu-id="35152-193">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="35152-194">ไฟล์ที่นำเข้าก่อนหน้านี้</span><span class="sxs-lookup"><span data-stu-id="35152-194">Previously imported files.</span></span> <span data-ttu-id="35152-195">สำหรับไฟล์เหล่านี้แต่ละไฟล์ ในส่วน **ล็อกแหล่งที่มาสำหรับรูปแบบการนำเข้า** คุณสามารถทบทวนประวัติของการนำเข้าไฟล์นี้ได้</span><span class="sxs-lookup"><span data-stu-id="35152-195">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="35152-196">คุณยังสามารถเปิดหน้า **สถานะของไฟล์สำหรับแหล่งที่มา** ได้ด้วยการเลือก **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **สถานะของไฟล์สำหรับแหล่งที่มา**</span><span class="sxs-lookup"><span data-stu-id="35152-196">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="35152-197">ในกรณีนี้ หน้าแสดงข้อมูลเกี่ยวกับแหล่งที่มาของไฟล์สำหรับรูปแบบ ER ทั้งหมด ที่แหล่งที่มาของไฟล์ได้ถูกตั้งค่าคอนฟิกสำหรับในบริษัทที่คุณกำลังลงชื่อเข้าใช้</span><span class="sxs-lookup"><span data-stu-id="35152-197">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="35152-198">นำเข้าข้อมูลจากไฟล์ Excel ที่อยู่ในโฟลเดอร์ SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-198">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="35152-199">ใน SharePoint อัปโหลดไฟล์ Microsoft Excel **1099import-data.xlsx** ที่ประกอบด้วยธุรกรรมผู้จัดจำหน่ายไปยังโฟลเดอร์ **ต้นทางการนำเข้าไฟล์ (หลัก)** SharePoint ที่คุณสร้างก่อนหน้า</span><span class="sxs-lookup"><span data-stu-id="35152-199">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

    <span data-ttu-id="35152-200">[![SharePoint เนื้อหา – ไฟล์ Microsoft Excel สำหรับการนำเข้า](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="35152-200">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="35152-201">ในหน้า **สถานะของไฟล์สำหรับแหล่งที่มา** เลือก **รีเฟรช** เพื่อรีเฟรชหน้า</span><span class="sxs-lookup"><span data-stu-id="35152-201">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="35152-202">ไฟล์ Excel ที่ถูกอัปโหลดไปยัง SharePoint ปรากฎอยู่บนหน้านี้พร้อมกับสถานะ **พร้อม**</span><span class="sxs-lookup"><span data-stu-id="35152-202">The Excel file that was uploaded to SharePoint appeared on this page with the status **Ready**.</span></span> <span data-ttu-id="35152-203">สถานะต่อไปนี้ได้รับการสนับสนุนในขณะนี้:</span><span class="sxs-lookup"><span data-stu-id="35152-203">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="35152-204">**พร้อม** – ถูกมอบหมายโดยอัตโนมัติสำหรับไฟล์ใหม่แต่ละไฟล์ในโฟลเดอร์ SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-204">**Ready** – Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="35152-205">สถานะนี้หมายความว่า ไฟล์พร้อมสำหรับการนำเข้า</span><span class="sxs-lookup"><span data-stu-id="35152-205">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="35152-206">**การนำเข้า** – กำหนดโดยอัตโนมัติโดยรายงาน ER เมื่อไฟล์จะถูกล็อคโดยกระบวนการนำเข้า เพื่อป้องกันการใช้งานโดยกระบวนการอื่นๆ (หากมีค่าหลายค่ากำลังรันพร้อมกัน)</span><span class="sxs-lookup"><span data-stu-id="35152-206">**Importing** – Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="35152-207">**นำเข้า** – กำหนดโดยอัตโนมัติตามรายงาน ER เมื่อการนำเข้าไฟล์เสร็จเรียบร้อยแล้ว</span><span class="sxs-lookup"><span data-stu-id="35152-207">**Imported** – Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="35152-208">สถานะนี้หมายความว่า ไฟล์ที่นำเข้าได้ถูกลบจากต้นทางไฟล์ที่ตั้งค่าคอนฟิก (โฟลเดอร์ SharePoint)</span><span class="sxs-lookup"><span data-stu-id="35152-208">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="35152-209">**ล้มเหลว** – กำหนดโดยอัตโนมัติตามการรายงาน ER เมื่อการนำเข้าไฟล์เสร็จเรียบร้อยโดยมีข้อผิดพลาดหรือข้อยกเว้น</span><span class="sxs-lookup"><span data-stu-id="35152-209">**Failed** – Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="35152-210">**ระงับ** – กำหนดด้วยตนเองโดยผู้ใช้บนหน้านี้</span><span class="sxs-lookup"><span data-stu-id="35152-210">**On hold** – Assigned manually by user on this page.</span></span> <span data-ttu-id="35152-211">สถานะนี้หมายความว่า จะไม่สามารถนำเข้าไฟล์ได้ในขณะนี้</span><span class="sxs-lookup"><span data-stu-id="35152-211">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="35152-212">สถานะนี้สามารถใช้เพื่อเลื่อนเวลาการนำเข้าไฟล์บางรายการ</span><span class="sxs-lookup"><span data-stu-id="35152-212">This status can be used to postpone the import of some files.</span></span>

    <span data-ttu-id="35152-213">[![หน้าสถานะของไฟล์ ER ที่รีเฟรชสำหรับแหล่งที่มาที่เลือก](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="35152-213">[![Refreshed ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="35152-214">นำเข้าข้อมูลจากแฟ้ม SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-214">Import data from SharePoint files</span></span>
1. <span data-ttu-id="35152-215">เปิดแผนภูมิการตั้งค่าคอนฟิก ER เลือก **แบบจำลองการชำระเงิน 1099** และขยายรายการของส่วนประกอบของแบบจำลอง ER</span><span class="sxs-lookup"><span data-stu-id="35152-215">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="35152-216">เลือกชื่อของการแม็ปแบบจำลองเพื่อเปิดรายการของการแม็ปแบบจำลองของการตั้งค่าคอนฟิกแบบจำลอง ER ที่เลือก</span><span class="sxs-lookup"><span data-stu-id="35152-216">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

    <span data-ttu-id="35152-217">[![หน้าการตั้งค่าคอนฟิก](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="35152-217">[![Configuration page](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="35152-218">เลือก **รัน** เพื่อรันการแม็ปแบบจำลองที่เลือก</span><span class="sxs-lookup"><span data-stu-id="35152-218">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="35152-219">เนื่องจากคุณตั้งค่าคอนฟิกแหล่งที่มาของไฟล์สำหรับรูปแบบ ER คุณสามารถเปลี่ยนการตั้งค่าของตัวเลือก **แหล่งที่มาของไฟล์** ได้ หากจำเป็น</span><span class="sxs-lookup"><span data-stu-id="35152-219">Because you configured file sources for the ER format, you can change the setting of the **File source** option, if needed.</span></span> <span data-ttu-id="35152-220">ถ้าคุณเก็บการตั้งค่าของตัวเลือกนี้ ไฟล์ .xslx จะถูกนำเข้าจากต้นทางที่ตั้งค่าคอนฟิก (โฟลเดอร์ SharePoint ในตัวอย่างนี้)</span><span class="sxs-lookup"><span data-stu-id="35152-220">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="35152-221">ในตัวอย่างนี้ คุณกำลังนำเข้าไฟล์เดียวเท่านั้น</span><span class="sxs-lookup"><span data-stu-id="35152-221">In this example, you're importing only one file.</span></span> <span data-ttu-id="35152-222">อย่างไรก็ตาม ถ้ามีไฟล์หลายไฟล์ จะมีการเลือกสำหรับการนำเข้าตามลำดับที่ซึ่งได้ถูกเพิ่มลงในโฟลเดอร์ SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-222">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="35152-223">การรันทุกของครั้งของรูปแบบ ER จะนำเข้าไฟล์ที่เลือกไฟล์เดียว</span><span class="sxs-lookup"><span data-stu-id="35152-223">Every run of an ER format imports a single selected file.</span></span>

    <span data-ttu-id="35152-224">[![นำเข้าจาก SharePoint และรันการแม็ปแบบจำลอง ER](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="35152-224">[![Import from SharePoint and run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="35152-225">การแม็ปแบบจำลองสามารถรัน [แบบอัตโนมัติ](#limitations) ได้ในโหมดชุดงาน</span><span class="sxs-lookup"><span data-stu-id="35152-225">The model mapping can run [unattended](#limitations) in batch mode.</span></span> <span data-ttu-id="35152-226">ในกรณีนี้ ทุกครั้งที่ชุดงานรันในรูปแบบ ER นี้ ไฟล์เดียวจะถูกนำเข้าจากแหล่งที่มาของไฟล์ที่ตั้งค่าคอนฟิก</span><span class="sxs-lookup"><span data-stu-id="35152-226">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span>

    <span data-ttu-id="35152-227">เมื่อไฟล์ถูกนำเข้าเสร็จสมบูรณ์แล้วจากโฟลเดอร์ SharePoint จะมีการลบออกจากโฟลเดอร์นั้นและถูกย้ายไปยังโฟลเดอร์สำหรับไฟล์ที่นำเข้าสำเร็จ หรือไปยังไฟล์ที่นำเข้าพร้อมคำเตือน</span><span class="sxs-lookup"><span data-stu-id="35152-227">When a file is successfully imported from the SharePoint folder, it's deleted from that folder and moved to folder for successful imported files or to the folder to imported files with warnings.</span></span> <span data-ttu-id="35152-228">มิฉะนั้น จะมีการย้ายไปยังโฟลเดอร์สำหรับไฟล์ที่ล้มเหลว หรือยังคงอยู่ในโฟลเดอร์นี้ ถ้าไม่ได้ติดตั้งโฟลเดอร์สำหรับไฟล์ที่ล้มเหลว</span><span class="sxs-lookup"><span data-stu-id="35152-228">Otherwise it's moved to folder for failed files or stays in this folder if the folder for failed files isn't set up.</span></span> 

5. <span data-ttu-id="35152-229">ป้อนรหัสใบสำคัญ เช่น **V-00001** และจากนั้น เลือก **ตกลง**</span><span class="sxs-lookup"><span data-stu-id="35152-229">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

    <span data-ttu-id="35152-230">[![รันการแม็ปแบบจำลอง ER](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="35152-230">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="35152-231">ในหน้า **สถานะของไฟล์สำหรับแหล่งที่มา** เลือก **รีเฟรช** เพื่อรีเฟรชหน้า</span><span class="sxs-lookup"><span data-stu-id="35152-231">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

    <span data-ttu-id="35152-232">[![หน้าสถานะของไฟล์ ER สำหรับแหล่งที่มา](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="35152-232">[![ER file states for the sources page](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="35152-233">ในส่วน **ไฟล์** ตรวจทานรายการของไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-233">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="35152-234">ส่วน **ล็อกแหล่งที่มาสำหรับรูปแบบการนำเข้า** แสดงประวัติของการนำเข้าไฟล์ Excel</span><span class="sxs-lookup"><span data-stu-id="35152-234">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="35152-235">เนื่องจากไฟล์นี้ถูกนำเข้าเสร็จสมบูรณ์ จะมีการทำเครื่องหมายเป็น **ลบแล้ว** ในโฟลเดอร์ SharePoint</span><span class="sxs-lookup"><span data-stu-id="35152-235">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="35152-236">ตรวจทานโฟลเดอร์ SharePoint ของ **ต้นทางการนำเข้าไฟล์ (หลัก)**</span><span class="sxs-lookup"><span data-stu-id="35152-236">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="35152-237">ไฟล์ Excel ซึ่งถูกนำเข้าสำเร็จแล้ว ได้ถูกลบออกจากโฟลเดอร์นี้</span><span class="sxs-lookup"><span data-stu-id="35152-237">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="35152-238">เลือก **บัญชีเจ้าหนี้** \> **งานประจำงวด** \> **ภาษี 1099** \> **การชำระเงินให้แก่ผู้จัดจำหน่ายสำหรับ 1099**</span><span class="sxs-lookup"><span data-stu-id="35152-238">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="35152-239">ในฟิลด์ **วันที่เริ่มต้น** และ **วันที่สิ้นสุด** ป้อนค่าที่เหมาะสม</span><span class="sxs-lookup"><span data-stu-id="35152-239">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="35152-240">จากนั้น เลือก **ธุรกรรม 1099 แบบกำหนดเอง**</span><span class="sxs-lookup"><span data-stu-id="35152-240">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="35152-241">ธุรกรรมผู้จัดจำหน่ายที่ถูกนำเข้าจากไฟล์ Excel ใน SharePoint สำหรับใบสำคัญ **V-00001** ถูกแสดงบนหน้า</span><span class="sxs-lookup"><span data-stu-id="35152-241">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

    <span data-ttu-id="35152-242">[![หน้าธุรกรรมของผู้จัดจำหน่าย 1099](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="35152-242">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="35152-243">เตรียมไฟล์ Excel สำหรับการนำเข้า</span><span class="sxs-lookup"><span data-stu-id="35152-243">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="35152-244">เปิดไฟล์ Excel ที่คุณใช้ก่อนหน้านี้</span><span class="sxs-lookup"><span data-stu-id="35152-244">Open the Excel file that you previously used.</span></span> <span data-ttu-id="35152-245">ในแถว 3 คอลัมน์ 1 เพิ่มรหัสผู้จัดจำหน่ายที่ไม่มีอยู่ในแอพลิเคชัน</span><span class="sxs-lookup"><span data-stu-id="35152-245">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="35152-246">เพิ่มข้อมูลผู้จัดจำหน่ายที่เป็นเท็จเพิ่มเติมในแถว</span><span class="sxs-lookup"><span data-stu-id="35152-246">Add additional false vendor information to the row.</span></span>

    <span data-ttu-id="35152-247">[![ไฟล์ Microsoft Excel ตัวอย่างสำหรับการนำเข้าจาก SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="35152-247">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="35152-248">อัปโหลดไฟล์ Excel ที่ปรับปรุงที่ประกอบด้วยธุรกรรมผู้จัดจำหน่ายไปยังโฟลเดอร์ SharePoint ของ **ต้นทางการนำเข้าไฟล์ (หลัก)**</span><span class="sxs-lookup"><span data-stu-id="35152-248">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="35152-249">เปิดแผนภูมิการตั้งค่าคอนฟิก ER เลือก **แบบจำลองการชำระเงิน 1099** และขยายรายการของส่วนประกอบของแบบจำลอง ER</span><span class="sxs-lookup"><span data-stu-id="35152-249">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="35152-250">เลือกชื่อของการแม็ปแบบจำลองเพื่อปรับปรุงการแม็ปแบบจำลอง เพื่อให้รหัสผู้จัดจำหน่ายที่ไม่ถูกต้องถือเป็นข้อผิดพลาดในระหว่างกระบวนการนำเข้าข้อมูล</span><span class="sxs-lookup"><span data-stu-id="35152-250">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="35152-251">เลือก **ตัวออกแบบ**</span><span class="sxs-lookup"><span data-stu-id="35152-251">Select **Designer**.</span></span>
6. <span data-ttu-id="35152-252">บนแท็บ **การตรวจสอบ** คุณต้องเปลี่ยนการดำเนินการหลังการตรวจสอบสำหรับกฎการตรวจสอบที่ถูกตั้งค่าคอนฟิก เพื่อประเมินว่ามีบัญชีผู้จัดจำหน่ายที่ถูกนำเข้าอยู่ในแอพลิเคชันหรือไม่</span><span class="sxs-lookup"><span data-stu-id="35152-252">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="35152-253">อัพเดตค่าของฟิลด์ **การดำเนินการหลังการตรวจสอบ** ไปยัง **หยุดดำเนินการ** บันทึกการเปลี่ยนแปลง และปิดหน้า</span><span class="sxs-lookup"><span data-stu-id="35152-253">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

    <span data-ttu-id="35152-254">[![หน้าตัวออกแบบการแม็ปแบบจำลอง ER](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="35152-254">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="35152-255">บันทึกการเปลี่ยนแปลงของคุณ และปิดตัวออกแบบการแม็ปแบบจำลอง ER</span><span class="sxs-lookup"><span data-stu-id="35152-255">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="35152-256">เลือก **รัน** เพื่อรันการแม็ปแบบจำลอง ER ที่ปรับเปลี่ยน</span><span class="sxs-lookup"><span data-stu-id="35152-256">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="35152-257">ป้อนรหัสใบสำคัญ เช่น **V-00002** และจากนั้น เลือก **ตกลง**</span><span class="sxs-lookup"><span data-stu-id="35152-257">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="35152-258">Infolog ประกอบด้วยการแจ้งเตือนที่มีไฟล์ในโฟลเดอร์ SharePoint ที่ประกอบด้วยลูกค้าองค์กรของผู้จัดจำหน่ายที่ไม่ถูกต้อง และไม่สามารถนำเข้าได้</span><span class="sxs-lookup"><span data-stu-id="35152-258">The Infolog contains a notification that there's a file in the SharePoint folder that contains incorrect vendor account and can’t be imported.</span></span>

    <span data-ttu-id="35152-259">[![รันการแม็ปแบบจำลอง ER ที่เสร็จสมบูรณ์](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="35152-259">[![Finished Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="35152-260">ในหน้า **สถานะของไฟล์สำหรับแหล่งที่มา** เลือก **รีเฟรช** และจากนั้น ในส่วน **ไฟล์** ตรวจทานรายการของไฟล์</span><span class="sxs-lookup"><span data-stu-id="35152-260">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

    <span data-ttu-id="35152-261">[![หน้าสถานะของไฟล์ ER สำหรับแหล่งที่มาที่เลือก](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="35152-261">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

   <span data-ttu-id="35152-262">ส่วน **บันทึกต้นทางสำหรับรูปแบบการนำเข้า** บ่งชี้ว่า กระบวนการนำเข้าล้มเหลวและไฟล์อยู่ในโฟลเดอร์ SharePoint ของข้อผิดพลาดของไฟล์ (ไม่มีการเลือกกล่องกาเครื่องหมาย **ถูกลบ**)</span><span class="sxs-lookup"><span data-stu-id="35152-262">The **Sources log for the import format** section indicates that the import process failed and that the file is in the Files error SharePoint folder (the **Is deleted** check box is not selected).</span></span> <span data-ttu-id="35152-263">ถ้าคุณแก้ไขไฟล์ใน SharePoint โดยการเพิ่มรหัสผู้จัดจำหน่ายที่เหมาะสม และจากนั้น ย้ายไปยังโฟลเดอร์ SharePoint ต้นทางการนำเข้าไฟล์ (หลัก) คุณสามารถนำเข้าไฟล์ได้อีกครั้ง</span><span class="sxs-lookup"><span data-stu-id="35152-263">If you fix this file on SharePoint by adding the proper vendor code and then move it to the Files import source (main) SharePoint folder, you can import the file again.</span></span>

11. <span data-ttu-id="35152-264">เลือก **บัญชีเจ้าหนี้** \> **งานประจำงวด** \> **ภาษี 1099** \> **การชำระเงินของผู้จัดจำหน่ายสำหรับ 1099** ป้อนค่าที่ถูกต้องในฟิลด์ **วันที่เริ่มต้น** และ **วันที่สิ้นสุด** และจากนั้นเลือก **ธุรกรรม 1099 แบบกำหนดเอง**</span><span class="sxs-lookup"><span data-stu-id="35152-264">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="35152-265">เฉพาะธุรกรรมสำหรับใบสำคัญ V-00001 จะพร้อมใช้งาน</span><span class="sxs-lookup"><span data-stu-id="35152-265">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="35152-266">ไม่มีธุรกรรมสำหรับใบสำคัญ V-00002 ที่พร้อมใช้งาน แม้ว่าจะมีการพบข้อผิดพลาดสำหรับธุรกรรมการนำเข้าครั้งล่าสุดในไฟล์ Excel</span><span class="sxs-lookup"><span data-stu-id="35152-266">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>

## <a name=""></a><span data-ttu-id="35152-267"><a name="limitations">การจำกัด</a></span><span class="sxs-lookup"><span data-stu-id="35152-267"><a name="limitations">Limitations</a></span></span>

<span data-ttu-id="35152-268">กรอบงาน ER ไม่มีความสามารถในการเริ่มต้นชุดงานใหม่ที่จะดำเนินการแม็ปแบบจำลองในโหมดการทำงานอัตโนมัติสำหรับการนำเข้าข้อมูล</span><span class="sxs-lookup"><span data-stu-id="35152-268">The ER framework doesn't offer the capability to initiate a new batch job that will execute a model mapping in unattended mode for data import.</span></span> <span data-ttu-id="35152-269">เมื่อต้องการทำเช่นนี้ คุณต้องพัฒนาตรรกะใหม่เพื่อให้สามารถเรียกการแม็ปแบบจำลอง ER ที่ตั้งค่าคอนฟิกจากอินเทอร์เฟสผู้ใช้โปรแกรมประยุกต์ (UI) เพื่อนำเข้าข้อมูลจากไฟล์ขาเข้า</span><span class="sxs-lookup"><span data-stu-id="35152-269">To do this, you must develop new logic so that the configured ER model mapping can be called from the application user interface (UI) to import data from inbound files.</span></span> <span data-ttu-id="35152-270">ดังนั้น จึงจำเป็นต้องใช้งานวิศวกรรมบางส่วน</span><span class="sxs-lookup"><span data-stu-id="35152-270">Therefore, some engineering work is required.</span></span> 

<span data-ttu-id="35152-271">เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับ ER API ที่เกี่ยวข้อง ให้ดูที่ส่วน [รหัสที่จะรันการแม็ปรูปแบบสำหรับการนำเข้าข้อมูล](er-apis-app73.md#code-to-run-a-format-mapping-for-data-import) ในหัวข้อ [การเปลี่ยนแปลง API ของกรอบงาน ER สำหรับการปรับปรุงโปรแกรมประยุกต์ 7.3](er-apis-app73.md)</span><span class="sxs-lookup"><span data-stu-id="35152-271">To learn more about the relevant ER API, see the [Code to run a format mapping for data import](er-apis-app73.md#code-to-run-a-format-mapping-for-data-import) section in the [ER framework API changes for Application update 7.3](er-apis-app73.md) topic.</span></span>

<span data-ttu-id="35152-272">ตรวจทานรหัสในคลาส `BankImport_RU` ของแบบจำลอง `Application Suite` เพื่อดูว่าคุณสามารถใช้ตรรกะแบบกำหนดเองของคุณได้อย่างไร</span><span class="sxs-lookup"><span data-stu-id="35152-272">Review the code in the `BankImport_RU` class of the `Application Suite` model to see how your custom logic can be implemented.</span></span> <span data-ttu-id="35152-273">คลาสนี้ขยายคลาส `RunBaseBatch`</span><span class="sxs-lookup"><span data-stu-id="35152-273">This class extends the `RunBaseBatch` class.</span></span> <span data-ttu-id="35152-274">โดยเฉพาะอย่างยิ่ง ให้ตรวจสอบวิธีการ `runER()` ที่ออบเจ็กต์ `ERIModelMappingDestinationRun` มีการสร้างเป็นตัวเรียกใช้การแม็ปแบบจำลอง ER</span><span class="sxs-lookup"><span data-stu-id="35152-274">In particular, review the `runER()` method where the `ERIModelMappingDestinationRun` object is created as the runner of an ER model mapping.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="35152-275">ทรัพยากรเพิ่มเติม</span><span class="sxs-lookup"><span data-stu-id="35152-275">Additional resources</span></span>

[<span data-ttu-id="35152-276">ภาพรวมการรายงานทางอิเล็กทรอนิกส์</span><span class="sxs-lookup"><span data-stu-id="35152-276">Electronic Reporting overview</span></span>](general-electronic-reporting.md)

[<span data-ttu-id="35152-277">การเปลี่ยนแปลง API กรอบงาน ER สำหรับ Application update 7.3</span><span class="sxs-lookup"><span data-stu-id="35152-277">ER framework API changes for Application update 7.3</span></span>](er-apis-app73.md)



[!INCLUDE[footer-include](../../../includes/footer-banner.md)]