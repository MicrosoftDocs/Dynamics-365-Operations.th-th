---
title: จัดกลุ่มเรกคอร์ดและการคํานวณค่ารวมโดยใช้แหล่งข้อมูล GROUPBY
description: หัวข้อนี้อธิบายวิธีการที่คุณสามารถใช้แหล่งข้อมูลชนิด GROUPBY ในการรายงานทางอิเล็กทรอนิกส์ (ER)
author: NickSelin
ms.date: 01/31/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERModelMappingDesigner, EROperationDesigner
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 5a6cdc486c5f799bdedafa38e90be989fd328c96
ms.sourcegitcommit: 89655f832e722cefbf796a95db10c25784cc2e8e
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 01/31/2022
ms.locfileid: "8075646"
---
# <a name="group-records-and-aggregate-calculations-by-using-groupby-data-sources"></a>จัดกลุ่มเรกคอร์ดและการคํานวณค่ารวมโดยใช้แหล่งข้อมูล GROUPBY

[!include[banner](../includes/banner.md)]

[!include[banner](../includes/preview-banner.md)]

เมื่อคุณตั้งค่าคอนฟิกการแมปแบบจำลองหรือรูปแบบ [การรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md) คุณสามารถ [เพิ่ม](#AddMmDataSource2) แหล่งข้อมูลที่ต้องการจากชนิด **GroupBy** ได้

ในเวลาออกแบบ แหล่งข้อมูล **GroupBy** มีการตั้งค่าคอนฟิกให้ระบุองค์ประกอบต่อไปนี้

- [แหล่งข้อมูลพื้นฐาน](#BaseDataSource) ที่มีเรกคอร์ดที่จะถูกจัดกลุ่มขณะรันไทม์
- [ฟิลด์การจัดกลุ่ม](#GroupingFields) ของแหล่งข้อมูลพื้นฐานซึ่งจะใช้ในการจัดกลุ่มเรกคอร์ดขณะรันไทม์
- [ฟังก์ชันรวม](#AggregateFunctions) ที่ระบุการคํานวณค่ารวมที่จะทำสำหรับแต่ละกลุ่มที่ค้นหาขณะรันไทม์

ขณะรันไทม์ แหล่งข้อมูล **GroupBy** ที่ตั้งค่าคอนฟิกจะจัดกลุ่มเรกคอร์ดที่มีค่าเดียวกันในฟิลด์การจัดกลุ่ม แล้วส่งคืนรายการเรกคอร์ด แต่ละเรกคอร์ดแสดงกลุ่มเพียงกลุ่มเดียว สำหรับแต่ละกลุ่ม แหล่งข้อมูลจะแสดงค่าฟิลด์ที่เรกคอร์ดเริ่มต้นจัดกลุ่มตาม ค่าของฟังก์ชันค่ารวมที่คํานวณได้และรายการของเรกคอร์ดของแหล่งข้อมูลพื้นฐานที่จัดอยู่ในกลุ่ม

## <a name="aggregate-functions"></a><a name="AggregateFunctions"></a>ฟังก์ชันค่ารวม

ขณะรันไทม์ การคํานวณค่ารวมทั้งหมดจะดำเนินการกับกลุ่มเรกคอร์ดแต่ละกลุ่ม คํานวณนี้ดำเนินการโดยใช้ค่าของฟิลด์เดียวหรือนิพจน์ในเรกคอร์ดของแหล่งข้อมูลที่เลือกสำหรับการจัดกลุ่มในแหล่งข้อมูลที่แก้ไขได้ที่เป็นชนิด **GroupBy** ขณะนี้ระบบสนับสนุนฟังก์ชันค่ารวมต่อไปนี้:

- **AVG** – ฟังก์ชันนี้จะส่งคืนค่าเฉลี่ยของค่าในกลุ่ม โดยสามารถใช้ได้กับฟิลด์ตัวเลขเท่านั้น
- **COUNT** – ฟังก์ชันนี้จะส่งคืนจํานวนของรายการที่พบในกลุ่ม
- **Min** – ฟังก์ชันนี้จะส่งคืนค่าต่ำสุดของค่าในกลุ่ม
- **Max** – ฟังก์ชันนี้จะส่งคืนค่าสูงสุดของค่าในกลุ่ม
- **SUM** – ฟังก์ชันนี้จะส่งคืนผลรวมของค่าทั้งหมดในกลุ่ม โดยสามารถใช้ได้กับฟิลด์ตัวเลขเท่านั้น

## <a name="execution-location"></a><a name="ExecutionLocation"></a>สถานที่การดำเนินการ

เมื่อคุณแก้ไขแหล่งข้อมูล **GroupBy** และระบุแหล่งข้อมูลพื้นฐานที่มีเรกคอร์ดที่ต้องจัดกลุ่ม ระบบจะตรวจสอบ [ตำแหน่ง](#ExecutionLocation) ที่มีประสิทธิภาพมากที่สุดในการดำเนินการของแหล่งข้อมูล **GroupBy** นั้น ถ้าแหล่งข้อมูลพื้นฐานเป็นแบบ [สามารถสอบถามได้](er-functions-list-filter.md#usage-notes) (นั่นคือถ้าสามารถเรียกใช้ได้ในระดับฐานข้อมูล) ฐานข้อมูลแอปพลิเคชันจะถูกระบุเป็นตำแหน่งการดำเนินการของแหล่งข้อมูล **GroupBy** ที่แก้ไขได้ด้วย หรือหน่วยความจําของแอปพลิเคชันเซิร์ฟเวอร์ถูกระบุเป็นตำแหน่งการดำเนินการ

คุณสามารถเปลี่ยนตำแหน่งการดำเนินการที่ตรวจพบโดยอัตโนมัติด้วยตนเองได้โดยการเลือกตำแหน่งที่สามารถใช้ได้กับแหล่งข้อมูลที่ตั้งค่าคอนฟิก หากตำแหน่งการดำเนินการที่เลือกไม่สามารถใช้ได้ จะมีการส่ง [ข้อผิดพลาดการตรวจสอบ](er-components-inspections.md#i5) ในเวลาออกแบบ

> [!TIP]
> ขอแนะให้ใช้ตำแหน่งฐานข้อมูลเพื่อจัดกลุ่มแหล่งข้อมูลที่แสดงถึงเรกคอร์ดจํานวนมาก

## <a name="memory-consumption"></a><a name="MemoryConsumption"></a>ปริมาณการใช้หน่วยความจํา

ตามค่าเริ่มต้น ถ้าแหล่งข้อมูล **GroupBy** ทำงานในหน่วยความจํา หน่วยความจําของแอปพลิเคชันเซิร์ฟเวอร์จะถูกใช้ในการจัดเก็บเรกคอร์ดของแหล่งข้อมูลพื้นฐานที่เป็นของกลุ่มแต่ละกลุ่มที่ค้นหาโดยเป็นเรกคอร์ดของกลุ่มเดียว หากต้องการลดปริมาณการใช้หน่วยความจํา คุณสามารถระงับการจัดเก็บเรกคอร์ดของแหล่งข้อมูล **GroupBy** ได้ หากมีการตั้งค่าคอนฟิกให้ใช้ฟังก์ชันที่รวมไว้เท่านั้น และไม่ได้ใช้เรกคอร์ดของกลุ่มขณะรันไทม์ เมื่อต้องการลดปริมาณการใช้หน่วยความจําด้วยวิธีนี้ ให้เปิดใช้งานคุณลักษณะ **ลดการใช้หน่วยความจําใน ER เมื่อการจัดกลุ่มเรกคอร์ดใช้เพื่อคำนวณค่ารวมเท่านั้น** ในพื้นที่ทำงาน **การจัดการคุณลักษณะ**

## <a name="alternatives"></a><a name="Alternatives"></a>วิธีการอื่น

ค่ารวมที่คล้ายกันสามารถคำนวณโดยใช้ชนิดของแหล่งข้อมูล [อื่น](er-data-collection-data-sources.md#if-i-have-to-calculate-running-totals-and-collect-data-what-is-the-difference-between-using-a-data-collection-data-source-and-using-the-built-in-data-collection-functions) หรือฟังก์ชันในตัวของ ER

เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับคุณลักษณะนี้ ให้ดำเนินการตัวอย่างต่อไปนี้ให้เสร็จสมบูรณ์

## <a name="example-use-a-groupby-data-source-for-aggregate-calculations-and-record-grouping"></a><a name="Example"></a>ตัวอย่าง: ใช้แหล่งข้อมูล GROUPBY สำหรับการคำนวณค่ารวมและการจัดกลุ่มเรกคอร์ด

ตัวอย่างนี้แสดงวิธีการที่ผู้ใช้ในบทบาทที่ปรึกษาด้านการทำงานของผู้ดูแลระบบหรือการรายงานทางอิเล็กทรอนิกส์สามารถตั้งค่าคอนฟิกการแมปแบบจำลอง ER ที่มีแหล่งข้อมูล **GROUPBY** ที่ใช้ในการคํานวณฟังก์ชันค่ารวมและจัดกลุ่มเรกคอร์ด การแมปแบบจำลองนี้ใช้ในการพิมพ์รายงานการควบคุมเมื่อสร้างการรายงานภาษีอินทราสแทต รายงานดังกล่าวช่วยคุณในการตรวจสอบธุรกรรมอินทราสแทตที่รายงานแล้ว

กระบวนงานในตัวอย่างนี้สามารถดำเนินงานให้เสร็จสมบูรณ์ได้ในบริษัท **DEMF** ใน Microsoft Dynamics 365 Finance 

### <a name="prepare-sample-data"></a>จัดเตรียมข้อมูลตัวอย่าง

ตรวจสอบให้แน่ใจว่าคุณมีธุรกรรมอินทราสแทตเพื่อการรายงานบนหน้า **อินทราสแทต** คุณต้องมีธุรกรรมสำหรับรหัสการส่งผ่านต่างๆ เนื่องจากคุณจะจัดกลุ่มธุรกรรมตามฟิลด์ **ส่งผ่าน** ในตัวอย่างนี้

![การจัดเตรียมธุรกรรมอินทราสแทตบนหน้าอินทราสแทต](./media/er-groupby-data-sources-prepare-transactions.png)

### <a name="configure-the-er-framework"></a>ตั้งค่าคอนฟิกกรอบงาน ER

ปฏิบัติตามขั้นตอนใน [ตั้งค่าคอนฟิกกรอบงาน ER](er-quick-start2-customize-report.md#ConfigureFramework) เพื่อตั้งค่าชุดที่น้อยที่สุดของพารามิเตอร์ ER คุณต้องเสร็จสิ้นการตั้งค่านี้ก่อนที่คุณจะเริ่มใช้กรอบงาน ER เพื่อออกแบบการแมปแบบจำลอง ER

### <a name="import-the-standard-er-format-configuration"></a>นำเข้าไฟล์การตั้งค่าคอนฟิกรูปแบบ ER มาตรฐาน

ปฏิบัติตามขั้นตอนใน [นําเข้าการตั้งค่าคอนฟิกรูปแบบ ER มาตรฐาน](er-quick-start2-customize-report.md#ImportERSolution1) เพื่อเพิ่มการตั้งค่าคอนฟิก ER มาตรฐานลงในอินสแตนซ์ Dynamics 365 Finance ปัจจุบันของคุณ นําเข้ารุ่น 1 ของการตั้งค่าคอนฟิก **แบบจำลองอินทราสแทต** จากที่เก็บ

### <a name="create-a-custom-data-model-configuration"></a>สร้างการตั้งค่าคอนฟิกแบบจำลองข้อมูลที่กำหนดเอง

ปฏิบัติตามขั้นตอนใน [เพิ่มการตั้งค่าคอนฟิกแบบจำลองข้อมูลที่กำหนดเอง](er-quick-start3-customize-report.md#add-a-custom-data-model-configuration) เพื่อเพิ่มการตั้งค่าคอนฟิกแบบจำลองข้อมูล ER ใหม่ของ **แบบจำลองอินทราสแทต (Litware)** ที่คุณรับมาจากการตั้งค่าคอนฟิก **แบบจำลองอินทราสแทต** ที่นำเข้าด้วยตนเอง

### <a name="configure-a-custom-data-model-component"></a>ตั้งค่าคอนฟิกส่วนประกอบแบบจำลองข้อมูลที่กำหนดเอง

ปฏิบัติตามขั้นตอนเหล่านี้เพื่อเปลี่ยนแปลงแบบจำลองข้อมูลสำหรับ **แบบจำลองอินทราสแทต (Litware)** ที่รับมาตามที่จำเป็น เพื่อให้สามารถใช้แสดงรหัสการส่งผ่านที่มีรายละเอียดที่ต้องการได้

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. บนหน้า **การตั้งค่าคอนฟิก** ในแผนผังการตั้งค่าคอนฟิก ให้เลือก **แบบจำลองอินทราสแทต (Litware)**
3. เลือก **ตัวออกแบบ**
4. บนหน้า **ตัวออกแบบแบบจำลองข้อมูล** ในแผนผังแบบจำลอง ให้เลือก **อินทราสแทต**
5. เลือก **สร้าง** เพื่อเพิ่มโหนดที่ซ้อนกันใหม่ให้กับโหนด **อินทราสแทต** ที่เลือก ในกล่องโต้ตอบแบบหล่นลงสำหรับการเพิ่มโหนดแบบจำลองข้อมูล ให้ทำตามขั้นตอนต่อไปนี้:

    1. ในฟิลด์ **ชื่อ** ให้ป้อน **การส่งผ่าน**
    2. ในฟิลด์ **ประเภทรายการ** ให้เลือก **รายการเรกคอร์ด**
    3. เลือก **เพิ่ม** เพื่อเพิ่มโหนดใหม่

6. เลือก **ใหม่** เพื่อเพิ่มโหนดที่ซ้อนกันใหม่สำหรับโหนด **การส่งผ่าน** ที่คุณเพิ่งเพิ่ม ในกล่องโต้ตอบแบบหล่นลงสำหรับการเพิ่มโหนดแบบจำลองข้อมูล ให้ทำตามขั้นตอนต่อไปนี้:

    1. ในฟิลด์ **ชื่อ** ให้ป้อน **รหัส**
    2. ในฟิลด์ **ประเภทรายการ** ให้เลือก **สตริง**
    3. เลือก **เพิ่ม** เพื่อเพิ่มโหนดใหม่

7. เลือก **ใหม่** เพื่อเพิ่มโหนดที่ซ้อนกันใหม่รายการอื่นสำหรับโหนด **การส่งผ่าน** ในกล่องโต้ตอบแบบหล่นลงสำหรับการเพิ่มโหนดแบบจำลองข้อมูล ให้ทำตามขั้นตอนต่อไปนี้:

    1. ในฟิลด์ **ชื่อ** ให้ป้อน **TotalInvoicedAmount**
    2. ในฟิลด์ **ประเภทรายการ** ให้เลือก **จำนวนจริง**
    3. เลือก **เพิ่ม** เพื่อเพิ่มโหนดใหม่

8. เลือก **ใหม่** เพื่อเพิ่มโหนดที่ซ้อนกันใหม่รายการอื่นสำหรับโหนด **การส่งผ่าน** ในกล่องโต้ตอบแบบหล่นลงสำหรับการเพิ่มโหนดแบบจำลองข้อมูล ให้ทำตามขั้นตอนต่อไปนี้:

    1. ในฟิลด์ **ชื่อ** ให้ป้อน **NumberOfTransactions**
    2. ในฟิลด์ **ประเภทสินค้า** ให้เลือก **จำนวนเต็ม**
    3. เลือก **เพิ่ม** เพื่อเพิ่มโหนดใหม่

9. เลือก **ใหม่** เพื่อเพิ่มโหนดที่ซ้อนกันใหม่รายการอื่นสำหรับโหนด **การส่งผ่าน** ในกล่องโต้ตอบแบบหล่นลงสำหรับการเพิ่มโหนดแบบจำลองข้อมูล ให้ทำตามขั้นตอนต่อไปนี้:

    1. ในฟิลด์ **ชื่อ** ป้อน **ธุรกรรม**
    2. ในฟิลด์ **ประเภทรายการ** ให้เลือก **รายการเรกคอร์ด**
    3. เลือก **เพิ่ม** เพื่อเพิ่มโหนดใหม่

10. สำหรับโหนด **ธุรกรรม** ที่คุณเพิ่งเพิ่ม บนแท็บด่วน **โหนด** ให้เลือก **สลับการอ้างอิงรายการ**
11. ในกล่องโต้ตอบ **สลับการอ้างอิงรายการ** ในแผนผังแบบจำลองข้อมูล ให้เลือก **CommodityRecord** จากนั้น เลือก **ตกลง**

![แบบจำลองข้อมูลที่ตั้งค่าคอนฟิกในตัวออกแบบแบบจำลองข้อมูล ER](./media/er-groupby-data-sources-configure-data-model.png)

### <a name="complete-the-design-of-a-custom-data-model"></a>ออกแบบแบบจำลองข้อมูลที่กำหนดเองให้เสร็จสมบูรณ์

ปฏิบัติตามขั้นตอนใน [ออกแบบแบบจำลองข้อมูลที่กำหนดเองให้เสร็จสมบูรณ์l](er-quick-start3-customize-report.md#add-a-custom-data-model-configuration) เพื่อทำการออกแบบแบบจำลองข้อมูลของ **แบบจำลองอินทราสแทต (Litware)** ที่รับมา

### <a name="create-a-new-model-mapping-configuration"></a>สร้างการตั้งค่าคอนฟิกการแมปแบบจำลองใหม่

ปฏิบัติตามขั้นตอนใน [สร้างการตั้งค่าคอนฟิกการแมปแบบจำลองข้อมูลใหม่](er-quick-start1-new-solution.md#CreateModelMapping) เพื่อเพิ่มการตั้งค่าคอนฟิกการแมปแบบจำลอง ER ใหม่ของ **การแมปตัวอย่างอินทราสแทต** ด้วยตนเองสำหรับการตั้งค่าคอนฟิก **แบบจำลองอินทราสแทต (Litware)** ที่รับมา

### <a name="add-a-new-model-mapping-component"></a>เพิ่มส่วนประกอบการแมปแบบจำลองใหม่

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. บนหน้า **การตั้งค่าคอนฟิก** ในแผนผังการตั้งค่าคอนฟิก ขยายการตั้งค่าคอนฟิก **แบบจำลองอินทราสแทต**
3. เลือกการตั้งค่าคอนฟิก **การแมปตัวอย่างอินทราสแทต**
4. เลือก **ตัวออกแบบ** เพื่อเปิดรายการของการแมป
5. เลือก **ลบ** เพื่อลบส่วนประกอบการแมปที่มีอยู่
6. เลือก **ใหม่** เพื่อเพิ่มส่วนประกอบการแมปใหม่
7. ในฟิลด์ **คำนิยาม** ให้เลือก **อินทราสแทต**
8. ในฟิลด์ **ชื่อ** ให้ป้อน **การแมปอินทราสแทต**
9. เลือก **ตัวออกแบบ** เพื่อตั้งค่าคอนฟิกการแมปใหม่

### <a name="design-the-added-model-mapping-component"></a>ออกแบบส่วนประกอบการแมปแบบจำลองที่เพิ่ม

#### <a name="add-a-data-source-to-access-an-application-table"></a><a name="AddMmDataSource1"></a>เพิ่มแหล่งข้อมูลที่จะเข้าถึงตารางแอปพลิเคชัน

ตั้งค่าคอนฟิกแหล่งข้อมูลที่จะเข้าถึงตารางแอปพลิเคชันที่มีรายละเอียดของธุรกรรมอินทราสแทต

1. บนหน้า **ตัวออกแบบการแมปแบบจำลอง** ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **Dynamics 365 for Operations\\เรกคอร์ดตาราง**
2. ในบานหน้าต่าง **แหล่งข้อมูล** ให้เลือก **เพิ่มราก** เพื่อเพิ่มแหล่งข้อมูลใหม่ที่จะใช้ในการเข้าถึงตาราง **อินทราสแทต** แต่ละเรกคอร์ดในตาราง **อินทราสแทต** จะแสดงถึงธุรกรรมอินทราสแทตเดียว
3. ในกล่องโต้ตอบ **คุณสมบัติแหล่งข้อมูล** ในฟิลด์ **ชื่อ** ให้ป้อน **ธุรกรรม**
4. ในฟิลด์ **ตาราง** ให้ป้อน **อินทราสแทต**
5. เลือก **ตกลง** เพื่อเพิ่มแหล่งข้อมูลใหม่

#### <a name="add-a-data-source-to-group-intrastat-transactions"></a><a name="AddMmDataSource2"></a>เพิ่มแหล่งข้อมูลเพื่อจัดกลุ่มธุรกรรมอินทราสแทต

ตั้งค่าคอนฟิกแหล่งข้อมูล **GroupBy** เพื่อจัดกลุ่มธุรกรรมอินทราสแทตและคำนวณฟังก์ชันค่ารวม

1. บนหน้า **ตัวออกแบบการแมปแบบจำลอง** ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **ฟังก์ชัน\\จัดกลุ่มตาม**
2. ในบานหน้าต่าง **แหล่งข้อมูล** ให้เลือก **เพิ่มราก** เพื่อเพิ่มแหล่งข้อมูลใหม่ที่จะใช้ในการจัดกลุ่มธุรกรรมอินทราสแทตและคำนวณฟังก์ชันค่ารวม
3. ในกล่องโต้ตอบ **คุณสมบัติแหล่งข้อมูล** ในฟิลด์ **ชื่อ** ให้ป้อน **TransportRecord**
4. เลือก **แก้ไขจัดกลุ่มตาม** เพื่อตั้งค่าคอนฟิกเงื่อนไขการจัดกลุ่ม
5. บนหน้า **แก้ไขพารามิเตอร์ 'จัดกลุ่มตาม'** ในรายการแหล่งข้อมูลในบานหน้าต่างด้านขวา ให้เลือกแหล่งข้อมูล **ธุรกรรม** และขยาย
6. เลือก **เพิ่มฟิลด์ไปยัง \> สิ่งที่จะจัดกลุ่ม** เพื่อแสดงว่ามีการเลือกแหล่งข้อมูล **ธุรกรรม** เป็น <a name="BaseDataSource">แหล่งข้อมูลพื้นฐาน</a> สำหรับแหล่งข้อมูล **GroupBy** ที่ตั้งค่าคอนฟิก เรกคอร์ดของแหล่งข้อมูล **ธุรกรรม** จะถูกจัดกลุ่มและจะมีการใช้ค่าฟิลด์ของแหล่งข้อมูลนี้เพื่อคํานวณในฟังก์ชันค่ารวม
7. เลือกฟิลด์ **ธุรกรรม\การส่งผ่าน** แล้วเลือก **เพิ่มฟิลด์ไปยัง \> ฟิลด์ที่จัดกลุ่ม** เพื่อแสดงว่ามีการเลือกฟิลด์ **การส่งผ่าน** ของแหล่งข้อมูลพื้นฐานเป็น <a name="GroupingFields">เกณฑ์การจัดกลุ่ม</a> สำหรับแหล่งข้อมูล **GroupBy** ที่ตั้งค่าคอนฟิก กล่าวอีกอย่างคือ เรกคอร์ดของแหล่งข้อมูล **ธุรกรรม** จะถูกจัดกลุ่มตามค่าของฟิลด์ **การส่งผ่าน** ทุกเรกคอร์ดของแหล่งข้อมูล **GroupBy** ที่ตั้งค่าคอนฟิกจะแสดงถึงรหัสการส่งผ่านเดียวที่พบในเรกคอร์ดของแหล่งข้อมูลพื้นฐาน
8. เลือกฟิลด์ **Transaction\AmountMST** แล้วปฏิบัติตามขั้นตอนต่อไปนี้

    1. เลือก **เพิ่มฟิลด์ไปยัง \> ฟิลด์ค่ารวม** เพื่อแสดงว่า <a name="AggregateFunctions">ฟังก์ชันค่ารวม</a> จะถูกคำนวณสำหรับฟิลด์นี้
    2. ในบานหน้าต่าง **การรวม** ในเรกคอร์ดที่มีการเพิ่มสำหรับฟิลด์ **Transaction\AmountMST** ที่เลือก ในฟิลด์ **วิธีการ** ให้เลือกฟังก์ชัน **ผลรวม**
    3. ในฟิลด์ตัวเลือก **ชื่อ** ให้ป้อน **TotalInvoicedAmount**

    การตั้งค่าเหล่านี้จะระบุว่าโปรแกรมจะคํานวณยอดรวมของฟิลด์ **Transaction\AmountMST** สำหรับทุกกลุ่มการส่งผ่าน

9. เลือกฟิลด์ **Transaction\RecId** แล้วปฏิบัติตามขั้นตอนต่อไปนี้

    1. เลือก **เพิ่มฟิลด์ไปยัง \> ฟิลด์ค่ารวม** เพื่อแสดงว่าฟังก์ชันค่ารวมจะได้รับการคำนวณสำหรับฟิลด์นี้
    2. ในบานหน้าต่าง **การรวม** ในเรกคอร์ดที่มีการเพิ่มสำหรับฟิลด์ **Transaction\RecId** ที่เลือก ในฟิลด์ **วิธีการ** ให้เลือกฟังก์ชัน **จำนวน**
    3. ในฟิลด์ตัวเลือก **ชื่อ** ให้ป้อน **NumberOfTransactions**

    การตั้งค่าเหล่านี้จะระบุว่าโปรแกรมจะคํานวณจำนวนของธุรกรรมในกลุ่มสำหรับทุกกลุ่มการส่งผ่าน

10. เลือก **บันทึก**
11. ตรวจสอบพารามิเตอร์ <a name="ExecutionLocation">การดำเนินการ</a> ของแหล่งข้อมูลที่แก้ไขได้ โปรดสังเกตว่า **ตรวจหาอัตโนมัติ** มีการเลือกโดยอัตโนมัติในฟิลด์ **ตำแหน่งการดำเนินการ** และฟิลด์ **ดำเนินการที่** มีค่า **SQL** การตั้งค่าเหล่านี้ระบุว่าแหล่งข้อมูลพื้นฐานของ **ธุรกรรม** ที่เลือกสามารถสอบถามได้ และคุณสามารถเรียกใช้แหล่งข้อมูล **GroupBy** ที่สามารถแก้ไขได้ในระดับฐานข้อมูล
12. เปิดการค้นหาฟิลด์ **ตำแหน่งการดำเนินการการ** เพื่อตรวจสอบรายการของค่าที่มีอยู่ โปรดสังเกตว่าคุณสามารถเลือก **การสอบถาม** หรือ **ในหน่วยความจำ** เพื่อบังคับให้แหล่งข้อมูล **GroupBy** นี้ทำงานในระดับฐานข้อมูลหรือในหน่วยความจำของแอปพลิเคชันเซิร์ฟเวอร์
13. เลือก **บันทึก** แล้วปิดหน้า **แก้ไขพารามิเตอร์ 'จัดกลุ่มตาม'**
14. เลือก **ตกลง** เพื่อตั้งค่าแหล่งข้อมูล **GroupBy** ให้เสร็จสิ้น

#### <a name="bind-the-groupby-data-source-to-data-model-fields"></a><a name="AddMmBindings"></a>ผูกแหล่งข้อมูล GroupBy เข้ากับฟิลด์แบบจำลองข้อมูล

ผูกแหล่งข้อมูลที่ตั้งค่าคอนฟิกเข้ากับฟิลด์ของแบบจำลองข้อมูลเพื่อระบุวิธีการกรอกข้อมูลของแบบจำลองข้อมูลโดยใช้ข้อมูลในแอปพลิเคชันขณะรันไทม์

1. บนหน้า **ตัวออกแบบการแมปแบบจำลอง** ในบานหน้าต่าง **แบบจำลองข้อมูล** ให้ขยายโหนด **การส่งผ่าน**
2. ในบานหน้าต่าง **แหล่งข้อมูล** ให้ขยายแหล่งข้อมูล **TransportRecord**
3. เพิ่มการผูกข้อมูลเพื่อแสดงรายการของกลุ่มการขนส่งที่พบดังนี้

    1. ในบานหน้าต่าง **แบบจำลองข้อมูล** ให้เลือกรายการ **การส่งผ่าน**
    2. ในบานหน้าต่าง **แหล่งข้อมูล** ให้เลือกแหล่งข้อมูล **TransportRecord**
    3. เลือก **ผูก**

4. เพิ่มการผูกข้อมูลเพื่อแสดงรหัสการส่งผ่านของกลุ่มการส่งผ่านที่พบดังนี้

    1. เลือกรายการแบบจำลองข้อมูล **Transport.Code**
    2. เลือกฟิลด์ที่จัดกลุ่ม **TransportRecord.grouped.TransportMode**
    3. เลือก **ผูก**

5. เพิ่มการผูกข้อมูลเพื่อแสดงค่าของฟังก์ชันค่ารวมที่คํานวณได้สำหรับกลุ่มการส่งผ่านที่พบแต่ละกลุ่ม

    1. เลือกรายการแบบจำลองข้อมูล **Transport.NumberOfTransactions**
    2. เลือกฟิลด์ที่รวม **TransportRecord.aggregated.NumberOfTransactions**
    3. เลือก **ผูก**
    4. เลือกรายการแบบจำลองข้อมูล **Transport.TotalInvoicedAmount**
    5. เลือกฟิลด์ที่รวม **TransportRecord.aggregated.TotalInvoicedAmount**
    6. เลือก **ผูก**

6. เพิ่มการผูกข้อมูลเพื่อแสดงเรกคอร์ดธุรกรรมที่เป็นของกลุ่มการส่งผ่านที่พบแต่ละกลุ่มดังนี้

    1. เลือกรายการแบบจำลองข้อมูล **Transport.Transaction**
    2. เลือกฟิลด์ **TransportRecord.lines**
    3. เลือก **ผูก**

    คุณสามารถตั้งค่าคอนฟิกการผูกข้อมูลสำหรับรายการที่ซ้อนกันของรายการแบบจำลองข้อมูล **Transport.Transaction** และฟิลด์แหล่งข้อมูล **TransportRecord.lines** เพื่อแสดงรายละเอียดของธุรกรรมอินทราสแทตที่เป็นของกลุ่มการขนส่งที่พบแต่ละกลุ่มขณะรันไทม์

![การแมปรูปแบบที่ตั้งค่าคอนฟิกในตัวออกแบบการแมปแบบจำลอง ER](./media/er-groupby-data-sources-configure-model-mapping.png)

### <a name="debug-the-added-model-mapping-component"></a>ดีบักส่วนประกอบการแมปแบบจำลองที่เพิ่ม

ใช้ [ดีบักเกอร์แหล่งข้อมูล ER](er-debug-data-sources.md) เพื่อทดสอบการแมปแบบจำลองที่ตั้งค่าคอนฟิก

1. บนหน้า **ตัวออกแบบการแมปแบบจำลอง** ให้เลือก **เริ่มการดีบัก**
2. บนหน้า **ดีบักแหล่งข้อมูล** ในบานหน้าต่างด้านซ้าย ให้เลือกแหล่งข้อมูล **TransportRecord** แล้วเลือก **อ่านเรกคอร์ดทั้งหมด**
3. ขยายแหล่งข้อมูล **TransportRecord** แล้วปฏิบัติตามขั้นตอนต่อไปนี้

    1. เลือกแหล่งข้อมูล **TransportRecord.grouped.TransportMode**
    2. เลือก **รับค่า**
    3. เลือกแหล่งข้อมูล **TransportRecord.grouped.NumberOfTransactions**
    4. เลือก **รับค่า**
    5. เลือกแหล่งข้อมูล **TransportRecord.grouped.TotalInvoicedAmount**
    6. เลือก **รับค่า**

4. ในบานหน้าต่างด้านขวา ให้เลือก **ขยายทั้งหมด**

แหล่งข้อมูล **TransportRecord** จะแสดงสองเรกคอร์ดและแสดงรหัสการส่งผ่านสองรหัส จํานวนของธุรกรรมและยอดเงินรวมที่ออกใบแจ้งหนี้แล้วจะได้รับการคำนวณสำหรับรหัสการขนส่งแต่ละรหัส

> [!NOTE]
> มีการใช้แนวทาง "การอ่านแบบ lazy" เมื่อมีการเรียกแหล่งข้อมูล **GroupBy** เพื่อเพิ่มประสิทธิภาพการเรียกฐานข้อมูล ดังนั้น ค่าฟิลด์บางค่าในแหล่งข้อมูล **GroupBy** จะมีการคํานวณในดีบักเกอร์แหล่งข้อมูล ER เฉพาะเมื่อผูกกับฟิลด์ของแบบจำลองข้อมูลเท่านั้น

![ผลลัพธ์ของการดีบักแหล่งข้อมูลในหน้าดีบักแหล่งข้อมูล](./media/er-groupby-data-sources-debug-datasource.png)

## <a name="frequently-asked-questions"></a>คำถามที่ถามบ่อย

### <a name="is-there-any-way-to-calculate-grand-totals-when-the-group-totals-are-calculated"></a>มีวิธีการคํานวณผลรวมทั้งหมดเมื่อมีการคํานวณผลรวมของกลุ่มหรือไม่

ใช่ เมื่อต้องการคํานวณผลรวมทั้งหมด ให้ตั้งค่าคอนฟิกแหล่งข้อมูล **GroupBy** อื่นโดยที่แหล่งข้อมูล **GroupBy** ที่คุณตั้งค่าคอนฟิกไว้ก่อนหน้านี้จะถูกใช้เป็นแหล่งข้อมูลพื้นฐาน ภาพประกอบต่อไปนี้แสดงแหล่งข้อมูล **ผลรวม** ที่เป็นชนิด **GroupBy** ที่ใช้ในการคำนวณฟังก์ชัน **SUM** ของค่ารวมตามการรวม **SUM** ของแหล่งข้อมูล **TransportRecord** ที่เป็นชนิด **GroupBy**

![แหล่งข้อมูลผลรวมในตัวออกแบบการแมปแบบจำลอง ER](./media/er-groupby-data-sources-configure-model-mapping2.png)

รูปภาพประกอบต่อไปนี้แสดงผลลัพธ์ของการดีบักแหล่งข้อมูล **ผลรวม**

![ผลลัพธ์ของการดีบักแหล่งข้อมูลผลรวมในหน้าดีบักแหล่งข้อมูล](./media/er-groupby-data-sources-debug-datasource2.png)

## <a name="additional-resources"></a>ทรัพยากรเพิ่มเติม

- [ภาพรวมการรายงานทางอิเล็กทรอนิกส์](general-electronic-reporting.md)
- [ดีบักแหล่งข้อมูลของรูปแบบ ER ที่ดําเนินการ เพื่อวิเคราะห์การแปลงและลำดับของข้อมูล](er-debug-data-sources.md)
- [ใช้แหล่งข้อมูล DATA COLLECTION ในรูปแบบการรายงานทางอิเล็กทรอนิกส์](er-data-collection-data-sources.md)

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
