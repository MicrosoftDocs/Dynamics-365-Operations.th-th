---
title: ออกแบบการตั้งค่าคอนฟิกสำหรับการสร้างเอกสารในรูปแบบ Excel
description: หัวข้อนี้อธิบายวิธีการออกแบบรูปแบบการรายงานทางอิเล็กทรอนิกส์ (ER) ที่จะกรอกข้อมูลในเท็มเพลต Excel แล้วสร้างเอกสารการจัดรูปแบบของ Excel ขาออก
author: NickSelin
ms.date: 03/10/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: EROperationDesigner, ERParameters
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: 2d737c3a58bf94079b8b674238ed7dd651e238752a2bd992f57c9be4b95aedae
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 08/05/2021
ms.locfileid: "6748483"
---
# <a name="design-a-configuration-for-generating-documents-in-excel-format"></a>ออกแบบการตั้งค่าคอนฟิกสำหรับการสร้างเอกสารในรูปแบบ Excel

[!include[banner](../includes/banner.md)]

คุณสามารถออกแบบการตั้งค่าคอนฟิกรูปแบบ [การรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md) ที่มี [ส่วนประกอบของรูปแบบ](general-electronic-reporting.md#FormatComponentOutbound) ER ซึ่งคุณสามารถตั้งค่าคอนฟิกเพื่อสร้างเอกสารขาออกในรูปแบบสมุดงาน Microsoft Excel ได้ ส่วนประกอบของรูปแบบ ER เฉพาะต้องใช้สำหรับวัตถุประสงค์นี้

เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับลักษณะการทำงานนี้ ให้ทำตามขั้นตอนในหัวข้อ [ออกแบบการตั้งค่าคอนฟิกสำหรับการสร้างรายงานในรูปแบบ OPENXML](tasks/er-design-reports-openxml-2016-11.md)

## <a name="add-a-new-er-format"></a>เพิ่มรูปแบบ ER ใหม่

เมื่อคุณเพิ่มการตั้งค่าคอนฟิกรูปแบบ ER ใหม่เพื่อสร้างเอกสารขาออกในรูปแบบสมุดงาน Excel คุณต้องเลือกค่า **Excel** สำหรับแอททริบิวต์ **ชนิดรูปแบบ** ของรูปแบบหรือปล่อยให้แอททริบิวต์ของ **ชนิดรูปแบบ** ว่างเปล่า

- ถ้าคุณเลือก **Excel** คุณสามารถตั้งค่าคอนฟิกรูปแบบเพื่อสร้างเอกสารขาออกในรูปแบบ Excel เท่านั้น
- ถ้าคุณปล่อยให้แอททริบิวต์ว่างเปล่า คุณสามารถตั้งค่าคอนฟิกรูปแบบเพื่อสร้างเอกสารขาออกในรูปแบบใดๆ ที่ได้รับการสนับสนุนโดยกรอบงาน ER

เมื่อต้องการตั้งค่าคอนฟิกส่วนประกอบของรูปแบบ ER ของการตั้งค่าคอนฟิก ให้เลือก **ตัวออกแบบ** บนบานหน้าต่างการดำเนินการและเปิดส่วนประกอบรูปแบบ ER เพื่อแก้ไขในตัวออกแบบการดำเนินงาน ER

![หน้าการตั้งค่าคอนฟิก](./media/er-excel-format-add-format.png)

## <a name="excel-file-component"></a>ส่วนประกอบไฟล์ Excel

### <a name="manual-entry"></a>ป้อนด้วยตนเอง

คุณต้องเพิ่มส่วนประกอบของ **Excel\\File** ไปยังรูปแบบ ER ที่กำหนดไว้เพื่อสร้างเอกสารขาออกในรูปแบบ Excel

![ส่วนประกอบ Excel\File](./media/er-excel-format-add-file-component.png)

เมื่อต้องการระบุโครงสร้างของเอกสารขาออก ให้แนบสมุดงาน Excel ที่มีส่วนขยาย. xlsx กับส่วนประกอบ **Excel\\File** เป็นเท็มเพลตสำหรับเอกสารขาออก

> [!NOTE]
> เมื่อคุณแนบเท็มเพลตด้วยตนเอง คุณต้องใช้ [ชนิดเอกสาร](../../../fin-ops-core/fin-ops/organization-administration/configure-document-management.md#configure-document-types) ที่ได้รับการตั้งค่าคอนฟิกไว้สำหรับวัตถุประสงค์ดังกล่าวใน [พารามิเตอร์ ER](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents)

![การเพิ่มไฟล์แนบลงในส่วนประกอบ Excel\File](./media/er-excel-format-add-file-component2.png)

ถ้าต้องการระบุวิธีการกรอกข้อมูลเท็มเพลตที่แนบเมื่อคุณรันรูปแบบ ER ที่ตั้งค่าคอนฟิก คุณต้องเพิ่มส่วนประกอบ **แผ่นงาน** **ช่วง** และ **เซลล์** ที่ซ้อนกันเข้ากับส่วนประกอบ **Excel\\File** แต่ละส่วนประกอบที่ซ้อนกันต้องเชื่อมโยงกับสินค้าที่มีการระบุชื่อ Excel

### <a name="template-import"></a>การนำเข้าเท็มเพลต

คุณสามารถเลือก **นำเข้าจาก Excel** บนแท็บ **นำเข้า** ของบานหน้าต่างการดำเนินการเพื่อนำเข้าเท็มเพลตใหม่ไปยังรูปแบบ ER เปล่า ในตัวอย่างนี้ส่วนประกอบ **Excel\\File** จะถูกสร้างขึ้นโดยอัตโนมัติ และจะมีการแนบเท็มเพลตที่นำเข้า ส่วนประกอบ ER ที่จำเป็นทั้งหมดจะถูกสร้างขึ้นโดยอัตโนมัติตามรายการของ Excel ที่มีการระบุชื่อรายการที่ค้นพบ

![เลือก นำเข้าจาก Excel](./media/er-excel-format-import-template.png)

> [!NOTE]
> ถ้าคุณต้องการสร้างองค์ประกอบ **แผ่นงาน** ที่ไม่จำเป็นในรูปแบบ ER ที่สามารถแก้ไขได้ ให้ตั้งค่าตัวเลือก **สร้างองค์ประกอบของรูปแบบของแผ่นงาน Excel** เป็น **ใช่**

## <a name="sheet-component"></a>ส่วนประกอบของแผ่นงาน

ส่วนประกอบของ **แผ่นงาน** บ่งชี้แผ่นงานของสมุดงาน Excel ที่แนบซึ่งต้องมีการกรอกข้อมูล มีการกำหนดชื่อของแผ่นงานในเท็มเพลต Excel ในคุณสมบัติ **แผ่นงาน** ของส่วนประกอบนี้

> [!NOTE]
> ส่วนประกอบนี้ไม่จำเป็นต้องระบุสำหรับสมุดงาน Excel ที่มีแผ่นงานเดียว

บนแท็บ **การแม็ป** ของตัวออกแบบการดำเนินงาน ER คุณสามารถตั้งค่าคอนฟิกคุณสมบัติ **ที่เปิดใช้งาน** สำหรับส่วนประกอบของ **แผ่นงาน** เพื่อระบุว่าต้องใส่ส่วนประกอบในเอกสารที่สร้างขึ้นหรือไม่:

- ถ้ามีการตั้งค่าคอนฟิกของนิพจน์ของคุณสมบัติ **ที่เปิดใช้งาน** ให้ส่งคืนเป็น **จริง** ในเวลาที่รัน หรือถ้าไม่มีการตั้งค่าคอนฟิกนิพจน์ใดๆ แผ่นงานที่เหมาะสมจะถูกวางในเอกสารที่สร้างขึ้น
- ถ้ามีการตั้งค่าคอนฟิกนิพจน์ของคุณสมบัติ **ที่เปิดใช้งาน** เพื่อส่งคืนเป็น **เท็จ** ในเวลาที่รัน เอกสารที่สร้างขึ้นจะไม่มีแผ่นงาน

![ตัวอย่างของส่วนประกอบแผ่นงาน](./media/er-excel-format-sheet-component.png)

## <a name="range-component"></a>ส่วนประกอบของช่วง

ส่วนประกอบของ **ช่วง** บ่งชี้ถึงช่วงของ Excel ที่ต้องควบคุมโดยส่วนประกอบ ER นี้ มีการกำหนดช่วงในคุณสมบัติ **ช่วงของ Excel** ของส่วนประกอบนี้

คุณสมบัติ **ทิศทางการจำลอง** ระบุว่าจะมีการทำซ้ำช่วงใดในเอกสารที่สร้างขึ้น:

- ถ้าคุณสมบัติ **ทิศทางการจำลอง** ถูกตั้งค่าเป็น **ไม่มีการจำลอง** ช่วง Excel ที่เหมาะสมจะไม่มีการทำซ้ำในเอกสารที่สร้างขึ้น
- ถ้าคุณสมบัติ **ทิศทางการจำลอง** ถูกตั้งค่าเป็น **แนวตั้ง** ช่วง Excel ที่เหมาะสมจะมีการทำซ้ำในเอกสารที่สร้างขึ้น ทุกช่วงที่จำลองแบบถูกวางไว้ให้ช่วงดั้งเดิมในเท็มเพลต Excel จำนวนของการทำซ้ำจะถูกกำหนดโดยจำนวนของเรกคอร์ดในแหล่งข้อมูลของชนิด **รายการเรกคอร์ด** ที่ผูกกับส่วนประกอบ ER นี้
- ถ้าคุณสมบัติ **ทิศทางการจำลอง** ถูกตั้งค่าเป็น **แนวนอน** ช่วง Excel ที่เหมาะสมจะมีการทำซ้ำในเอกสารที่สร้างขึ้น ทุกช่วงที่จำลองแบบถูกวางไว้ทางด้านขวาของช่วงดั้งเดิมในเท็มเพลต Excel จำนวนของการทำซ้ำจะถูกกำหนดโดยจำนวนของเรกคอร์ดในแหล่งข้อมูลของชนิด **รายการเรกคอร์ด** ที่ผูกกับส่วนประกอบ ER นี้

เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับการจำลองแบบแนวนอน ให้ทำตามขั้นตอนต่างๆ ใน [ใช้ช่วงที่ขยายตามแนวนอนเพื่อเพิ่มคอลัมน์ในรายงานของ Excel แบบไดนามิก](tasks/er-horizontal-1.md)

ส่วนประกอบ **ช่วง** อาจมีส่วนประกอบ ER ที่ซ้อนกันอื่นๆ ที่ใช้ในการป้อนค่าในช่วง Excel ที่มีชื่อที่เหมาะสม

- ถ้าส่วนประกอบใดๆ ของกลุ่ม **ข้อความ** ถูกใช้ในการป้อนค่า ค่าจะถูกป้อนในช่วงของ Excel เป็นค่าข้อความ

    > [!NOTE]
    > ใช้รูปแบบนี้เพื่อจัดรูปแบบค่าที่ป้อนตามตำแหน่งที่ตั้งที่กำหนดไว้ในแอปพลิเคชัน

- ถ้าส่วนประกอบ **เซลล์** ของกลุ่ม **Excel** ใช้ในการป้อนค่า จะมีการป้อนค่าในช่วงของ Excel เป็นค่าของชนิดข้อมูลที่กำหนดโดยการรวมของส่วนประกอบ **เซลล์** นั้น (ตัวอย่างเช่น **สตริง** **จริง** หรือ **จำนวนเต็ม**)

    > [!NOTE]
    > ใช้รูปแบบนี้เพื่อเปิดใช้งานแอปพลิเคชัน Excel เพื่อจัดรูปแบบค่าที่ป้อนตามตำแหน่งที่ตั้งของคอมพิวเตอร์เฉพาะที่ที่เปิดเอกสารขาออก

บนแท็บ **การแม็ป** ของตัวออกแบบการดำเนินงาน ER คุณสามารถตั้งค่าคอนฟิกคุณสมบัติ **ที่เปิดใช้งาน** สำหรับส่วนประกอบของ **ช่วง** เพื่อระบุว่าต้องใส่ส่วนประกอบในเอกสารที่สร้างขึ้นหรือไม่:

- ถ้ามีการตั้งค่าคอนฟิกของนิพจน์ของคุณสมบัติ **ที่เปิดใช้งาน** ให้ส่งคืนเป็น **จริง** ในเวลาที่รัน หรือถ้าไม่มีการตั้งค่าคอนฟิกนิพจน์ใดๆ ช่วงที่เหมาะสมจะถูกเติมในเอกสารที่สร้างขึ้น
- ถ้ามีการตั้งค่าคอนฟิกของนิพจน์ของคุณสมบัติ **ที่เปิดใช้งาน** ให้ส่งคืนเป็น **เท็จ** ในเวลาที่รัน และถ้าช่วงนี้ไม่ได้แสดงถึงแถวหรือคอลัมน์ทั้งหมด ช่วงที่เหมาะสมจะไม่ถูกเติมในเอกสารที่สร้างขึ้น
- ถ้ามีการตั้งค่าคอนฟิกของนิพจน์ของคุณสมบัติ **ที่เปิดใช้งาน** ให้ส่งคืนเป็น **เท็จ** ในเวลาที่รัน และถ้าช่วงนี้แสดงถึงแถวหรือคอลัมน์ทั้งหมด เอกสารที่สร้างขึ้นจะมีแถวและคอลัมน์เหล่านั้นเป็นแถวและคอลัมน์ที่ซ่อนอยู่

## <a name="cell-component"></a>ส่วนประกอบเซลล์

ส่วนประกอบ **เซลล์** ใช้ในการกรอกข้อมูลใน Excel ที่ชื่อเซลล์ รูปร่าง และรูปภาพ เมื่อต้องการบ่งชี้ว่ามีการระบุชื่อออบเจ็กต์ของ Excel ที่ต้องถูกกรอกข้อมูลโดยส่วนประกอบ ER **เซลล์** คุณต้องระบุชื่อของออบเจ็กต์นั้นในคุณสมบัติ **ช่วงของ Excel** ของส่วนประกอบ **เซลล์**

บนแท็บ **การแม็ป** ของตัวออกแบบการดำเนินงาน ER คุณสามารถตั้งค่าคอนฟิกคุณสมบัติ **ที่เปิดใช้งาน** สำหรับส่วนประกอบของ **เซลล์** เพื่อระบุว่าต้องเติมออบเจ็กต์ในเอกสารที่สร้างขึ้นหรือไม่:

- ถ้ามีการตั้งค่าคอนฟิกของนิพจน์ของคุณสมบัติ **ที่เปิดใช้งาน** ให้ส่งคืนเป็น **จริง** ในเวลาที่รัน หรือถ้าไม่มีการตั้งค่าคอนฟิกนิพจน์ใดๆ ออบเจ็กต์ที่เหมาะสมจะถูกเติมในเอกสารที่สร้างขึ้น การรวมของส่วนประกอบของ **เซลล์** นี้ ระบุค่าที่ถูกวางในออบเจ็กต์ที่เหมาะสม
- ถ้ามีการตั้งค่าคอนฟิกนิพจน์ของคุณสมบัติ **ที่เปิดใช้งาน** เพื่อส่งคืนเป็น **เท็จ** ในเวลาที่รัน จะไม่มีการเติมออบเจ็กต์ที่เหมาะสมในเอกสารที่สร้างขึ้น

เมื่อมีการตั้งค่าคอนฟิกส่วนประกอบ **เซลล์** เพื่อป้อนค่าในเซลล์ อาจมีการผูกกับแหล่งข้อมูลที่ส่งคืนค่าของชนิดข้อมูลดั้งเดิม (ตัวอย่างเช่น **สตริง** **จำนวนจริง** หรือ **จำนวนเต็ม**) ในกรณีนี้จะมีการป้อนค่าในเซลล์เป็นค่าของชนิดข้อมูลเดียวกัน

เมื่อมีการตั้งค่าคอนฟิกส่วนประกอบ **เซลล์** เพื่อป้อนค่าในรูปร่าง Excel อาจมีการผูกกับแหล่งข้อมูลที่ส่งคืนค่าของชนิดข้อมูลดั้งเดิม (ตัวอย่างเช่น **สตริง** **จำนวนจริง** หรือ **จำนวนเต็ม**) ในกรณีนี้จะมีการป้อนค่าในรูปร่าง Excel เป็นข้อความของรูปร่างนั้น สำหรับค่าของชนิดข้อมูลที่ไม่ใช่ **สตริง** การแปลงเป็นข้อความจะถูกทำให้โดยอัตโนมัติ

> [!NOTE]
> คุณสามารถตั้งค่าคอนฟิกส่วนประกอบ **เซลล์** ให้กรอกข้อมูลในรูปร่างได้เฉพาะในกรณีที่มีการสนับสนุนคุณสมบัติข้อความของรูปร่างเท่านั้น

เมื่อมีการตั้งค่าคอนฟิกส่วนประกอบ **เซลล์** เพื่อป้อนค่าในรูปภาพของ Excel อาจมีการผูกกับแหล่งข้อมูลที่ส่งคืนค่าของชนิดข้อมูล **คอนเทนเนอร์** ที่แสดงถึงรูปภาพในรูปแบบฐานสอง ในกรณีนี้จะมีการป้อนค่าในรูปภาพ Excel เป็นรูปภาพ

> [!NOTE]
> รูปภาพและรูปร่างของ Excel ทั้งหมดถือเป็นการยึดตามมุมซ้ายด้านบนไปยังเซลล์หรือช่วงของ Excel โดยเฉพาะ ถ้าคุณต้องการคัดลอกรูปภาพหรือรูปร่าง Excel คุณต้องตั้งค่าคอนฟิกเซลล์หรือช่วงที่ยึดตามเซลล์หรือช่วงที่ถูกจำลองแบบ

เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับวิธีการฝังรูปภาพและรูปร่าง ให้ดูที่ [ฝังรูปภาพและรูปร่างในเอกสารที่คุณสร้างขึ้นโดยใช้ ER](electronic-reporting-embed-images-shapes.md)

## <a name="page-break-component"></a>ส่วนประกอบของตัวแบ่งหน้า

ส่วนประกอบ **PageBreak** บังคับ Excel ให้เริ่มหน้าใหม่ ส่วนประกอบนี้ไม่จำเป็นต้องใช้เมื่อคุณต้องการใช้การแบ่งหน้าเริ่มต้นของ Excel แต่คุณควรใช้ในกรณีที่คุณต้องการให้ Excel ทำตามรูปแบบ ER ของคุณไปยังหน้าโครงสร้าง

## <a name="footer-component"></a>ส่วนประกอบส่วนท้าย

ส่วนประกอบ **ส่วนท้าย** จะถูกใช้ในการเติมส่วนท้ายที่ด้านล่างของแผ่นงานที่ถูกสร้างในสมุดงาน Excel

> [!NOTE]
> คุณสามารถเพิ่มส่วนประกอบนี้ให้กับส่วนประกอบ **แผ่นงาน** ทุกส่วน เพื่อระบุส่วนท้ายที่ต่างกันของแผ่นงานต่างๆ ในสมุดงาน Excel ที่สร้างขึ้น

เมื่อคุณกำหนดค่าคอนฟิกส่วนประกอบ **ส่วนท้าย** แต่ละรายการ คุณจะสามารถใช้คุณสมบัติ **ลักษณะที่ปรากฏของส่วนหัว/ส่วนท้าย** เพื่อระบุหน้าที่จะใช้ส่วนประกอบได้ ค่าที่พร้อมใช้งานมีดังต่อไปนี้

- **ใดๆ** ดำเนินการกำหนดค่าคอนฟิกส่วนประกอบ **ส่วนท้าย** ไว้ที่หน้าใดๆ ของแผ่นงาน Excel หลัก
- **ลำดับแรก** ดำเนินการกำหนดค่าคอนฟิกส่วนประกอบ **ส่วนท้าย** ไว้ที่หน้าแรกของแผ่นงาน Excel หลัก
- **เลขคู่** ดำเนินการกำหนดค่าคอนฟิกส่วนประกอบ **ส่วนท้าย** ไว้ที่หน้าที่เป็นเลขคู่ของแผ่นงาน Excel หลัก
- **เลขคี่** ดำเนินการกำหนดค่าคอนฟิกส่วนประกอบ **ส่วนท้าย** ไว้ที่หน้าที่เป็นเลขคี่ของแผ่นงาน Excel หลัก

สำหรับองค์ประกอบ **แผ่นงาน** เดี่ยว คุณจะสามารถเพิ่มส่วนประกอบ **ส่วนท้าย** ได้จำนวนมาก แต่ละแผ่นจะมีค่าที่ต่างกันสำหรับคุณสมบัติ **ลักษณะที่ปรากฎของส่วนหัว/ส่วนท้าย** ด้วยวิธีนี้ คุณสามารถสร้างส่วนท้ายที่ต่างกันได้ในหลายประเภทของหน้าในแผ่นงาน Excel

> [!NOTE]
> ตรวจสอบให้แน่ใจว่าแต่ละองค์ประกอบ **ส่วนท้าย** ที่คุณได้เพิ่มองค์ประกอบ **แผ่นงาน** เดี่ยว มีค่าที่แตกต่างกันสำหรับคุณสมบัติ **ลักษณะการปรากฎของส่วนหัว/ส่วนท้าย** มิฉะนั้น จะเกิด [ข้อผิดพลาดการตรวจสอบความถูกต้อง](er-components-inspections.md#i16) ข้อความแสดงข้อผิดพลาดที่คุณได้รับจะแจ้งคุณเกี่ยวกับความไม่แน่นอน

ภายใต้ส่วนประกอบ **ส่วนท้าย** ที่เพิ่มเข้ามา ให้เพิ่มส่วนประกอบที่ซ้อนกันที่จำเป็นของ **ข้อความ\\สตริง**, **ข้อความ\\DateTime** หรือประเภทอื่น กำหนดค่าคอนฟิกการผูกข้อมูลสำหรับส่วนประกอบเหล่านั้นเพื่อระบุวิธีการเติมส่วนท้ายของหน้าของคุณ

คุณยังสามารถใช้ [รหัสการจัดรูปแบบ](/office/vba/excel/concepts/workbooks-and-worksheets/formatting-and-vba-codes-for-headers-and-footers) พิเศษ เพื่อจัดรูปแบบเนื้อหาของส่วนท้ายที่สร้างขึ้นอย่างถูกต้อง หากต้องการทราบวิธีการใช้วิธีการนี้ ให้ปฏิบัติตามขั้นตอนใน [ตัวอย่างที่ 1 ](#example-1) ในภายหลังในหัวข้อนี้

> [!NOTE]
> เมื่อคุณกำหนดค่าคอนฟิกรูปแบบ ER ต้องแน่ใจว่าได้พิจารณา [ขีดจํากัด](https://support.microsoft.com/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3) ของ Excel และจํานวนอักขระสูงสุดในส่วนหัวหรือส่วนท้ายเดียว

## <a name="header-component"></a>ส่วนประกอบส่วนหัว

ส่วนประกอบ **ส่วนหัว** จะถูกใช้ในการเติมส่วนหัวที่ด้านบนของแผ่นงานที่ถูกสร้างในสมุดงาน Excel จะถูกนำไปใช้เหมือนกับส่วนประกอบ **ส่วนท้าย**

## <a name="edit-an-added-er-format"></a>แก้ไขรูปแบบ ER ที่เพิ่ม

### <a name="update-a-template"></a>อัปเดตเท็มเพลต

คุณสามารถเลือก **อัปเดตจาก Excel** บนแท็บ **นำเข้า** ของบานหน้าต่างการดำเนินการเพื่ออัปเดตเท็มเพลตไปยังรูปแบบ ER ที่แก้ไขได้ ในระหว่างกระบวนการนี้ เท็มเพลตของส่วนประกอบ **Excel\\File** ที่เลือกจะถูกแทนที่ด้วยเท็มเพลตใหม่ เนื้อหาของรูปแบบ ER ที่สามารถแก้ไขได้จะถูกซิงค์กับเนื้อหาของเท็มเพลต ER ที่อัปเดต

- ส่วนประกอบรูปแบบ ER ใหม่จะถูกสร้างขึ้นโดยอัตโนมัติสำหรับทุกชื่อ Excel ถ้าไม่พบส่วนประกอบรูปแบบ ER ในรูปแบบที่แก้ไขได้
- ส่วนประกอบรูปแบบ ER ทั้งหมดจะถูกลบออกจากรูปแบบ ER ที่สามารถแก้ไขได้ ถ้าไม่พบชื่อ Excel ที่เหมาะสม

> [!NOTE]
> ให้ตั้งค่าตัวเลือก **สร้างองค์ประกอบของรูปแบบของแผ่นงาน Excel** เป็น **ใช่** ถ้าคุณต้องการสร้างองค์ประกอบ **แผ่นงาน** ที่ไม่จำเป็นในรูปแบบ ER ที่สามารถแก้ไขได้
>
> ถ้ารูปแบบ ER ที่สามารถแก้ไขได้มีองค์ประกอบ **แผ่นงาน** โดยดั้งเดิม เราขอแนะนำให้คุณตั้งค่าตัวเลือก **สร้างองค์ประกอบของรูปแบบของแผ่นงาน Excel** เป็น **ใช่** เมื่อคุณนำเข้าเท็มเพลตที่อัปเดตแล้ว มิฉะนั้นองค์ประกอบที่ซ้อนกันทั้งหมดขององค์ประกอบ **แผ่นงาน** ต้นฉบับ จะถูกสร้างตั้งแต่เริ่มต้น ดังนั้นการรวมทั้งหมดขององค์ประกอบรูปแบบที่สร้างขึ้นใหม่จะสูญหายในรูปแบบ ER ที่อัปเดตแล้ว

![สร้างตัวเลือกองค์ประกอบรูปแบบของแผ่นงาน Excel ในการอัปเดตจากกล่องโต้ตอบ Excel](./media/er-excel-format-update-template.png)

เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับลักษณะการทำงานนี้ ให้ทำตามขั้นตอนใน [ปรับเปลี่ยนรูปแบบการรายงานทางอิเล็กทรอนิกส์โดยนำเท็มเพลต Excel ไปใช้อีกครั้ง](modify-electronic-reporting-format-reapply-excel-template.md)

## <a name="validate-an-er-format"></a>ตรวจสอบความถูกต้องของรูปแบบ ER

เมื่อคุณตรวจสอบความถูกต้องของรูปแบบ ER ที่สามารถแก้ไขได้ ให้ทำการตรวจสอบความสอดคล้องกันเพื่อให้แน่ใจว่าชื่อ Excel มีอยู่ในเท็มเพลต Excel ที่มีการใช้งานอยู่ในปัจจุบัน คุณจะได้รับการแจ้งเตือนเกี่ยวกับความไม่สอดคล้องกัน สำหรับความไม่สอดคล้องกันบางส่วน ตัวเลือกในการแก้ไขปัญหาโดยอัตโนมัติจะถูกนำเสนอ

![ข้อความแสดงข้อผิดพลาดของการตรวจสอบความถูกต้อง](./media/er-excel-format-validate.png)

## <a name="control-the-calculation-of-excel-formulas"></a>การควบคุมการคำนวณสูตรของ Excel

เมื่อมีการสร้างเอกสารขาออกในรูปแบบสมุดงาน Microsoft Excel เซลล์บางเซลล์ของเอกสารนี้อาจประกอบด้วยสูตรของ Excel เมื่อเปิดใช้งานลักษณะการทำงาน **เปิดใช้งานการใช้ไลบรารี EPPlus ในกรอบงานการรายงานทางอิเล็กทรอนิกส์** คุณสามารถควบคุมได้ว่าจะคำนวณสูตรด้วยการเปลี่ยนแปลงค่าของ **ตัวเลือกการคำนวณ** ของ [พารามิเตอร์](https://support.microsoft.com/office/change-formula-recalculation-iteration-or-precision-in-excel-73fc7dac-91cf-4d36-86e8-67124f6bcce4#ID0EAACAAA=Windows) ในแม่แบบ Excel ที่มีการใช้:

- เลือก **อัตโนมัติ** เพื่อคำนวณสูตรทั้งหมดที่ไม่ขึ้นอยู่กับทุกครั้งที่เอกสารที่สร้างขึ้นจะถูกผนวกตามช่วงใหม่ เซลล์ ฯลฯ
    >[!NOTE]
    > ซึ่งอาจทำให้เกิดปัญหาประสิทธิภาพสำหรับแม่แบบ Excel ที่มีสูตรที่เกี่ยวข้องหลายสูตร
- เลือก **ด้วยตนเอง** เพื่อหลีกเลี่ยงการคำนวณสูตรใหม่เมื่อสร้างเอกสาร
    >[!NOTE]
    > การคำนวณสูตรใหม่จะถูกบังคับด้วยตนเองเมื่อมีการเปิดเอกสารที่สร้างขึ้นสำหรับการแสดงตัวอย่างโดยใช้ Excel
    > อย่าใช้ตัวเลือกนี้ถ้าคุณตั้งค่าคอนฟิกปลายทางเอ้อซึ่งสันนิษฐานว่าการใช้งานเอกสารที่สร้างขึ้นโดยไม่มีการแสดงตัวอย่างใน Excel (การแปลง PDF การส่งอีเมล์ ฯลฯ) เนื่องจากเอกสารที่สร้างขึ้นอาจไม่มีค่าในเซลล์ที่มีสูตร

## <a name="example-1-format-footer-content"></a><a name="example-1"></a> ตัวอย่างที่ 1 เนื้อหาส่วนท้ายของรูปแบบ

1. ใช้การกำหนดค่าคอนฟิก ER ที่ให้เพื่อ [สร้าง](er-generate-printable-fti-forms.md) เอกสารใบแจ้งหนี้ข้อความอิสระ (FTI) ที่สามารถพิมพ์ได้
2. ตรวจสอบส่วนท้ายของเอกสารที่สร้าง โปรดสังเกตว่างานจะประกอบด้วยข้อมูลเกี่ยวกับหมายเลขหน้าปัจจุบันและจํานวนรวมของหน้าในเอกสาร

    ![การตรวจทานส่วนท้ายของเอกสารที่สร้างในรูปแบบ Excel](./media/er-fillable-excel-footer-1.gif)

3. ในโปรแกรมออกแบบรูปแบบ ER [เปิด](er-generate-printable-fti-forms.md#features-that-are-implemented-in-the-sample-er-format) รูปแบบ ER ตัวอย่างเพื่อตรวจทาน

    ส่วนท้ายของแผ่นงาน **ใบแจ้งหนี้** จะถูกสร้างขึ้นตามการตั้งค่าของส่วนประกอบ **สตริง** สองตัวที่อยู่ภายใต้ส่วนประกอบ **ส่วนท้าย**

    - ส่วนประกอบ **สตริง** แรกจะเติมรหัสการจัดรูปแบบพิเศษต่อไปนี้เพื่อบังคับให้ Excel ใช้การจัดรูปแบบเฉพาะ

        - **&C** ปรับข้อความท้ายกระดาษให้อยู่กึ่งกลาง
        - **&"Segoe UI,Regular"&8** แสดงข้อความท้ายกระดาษในแบบอักษร "Segoe UI Regular" ที่ขนาด 8 พอยท์

    - ส่วนประกอบ **สตริง** ที่สองจะเติมข้อความที่มีหมายเลขหน้าปัจจุบันและจํานวนหน้าทั้งหมดในเอกสารปัจจุบัน

    ![การตรวจทานส่วนประกอบรูปแบบ ER ส่วนท้ายบนหน้าตัวออกแบบรูปแบบ](./media/er-fillable-excel-footer-2.png)

4. ปรับแต่งรูปแบบ ER ตัวอย่างเพื่อแก้ไขส่วนท้ายของหน้าปัจจุบัน

    1. [สร้าง](er-quick-start2-customize-report.md#DeriveProvidedFormat) รูปแบบ ER **ใบแจ้งหนี้ข้อความอิสระ (Excel) ที่กำหนดเอง** ที่สืบทอดมาโดยยึดตามรูปแบบ ER ตัวอย่าง
    2. เพิ่มส่วนประกอบ **สตริง** คู่แรกคู่ใหม่สำหรับส่วนประกอบ **ส่วนท้าย** ของแผ่นงาน **ใบแจ้งหนี้** 

        1. เพิ่มส่วนประกอบ **สตริง** ที่จัดเรียงชื่อบริษัทไว้ทางด้านซ้ายและแสดงเป็นแบบอักษร "Segoe UI Regular" ขนาด 8 พอยท์ (**"&L&"Segoe UI,Regular"&8")**
        2. เพิ่มส่วนประกอบ **สตริง** ที่กรอกในชื่อบริษัท (**model.InvoiceBase.CompanyInfo.Name)**

    3. เพิ่มส่วนประกอบคู่ที่สองของ **สตริง** สำหรับส่วนประกอบ **ส่วนท้าย** ของแผ่นงาน **ใบแจ้งหนี้** 

        1. เพิ่มส่วนประกอบ **สตริง** ที่จัดเรียงวันที่ดำเนินการไว้ทางด้านขวาและแสดงเป็นแบบอักษร "Segoe UI Regular" ขนาด 8 พอยท์ (**"&L&"Segoe UI,Regular"&8"**)
        2. เพิ่มส่วนประกอบ **สตริง** ที่กรอกวันที่ดำเนินการในรูปแบบที่กำหนดเอง (**"&nbsp;"&DATEFORMAT(SESSIONTODAY(), "yyyy-MM-dd")**)

        ![การตรวจทานส่วนประกอบรูปแบบ ER ส่วนท้ายบนหน้าตัวออกแบบรูปแบบ](./media/er-fillable-excel-footer-3.png)

    4. [เสร็จสมบูรณ์](er-quick-start2-customize-report.md#CompleteDerivedFormat) เวอร์ชันแบบร่างของรูปแบบ ER **ใบแจ้งหนี้ข้อความอิสระ (Excel) ที่กำหนดเอง** ที่นำมาใช้

5. [กำหนดค่าคอนฟิก](er-generate-printable-fti-forms.md#configure-print-management) การจัดการการพิมพ์เพื่อใช้รูปแบบ ER **ใบแจ้งหนี้ข้อความอิสระ (Excel) ที่กําหนดเอง** แทนรูปแบบ ER ตัวอย่าง
6. สร้างเอกสาร FTI ที่สามารถพิมพ์ได้ และทบทวนส่วนท้ายของเอกสารที่สร้าง

    ![การทบทวนส่วนท้ายของเอกสารที่สร้างในรูปแบบ Excel](./media/er-fillable-excel-footer-4.gif)

## <a name="additional-resources"></a>ทรัพยากรเพิ่มเติม

[ภาพรวมการรายงานทางอิเล็กทรอนิกส์](general-electronic-reporting.md)

[ออกแบบการตั้งค่าคอนฟิกสำหรับการจัดทำรายงานในรูปแบบ OPENXML](tasks\er-design-reports-openxml-2016-11.md)

[แก้ไขรูปแบบการรายงานทางอิเล็กทรอนิกส์ด้วยการใช้เท็มเพลต Excel อีกครั้ง](modify-electronic-reporting-format-reapply-excel-template.md)

[ใช้ช่วงที่สามารถขยายได้ตามแนวนอนเพื่อเพิ่มคอลัมน์ลงในรายงาน Excel แบบไดนามิก](tasks/er-horizontal-1.md)

[ฝังข้อมูลและรูปร่างในเอกสารที่คุณสร้างโดยใช้ ER](electronic-reporting-embed-images-shapes.md)

[ตั้งค่าคอนฟิกการรายงานทางอิเล็กทรอนิกส์ (ER) เพื่อดึงข้อมูลไปยัง Power BI](general-electronic-reporting-report-configuration-get-data-powerbi.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]