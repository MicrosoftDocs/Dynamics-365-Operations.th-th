---
title: ออกแบบรูปแบบ ER เพื่อเก็บแถวไว้ด้วยกันในหน้า Excel เดียวกัน
description: บทความนี้จะอธิบายถึงวิธีการออกแบบรูปแบบการรายงานทางอิเล็กทรอนิกส์ (ER) ที่เก็บแถวไว้ด้วยกันในหน้า Microsoft Excel เดียวกัน
author: kfend
ms.date: 02/28/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.region: Global
ms.author: filatovm
ms.search.validFrom: 2022-03-01
ms.dyn365.ops.version: Version 10.0.26
ms.custom: 220314
ms.assetid: ''
ms.search.form: EROperationDesigner
ms.openlocfilehash: 7ecc4358a0d4d9ae9e729393bd3ac4cefbf15ad2
ms.sourcegitcommit: 87e727005399c82cbb6509f5ce9fb33d18928d30
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 08/12/2022
ms.locfileid: "9287972"
---
# <a name="design-an-er-format-to-keep-rows-together-on-the-same-excel-page"></a>ออกแบบรูปแบบ ER เพื่อเก็บแถวไว้ด้วยกันในหน้า Excel เดียวกัน

[!include [banner](../includes/banner.md)]


บทความนี้อธิบายวิธีการของผู้ใช้ในบทบาทที่ปรึกษาด้านการทำงานการรายงานทางอิเล็กทรอนิกส์หรือผู้ดูแลระบบสามารถตั้งค่าคอนฟิก [รูปแบบ](er-overview-components.md#format-component) [การรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md) ที่สร้างเอกสารขาออกใน Microsoft Excel และจัดการการแบ่งหน้าเอกสารเพื่อให้แถวที่สร้างเก็บอยู่ในหน้าเดียวกัน

ในตัวอย่างนี้ คุณจะสามารถแก้ไขรูปแบบ ER ที่ Microsoft ให้ไว้ ซึ่งใช้เพื่อพิมพ์ใบแจ้งหนี้ข้อความอิสระใน Excel การปรับเปลี่ยนของคุณจะช่วยให้คุณสามารถจัดการการแบ่งหน้าของรายงานใบแจ้งหนี้ข้อความอิสระที่สร้างขึ้น เพื่อให้แถวทั้งหมดของรายการใบแจ้งหนี้หนึ่งๆ เก็บไว้ในหน้าเดียวกัน ถ้าเป็นไปได้

สามารถดำเนินงานกระบวนงานในบทความนี้ให้เสร็จสมบูรณ์ได้ ในบริษัท **USMF** ไม่จำเป็นต้องมีการเขียนโค้ด

ในตัวอย่างนี้ คุณจะสร้าง [การตั้งค่าคอนฟิก](general-electronic-reporting.md#Configuration) ER สำหรับบริษัทตัวอย่าง **Litware, Inc.** ตรวจสอบให้แน่ใจว่าตัวให้บริการการตั้งค่าคอนฟิกสำหรับบริษัทตัวอย่าง **Litware, Inc.** (`http://www.litware.com`) แสดงสำหรับกรอบงาน ER และได้รับการระบุว่า **ใช้งานอยู่** ถ้าตัวให้บริการการตั้งค่าคอนฟิกนี้ไม่มีอยู่ในรายการหรือถ้าไม่ได้ทำเครื่องหมายเป็น **ใช้งานอยู่** ให้ทำตามขั้นตอนในหัวข้อ [สร้างตัวให้บริการการตั้งค่าคอนฟิกและทำเครื่องหมายเป็นใช้งานอยู่](tasks/er-configuration-provider-mark-it-active-2016-11.md)

## <a name="enter-a-new-free-text-invoice"></a>ป้อนใบแจ้งหนี้ข้อความอิสระ

1. ปฏิบัติตามขั้นตอนใน [สร้างใบแจ้งหนี้ข้อความอิสระ](../../../finance/accounts-receivable/create-free-text-invoice-new.md#create-a-free-text-invoice-1) เพื่อเพิ่มใบแจ้งหนี้ข้อความอิสระ

    1. เพิ่มรายการเดียวลงในใบแจ้งหนี้
    2. เพิ่มหมายเหตุห้ารายการสำหรับรายการใบแจ้งหนี้

    ![การตรวจทานหมายเหตุของรายการใบแจ้งหนี้ในหน้าสิ่งที่แนบ](./media/er-keep-excel-rows-together-notes.png)

2. ปฏิบัติตามขั้นตอนใน [คัดลอกรายการ](../../../finance/accounts-receivable/create-free-text-invoice-new.md#copy-lines) เพื่อสร้างรายการใบแจ้งหนี้เพิ่มเติมห้ารายการที่จะคัดลอกรายการใบแจ้งหนี้ที่คุณเพิ่มในขั้นตอนก่อนหน้า

    ![การตรวจทานรายการใบแจ้งหนี้ข้อความอิสระในหน้าใบแจ้งหนี้ข้อความอิสระ](./media/er-keep-excel-rows-together-invoice.png)

## <a name="configure-the-er-framework"></a>ตั้งค่าคอนฟิกกรอบงาน ER

ปฏิบัติตามขั้นตอนใน [ตั้งค่าคอนฟิกกรอบงาน ER](er-quick-start2-customize-report.md#ConfigureFramework) เพื่อตั้งค่าชุดที่น้อยที่สุดของพารามิเตอร์ ER คุณต้องเสร็จสิ้นการตั้งค่านี้ก่อนที่คุณจะเริ่มใช้กรอบงาน ER เพื่อออกแบบรุ่นที่กำหนดเองของรูปแบบ ER มาตรฐาน

## <a name="import-the-standard-er-format-configuration"></a>นำเข้าไฟล์การตั้งค่าคอนฟิกรูปแบบ ER มาตรฐาน

ปฏิบัติตามขั้นตอนใน [นําเข้าการตั้งค่าคอนฟิกรูปแบบ ER มาตรฐาน](er-quick-start2-customize-report.md#ImportERSolution1) เพื่อเพิ่มการตั้งค่าคอนฟิก ER มาตรฐานลงในอินสแตนซ์ Dynamics 365 Finance ปัจจุบันของคุณ ตัวอย่างเช่น นำเข้ารุ่น **252.116** ของการตั้งค่าคอนฟิกรูปแบบ **ใบแจ้งหนี้ข้อความอิสระ (Excel)** รุ่นพื้นฐาน **252** องการตั้งค่าคอนฟิก **แบบจำลองใบแจ้งหนี้** พื้นฐานจะถูกนําเข้าโดยอัตโนมัติจากที่เก็บพร้อมกับการตั้งค่าคอนฟิก **การแมปแบบจำลองใบแจ้งหนี้** ที่ต้องการ

## <a name="set-up-print-management-to-use-the-standard-er-format"></a>ตั้งค่าการจัดการการพิมพ์เพื่อใช้รูปแบบ ER มาตรฐาน

ปฏิบัติตามขั้นตอนใน [ตั้งค่าการจัดการการพิมพ์](er-embed-images-header-footer-excel-reports.md#ConfigurePrintManagement1) เพื่อตั้งค่าคอนฟิกการจัดการการพิมพ์สำหรับโมดูล **บัญชีลูกหนี้** เพื่อให้มีการใช้รูปแบบ ER มาตรฐานในการพิมพ์ใบแจ้งหนี้ข้อความอิสระ

## <a name="configure-a-format-destination-for-the-standard-er-format"></a>ตั้งค่าคอนฟิกปลายทางรูปแบบของรูปแบบ ER มาตรฐาน

ปฏิบัติตามขั้นตอนใน [ตั้งค่าคอนฟิกปลายทางรูปแบบเพื่อดูตัวอย่างบนหน้าจอ](er-quick-start1-new-solution.md#ConfigureDestination) เพื่อตั้งค่าคอนฟิกปลายทาง ER [บนหน้าจอ](er-destination-type-screen.md) ของรูปแบบ ER มาตรฐาน เพื่อให้รายงานที่สร้างขึ้นแปลงเป็นรูปแบบ PDF และแสดงตัวอย่างบนแท็บเบราว์เซอร์ใหม่

## <a name="print-a-free-text-invoice-by-using-the-standard-er-format"></a>พิมพ์ใบแจ้งหนี้ข้อความอิสระโดยใช้รูปแบบ ER มาตรฐาน

1. ปฏิบัติตามขั้นตอนใน [พิมพ์ใบแจ้งหนี้ข้อความอิสระ](er-embed-images-header-footer-excel-reports.md#ProcessInvoice1) เพื่อใช้รูปแบบ ER มาตรฐานในการสร้างรายงานใบแจ้งหนี้ข้อความอิสระในรูปแบบ Excel ของใบแจ้งหนี้ที่เพิ่ม
2. ดาวน์โหลดเวิร์กบุ๊ก Excel ที่สร้างและตรวจทานในแอปพลิเคชัน Excel บนเดสก์ทอป

    โปรดสังเกตว่าบรรทัดที่หกของใบแจ้งหนี้จะเริ่มต้นในหน้าแรกของรายงาน และต่อไปในหน้าที่สอง หมายเหตุสุดท้ายจะปรากฏขึ้นบนหน้าที่สอง และไม่ใช่ของบรรทัดที่หกของใบแจ้งหนี้ ดังนั้นตัวแบ่งหน้าตรงกลางของเนื้อหารายการใบแจ้งหนี้จึงยากที่จะอ่านเอกสารนี้

    ![การตรวจทานการแบ่งหน้าของใบแจ้งหนี้ข้อความอิสระที่สร้างในแอปพลิเคชัน Excel บนเดสก์ท็อป](./media/er-keep-excel-rows-together-invoice1.gif)

ขั้นตอนที่เหลือในบทความนี้ แสดงวิธีการที่คุณสามารถปรับแต่งรูปแบบ ER มาตรฐาน เพื่อปรับปรุงลักษณะและความสามารถในการอ่านของรายงานใบแจ้งหนี้ โดยมีการรักษาเนื้อหาทั้งหมดของรายการใบแจ้งหนี้เดียวในหน้าเดียวกัน

## <a name="create-a-custom-format"></a>สร้างรูปแบบที่กำหนดเอง

ปฏิบัติตามขั้นตอนใน [สร้างรูปแบบที่กำหนดเอง](er-embed-images-header-footer-excel-reports.md#DeriveProvidedFormat) เพื่อให้ได้รับรูปแบบจากรูปแบบ ER ที่นําเข้า และสร้างการตั้งค่าคอนฟิก ER ที่กําหนดเองของ **ใบแจ้งหนี้ข้อความอิสระ (Excel)** ซึ่งพร้อมให้แก้ไขและปรับเปลี่ยนได้

## <a name="edit-the-custom-format"></a>แก้ไขรูปแบบแบบกำหนดเอง

1. ปฏิบัติตามขั้นตอนใน [สร้างรูปแบบที่กำหนดเอง](er-embed-images-header-footer-excel-reports.md#ConfigureDerivedFormat) เพื่อเปิดรูปแบบ ER ที่สืบทอดมาสำหรับการแก้ไขตัวออกแบบรูปแบบ ER
2. บนหน้า **ตัวออกแบบรูปแบบ** ในแผนผังส่วนประกอบรูปแบบในบานหน้าต่างด้านซ้าย ให้ขยาย **ใบแจ้งหนี้ข้อความอิสระ \> แผ่นงาน \> InvoiceLines** และเลือกส่วนประกอบ **InvoiceLines_Values**
3. บนแท็บ **รูปแบบ** ให้ตั้งค่าตัวเลือก **เก็บแถวไว้ด้วยกัน** เป็น **ใช่**

    ![การตั้งค่าตัวเลือก เก็บแถวไว้ด้วยกัน ของรูปแบบ ER ที่แก้ไขได้ในหน้าตัวออกแบบรูปแบบ](./media/er-keep-excel-rows-together-format.png)

4. เลือก **บันทึก** และปิดหน้า

## <a name="mark-the-custom-format-as-runnable"></a>ทำเครื่องหมายรูปแบบที่กำหนดเองเป็นที่สามารถรันได้

ปฏิบัติตามขั้นตอนใน [ทำเครื่องหมายรูปแบบที่กำหนดเองเป็นเรียกใช้ได้](er-embed-images-header-footer-excel-reports.md#MarkFormatRunnable) เพื่อให้รุ่นที่แก้ไขของรูปแบบ ER ที่กำหนดเองสามารถเรียกใช้ได้

## <a name="set-up-print-management-to-use-the-custom-er-format"></a>ตั้งค่าการจัดการการพิมพ์เพื่อใช้รูปแบบ ER ที่กำหนดเอง

ปฏิบัติตามขั้นตอนใน [ตั้งค่าการจัดการการพิมพ์](er-embed-images-header-footer-excel-reports.md#ConfigurePrintManagement2) เพื่อตั้งค่าคอนฟิกการจัดการการพิมพ์สำหรับโมดูล **บัญชีลูกหนี้** เพื่อให้มีการใช้รูปแบบ ER ที่กำหนดเองในการพิมพ์ใบแจ้งหนี้ข้อความอิสระ

## <a name="configure-a-format-destination-for-the-custom-er-format"></a>ตั้งค่าคอนฟิกปลายทางรูปแบบของรูปแบบ ER ที่กำหนดเอง

ปฏิบัติตามขั้นตอนใน [ตั้งค่าคอนฟิกปลายทางรูปแบบเพื่อดูตัวอย่างบนหน้าจอ](er-quick-start1-new-solution.md#ConfigureDestination) เพื่อตั้งค่าคอนฟิกปลายทาง ER **บนหน้าจอ** ของรูปแบบ ER ที่กำหนดเอง เพื่อให้รายงานที่สร้างขึ้นแปลงเป็นรูปแบบ PDF และแสดงตัวอย่างบนแท็บเบราว์เซอร์ใหม่

## <a name="print-a-free-text-invoice-by-using-the-custom-er-format"></a>พิมพ์ใบแจ้งหนี้ข้อความอิสระโดยใช้รูปแบบ ER ที่กำหนดเอง

1. ปฏิบัติตามขั้นตอนใน [พิมพ์ใบแจ้งหนี้ข้อความอิสระ](er-embed-images-header-footer-excel-reports.md#ProcessInvoice2) เพื่อใช้รูปแบบ ER ที่กำหนดเองในการสร้างรายงานใบแจ้งหนี้ข้อความอิสระในรูปแบบ Excel ของใบแจ้งหนี้ที่เพิ่ม
2. ดาวน์โหลดเวิร์กบุ๊ก Excel ที่สร้างและตรวจทานในแอปพลิเคชัน Excel บนเดสก์ทอป

    โปรดสังเกตว่าบรรทัดที่หกของใบแจ้งหนี้จะเริ่มต้นในหน้าที่สอง และแถว Excel ทั้งหมดที่แสดงถึงบรรทัดใบแจ้งหนี้นี้จะปรากฏขึ้นด้วยกันในหน้านั้น

    ![การตรวจทานการแบ่งหน้าที่อัปเดตของใบแจ้งหนี้ข้อความอิสระที่สร้างในแอปพลิเคชัน Excel บนเดสก์ท็อป](./media/er-keep-excel-rows-together-invoice2.gif)

## <a name="additional-resources"></a>ทรัพยากรเพิ่มเติม

[ออกแบบการตั้งค่าคอนฟิกสำหรับการสร้างเอกสารในรูปแบบ Excel](er-fillable-excel.md)

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
