---
title: ใช้การตั้งค่าคอนฟิก ER กับเท็มเพลต Excel มาใช้ใหม่เพื่อสร้างรายงานในรูปแบบ Word
description: หัวข้อนี้จะอธิบายวิธีการออกแบบรูปแบบรายงานที่ออกแบบมาเพื่อสร้างรายงาน เมื่อสามารถตั้งค่าคอนฟิกสมุดงาน Excel ให้สร้างรายงานเป็นเอกสาร Word ได้
author: NickSelin
ms.date: 01/11/2021
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, EROperationDesigner, LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: ab4cd4a390782936a74977ac2aef3790aa8ac1af
ms.sourcegitcommit: 951393b05bf409333cb3c7ad977bcaa804aa801b
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 04/13/2021
ms.locfileid: "5891706"
---
# <a name="reuse-er-configurations-with-excel-templates-to-generate-reports-in-word-format"></a>ใช้การตั้งค่าคอนฟิก ER กับเท็มเพลต Excel มาใช้ใหม่เพื่อสร้างรายงานในรูปแบบ Word

[!include [banner](../../includes/banner.md)]

หากต้องการสร้างรายงานเป็นเอกสาร Microsoft Word คุณสามารถ [ตั้งค่าคอนฟิก](../er-design-configuration-word.md) [การรายงานทางอิเล็กทรอนิกส์ (ER)](../general-electronic-reporting.md) [รูปแบบ](../general-electronic-reporting.md#FormatComponentOutbound) ใหม่ได้ หรือ คุณสามารถใช้รูปแบบ ER ที่ออกแบบไว้ในตอนแรกเพื่อสร้างรายงานเป็นสมุดงาน Excel ได้ ในกรณีนี้ คุณต้องแทนที่เท็มเพลต Excel ด้วยเท็มเพลต Word

กระบวนงานต่อไปนี้แสดงวิธีการที่ผู้ใช้ที่มีบทบาทเป็นผู้ดูแลระบบหรือบทบาทนักพัฒนาการรายงานทางอิเล็กทรอนิกส์ สามารถตั้งค่าคอนฟิกรูปแบบ ER เพื่อสร้างรายงานเป็นไฟล์ Word โดยการใช้รูปแบบ ER ใหม่ ที่ออกแบบมาเพื่อสร้างรายงานเป็นไฟล์ Excel

คุณสามารถดำเนินการกระบวนงานเหล่านี้ให้เสร็จสมบูรณ์ได้ในบริษัท GBSI

## <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น

เพื่อทำขั้นตอนในกระบวนงานนี้ให้เสร็จสมบูรณ์ ก่อนอื่นคุณต้องทำตามขั้นตอนใน คู่มืองาน [ออกแบบการตั้งค่าคอนฟิกสำหรับการสร้างรายงานในรูปแบบ OPENXML](er-design-reports-openxml-2016-11.md)

คุณยังต้องดาวน์โหลดและบันทึกเท็มเพลตต่อไปนี้ไว้ภายในเครื่อง สำหรับรายงานตัวอย่าง:

- [เท็มเพลตของรายงานการชำระเงิน (SampleVendPaymDocReport.docx)](https://go.microsoft.com/fwlink/?linkid=862266)
- [เท็มเพลตที่กำหนดขอบเขตของรายงานการชำระเงิน (SampleVendPaymDocReportBounded.docx)](https://go.microsoft.com/fwlink/?linkid=862266)

กระบวนงานเหล่านี้ใช้เฉพาะกับคุณลักษณะที่ถูกเพิ่มใน Dynamics 365 for Operations เวอร์ชัน 1611 (พฤศจิกายน 2016)

## <a name="select-the-existing-er-report-configuration"></a>เลือกการตั้งค่าคอนฟิกรายงาน ER ที่มีอยู่

1. ใน Dynamics 365 Finance ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. ตรวจสอบให้แน่ใจว่ามีการเลือกให้ผู้ให้บริการการตั้งค่าคอนฟิก **Litware, Inc.** เป็น **เปิดใช้งาน** ถ้าไม่มี ให้ปฏิบัติตามขั้นตอนใน คู่มืองาน [สร้างผู้ให้บริการการตั้งค่าคอนฟิก และทำเครื่องหมายเป็น ใช้งานอยู่](er-configuration-provider-mark-it-active-2016-11.md)
3. เลือก **การตั้งค่าคอนฟิกการรายงาน** คุณจะใช้การตั้งค่าคอนฟิก ER ที่มีอยู่ ซึ่งได้รับการออกแบบเพื่อสร้างเอาท์พุทรายงานในรูปแบบ OPENXML อีกครั้ง
4. บนหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิกในบานหน้าต่างด้านซ้าย ให้ขยาย **แบบจำลองการชำระเงิน** และเลือก **รายงานเวิร์กชีตตัวอย่าง**

    > [!NOTE]
    > เวอร์ชันแบบร่างของรูปแบบ ER ที่เลือก สามารถแก้ไขได้บนแท็บด่วน **เวอร์ชัน**

5. เลือก **ตัวออกแบบ**
6. ในหน้า **ตัวออกแบบรูปแบบ** ให้สังเกตว่าชื่อขององค์ประกอบรูปแบบรากบ่งชี้ว่ามีการใช้เท็มเพลต Excel อยู่ในขณะนี้

![การเลือกการตั้งค่าคอนฟิกที่มีอยู่](../media/er-design-configuration-word-2016-11-image01.gif)

## <a name="review-the-downloaded-word-template"></a>ตรวจทานเท็มเพลต Word ที่ดาวน์โหลด

1. ในแอพลิเคชันบนเดสก์ท็อปของ Word ให้เปิดไฟล์เท็มเพลต **SampleVendPaymDocReport.docx** ที่คุณดาวน์โหลดก่อนหน้านี้
2. ตรวจสอบว่าเท็มเพลตประกอบด้วยโครงร่างของเอกสารที่คุณต้องการสร้างเป็นเอาท์พุท ER เท่านั้น

![โครงร่างเท็มเพลต Word ในแอพลิเคชันบนเดสก์ทอป](../media/er-design-configuration-word-2016-11-image02.png)

## <a name="replace-the-excel-template-with-the-word-template-and-add-a-custom-xml-part"></a>แทนที่เท็มเพลต Excel ด้วยเท็มเพลต Word และเพิ่มส่วน XML แบบกำหนดเอง

ปัจจุบัน เอกสาร Excel จะใช้เป็นเท็มเพลตเพื่อสร้างเอาท์พุทในรูปแบบ OPENXML คุณจะแทนที่เท็มเพลตนี้ ด้วยไฟล์เท็มเพลต Word ชื่อ SampleVendPaymDocReport.docx ที่คุณดาวน์โหลดมาก่อนหน้านี้ คุณยังจะขยายเท็มเพลต Word โดยการเพิ่มส่วน XML แบบกำหนดเอง

1. ใน Finance บนหน้า **ตัวออกแบบรูปแบบ** บนแท็บ **รูปแบบ** ให้เลือก **เอกสารแนบ**
2. บนหน้า **เอกสารแนบ** ให้เลือก **ลบ** เพื่อลบเท็มเพลต Excel ที่มีอยู่ เลือก **ใช่** เพื่อยืนยันการเปลี่ยนแปลง
3. เลือก **ใหม่** \> **ไฟล์**

    > [!NOTE]
    > คุณต้องเลือกชนิดเอกสารที่มีการ [ตั้งค่าคอนฟิก](../electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) ในพารามิเตอร์ ER เพื่อจัดเก็บเท็มเพลตของรูปแบบ ER

4. เลือก **เลือกดู** แล้วเลือกดู และเลือกไฟล์ **SampleVendPaymDocReport.docx** ที่คุณดาวน์โหลดก่อนหน้านี้
5. เลือก **ตกลง**
6. ปิดหน้า **เอกสารแนบ**
7. ในหน้า **โปรแกรมออกแบบรูปแบบ** ในฟิลด์ **เท็มเพลต** ให้ป้อนหรือเลือกไฟล์ **SampleVendPaymDocReport.docx** เพื่อใช้เท็มเพลต Word นั้นแทนเท็มเพลต Excel ที่ใช้ก่อนหน้านี้
8. เลือก **บันทึก**

    นอกจากจะเก็บข้อมูลการเปลี่ยนแปลงการตั้งค่าคอนฟิก การดำเนินการ **บันทึก** ยังเป็นการอัปเดตเท็มเพลต Word ที่แนบอีกด้วย โครงสร้างตามลำดับของรูปแบบที่ได้รับการออกแบบมาถูกเพิ่มไปยังเอกสาร Word ที่แนบ เป็นส่วน XML แบบกำหนดเองใหม่ ที่มีชื่อว่า **รายงาน** เท็มเพลต Word ที่แนบมีโครงร่างของเอกสารที่จะสร้างเป็นเอาท์พุท ER และโครงสร้างของข้อมูลที่ ER จะป้อนลงในเท็มเพลตนี้ขณะรันไทม์

9. ให้สังเกตว่าชื่อขององค์ประกอบรูปแบบรากบ่งชี้ว่ามีการใช้เท็มเพลต Word อยู่ในขณะนี้

    ![การแทนที่เท็มเพลต Excel ด้วยเท็มเพลต Word และการเพิ่มส่วน XML แบบกำหนดเอง](../media/er-design-configuration-word-2016-11-image03.gif)

10. บนแท็บ **รูปแบบ** ให้เลือก **เอกสารแนบ**

ตอนนี้คุณสามารถแม็ปองค์ประกอบของส่วน XML **รายงาน** แบบกำหนดเองให้กับตัวควบคุมเนื้อหาของเอกสาร Word

ถ้าคุณคุ้นเคยกับกระบวนการของการออกแบบเอกสาร Word ที่เป็นแบบฟอร์มที่มี [ตัวควบคุมเนื้อหา](/office/client-developer/word/content-controls-in-word) ซึ่งถูกแม็บกับองค์ประกอบของ [ส่วน XML แบบกำหนดเอง](/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) ดำเนินการขั้นตอนทั้งหมดในกระบวนงานถัดไปให้เสร็จสิ้น เพื่อสร้างเอกสาร สำหรับข้อมูลเพิ่มเติม ให้ดูที่ [สร้างฟอร์มที่ผู้ใช้ดำเนินการให้เสร็จสิ้นหรือพิมพ์ใน Words](https://support.office.com/article/Create-forms-that-users-complete-or-print-in-Word-040c5cc1-e309-445b-94ac-542f732c8c8b) มิฉะนั้น ข้ามกระบวนงานถัดไป

## <a name="get-a-word-document-that-has-a-custom-xml-part-and-do-data-mapping"></a><a id='get-word-doc'></a>รับเอกสาร Word ที่มีส่วน XML แบบกำหนดเอง และแม็ปข้อมูล

1. ใน Finance บนหน้า **เอกสารแนบ** ให้เลือก **เปิด** เพื่อดาวน์โหลดเท็มเพลตที่เลือกจาก Finance และจัดเก็บเป็นเอกสาร Word ไว้ในเครื่อง
3. ในแอพลิเคชันบนเดสก์ท็อปของ Word ให้เปิดเอกสารที่คุณดาวน์โหลดมา
4. บนแท็บ **นักพัฒนา** ให้เลือก **บานหน้าต่างการแม็ป XML**

    > [!NOTE]
    > ถ้าแท็บ **นักพัฒนา** ไม่ปรากฏบน Ribbon ให้เลือกปรับแต่ง Ribbon เพื่อเพิ่มแท็บนั้น

5. ในบานหน้าต่าง **การแม็ป XML** ในฟิลด์ **ส่วน XML แบบกำหนดเอง** ให้เลือก ส่วน XML แบบกำหนดเองของ **รายงาน**
6. แม็ปองค์ประกอบของส่วน XML แบบกำหนดเองของ **รายงาน** ที่เลือก และตัวควบคุมเนื้อหาของเอกสาร Word
7. บันทึกเอกสาร Word ที่อัปเดตไว้ในเครื่อง เป็น **SampleVendPaymDocReportBounded.docx**

## <a name="review-the-word-template-where-the-custom-xml-part-is-mapped-to-content-controls"></a>ตรวจสอบเท็มเพลต Word ที่มีการแม็ปส่วน XML แบบกำหนดเอง กับตัวควบคุมเนื้อหา

1. ในแอพลิเคชันบนเดสก์ท็อปของ Word ให้เปิดไฟล์เท็มเพลต **SampleVendPaymDocReportBounded.docx**
2. ตรวจสอบว่าเท็มเพลตประกอบด้วยโครงร่างของเอกสารที่คุณต้องการสร้างเป็นเอาท์พุท ER เท่านั้น ตัวควบคุมเนื้อหาที่ใช้เป็นตัวยึดตัวยึดข้อมูลซึ่ง ER จะป้อนในเท็มเพลตนี้เมื่อรันไทม์ จะขึ้นอยู่กับการแม็ปที่มีการตั้งค่าคอนฟิกระหว่างองค์ประกอบของส่วน XML ที่กําหนดเองของ **รายงาน** และตัวควบคุมเนื้อหาของเอกสาร Word

![แสดงตัวอย่างเท็มเพลต Word ในแอพลิเคชันบนเดสก์ทอป](../media/er-design-configuration-word-2016-11-image04.png)

## <a name="upload-the-word-template-where-the-custom-xml-part-is-mapped-to-content-controls"></a>อัปโหลดเท็มเพลต Word ที่มีการแม็ปส่วน XML แบบกำหนดเองกับตัวควบคุมเนื้อหา

1. ใน Finance บนหน้า **เอกสารแนบ** ให้เลือก **ลบ** เพื่อลบเท็มเพลต Word ที่ไม่มีการแม็ประหว่างองค์ประกอบของส่วน XML แบบกำหนดเองของ **รายงาน** และตัวควบคุมเนื้อหา เลือก **ใช่** เพื่อยืนยันการเปลี่ยนแปลง
2. เลือก **ใหม่** \> **ไฟล์** เพื่อเพิ่มไฟล์เท็มเพลตใหม่ ที่มีการแม็ประหว่างองค์ประกอบของส่วน XML แบบกำหนดเองของ **รายงาน** และตัวควบคุมเนื้อหา

    > [!NOTE]
    > คุณต้องเลือกชนิดเอกสารที่มีการ [ตั้งค่าคอนฟิก](../electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) ในพารามิเตอร์ ER เพื่อจัดเก็บเท็มเพลตของรูปแบบ ER

3. เลือก **เลือกดู** แล้วเลือกดู และเลือกไฟล์ **SampleVendPaymDocReportBounded.docx** ที่คุณดาวน์โหลดหรือจัดเตรียมไว้ โดยการทํากระบวนงานในส่วน [รับ Word ที่มีส่วน XML แบบกำหนดเอง เพื่อแม็บข้อมูล](#get-word-doc)
4. เลือก **ตกลง**
5. ปิดหน้า **เอกสารแนบ**
6. ในหน้า **โปรแกรมออกแบบรูปแบบ** ในฟิลด์ **เท็มเพลต** ให้เลือกเอกสารที่คุณเพิ่งดาวน์โหลด
7. เลือก **บันทึก**
8. ปิดหน้า **ตัวออกแบบรูปแบบ**

## <a name="mark-the-configured-format-as-runnable"></a>ทำเครื่องหมายรูปแบบที่ตั้งค่าคอนฟิกเป็นรันได้

เมื่อต้องการรันเวอร์ชันแบบร่างของรูปแบบที่แก้ไขได้ คุณต้องตั้งค่า [ให้รันได้](../er-quick-start2-customize-report.md#MarkFormatRunnable)

1. ใน Finance บนหน้า **การตั้งค่าคอนฟิก** บนบานหน้าต่างการดำเนินการ บนแท็บ **การตั้งค่าคอนฟิก** ในกลุ่ม **การตั้งค่าล่วงหน้า** เลือก **พารามิเตอร์ผู้ใช้**
2. ในกล่องโต้ตอบ **พารามิเตอร์ผู้ใช้** ให้ตั้งค่าตัวเลือก **เรียกใช้การตั้งค่า** เป็น **ใช่** และจากนั้น เลือก **ตกลง**
3. ให้เลือก **แก้ไข้** เพื่อทำให้หน้าปัจจุบันพร้อมสำหรับการแก้ไข หากจำเป็น
4. สำหรับการตั้งค่าคอนฟิก **รายงานเวิร์กชีตตัวอย่าง** ที่เลือกในปัจจุบัน ให้ตั้งค่าตัวเลือก **รันแบบร่าง** เป็น **ใช่**
5. เลือก **บันทึก**

## <a name="run-the-format-to-create-output-in-word-format"></a>รันรูปแบบเพื่อสร้างผลลัพธ์ในรูปแบบ Word

1. ใน Finance ไปที่ **บัญชีเจ้าหนี้** \> **การชำระเงิน** \> **สมุดรายวันการชำระเงิน**
2. ในสมุดรายวันการชำระเงินที่คุณป้อนไว้ก่อนหน้านี้ ให้เลือก **บรรทัด**
3. บนหน้า **การชำระเงินให้แก่ผู้จัดจำหน่าย** ให้เลือกแถวทั้งหมดในกริด
4. เลือก **สถานะการชำระเงิน** \> **ไม่มี**

    ![การชําระเงินสำหรับการดำเนินการ บนหน้าการชําระเงินให้แก่ผู้จัดจําหน่าย](../media/er-design-configuration-word-2016-11-image05.png)

5. ในบานหน้าต่างการดำเนินการ เลือก **สร้างการชำระเงิน**
6. ในกล่องโต้ตอบที่ปรากฎขึ้น ให้ทำตามขั้นตอนเหล่านี้:

    1. เลือกฟิลด์ **วิธีการชำระเงิน** เลือก **อิเล็กทรอนิกส์**
    2. ในฟิลด์ **บัญชีธนาคาร** ให้เลือก **GBSI OPER**
    3. เลือก **ตกลง**

7. ในกล่องโต้ตอบ **พารามิเตอร์ของรายงานทางอิเล็กทรอนิกส์** เลือก **ตกลง**
8. ผลลัพธ์ที่สร้างขึ้นจะแสดงในรูปแบบ Word และประกอบด้วยรายละเอียดเกี่ยวกับการชำระเงินที่ประมวลผลแล้ว วิเคราะห์ผลลัพธ์ที่สร้างขึ้น

    ![ผลลัพธ์ที่สร้างขึ้นในรูปแบบ Word](../media/er-design-configuration-word-2016-11-image06.png)

## <a name="additional-resources"></a>ทรัพยากรเพิ่มเติม

- [ออกแบบการตั้งค่าคอนฟิก ER ใหม่ เพื่อสร้างรายงานในรูปแบบ Word](../er-design-configuration-word.md)
- [ฝังข้อมูลและรูปร่างในเอกสารที่คุณสร้างโดยใช้ ER](../electronic-reporting-embed-images-shapes.md#embed-an-image-in-a-word-document)


[!INCLUDE[footer-include](../../../../includes/footer-banner.md)]