---
title: ออกแบบโซลูชัน ER ใหม่เพื่อพิมพ์รายงานแบบกำหนดเอง
description: หัวข้อนี้จะอธิบายวิธีการออกแบบโซลูชันการรายงานทางอิเล็กทรอนิกส์ (ER) เพื่อพิมพ์รายงานแบบกำหนดเอง
author: NickSelin
ms.date: 08/10/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, ERParameters, ERDataModelDesigner, ERModelMappingTable, ERModelMappingDesigner, EROperationDesigner, ERVendorTable
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom:
- "220314"
- intro-internal
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: 36998d299e166709778bfaa7bfd0d8980890d4fe
ms.sourcegitcommit: d5d6b81bd8b08de20cc018c2251436065982489e
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 02/17/2022
ms.locfileid: "8323853"
---
# <a name="design-a-new-er-solution-to-print-a-custom-report"></a>ออกแบบโซลูชัน ER ใหม่เพื่อพิมพ์รายงานแบบกำหนดเอง

[!include[banner](../includes/banner.md)]

ขั้นตอนต่อไปนี้อธิบายถึงวิธีการที่ผู้ใช้ในบทบาทผู้ดูแลระบบ ผู้พัฒนาการรายงานทางอิเล็กทรอนิกส์ หรือผู้ที่ปรึกษาด้านการรายงานทางอิเล็กทรอนิกส์ สามารถตั้งค่าคอนฟิกพารามิเตอร์ของกรอบงาน ER การออกแบบการตั้งค่าคอนฟิก ER ที่จำเป็นต้องใช้ของโซลูชัน ER ใหม่เพื่อเข้าถึงข้อมูลของโดเมนธุรกิจเฉพาะ และสร้างรายงานแบบกำหนดเองในรูปแบบ Microsoft Office คุณสามารถดำเนินการขั้นตอนเหล่านี้ได้ในบริษัท **USMF**

- [ตั้งค่าคอนฟิกกรอบงาน ER](#ConfigureFramework)

    - [ตั้งค่าคอนฟิกพารามิเตอร์ ER](#ConfigureParameters)
    - [เปิดใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER](#ActivateProvider)

        - [ตรวจทานรายการของผู้ให้บริการการตั้งค่าคอนฟิก ER](#ReviewProvidersList)
        - [เพิ่มผู้ให้บริการการตั้งค่าคอนฟิก ER ใหม่](#AddProvider)
        - [เปิดใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER](#ActivateAddedProvider)

- [ออกแบบรูปแบบข้อมูลเฉพาะโดเมน](#DesignModel)

    - [นำเข้าการตั้งค่าคอนฟิกรูปแบบข้อมูลใหม่](#ImportDataModel)
    - [สร้างการตั้งค่าคอนฟิกรูปแบบข้อมูลใหม่](#DesignDataModel)

        - [ตั้งชื่อรูปแบบข้อมูล](#NameDataModel)
        - [เพิ่มฟิลด์รูปแบบข้อมูล](#FieldsEntry)
        - [ทำการออกแบบของรูปแบบข้อมูลให้เสร็จสมบูรณ์](#CompleteDataModel)

- [ออกแบบการแมปรูปแบบสำหรับรูปแบบข้อมูลที่ตั้งค่าคอนฟิก](#DesignMapping)

    - [นำเข้าการตั้งค่าคอนฟิกการแมปรูปแบบใหม่](#ImportModelMapping)
    - [สร้างการตั้งค่าคอนฟิกการแมปรูปแบบใหม่](#CreateModelMapping)

        - [ออกแบบส่วนประกอบการแมปรูปแบบใหม่](#DesignMappingComponent)
        - [เพิ่มแหล่งข้อมูลที่จะเข้าถึงตารางแอปพลิเคชัน](#AddMmDataSource1)
        - [เพิ่มแหล่งข้อมูลที่จะเข้าถึงการแจงนับแอปพลิเคชัน](#AddMmDataSource2)
        - [เพิ่มป้ายชื่อ ER เพื่อสร้างรายงานในภาษาที่ระบุ](#AddMmLabels)
        - [เพิ่มแหล่งข้อมูลเพื่อแปลงผลลัพธ์ของการเปรียบเทียบค่าการแจงนับเป็นค่าข้อความ](#AddMmDataSource3)
        - [ผูกแหล่งข้อมูลเข้ากับฟิลด์รูปแบบข้อมูล](#AddMmBindings1)
        - [ทำการออกแบบการแมปรูปแบบให้เสร็จสมบูรณ์](#CompleteModelMapping)

- [ออกแบบเทมเพลตสำหรับรายงานแบบกำหนดเอง](#DesignReportTemplate)
- [ออกแบบรูปแบบ](#DesignFormat)

    - [นำเข้าการตั้งค่าคอนฟิกรูปแบบที่ออกแบบ](#FormatImport)
    - [สร้างการตั้งค่าคอนฟิกรูปแบบใหม่](#FormatCreate)

        - [นำเข้าเทมเพลตของรายงาน](#ImportReportTemplate)
        - [ตั้งค่าคอนฟิกรูปแบบ](#ConfigureFormat)
        - [กำหนดการผูกข้อมูลสำหรับชื่อรายงาน](#DefineFormatBindings)
        - [ตรวจสอบแหล่งข้อมูลรูปแบบ](#ReviewModelDataSource)
        - [ผูกองค์ประกอบของรูปแบบกับฟิลด์แหล่งข้อมูล](#BindFormatElements)

    - [เรียกใช้รูปแบบที่ออกแบบจาก ER](#RunFormatFromER)

- [ปรับแต่งรูปแบบที่ออกแบบ](#TuneFormat)

    - [แก้ไขรูปแบบที่จะเปลี่ยนชื่อของเอกสารที่สร้าง](#ModifyToChangeName)
    - [ปรับเปลี่ยนรูปแบบที่จะเปลี่ยนลำดับของคำถาม](#ModifyToOrder)
    - [เรียกใช้รูปแบบที่ปรับเปลี่ยนจาก ER](#RunFormatFromER2)
    - [ทำการออกแบบรูปแบบให้เสร็จสมบูรณ์](#CompleteFormat)

- [พัฒนาอาร์ทิแฟกต์ของแอปพลิเคชันเพื่อเรียกรายงานที่ออกแบบ](#DevelopCustomCode)

    - [ปรับเปลี่ยนโค้ดต้นฉบับ](#ModifySourceCode)

        - [เพิ่มคลาสสัญญาข้อมูล](#DataContractClass)
        - [เพิ่มคลาสตัวสร้าง UI](#UIBuilderClass)
        - [เพิ่มคลาสผู้ให้บริการข้อมูล](#DataProviderClass)
        - [เพิ่มไฟล์ป้ายชื่อ](#LabelsFile)
        - [เพิ่มคลาสบริการรายงาน](#ServiceClass)
        - [เพิ่มคลาสตัวควบคุมรายงาน](#ControllerClass)
        - [เพิ่มรายการเมนู](#MenuItem)
        - [เพิ่มรายการเมนูลงในเมนู](#Menu)
        - [สร้างโครงการ Visual Studio](#BuildVSProject)

    - [เรียกใช้รูปแบบจากแอปพลิเคชัน](#RunFormatFromApp)

- [ปรับแต่งโซลูชัน ER ที่ออกแบบ](#TuneSolution)

    - [ปรับเปลี่ยนการแมปรูปแบบ](#ModifyModelMapping)

        - [เพิ่มแหล่งข้อมูลที่จะเข้าถึงออบเจ็กต์สัญญาข้อมูล](#AddDataSource1)
        - [เพิ่มแหล่งข้อมูลที่จะเข้าถึงเรกคอร์ดการแมปรูปแบบ ER](#AddDataSource2)
        - [เพิ่มแหล่งข้อมูลที่จะเข้าถึงเรกคอร์ดการแมปรูปแบบของรูปแบบ ER ที่เรียกใช้](#AddDataSource3)
        - [ป้อนชื่อของรูปแบบ ER ที่กำลังทำงานอยู่ในรูปแบบข้อมูล](#AddBinding)
        - [ทำการออกแบบการแมปรูปแบบให้เสร็จสมบูรณ์](#CompleteModelMapping2)

    - [ปรับเปลี่ยนรูปแบบ](#ModifyFormat)

        - [เพิ่มองค์ประกอบรูปแบบใหม่](#AddFormatElement)
        - [ผูกองค์ประกอบรูปแบบที่เพิ่ม](#BindAddedFormatElement)
        - [ทำการออกแบบรูปแบบให้เสร็จสมบูรณ์](#CompleteFormat2)

    - [เรียกใช้รูปแบบจากแอปพลิเคชัน](#RunFormatFromApp2)
    - [เรียกใช้รูปแบบจาก ER](#RunFormatFromER3)
    - [ตั้งค่าคอนฟิกปลายทางรูปแบบสำหรับการแสดงตัวอย่างบนหน้าจอ](#ConfigureDestination)
    - [เรียกใช้รูปแบบจากแอปพลิเคชันเพื่อแสดงตัวอย่างเป็นเอกสาร PDF](#RunFormatFromApp3)

- [ทรัพยากรเพิ่มเติม](#References)

ในตัวอย่างนี้ คุณจะสร้างโซลูชัน ER ใหม่สำหรับโมดูล [แบบสอบถาม](../../../human-resources/hr-learning-questionnaires.md) โซลูชัน ER ใหม่นี้ช่วยให้คุณสามารถออกแบบรายงานโดยใช้เวิร์กชีต Microsoft Excel เป็นเทมเพลต จากนั้น คุณจะสามารถสร้างรายงาน **แบบสอบถาม** ในรูปแบบ Excel หรือ PDF นอกจากนี้ เมื่อต้องการสร้างรายงาน SQL Server Reporting Services (SSRS) ที่มีอยู่ นอกจากนี้ คุณยังสามารถปรับเปลี่ยนรายงานใหม่ได้ในภายหลังเมื่อมีการร้องขอ ไม่จำเป็นต้องมีการเขียนโค้ด

1. เมื่อต้องการเรียกใช้รายงานที่มีอยู่ ให้ไปที่ **แบบสอบถาม** \> **ออกแบบ** \> **รายงานแบบสอบถาม**

    ![การเลือกรายการเมนูรายงานแบบสอบถามในโมดูลแบบสอบถาม เพื่อเรียกใช้รายงาน SSRS ที่มีอยู่](./media/er-quick-start1-application-menu-origin.png)

2. ในกล่องโต้ตอบ **รายงานแบบสอบถาม** ให้ระบุเงื่อนไขการเลือก ใช้ตัวกรองเพื่อให้รายงานรวมเฉพาะแบบสอบถาม **SBCCrsExam** เท่านั้น

    ![การระบุเงื่อนไขการเลือกในกล่องโต้ตอบรายงานแบบสอบถาม](./media/er-quick-start1-ssrs-report-dialog.png)

ภาพประกอบต่อไปนี้แสดงรุ่นที่สร้างขึ้นของรายงาน SSRS สำหรับแบบสอบถาม **SBCCrsExam**

![รายงาน SSRS ที่สร้าง](./media/er-quick-start1-ssrs-report.png)

## <a name="configure-the-er-framework"></a><a name="ConfigureFramework"></a>ตั้งค่าคอนฟิกกรอบงาน ER

ในฐานะผู้ใช้ในบทบาทนักพัฒนาการรายงานทางอิเล็กทรอนิกส์ คุณต้องตั้งค่าคอนฟิกชุดพารามิเตอร์ ER ที่ น้อยที่สุดก่อนที่คุณจะสามารถเริ่มต้นการใช้กรอบงาน ER เพื่อออกแบบโซลูชัน ER ใหม่ของคุณ

### <a name="configure-er-parameters"></a><a name="ConfigureParameters"></a>ตั้งค่าคอนฟิกพารามิเตอร์ ER

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. ในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** เลือก **พารามิเตอร์การรายงานทางอิเล็กทรอนิกส์**
3. ในหน้า **พารามิเตอร์การรายงานทางอิเล็กทรอนิกส์** บนแท็บ **ทั่วไป** ตั้งค่าตัวเลือก **เปิดใช้งานโหมดการออกแบบ** เป็น **ใช่**
4. บนแท็บ **เอกสารแนบ** ให้ตั้งค่าพารามิเตอร์ต่อไปนี้:

    - ตั้งค่าฟิลด์ **การตั้งค่าคอนฟิก** เป็น **ไฟล์** สำหรับบริษัท **USMF**
    - ตั้งค่าฟิลด์ **ที่เก็บงานถาวร** **ชั่วคราว** **พื้นฐาน** และ **อื่นๆ** เป็น **ไฟล์**

สำหรับข้อมูลเพิ่มเติมเกี่ยวกับพารามิเตอร์ ER ให้ดูที่ [ตั้งค่าคอนฟิกกรอบงาน ER](electronic-reporting-er-configure-parameters.md)

### <a name="activate-an-er-configuration-provider"></a><a name="ActivateProvider"></a>เปิดใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER

มีการทำเครื่องหมายการตั้งค่าคอนฟิก ER ทั้งหมดที่เป็นเจ้าของโดยผู้ให้บริการการตั้งค่าคอนฟิก ER ดังนั้นคุณต้องเรียกใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER ในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** ก่อนที่คุณจะเริ่มต้นการเพิ่มหรือแก้ไขการตั้งค่าคอนฟิก ER

> [!NOTE]
> เฉพาะเจ้าของที่มีการตั้งค่าคอนฟิก ER เท่านั้นที่สามารถแก้ไขได้ ดังนั้นก่อนที่จะแก้ไขการตั้งค่าคอนฟิก ER ต้องมีการเรียกใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER ในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** ที่เหมาะสม

#### <a name="review-the-list-of-er-configuration-providers"></a><a name="ReviewProvidersList"></a>ตรวจทานรายการของผู้ให้บริการการตั้งค่าคอนฟิก ER

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. ในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** ในส่วน **ลิงค์ที่เกี่ยวข้อง** ให้เลือก **ผู้ให้บริการการตั้งค่าคอนฟิก**
3. บนหน้า **ผู้ให้บริการการตั้งค่าคอนฟิก** แต่ละเรกคอร์ดผู้ให้บริการการตั้งค่าคอนฟิกจะมีชื่อและ URL ที่ไม่ซ้ำกัน ตรวจทานเนื้อหาของหน้านี้ ถ้ามีเรกคอร์ดสำหรับ **Litware, inc.** (`https://www.litware.com`) อยู่แล้ว ให้ข้ามขั้นตอนถัดไป [เพิ่มผู้ให้บริการการตั้งค่าคอนฟิก ER ใหม่](#ActivateProvider)

#### <a name="add-a-new-er-configuration-provider"></a><a name="AddProvider"></a>เพิ่มผู้ให้บริการการตั้งค่าคอนฟิก ER ใหม่

1. ในหน้า **ผู้ให้บริการการตั้งค่าคอนฟิก** เลือก **ใหม่**
2. ในฟิลด์ **ชื่อ** ให้ป้อน **Litware, Inc.**
3. ในฟิลด์ **ที่อยู่อินเทอร์เน็ต** ให้ป้อน `https://www.litware.com`
4. เลือก **บันทึก**

#### <a name="activate-an-er-configuration-provider"></a><a name="ActivateAddedProvider"></a>เปิดใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. ในพื้นที่ทำงาน **การรายงานอิเล็กทรอนิกส์** ให้เลือกผู้ให้บริการการตั้งค่าคอนฟิก **Litware, Inc.**
3. เลือก **กำหนดเป็นใช้งานอยู่**

สำหรับข้อมูลเพิ่มเติมเกี่ยวกับผู้ให้บริการการตั้งค่าคอนฟิก ER ให้ดูที่ [สร้างผู้ให้บริการการตั้งค่าคอนฟิก และทำเครื่องหมายเป็นใช้งานอยู่](tasks/er-configuration-provider-mark-it-active-2016-11.md)

## <a name="design-a-domain-specific-data-model"></a><a name="DesignModel"></a>ออกแบบรูปแบบข้อมูลเฉพาะโดเมน

คุณต้องสร้างการตั้งค่าคอนฟิก ER ใหม่ที่มีส่วนประกอบ รูปแบบข้อมูลสำหรับโดเมนธุรกิจ **แบบสอบถาม** รูปแบบข้อมูลนี้จะใช้เป็นแหล่งข้อมูลในภายหลังเมื่อคุณออกแบบรูปแบบ ER เพื่อสร้างรายงาน **แบบสอบถาม**

เมื่อดำเนินการขั้นตอนนี้ในส่วน [นำเข้าการตั้งค่าคอนฟิกรูปแบบข้อมูลใหม่](#ImportDataModel) แล้ว คุณสามารถนำเข้ารูปแบบข้อมูลที่จำเป็นจากไฟล์ XML ที่ระบุ อีกทางหนึ่งคือ คุณสามารถทำขั้นตอนนี้ให้เสร็จสมบูรณ์ได้ในส่วน [สร้างการตั้งค่าคอนฟิกรูปแบบข้อมูลใหม่](#DesignDataModel) เพื่อออกแบบรูปแบบข้อมูลนี้ตั้งแต่เริ่มต้น

### <a name="import-a-new-data-model-configuration"></a><a name="ImportDataModel"></a>นำเข้าการตั้งค่าคอนฟิกรูปแบบข้อมูลใหม่

1. ดาวน์โหลดไฟล์ [Questionnaires model.version.1.xml](https://download.microsoft.com/download/b/6/3/b633bd34-d200-4422-96d9-8f62eb5218f8/Questionnaires_model.version.1.xml) และบันทึกไปยังคอมพิวเตอร์เฉพาะที่ของคุณ
2. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
3. ในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** เลือก **การตั้งค่าคอนฟิกการรายงาน**
4. ในบานหน้าต่างการดำเนินการ เลือก **แลกเปลี่ยน** \> **โหลดจากไฟล์ XML**
5. เลือก **เรียกดู** แล้วค้นหาและเลือกไฟล์ **Questionnaires model.version.1.xml**
6. เลือก **ตกลง** เพื่อนำเข้าการตั้งค่าคอนฟิก

เมื่อต้องการดำเนินการต่อ ให้ข้ามขั้นตอนถัดไป [สร้างการตั้งค่าคอนฟิกรูปแบบข้อมูลใหม่](#DesignDataModel)

### <a name="create-a-new-data-model-configuration"></a><a name="DesignDataModel"></a>สร้างการตั้งค่าคอนฟิกรูปแบบข้อมูลใหม่

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. ในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** เลือก **การตั้งค่าคอนฟิกการรายงาน**
3. เลือก **สร้างการตั้งค่าคอนฟิก**
4. ในกล่องโต้ตอบรายการแบบหล่นลง ในฟิลด์ **ชื่อ** ให้ป้อน **รูปแบบแบบสอบถาม**
5. เลือก **สร้างการตั้งค่าคอนฟิก** เพื่อสร้างการตั้งค่าคอนฟิก

#### <a name="name-the-data-model"></a><a name="NameDataModel"></a>ตั้งชื่อรูปแบบข้อมูล

1. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก เลือก **รูปแบบแบบสอบถาม**
2. เลือก **ตัวออกแบบ**
3. บนหน้า **ตัวออกแบบรูปแบบข้อมูล** บนแท็บด่วน **ทั่วไป** ในฟิลด์ **ชื่อ** ให้ป้อน <a name="DataModeName"></a>**แบบสอบถาม**

#### <a name="add-new-data-model-fields"></a><a name="FieldsEntry"></a>เพิ่มฟิลด์รูปแบบข้อมูลใหม่

1. ในหน้า **ตัวออกแบบรูปแบบข้อมูล** เลือก **สร้าง**
2. ในกล่องโต้ตอบแบบหล่นลงสำหรับการเพิ่มโหนดรูปแบบข้อมูล ให้ทำตามขั้นตอนต่อไปนี้:

    1. เลือก **รากของรูปแบบ** เป็นชนิดโหนดใหม่
    2. ในฟิลด์ **ชื่อ** ให้ป้อน <a name="RootDefinitionName"></a>**ราก**
    3. เลือก **เพิ่ม** เพื่อเพิ่มโหนดใหม่

    ตัวอธิบายรากนี้จะใช้เพื่อให้ข้อมูลสำหรับรายงาน **แบบสอบถาม** รูปแบบข้อมูลเดียวสามารถมีตัวอธิบายได้หลายรายการ คุณสามารถระบุตัวอธิบายแต่ละตัวสำหรับรูปแบบ ER เดียวเพื่อระบุข้อมูลที่จำเป็นในการสร้างรายงาน

3. เลือก **สร้าง** อีกครั้ง จากนั้นในกล่องโต้ตอบแบบหล่นลงสำหรับการเพิ่มโหนดรูปแบบข้อมูล ให้ทำตามขั้นตอนต่อไปนี้:

    1. เลือก **รายการรองของโหนดที่ใช้งานอยู่** เป็นชนิดโหนดใหม่
    2. ในฟิลด์ **ชื่อ** ให้ป้อน **ชื่อบริษัท**
    3. ในฟิลด์ **ประเภทรายการ** ให้เลือก **สตริง**
    4. เลือก **เพิ่ม** เพื่อเพิ่มฟิลด์ใหม่

    ฟิลด์นี้จำเป็นต้องใช้ในการส่งชื่อของบริษัทปัจจุบันไปยังรายงาน ER ซึ่งจะใช้รูปแบบข้อมูลนี้เป็นแหล่งข้อมูล

4. เลือก **สร้าง** อีกครั้ง จากนั้นในกล่องโต้ตอบแบบหล่นลงสำหรับการเพิ่มโหนดรูปแบบข้อมูล ให้ทำตามขั้นตอนต่อไปนี้:

    1. เลือก **รายการรองของโหนดที่ใช้งานอยู่** เป็นชนิดโหนดใหม่
    2. ในฟิลด์ **ชื่อ** ให้ป้อน **แบบสอบถาม**
    3. ในฟิลด์ **ประเภทรายการ** ให้เลือก **รายการเรกคอร์ด**
    4. เลือก **เพิ่ม** เพื่อเพิ่มฟิลด์ใหม่

    ฟิลด์นี้จะต้องใช้ในการส่งรายการของแบบสอบถามไปยังรายงาน ER ซึ่งจะใช้รูปแบบข้อมูลนี้เป็นแหล่งข้อมูล

5. เลือกโหนด **แบบสอบถาม**
6. ดำเนินการต่อเพื่อเพิ่มฟิลด์ที่จำเป็นของรูปแบบข้อมูลที่สามารถแก้ไขได้ในลักษณะเดียวกันจนกว่าคุณจะกรอกข้อมูลโครงสร้างรูปแบบข้อมูลต่อไปนี้

    | พาธของฟิลด์                                                    | ชนิดข้อมูล   | การกำหนดฟิลด์/ค่าที่ส่งคืน |
    |---------------------------------------------------------------|-------------|----------------------------------|
    | ราก                                                          |             | จุดอ้างอิงที่จะร้องขอข้อมูลแบบสอบถาม |
    | Root\\CompanyName                                             | สตริง      | ชื่อของบริษัทปัจจุบัน |
    | Root\\ExecutionContext                                        | เรกคอร์ด      | รายละเอียดการดำเนินการรูปแบบ |
    | Root\\ExecutionContext\\FormatName                            | สตริง      | ชื่อของรูปแบบ ER ที่กำลังทำงานอยู่ |
    | Root\\Questionnaire                                           | รายการเรกคอร์ด | รายการของแบบสอบถาม |
    | Root\\Questionnaire\\Active                                   | สตริง      | สถานะของแบบสอบถามปัจจุบัน |
    | Root\\Questionnaire\\Code                                     | สตริง      | โค้ดของแบบสอบถามปัจจุบัน |
    | Root\\Questionnaire\\Description                              | สตริง      | คำอธิบายของแบบสอบถามปัจจุบัน |
    | Root\\Questionnaire\\QuestionnaireType                        | สตริง      | ชนิดของแบบสอบถามปัจจุบัน |
    | Root\\Questionnaire\\QuestionOrder                            | สตริง      | ลำดับตัวเลขของแบบสอบถามปัจจุบัน |
    | Root\\Questionnaire\\ResultsGroup                             | เรกคอร์ด      | พารามิเตอร์ที่เป็นผลลัพธ์ของแบบสอบถามปัจจุบัน |
    | Root\\Questionnaire\\ResultsGroup\\Code                       | สตริง      | รหัสระบุของกลุ่มผลลัพธ์ปัจจุบัน |
    | Root\\Questionnaire\\ResultsGroup\\Description                | สตริง      | คำอธิบายของกลุ่มผลลัพธ์ปัจจุบัน |
    | Root\\Questionnaire\\ResultsGroup\\MaxNumberOfPoints          | จำนวนจริง        | จำนวนคะแนนสูงสุดที่สามารถได้รับ |
    | Root\\Questionnaire\\Question                                 | รายการเรกคอร์ด | รายการของคำถามสำหรับแบบสอบถามปัจจุบัน |
    | Root\\Questionnaire\\Question\\CollectionSequenceNumber       | เลขจำนวนเต็ม     | หมายเลขลำดับของชุดคำตอบปัจจุบัน |
    | Root\\Questionnaire\\Question\\Id                             | สตริง      | รหัสระบุของคำถามปัจจุบัน |
    | Root\\Questionnaire\\Question\\MustBeCompleted                | สตริง      | แฟล็กที่แสดงว่าต้องมีการตอบคำถามปัจจุบันหรือไม่ |
    | Root\\Questionnaire\\Question\\PrimaryQuestion                | สตริง      | แฟล็กที่แสดงว่าต้องคำถามปัจจุบันเป็นรายการหลักหรือไม่ |
    | Root\\Questionnaire\\Question\\SequenceNumber                 | เลขจำนวนเต็ม     | หมายเลขลำดับของคำถามปัจจุบัน |
    | Root\\Questionnaire\\Question\\Text                           | สตริง      | ข้อความของคำถามปัจจุบัน |
    | Root\\Questionnaire\\Question\\Answer                         | รายการเรกคอร์ด | รายการของคำตอบสำหรับคำถามปัจจุบัน |
    | Root\\Questionnaire\\Question\\Answer\\CorrectAnswer          | สตริง      | แฟล็กที่แสดงว่าคำตอบปัจจุบันถูกต้องหรือไม่ |
    | Root\\Questionnaire\\Question\\Answer\\Points                 | จำนวนจริง        | คะแนนที่ทำได้เมื่อมีการเลือกคำตอบปัจจุบัน |
    | Root\\Questionnaire\\Question\\Answer\\SequenceNumber         | เลขจำนวนเต็ม     | หมายเลขลำดับของคำตอบปัจจุบัน |
    | Root\\Questionnaire\\Question\\Answer\\Text                   | สตริง      | ข้อความของคำตอบปัจจุบัน |

    ภาพประกอบต่อไปนี้แสดงรูปแบบข้อมูลที่สามารถแก้ไขที่เสร็จสมบูรณ์บนหน้า **ตัวออกแบบรูปแบบข้อมูล**

    ![รูปแบบข้อมูลที่ตั้งค่าคอนฟิกในตัวออกแบบรูปแบบข้อมูล ER](./media/er-quick-start1-model2.png)

7. บันทึกการเปลี่ยนแปลง
8. ปิดหน้า **ตัวออกแบบรูปแบบข้อมูล**

#### <a name="complete-the-design-of-the-data-model"></a><a name="CompleteDataModel"></a>ทำการออกแบบของรูปแบบข้อมูลให้เสร็จสมบูรณ์

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก เลือก **รูปแบบแบบสอบถาม**
3. บนแท็บด่วน **รุ่น** ให้เลือกรุ่นการตั้งค่าคอนฟิกที่มีสถานะเป็น **แบบร่าง**
4. เลือก **เปลี่ยนแปลงสถานะ** \> **เสร็จสมบูรณ์**

สถานะของรุ่น 1 ของการตั้งค่าคอนฟิกนี้มีการเปลี่ยนแปลงจาก **แบบร่าง** เป็น **เสร็จสมบูรณ์** รุ่น 1 ไม่สามารถเปลี่ยนแปลงได้อีกต่อไป รุ่นนี้มีรูปแบบข้อมูลที่ตั้งค่าคอนฟิกและสามารถใช้เป็นข้อมูลพื้นฐานสำหรับการตั้งค่าคอนฟิก ER อื่นๆ รุ่น 2 ของการตั้งค่าคอนฟิกนี้จะถูกสร้างขึ้นและมีสถานะเป็น **แบบร่าง** คุณสามารถแก้ไขรุ่นนี้เพื่อปรับปรุงรูปแบบข้อมูล **แบบสอบถาม**

![รุ่นของการตั้งค่าคอนฟิกที่แก้ไขได้บนหน้าการตั้งค่าคอนฟิก](./media/er-quick-start1-model-configuration.png)

สำหรับข้อมูลเพิ่มเติมเกี่ยวกับการกำหนดรุ่นสำหรับการตั้งค่าคอนฟิก ER โปรดดู [ภาพรวมของการรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md#component-versioning)

> [!NOTE]
> รูปแบบข้อมูลที่ตั้งค่าคอนฟิกเป็นการแสดงเชิงนามธรรมของโดเมนธุรกิจ **แบบสอบถาม** และไม่มีความสัมพันธ์กับอาร์ทิแฟกต์ที่เกี่ยวข้องกับ Microsoft Dynamics 365 Finance

## <a name="design-a-model-mapping-for-the-configured-data-model"></a><a name="DesignMapping"></a>ออกแบบการแมปรูปแบบสำหรับรูปแบบข้อมูลที่ตั้งค่าคอนฟิก

ในฐานะผู้ใช้ในบทบาทนักพัฒนาการรายงานทางอิเล็กทรอนิกส์ คุณต้องสร้างการตั้งค่าคอนฟิก ER ใหม่ที่มีส่วนประกอบของ การแมปแบบจำลองสำหรับแบบจำลองข้อมูล **แบบสองถาม** เนื่องจากส่วนประกอบนี้ใช้รูปแบบข้อมูลที่ตั้งค่าคอนฟิกสำหรับ Finance จึงใช้เฉพาะกับ Finance คุณต้องตั้งค่าคอนฟิกส่วนประกอบของการแมปรูปแบบเพื่อระบุออบเจ็กต์ของแอปพลิเคชันที่ต้องใช้ในการกรอกข้อมูลในรูปแบบข้อมูลที่ตั้งค่าคอนฟิกด้วยข้อมูลแอปพลิเคชันขณะรันไทม์ เมื่อต้องการทำงานนี้ให้เสร็จสมบูรณ์ คุณต้องทราบรายละเอียดการดำเนินการของโครงสร้างข้อมูลของโดเมนธุรกิจ **แบบสอบถาม** ใน Finance

เมื่อดำเนินการขั้นตอนนี้ในส่วน [นำเข้าการตั้งค่าคอนฟิกการแมปรูปแบบใหม่](#ImportModelMapping) แล้ว คุณสามารถนำเข้าการตั้งค่าคอนฟิกการแมปรูปแบบที่จำเป็นจากไฟล์ XML ที่ระบุ อีกทางหนึ่งคือ คุณสามารถทำขั้นตอนนี้ให้เสร็จสมบูรณ์ได้ในส่วน [สร้างการตั้งค่าคอนฟิกการแมปรูปแบบใหม่](#CreateModelMapping) เพื่อออกแบบการแมปรูปแบบนี้ตั้งแต่เริ่มต้น

### <a name="import-a-new-model-mapping-configuration"></a><a name="ImportModelMapping"></a>นำเข้าการตั้งค่าคอนฟิกการแมปรูปแบบใหม่

1. ดาวน์โหลดไฟล์ [Questionnaires mapping.version.1.1.xml](https://download.microsoft.com/download/7/b/2/7b258e4e-4bd5-46a4-8114-27419ae4acd8/Questionnaires_mapping.version.1.1.xml) และบันทึกไปยังคอมพิวเตอร์เฉพาะที่ของคุณ
2. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
3. ในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** เลือก **การตั้งค่าคอนฟิกการรายงาน**
4. ในบานหน้าต่างการดำเนินการ เลือก **แลกเปลี่ยน** \> **โหลดจากไฟล์ XML**
5. เลือก **เรียกดู** แล้วค้นหาและเลือกไฟล์ **Questionnaires mapping.version.1.1.xml**
6. เลือก **ตกลง** เพื่อนำเข้าการตั้งค่าคอนฟิก

เมื่อต้องการดำเนินการต่อ ให้ข้ามขั้นตอนถัดไป [สร้างการตั้งค่าคอนฟิกการแมปรูปแบบใหม่](#CreateModelMapping)

### <a name="create-a-new-model-mapping-configuration"></a><a name="CreateModelMapping"></a>สร้างการตั้งค่าคอนฟิกการแมปรูปแบบใหม่

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก เลือก **รูปแบบแบบสอบถาม**
3. เลือก **สร้างการตั้งค่าคอนฟิก**
4. ในกล่องโต้ตอบรายการแบบหล่นลง ให้ทำตามขั้นตอนเหล่านี้:

    1. ในฟิลด์ **สร้าง** เลือก **การแมปรูปแบบตามแบบสอบถามรูปแบบข้อมูล**
    2. ในฟิลด์ **ชื่อ** ให้ป้อน **การแมปแบบสอบถาม**
    3. ในฟิลด์ **ข้อกำหนดของรูปแบบข้อมูล** ให้เลือกข้อกำหนด **ราก**
    4. เลือก **สร้างการตั้งค่าคอนฟิก** เพื่อสร้างการตั้งค่าคอนฟิก

#### <a name="design-a-new-model-mapping-component"></a><a name="DesignMappingComponent"></a>ออกแบบส่วนประกอบการแมปรูปแบบใหม่

1. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก เลือก **การแมปแบบสอบถาม**
2. เลือก **ตัวออกแบบ** เพื่อเปิดรายการของการแมป
3. เลือก **การแมปแบบสอบถาม** ที่ถูกเพิ่มโดยอัตโนมัติสำหรับข้อกำหนด **ราก**
4. เลือก **ตัวออกแบบ** เพื่อเริ่มต้นการตั้งค่าคอนฟิกการแมปที่เลือก

การแมปใหม่จะถูกเพิ่มโดยอัตโนมัติสำหรับข้อกำหนด **ราก** การแมปนี้มีทิศทาง **ไปยังรูปแบบ** การแมปนี้สามารถใช้ในการกรอกข้อมูลในรูปแบบข้อมูลด้วยข้อมูลที่จำเป็น

#### <a name="add-data-sources-to-access-application-tables"></a><a name="AddMmDataSource1"></a>เพิ่มแหล่งข้อมูลที่จะเข้าถึงตารางแอปพลิเคชัน

คุณต้องตั้งค่าคอนฟิกแหล่งข้อมูลที่จะเข้าถึงตารางแอปพลิเคชันที่มีรายละเอียดของแบบสอบถาม

1. บนหน้า **ตัวออกแบบการแมปรูปแบบ** ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **Dynamics 365 for Operations\\เรกคอร์ดตาราง**
2. เพิ่มแหล่งข้อมูลใหม่ที่จะใช้ในการเข้าถึงตาราง KMCollection ซึ่งเรกคอร์ดทั้งหมดแสดงถึงแบบสอบถามเดียว:

    1. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **เพิ่มราก**
    2. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ให้ป้อน **แบบสอบถาม**
    3. ในฟิลด์ **ตาราง** ให้ป้อน **KMCollection**
    4. ตั้งค่าตัวเลือก **ขอการสอบถาม** เป็น **ใช่** จากนั้นคุณจะสามารถระบุตัวเลือก [การกรอง](../../fin-ops/get-started/advanced-filtering-query-options.md) สำหรับตารางนี้ในกล่องโต้ตอบการสอบถามระบบขณะรันไทม์
    5. เลือก **ตกลง** เพื่อเพิ่มแหล่งข้อมูลใหม่

3. ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** ให้เลือก **Dynamics 365 for Operations\\เรกคอร์ดตาราง**
4. เพิ่มแหล่งข้อมูลใหม่ที่จะใช้ในการเข้าถึงตาราง KMQuestion ซึ่งเรกคอร์ดทั้งหมดแสดงถึงคำถามเดียวในแบบสอบถาม:

    1. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **เพิ่มราก**
    2. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ให้ป้อน **คำถาม**
    3. ในฟิลด์ **ตาราง** ให้ป้อน **KMQuestion**
    4. เลือก **ตกลง** เพื่อเพิ่มแหล่งข้อมูลใหม่

5. ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** ให้เลือก **Dynamics 365 for Operations\\เรกคอร์ดตาราง**
6. เพิ่มแหล่งข้อมูลใหม่ที่จะใช้ในการเข้าถึงตาราง KMAnswer ซึ่งเรกคอร์ดทั้งหมดแสดงถึงคำตอบเดียวของคำถามในแบบสอบถาม:

    1. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **เพิ่มราก**
    2. ในฟิลด์ **ชื่อ** ให้ป้อน **คำตอบ**
    3. ในฟิลด์ **ตาราง** ให้ป้อน **KMAnswer**
    4. เลือก **ตกลง** เพื่อเพิ่มแหล่งข้อมูลใหม่

7. ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **ฟังก์ชัน\\ฟิลด์ที่คำนวณ**
8. เพิ่มฟิลด์ที่คำนวณใหม่ซึ่งจะใช้ในการเข้าถึงเรกคอร์ดของตาราง KMQuestionResultGroup จากเรกคอร์ดทั้งหมดของตาราง KMCollection หลัก:

    1. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **แบบสอบถาม**
    2. เลือก **เพิ่ม**
    3. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ป้อน **\$ResultGroup**
    4. เลือก **แก้ไขสูตร**
    5. ใน [ตัวแก้ไขสูตร ER](general-electronic-reporting-formula-designer.md) ในฟิลด์ **สูตร** ป้อน **FIRSTORNULL(\@.'\<Relations'.KMQuestionResultGroup)** เพื่อใช้ [พาธ](er-formula-language.md#Paths) ของความสัมพันธ์แบบหนึ่งต่อกลุ่มระหว่างตาราง KMCollection และ KMQuestionResultGroup
    6. เลือก **ตกลง** และปิดตัวแก้ไขสูตร
    7. เลือก **ตกลง** เพื่อเพิ่มฟิลด์ที่คำนวณ

9. ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **ฟังก์ชัน\\ฟิลด์ที่คำนวณ**
10. เพิ่มฟิลด์ที่คำนวณใหม่ซึ่งจะใช้ในการเข้าถึงเรกคอร์ดขคำถามองตาราง KMQuestion จากเรกคอร์ดทั้งหมดของตาราง KMCollectionQuestion หลัก:

    1. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **แบบสอบถาม**
    2. ขยายโหนด **\<ความสัมพันธ์** ที่มีความสัมพันธ์แบบหนึ่งต่อกลุ่มของตาราง KMCollection
    3. เลือกตาราง **KMCollectionQuestion** ที่เกี่ยวข้อง และเลือก **เพิ่ม**
    4. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ป้อน **\$คำถาม**
    5. เลือก **แก้ไขสูตร**
    6. ในตัวแก้ไขสูตร ในฟิลด์ **สูตร** ป้อน **FIRSTORNULL (FILTER(Question, Question.kmQuestionId = \@.kmQuestionId))** เพื่อส่งคืนเรกคอร์ดคำถามที่เหมาะสมจากตาราง KMQuestion
    7. เลือก **ตกลง** และปิดตัวแก้ไขสูตร
    8. เลือก **ตกลง** เพื่อเพิ่มฟิลด์ที่คำนวณ

11. ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **ฟังก์ชัน\\ฟิลด์ที่คำนวณ**
12. เพิ่มฟิลด์ที่คำนวณใหม่ซึ่งจะใช้ในการเข้าถึงเรกคอร์ดคำตอบของตาราง KMAnswer จากเรกคอร์ดทั้งหมดของตาราง KMQuestion หลัก:

    1. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **แบบสอบถาม\<Relations.KMCollectionQuestion.\$คำถาม** แล้วเลือก **เพิ่ม**
    2. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ป้อน **\$คำตอบ**
    3. เลือก **แก้ไขสูตร**
    4. ในตัวแก้ไขสูตร ในฟิลด์ **สูตร** ป้อน **FILTER (Answer, Answer.kmAnswerCollectionId = \@.kmAnswerCollectionId)** เพื่อส่งคืนเรกคอร์ดคำตอบที่เหมาะสมจากตาราง KMAnswer
    5. เลือก **ตกลง** และปิดตัวแก้ไขสูตร
    6. เลือก **ตกลง** เพื่อเพิ่มฟิลด์ที่คำนวณ

13. ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** ให้เลือก **Dynamics 365 for Operations\\ตาราง**
14. เพิ่มแหล่งข้อมูลใหม่ที่จะใช้ในการเข้าถึงวิธีการของตาราง CompanyInfo โปรดสังเกตว่าเมธอด **find()** ของตารางนี้จะส่งคืนเรกคอร์ดซึ่งแสดงถึงบริษัทของอินสแตนซ์ Finance ปัจจุบันที่มีการเรียกการแมปนี้ไว้ในบริบท

    1. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **เพิ่มราก**
    2. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ให้ป้อน **CompanyInfo**
    3. ในฟิลด์ **ตาราง** ให้ป้อน **CompanyInfo**
    4. เลือก **ตกลง** เพื่อเพิ่มแหล่งข้อมูลใหม่

#### <a name="add-data-sources-to-access-application-enumerations"></a><a name="AddMmDataSource2"></a>เพิ่มแหล่งข้อมูลที่จะเข้าถึงการแจงนับแอปพลิเคชัน

คุณต้องตั้งค่าคอนฟิกแหล่งข้อมูลในการเข้าถึงการแจงนับของแอปพลิเคชันและเปรียบเทียบค่ากับค่าของฟิลด์ชนิด **การแจงนับ** ในตารางของแอปพลิเคชัน คุณต้องใช้ผลลัพธ์ของการเปรียบเทียบเพื่อกรอกข้อมูลในฟิลด์ที่เหมาะสมของรูปแบบข้อมูล

1. บนหน้า **ตัวออกแบบการแมปรูปแบบ** ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **Dynamics 365 for Operations\\การแจงนับ**
2. เพิ่มแหล่งข้อมูลใหม่ที่จะใช้ในการเข้าถึงค่าของการแจงนับ **EnumAppNoYes**:

    1. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **เพิ่มราก**
    2. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ให้ป้อน **EnumAppNoYes**
    3. ในฟิลด์ **การแจงนับ** ป้อน **NoYes**
    4. เลือก **ตกลง** เพื่อเพิ่มแหล่งข้อมูลใหม่

3. ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** ให้เลือก **Dynamics 365 for Operations\\การแจงนับ**
4. เพิ่มแหล่งข้อมูลใหม่ที่จะใช้ในการเข้าถึงค่าของการแจงนับ **KMCollectionQuestionMode**:

    1. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **เพิ่มราก**
    2. ในกล่องโต้ตอบรายการแบบหล่นลง ในฟิลด์ **ชื่อ** ให้ป้อน **EnumAppQuestionOrder**
    3. ในฟิลด์ **การแจงนับ** ป้อน **KMCollectionQuestionMode**
    4. เลือก **ตกลง** เพื่อเพิ่มแหล่งข้อมูลใหม่

#### <a name="add-er-labels-to-generate-a-report-in-a-specified-language"></a><a name="AddMmLabels"></a>เพิ่มป้ายชื่อ ER เพื่อสร้างรายงานในภาษาที่ระบุ

คุณสามารถเพิ่มป้ายชื่อ ER เพื่อตั้งค่าคอนฟิกแหล่งข้อมูลบางอย่างที่จะส่งคืนค่าที่ขึ้นอยู่กับภาษาที่กำหนดไว้ในบริบทของการเรียกของการแมปรูปแบบ

1. บนหน้า **วออกแบบการแมปรูปแบบ** ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **คำตอบ** แล้วเลือก **แก้ไข**
2. เปิดใช้งานฟิลด์ **ป้ายชื่อ**
3. เลือก **การแปล**
4. ในกล่องโต้ตอบ **การแปลข้อความ** ให้ทำตามขั้นตอนเหล่านี้:

    1. ในฟิลด์ **รหัสป้ายชื่อ** ป้อน **PositiveAnswer**
    2. ในฟิลด์ **ข้อความในภาษาเริ่มต้น** ให้ป้อน **ใช่**
    3. เลือก **การแปล**
    4. ในฟิลด์ **รหัสป้ายชื่อ** ป้อน **NegativeAnswer**
    5. ในฟิลด์ **ข้อความในภาษาเริ่มต้น** ให้ป้อน **ไม่**
    6. เลือก **การแปล**

5. ปิดกล่องโต้ตอบ **การแปลข้อความ**
6. เลือก **ยกเลิก**

![การเพิ่มป้ายชื่อ ER สำหรับการแมปรูปแบบที่แก้ไขได้](./media/er-quick-start1-adding-labels.png)

คุณได้ป้อนป้ายชื่อ ER เฉพาะสำหรับภาษาเริ่มต้นเท่านั้น สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการแปลป้ายชื่อ ER เป็นภาษาอื่นๆ ให้ดูที่ [ออกแบบรายงานหลายภาษา](er-design-multilingual-reports.md)

#### <a name="add-a-data-source-to-transform-the-results-of-comparing-enumeration-values-to-a-text-value"></a><a name="AddMmDataSource3"></a>เพิ่มแหล่งข้อมูลเพื่อแปลงผลลัพธ์ของการเปรียบเทียบค่าการแจงนับเป็นค่าข้อความ

เนื่องจากคุณต้องแปลงผลลัพธ์ของการเปรียบเทียบระหว่างค่าการแจงนับและค่าข้อความหลายครั้งสำหรับแหล่งที่มาของความแตกต่าง จึงควรตั้งค่าคอนฟิกตรรกะนี้เป็นแหล่งข้อมูลเดียว อย่างไรก็ตาม เมื่อต้องการทำให้แหล่งข้อมูลนี้ใช้ใหม่ได้ คุณต้องตั้งค่าคอนฟิกให้เป็นแหล่งข้อมูลที่กำหนดเป็นพารามิเตอร์ สำหรับข้อมูลเพิ่มเติม ดูที่ [สนับสนุนการเรียกแบบใช้พารามิเตอร์ของแหล่งข้อมูลการรายงานทางอิเล็กทรอนิกส์ของชนิดฟิลด์ที่คำนวณได้](er-calculated-field-type.md)

1. บนหน้า **ตัวออกแบบการแมปรูปแบบ** ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **ทั่วไป\\คอนเทนเนอร์ที่ว่างเปล่า**
2. เพิ่มแหล่งข้อมูลคอนเทนเนอร์ใหม่:

    1. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **เพิ่มราก**
    2. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ให้ป้อน **ตัวช่วย**
    3. เลือก **ตกลง** เพื่อเพิ่มแหล่งข้อมูลคอนเทนเนอร์ใหม่

3. ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **ฟังก์ชัน\\ฟิลด์ที่คำนวณ**
4. เพิ่มแหล่งข้อมูลใหม่:

    1. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **ตัวช่วย**
    2. เลือก **เพิ่ม**
    3. ในกล่องโต้ตอบรายการแบบหล่นลง ในฟิลด์ **ชื่อ** ให้ป้อน **NoYesEnumToString**
    4. เลือก **แก้ไขสูตร**
    5. ในตัวแก้ไขสูตร ให้เลือก **พารามิเตอร์**
    6. ทำตามขั้นตอนเหล่านี้เพื่อระบุพารามิเตอร์สำหรับนิพจน์ที่ตั้งค่าคอนฟิก:

        1. เลือก **ใหม่**
        2. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ให้ป้อน **อาร์กิวเมนต์**
        3. ในฟิลด์ **ชนิด** เลือกชนิดข้อมูล **แบบบูลีน**
        4. เลือก **ตกลง**

    7. ในฟิลด์ **สูตร** ป้อน **IF (Argument = true, \@"GER\_LABEL:PositiveAnswer", \@"GER\_LABEL:NegativeAnswer")** เพื่อส่งคืนข้อความของป้ายชื่อ ER ที่เหมาะสม ทั้งนี้ขึ้นอยู่กับภาษาของบริบทการดำเนินการและค่าของพารามิเตอร์ที่ระบุ
    8. เลือก **ตกลง** และปิดตัวแก้ไขสูตร
    9. เลือก **ตกลง** เพื่อเพิ่มแหล่งข้อมูลใหม่

![การแมปรูปแบบที่ตั้งค่าคอนฟิกในตัวออกแบบการแมปรูปแบบ ER](./media/er-quick-start1-added-data-sources.png)

#### <a name="bind-data-sources-to-data-model-fields"></a><a name="AddMmBindings1"></a>ผูกแหล่งข้อมูลเข้ากับฟิลด์รูปแบบข้อมูล

คุณต้องผูกแหล่งข้อมูลที่ตั้งค่าคอนฟิกเข้ากับฟิลด์ของรูปแบบข้อมูลเพื่อระบุวิธีการกรอกข้อมูลของรูปแบบข้อมูลโดยใช้ข้อมูลในแอปพลิเคชันขณะรันไทม์

1. บนหน้า **ตัวออกแบบการแมปรูปแบบ** ในบานหน้าต่าง **รูปแบบข้อมูล** เลือก **CompanyName**
2. ในบานหน้าต่าง **แหล่งข้อมูล** ให้ขยาย **CompanyInfo** แล้วปฏิบัติตามขั้นตอนต่อไปนี้

    1. ขยายโหนด **CompanyInfo()** ที่แสดงถึงเมธอด **find()** ของตาราง CompanyInfo
    2. เลือก **CompanyInfo.find().Name**
    3. เลือก **ผูก** เพื่อกรอกชื่อของบริษัทที่มีการเรียกการแมปรูปแบบที่ตั้งค่าคอนฟิกไว้ในบริบทของขณะรันไทม์

3. ในบานหน้าต่าง **รูปแบบข้อมูล** เลือก **แบบสอบถาม**
4. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **แบบสอบถาม** และเลือก **ผูก** เพื่อกรอกข้อมูลในเรกคอร์ดแบบสอบถาม
5. ในบานหน้าต่าง **รูปแบบข้อมูล** ให้ขยาย **แบบสอบถาม** แล้วปฏิบัติตามขั้นตอนต่อไปนี้

    1. ในบานหน้าต่าง **รูปแบบข้อมูล** เลือก **ใช้งานอยู่**
    2. ในบานหน้าต่าง **รูปแบบข้อมูล** เลือก **แก้ไข**
    3. ในฟิลด์ **สูตร** ป้อน **Helper.NoYesEnumToString (\@.Active = EnumAppNoYes.Yes)** เพื่อกรอกข้อมูลผลลัพธ์ที่อิงกับข้อความและอิงกับภาษาของการเปรียบเทียบระหว่างค่าการแจงนับ

6. ดำเนินการผูกแหล่งข้อมูลเข้ากับฟิลด์รูปแบบข้อมูลในลักษณะเดียวกันจนกว่าคุณจะได้รับผลลัพธ์ต่อไปนี้

    | พาธของฟิลด์                                              | ชนิดข้อมูล   | การดำเนินการ | นิพจน์การผูก |
    |---------------------------------------------------------|-------------|--------|--------------------|
    | CompanyName                                             | สตริง      | ผูก   | CompanyInfo.'find()'.Name |
    | แบบสอบถาม                                           | รายการเรกคอร์ด | ผูก   | แบบสอบถาม |
    | Questionnaire\\Active                                   | สตริง      | แก้ไข   | Helper.NoYesEnumToString(\@.active = EnumAppNoYes.Yes) |
    | Questionnaire\\Code                                     | สตริง      | ผูก   | \@.kmCollectionId |
    | Questionnaire\\Description                              | สตริง      | ผูก   | \@.Description |
    | Questionnaire\\QuestionnaireType                        | สตริง      | ผูก   | \@.'&gt;Relations'.kmCollectionTypeId.Description |
    | Questionnaire\\QuestionOrder                            | สตริง      | แก้ไข   | CASE (\@.questionMode,<br>EnumAppQuestionOrder.Conditional, "แบบมีเงื่อนไข",<br>EnumAppQuestionOrder.Random, "แบบสุ่ม (เปอร์เซ็นต์ในแบบสอบถาม)",<br>EnumAppQuestionOrder.RandomGroup, "แบบสุ่ม (เปอร์เซ็นต์ในกลุ่มผลลัพธ์)",<br>EnumAppQuestionOrder.Sequence, "แบบเรียงตามลำดับ",<br>"") |
    | Questionnaire\\ResultsGroup                             | เรกคอร์ด      |        | |
    | Questionnaire\\ResultsGroup\\Code                       | สตริง      | ผูก   | \@.'\$ResultGroup'.kmQuestionResultGroupId |
    | Questionnaire\\ResultsGroup\\Description                | สตริง      | ผูก   | \@.'\$ResultGroup'.description |
    | Questionnaire\\ResultsGroup\\MaxNumberOfPoints          | จำนวนจริง        | ผูก   | \@.'\$ResultGroup'.maxPoint |
    | Questionnaire\\Question                                 | รายการเรกคอร์ด | ผูก   | \@.'&lt;Relations'.KMCollectionQuestion |
    | Questionnaire\\Question\\CollectionSequenceNumber       | เลขจำนวนเต็ม     | ผูก   | \@.answerCollectionSequenceNumber |
    | Questionnaire\\Question\\Id                             | สตริง      | ผูก   | \@.kmQuestionId |
    | Questionnaire\\Question\\MustBeCompleted                | สตริง      | แก้ไข   | Helper.NoYesEnumToString(\@.mandatory = EnumAppNoYes.Yes) |
    | Questionnaire\\Question\\PrimaryQuestion                | สตริง      | ผูก   | \@.parentQuestionId |
    | Questionnaire\\Question\\SequenceNumber                 | เลขจำนวนเต็ม     | ผูก   | \@.SequenceNumber |
    | Questionnaire\\Question\\Text                           | สตริง      | ผูก   | \@.'\$Question'.text |
    | Questionnaire\\Question\\Answer                         | รายการเรกคอร์ด | ผูก   | \@.'\$Question'.'\$Answer' |
    | Questionnaire\\Question\\Answer\\CorrectAnswer          | สตริง      | แก้ไข   | Helper.NoYesEnumToString(\@.correctAnswer = EnumAppNoYes.Yes) |
    | Questionnaire\\Question\\Answer\\Points                 | จำนวนจริง        | ผูก   | \@.point |
    | Questionnaire\\Question\\Answer\\SequenceNumber         | เลขจำนวนเต็ม     | ผูก   | \@.sequenceNumber |
    | Questionnaire\\Question\\Answer\\Text                   | สตริง      | ผูก   | \@.text |

    ภาพประกอบต่อไปนี้แสดงสถานะขั้นสุดท้ายของการแมปรูปแบบที่ตั้งค่าคอนฟิกบนหน้า **ตัวออกแบบการแมปรูปแบบ**

    ![การแมปรูปแบบที่ตั้งค่าคอนฟิกทั้งหมดในตัวออกแบบการแมปรูปแบบ ER](./media/er-quick-start1-mapping2.png)

7. บันทึกการเปลี่ยนแปลง
8. ปิดหน้า **ตัวออกแบบการแมปรูปแบบ**

#### <a name="complete-the-design-of-the-model-mapping"></a><a name="CompleteModelMapping"></a>ทำการออกแบบการแมปรูปแบบให้เสร็จสมบูรณ์

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก เลือก **การแมปแบบสอบถาม**
3. บนแท็บด่วน **รุ่น** ให้เลือกรุ่นการตั้งค่าคอนฟิกที่มีสถานะเป็น **แบบร่าง**
4. เลือก **เปลี่ยนแปลงสถานะ** \> **เสร็จสมบูรณ์**

สถานะของรุ่น 1.1 ของการตั้งค่าคอนฟิกนี้มีการเปลี่ยนแปลงจาก **แบบร่าง** เป็น **เสร็จสมบูรณ์** รุ่น 1.1 ไม่สามารถเปลี่ยนแปลงได้อีกต่อไป รุ่นนี้มีการแมปรูปแบบที่ตั้งค่าคอนฟิกและสามารถใช้เป็นข้อมูลพื้นฐานสำหรับการตั้งค่าคอนฟิก ER อื่นๆ รุ่น 1.2 ของการตั้งค่าคอนฟิกนี้จะถูกสร้างขึ้นและมีสถานะเป็น **แบบร่าง** คุณสามารถแก้ไขรุ่นนี้เพื่อปรับปรุงการตั้งค่าคอนฟิก **การแมปแบบสอบถาม**

![รุ่นของการตั้งค่าคอนฟิก ER ที่แก้ไขได้บนหน้าการตั้งค่าคอนฟิก](./media/er-quick-start1-mapping-configuration.png)

> [!NOTE]
> การแมปรูปแบบที่ตั้งค่าคอนฟิกเป็นการใช้งานเฉพาะทางการเงินของรูปแบบข้อมูลเชิงนามธรรมซึ่งแสดงถึงโดเมนธุรกิจ **แบบสอบถาม**

## <a name="design-a-template-for-a-custom-report"></a><a name="DesignReportTemplate"></a>ออกแบบเทมเพลตสำหรับรายงานแบบกำหนดเอง

กรอบงาน ER ใช้เทมเพลตที่กำหนดล่วงหน้าเพื่อสร้างรายงานในรูปแบบ Microsoft Office (สมุดงาน Excel หรือเอกสาร Word) ในขณะที่มีการสร้างรายงานที่ต้องการ จะมีการกรอกเทมเพลตด้วยข้อมูลที่จำเป็นตามกระแสข้อมูลที่ตั้งค่าคอนฟิก ดังนั้น คุณต้องออกแบบเทมเพลตสำหรับรายงานแบบกำหนดเองของคุณก่อน เทมเพลตนี้ต้องออกแบบเป็นสมุดงาน Excel โดยโครงสร้างแสดงถึงโครงร่างของรายงานแบบกำหนดเอง คุณต้องกำหนดชื่อทุกรายการของ Excel ที่คุณวางแผนจะกรอกโดยใช้ข้อมูลที่จำเป็น

1. ดาวน์โหลดไฟล์ [Questionnaires report template.xlsx](https://download.microsoft.com/download/3/8/2/382c3cf0-87bb-473f-b7bb-3015b4facb74/Questionnaires_report_template.xlsx) และบันทึกไปยังคอมพิวเตอร์เฉพาะที่ของคุณ
2. เปิดไฟล์ใน Excel และตรวจสอบโครงสร้างของสมุดงาน

เมื่อแสดงภาพต่อไปนี้ เทมเพลตที่ดาวน์โหลดได้ออกแบบให้พิมพ์แบบสอบถามที่ระบุ ซึ่งแสดงคำถามของแบบสอบถามพร้อมกับคำตอบที่เหมาะสม

![เทมเพลต Excel ที่จะพิมพ์แบบสอบถามที่ระบุ](./media/er-quick-start1-template-layout.png)

มีการเพิ่มชื่อ Excel เข้าในเทมเพลตนี้ ให้กรอกรายละเอียดของแบบสอบถาม คุณสามารถใช้ตัวจัดการชื่อเพื่อตรวจสอบชื่อ Excel

![การใช้ตัวจัดการชื่อเพื่อตรวจสอบชื่อ Excel ในเทมเพลต Excel ที่ระบุ](./media/er-quick-start1-template-names.png)

มีการเพิ่มป้ายชื่อรายงานเป็นข้อความแบบคงที่ในภาษาอังกฤษ คุณสามารถแทนที่ป้ายชื่อของรายงานด้วยชื่อ Excel ใหม่ที่กรอกในป้ายชื่อด้วยข้อความที่ขึ้นอยู่กับภาษาโดยใช้ [ป้ายชื่อ](#AddMmLabels) รูปแบบ ER ตามที่คุณใช้สำหรับนิพจน์ที่อิงกับภาษาในการแมปรูปแบบที่ตั้งค่าคอนฟิก ในกรณีนี้ ป้ายชื่อ ER ต้องมีการเพิ่มในรูปแบบ ER ที่สามารถแก้ไขได้

ในภาพประกอบต่อไปนี้แสดงว่ามีการระบุหัวข้อรายงานแบบกำหนดเองเพื่อเปิดใช้งาน Excel เพื่อทำการแบ่งหน้า

![ส่วนหัวของรายงานแบบกำหนดเองในเทมเพลต Excel ที่ระบุ](./media/er-quick-start1-template-header.png)

## <a name="design-a-format"></a><a name="DesignFormat"></a>ออกแบบรูปแบบ

ในฐานะผู้ใช้ในบทบาทที่ปรึกษาการทำงานของการรายงานทางอิเล็กทรอนิกส์ คุณต้องสร้างการตั้งค่าคอนฟิก ER ใหม่ที่มีส่วนประกอบของ รูปแบบ คุณต้องตั้งค่าคอนฟิกส่วนประกอบของรูปแบบเพื่อระบุว่าจะมีการกรอกเทมเพลตรายงานด้วยข้อมูลที่จำเป็นขณะรันไทม์อย่างไร

เมื่อดำเนินการขั้นตอนนี้ในส่วน [นำเข้าการตั้งค่าคอนฟิกรูปแบบที่ออกแบบ](#FormatImport) แล้ว คุณสามารถนำเข้ารูปแบบที่จำเป็นจากไฟล์ XML ที่ระบุ อีกทางหนึ่งคือ คุณสามารถทำขั้นตอนนี้ให้เสร็จสมบูรณ์ได้ในส่วน [สร้างการตั้งค่าคอนฟิกรูปแบบใหม่](#FormatCreate) เพื่อออกแบบรูปแบบนี้ตั้งแต่เริ่มต้น

### <a name="import-a-designed-format-configuration"></a><a name="FormatImport"></a>นำเข้าการตั้งค่าคอนฟิกรูปแบบที่ออกแบบ

1. ดาวน์โหลดไฟล์ [Questionnaires format.version.1.1.xml](https://download.microsoft.com/download/1/b/a/1ba39ec2-257a-44d8-972f-25bf7d18fb41/Questionnaires_format.version.1.1.xml) และบันทึกไปยังคอมพิวเตอร์เฉพาะที่ของคุณ
2. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
3. ในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** เลือก **การตั้งค่าคอนฟิกการรายงาน**
4. ในบานหน้าต่างการดำเนินการ เลือก **แลกเปลี่ยน** \> **โหลดจากไฟล์ XML**
5. เลือก **เรียกดู** แล้วค้นหาและเลือกไฟล์ **Questionnaires format.version.1.1.xml**
6. เลือก **ตกลง** เพื่อนำเข้าการตั้งค่าคอนฟิก

เมื่อต้องการดำเนินการต่อ ให้ข้ามขั้นตอนถัดไป [สร้างการตั้งค่าคอนฟิกรูปแบบใหม่](#FormatCreate)

### <a name="create-a-new-format-configuration"></a><a name="FormatCreate"></a>สร้างการตั้งค่าคอนฟิกรูปแบบใหม่
 
1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก เลือก **รูปแบบแบบสอบถาม**
3. เลือก **สร้างการตั้งค่าคอนฟิก**
4. ในกล่องโต้ตอบรายการแบบหล่นลง ให้ทำตามขั้นตอนเหล่านี้:

    1. ในฟิลด์ **สร้าง** เลือก **รูปปแบบตามแบบสอบถามรูปแบบข้อมูล**
    2. ในฟิลด์ **ชื่อ** ให้ป้อน **รายงานแบบสอบถาม**
    3. ในฟิลด์ **รุ่นของรูปแบบข้อมูล** เลือก **1**

        > [!NOTE]
        > - ถ้าคุณเลือกรุ่นเฉพาะของรูปแบบข้อมูลพื้นฐาน โครงสร้างขอรุ่นที่สัมพันธ์กันของรูปแบบข้อมูลจะแสดงให้คุณเป็นโครงสร้างของแหล่งข้อมูล **รูปแบบ** ในรูปแบบที่สร้างขึ้น
        > - คุณสามารถปล่อยฟิลด์นี้ว่างไว้ได้ ในกรณีดังกล่าว โครงสร้างของรุ่น **แบบร่าง** ของรูปแบบข้อมูลจะแสดงให้คุณเป็นโครงสร้างของแหล่งข้อมูล **รูปแบบ** ในรูปแบบที่สร้างขึ้น จากนั้น คุณสามารถปรับปรุงรูปแบบของคุณและดูการปรับปรุงดังกล่าวในรูปแบบของคุณได้ทันที วิธีการนี้อาจปรับปรุงประสิทธิภาพการทำงานของการออกแบบโซลูชัน ER เมื่อคุณตั้งค่าคอนฟิกรูปแบบข้อมูล การแมปรูปแบบ และรูปแบบพร้อมกัน
        > - ถ้าคุณเลือกรุ่นเฉพาะของรูปแบบข้อมูลพื้นฐาน คุณสามารถสลับไปใช้รุ่น **แบบร่าง** ในภายหลังได้ เมื่อคุณเริ่มแก้ไขรูปแบบ

    4. ในฟิลด์ **ข้อกำหนดของรูปแบบข้อมูล** ให้เลือกข้อกำหนด **ราก**

5. เลือก **สร้างการตั้งค่าคอนฟิก** เพื่อสร้างการตั้งค่าคอนฟิก

#### <a name="import-a-report-template"></a><a name="ImportReportTemplate"></a>นำเข้าเทมเพลตของรายงาน

1. ในหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิก เลือก **รายงานแบบสอบถาม**
2. เลือก **ตัวออกแบบ** เพื่อเริ่มต้นการตั้งค่าคอนฟิกรูปแบบที่กำหนดเอง
3. บนหน้า **ตัวออกแบบรูปแบบ** บนบานหน้าต่างการดำเนินการ เลือก **นำเข้า** \> **นำเข้าจาก Excel**
4. ในกล่องโต้ตอบ ให้ทำตามขั้นตอนเหล่านี้:

    1. เลือก **เพิ่มเทมเพลต**
    2. ค้นหาและเลือกไฟล์ **Questionnaires report template.xslx** ที่บันทึกไว้ในเครื่อง แล้วเลือก **เปิด**
    3. เลือก **ตกลง** เพื่อนำเข้าเทมเพลต

    ![การนำเข้าเทมเพลตของรายงาน](./media/er-quick-start1-template-import.png)

องค์ประกอบรูปแบบ **Excel\\File** จะถูกเพิ่มลงในรูปแบบที่แก้ไขได้โดยอัตโนมัติเป็นองค์ประกอบราก นอกจากนี้ องค์ประกอบรูปแบบ **Excel\\Range** หรือองค์ประกอบรูปแบบ **Excel\\Cell** จะถูกเพิ่มโดยอัตโนมัติสำหรับชื่อ Excel ที่ได้รับการยอมรับทั้งหมดของเทมเพลตที่นำเข้า องค์ประกอบรูปแบบ **Excel\\Header** ที่มีองค์ประกอบของ **สตริง** ที่ซ้อนกันจะถูกเพิ่มโดยอัตโนมัติเพื่อให้สะท้อนถึงการตั้งค่าหัวข้อของเทมเพลตที่นำเข้า

![จัดรูปแบบโครงสร้างที่มีองค์ประกอบเพิ่มโดยอัตโนมัติในตัวออกแบบการดำเนินงานของ ER](./media/er-quick-start1-template-import2.png)

#### <a name="configure-a-format"></a><a name="ConfigureFormat"></a>ตั้งค่าคอนฟิกรูปแบบ

1. บนหน้า **ตัวออกแบบรูปแบบ** ในแผนผังรูปแบบ เลือกองค์ประกอบราก **Excel**
2. บนแท็บ **รูปแบบ** ทางด้านขวาของหน้า ในฟิลด์ **ชื่อ** ป้อน <a name="AddFormatRootElement"></a>**รายงาน**
3. ในฟิลด์ **การกำหนดลักษณะภาษา** เลือก **การกำหนดลักษณะของผู้ใช้** เพื่อเรียกใช้รายงานในภาษาที่ต้องการของผู้ใช้
4. ในฟิลด์ **การกำหนดลักษณะวัฒนธรรม** เลือก **การกำหนดลักษณะของผู้ใช้** เพื่อเรียกใช้รายงานในวัฒนธรรมที่ต้องการของผู้ใช้

    สำหรับข้อมูลเกี่ยวกับวิธีการระบุบริบทภาษาและวัฒนธรรมสำหรับกระบวนการ ER ให้ดูที่[ออกแบบรายงานหลายภาษา](er-design-multilingual-reports.md)

    ![ตั้งค่าคอนฟิกการตั้งค่าภาษาและวัฒนธรรมสำหรับรายงานที่ออกแบบในตัวออกแบบการดำเนินงานของ ER](./media/er-quick-start1-template-format-structure1.png)

5. ในแผนภูมิรูปแบบ ให้ขยายโหนดราก แล้วเลือก **ResultsGroup**
6. บนแท็บ **รูปแบบ** ในฟิลด์ **ทิศทางการจำลอง** ให้เลือก **ไม่มีการจำลอง** เนื่องจากคุณไม่คาดว่าจะมีกลุ่มผลลัพธ์จำนวนมากสำหรับแบบสอบถามเดียว

    ![การกำหนดทิศทางการจำลองสำหรับองค์ประกอบรูปแบบช่วงในตัวออกแบบการดำเนินงานของ ER](./media/er-quick-start1-template-format-structure2.png)

7. เลือก **บันทึก**

#### <a name="define-the-data-binding-for-a-report-title"></a><a name="DefineFormatBindings"></a>กำหนดการผูกข้อมูลสำหรับชื่อรายงาน

คุณต้องระบุการผูกข้อมูลสำหรับองค์ประกอบรูปแบบที่ใช้ในการกรอกชื่อเรื่องของรายงานที่สร้าง

1. บนหน้า **ตัวออกแบบรูปแบบ** บนแท็บ **การแมป** ที่อยู่ทางขวา เลือกองค์ประกอบ **Report\\ReportTitle**
2. เลือก **แก้ไขสูตร**
3. ในตัวแก้ไขสูตร ให้เลือก **แปล**
4. ในกล่องโต้ตอบ **การแปลข้อความ** ให้ทำตามขั้นตอนเหล่านี้:

    1. ในฟิลด์ **รหัสป้ายชื่อ** ป้อน **ReportTitle**
    2. ในฟิลด์ **ข้อความในภาษาเริ่มต้น** ให้ป้อน **รายงานแบบสอบถาม**
    3. เลือก **แปล** แล้วจากนั้น เลือก **บันทึก**
    4. เลือก **แปล** เพื่อปิดกล่องโต้ตอบ **การแปลข้อความ**

5. ปิดตัวแก้ไขสูตร

    ![การตั้งค่าคอนฟิกการผูกข้อมูลที่จะกรอกในชื่อเรื่องของรายงานที่สร้าง](./media/er-quick-start1-add-report-title-label.png)

คุณสามารถใช้เทคนิคนี้เพื่อทำให้ป้ายชื่ออื่นๆ ทั้งหมดของเทมเพลตเป็นแบบอิงกับภาษาปัจจุบัน สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการแปลป้ายชื่อของการตั้งค่าคอนฟิก ER แบบครั้งเดียวเป็นภาษาที่ได้รับการสนับสนุนทั้งหมด ให้ดูที่ [ออกแบบรายงานหลายภาษา](er-design-multilingual-reports.md)

#### <a name="review-model-data-source"></a><a name="ReviewModelDataSource"></a>ตรวจทานแหล่งข้อมูลรูปแบบ

1. บนหน้า **ตัวอกแบบรูปแบบ** บนแท็บ **การแมป** เลือกแหล่งข้อมูล <a name="ModelDSName"></a>**รูปแบบ** ที่แสดงถึงรูปแบบข้อมูลพื้นฐานของรูปแบบ ER นี้
2. เลือก **แก้ไข**
3. ตรวจทานข้อมูลในกล่องโต้ตอบ **คุณสมบัติแหล่งข้อมูล** แหล่งข้อมูลนี้หมายถึงรุ่น 1 ของส่วนประกอบรูปแบบข้อมูล **แบบสอบถาม** ที่อยู่ในการตั้งค่าคอนฟิก ER ของ **แบบสอบถาม**

![คุณสมบัติของแหล่งข้อมูลรูปแบบในตัวออกแบบการดำเนินงานของ ER](./media/er-quick-start1-model-data-source.png)

#### <a name="bind-format-elements-to-data-source-fields"></a><a name="BindFormatElements"></a>ผูกองค์ประกอบของรูปแบบกับฟิลด์แหล่งข้อมูล

ถ้าต้องการระบุวิธีการกรอกข้อมูลเทมเพลตขณะรันไทม์ คุณต้องผูกองค์ประกอบรูปแบบทั้งหมดที่เชื่อมโยงกับชื่อ Excel ที่เหมาะสมกับฟิลด์เดียวของแหล่งข้อมูลของรูปแบบนี้

1. บนหน้า **ตัวออกแบบรูปแบบ** ในแผนผังรูปแบบ เลือกองค์ประกอบรูปแบบ **Report\\CompanyName**
2. บนแท็บ **การแมป** เลือกฟิลด์แหล่งข้อมูล **model.CompanyName** ของชนิด **ชนิด**
3. เลือก **ผูก** เพื่อป้อนชื่อบริษัทในเทมเพลต
4. ในแผนผังรูปแบบ ให้เลือกองค์ประกอบ **Report\\Questionnaire**
5. บนแท็บ **การแมป** เลือกฟิลด์แหล่งข้อมูล **model.Questionnaire** ของชนิด **รายการเรกคอร์ด**
6. เลือก **ผูก**
7. เลือก **แสดงรายละเอียด** เพื่อดูรายละเอียดเพิ่มเติมสำหรับองค์ประกอบรูปแบบ

    องค์ประกอบรูปแบบช่วง **แบบสอบถาม** ถูกตั้งค่าคอนฟิกเป็นการจำลองตามแนวตั้ง เมื่อมีการผูกกับแหล่งข้อมูลของชนิด **รายการเรกคอร์ด** ช่วง **แบบสอบถาม** ที่เหมาะสมของเทมเพลต Excel จะถูกทำซ้ำสำหรับเรกคอร์ดทั้งหมดของแหล่งข้อมูลที่ผูกไว้
 
    ![การผูกองค์ประกอบรูปแบบช่วงแบบสอบถามกับแหล่งข้อมูลรายการเรกคอร์ดที่เหมาะสมในตัวออกแบบการดำเนินงาน ER](./media/er-quick-start1-bindings1.png)

    เนื่องจากช่วง **แบบสอบถาม** ของเทมเพลต Excel จะถูกกำหนดระหว่างแถวที่ 5 ถึง 14 แถวเหล่านี้จะถูกทำซ้ำสำหรับแบบสอบถามที่รายงานทุกครั้ง

    ![แถวในเทมเพลต Excel ที่จะทำซ้ำในรายงานที่สร้างสำหรับเรกคอร์ดทั้งหมดของแหล่งข้อมูลของรายการเรกคอร์ด](./media/er-quick-start1-template-questionnaire-range.png)

8. ตั้งค่าคอนฟิกการผูกที่คล้ายกันสำหรับองค์ประกอบรูปแบบที่เหลือ ดังที่อธิบายไว้ในตารางต่อไปนี้

    > [!NOTE]
    > ในตารางนี้ ข้อมูลในคอลัมน์ "พาธแหล่งข้อมูล" สันนิษฐานว่า [พาธที่สัมพันธ์กัน](relative-path-data-bindings-er-models-format.md) คุณลักษณะ ER เปิดใช้งานอยู่

    | พาธองค์ประกอบรูปแบบ                                      | พาธแหล่งข้อมูล |
    |----------------------------------------------------------|------------------|
    | Excel\\ReportTitle                                       | **\@"GER\_LABEL:ReportTitle"** |
    | Excel\\CompanyName                                       | **model.CompanyName** |
    | Excel\\Questionnaire                                     | **model.Questionnaire** |
    | Excel\\Questionnaire\\Active                             | **\@.Active** โดยที่ **\@** คือ **model.Questionnaire** |
    | Excel\\Questionnaire\\Code                               | **\@.Code** |
    | Excel\\Questionnaire\\Description                        | **\@.Description** |
    | Excel\\Questionnaire\\QuestionnaireType                  | **\@.QuestionnaireType** |
    | Excel\\Questionnaire\\QuestionOrder                      | **\@.QuestionOrder** |
    | Excel\\Questionnaire\\ResultsGroup\\Code\_               | **\@.ResultsGroup.Code** |
    | Excel\\Questionnaire\\ResultsGroup\\Description\_        | **\@.ResultsGroup.Description** |
    | Excel\\Questionnaire\\ResultsGroup\\MaxNumberOfPoints    | **\@.ResultsGroup.MaxNumberOfPoint** |
    | Excel\\Questionnaire\\Question                           | **\@.Question** |
    | Excel\\Questionnaire\\Question\\CollectionSequenceNumber | **\@.CollectionSequenceNumber** โดยที่ **\@** คือ **model.Questionnaire.Question** |
    | Excel\\Questionnaire\\Question\\Id                       | **\@.Id** |
    | Excel\\Questionnaire\\Question\\MustBeCompleted          | **\@.MustBeCompleted** |
    | Excel\\Questionnaire\\Question\\PrimaryQuestion          | **\@.PrimaryQuestion** |
    | Excel\\Questionnaire\\Question\\SequenceNumber           | **\@.SequenceNumber** |
    | Excel\\Questionnaire\\Question\\Text                     | **\@.Text** |
    | Excel\\Questionnaire\\Question\\Answer                   | **\@.Answer** |
    | Excel\\Questionnaire\\Question\\Answer\\CorrectAnswer    | **\@.CorrectAnswer**, where **\@** is **model.Questionnaire.Answer** |
    | Excel\\Questionnaire\\Question\\Answer\\Points           | **\@.Points** |
    | Excel\\Questionnaire\\Question\\Answer\\Text             | **\@.Text** |

9. เมื่อคุณได้ทำเสร็จสิ้นแล้ว เลือก **บันทึก**

ภาพประกอบต่อไปนี้แสดงสถานะขั้นสุดท้ายของการผูกข้อมูลที่ตั้งค่าคอนฟิกบนหน้า **ตัวออกแบบรูปแบบ**

![การผูกข้อมูลที่ตั้งค่าคอนฟิกในตัวออกแบบการดำเนินงานของ ER](./media/er-quick-start1-bindings2.png)

> [!IMPORTANT]
> คอลเลกชันทั้งหมดของแหล่งข้อมูลที่ระบุและการผูกแสดงถึงส่วนประกอบการแมปรูปแบบของรูปแบบที่ตั้งค่าคอนฟิก การแมปรูปแบบนี้ถูกเรียกเมื่อคุณเรียกใช้รูปแบบที่ตั้งค่าคอนฟิกสำหรับการสร้างรายงาน

### <a name="run-a-designed-format-from-er"></a><a name="RunFormatFromER"></a>เรียกใช้รูปแบบที่ออกแบบจาก ER

ขณะนี้ คุณสามารถเรียกใช้รูปแบบที่ออกแบบมาเพื่อวัตถุประสงค์ในการทดสอบจากหน้า **การตั้งค่าคอนฟิก**

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. บนหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิกในบานหน้าต่างด้านซ้าย ให้ขยาย **รูปแบบแบบสอบถาม** จากนั้นเลือก **รายงานแบบสอบถาม**
3. เลือก **ตัวออกแบบ** สำหรับรุ่นของรูปแบบที่มีสถานะเป็น **แบบร่าง**
4. ในหน้า **ตัวออกแบบรูปแบบ** เลือก **รัน**
5. ในกล่องโต้ตอบ **พารามิเตอร์ ER** บนแท็บด่วน **เรกคอร์ดที่จะรวม** ให้ตั้งค่าคอนฟิกตัวเลือกการกรองเพื่อให้รวมเฉพาะแบบสอบถาม **SBCCrsExam** เท่านั้น
6. เลือก **ตกลง** เพื่อยืนยันตัวเลือกการกรอง
7. เลือก **ตกลง** เพื่อเรียกใช้รายงาน
8. ตรวจสอบรายงานที่สร้าง

ตาม [ค่าเริ่มต้น ](electronic-reporting-destinations.md#default-behavior) จะมีการจัดส่งรายงานที่สร้างเป็นไฟล์ Excel ที่คุณสามารถดาวน์โหลดได้ ภาพประกอบต่อไปนี้แสดงสองหน้าของรายงานที่สร้างขึ้นในรูปแบบ Excel

![ตัวอย่างของรายงานที่สร้างขึ้นในรูปแบบ Excel, หน้าที่ 1](./media/er-quick-start1-report1a.png)

![ตัวอย่างของรายงานที่สร้างขึ้นในรูปแบบ Excel, หน้าที่ 2](./media/er-quick-start1-report1b.png)

## <a name="tune-a-designed-format"></a><a name="TuneFormat"></a>ปรับแต่งรูปแบบที่ออกแบบ

### <a name="modify-a-format-to-change-the-name-of-a-generated-document"></a><a name="ModifyToChangeName"></a>แก้ไขรูปแบบที่จะเปลี่ยนชื่อของเอกสารที่สร้าง

ตามค่าเริ่มต้น เอกสารที่สร้างขึ้นจะถูกตั้งชื่อโดยใช้นามแฝงของผู้ใช้ปัจจุบัน ด้วยการปรับเปลี่ยนรูปแบบ คุณสามารถเปลี่ยนลักษณะการทำงานนี้เพื่อให้เอกสารที่สร้างขึ้นมีการตั้งชื่อตามตรรกะที่กำหนดเองของคุณ ตัวอย่างเช่น ชื่อของเอกสารที่สร้างขึ้นสามารถอิงตามวันที่และเวลาของรอบเวลาปัจจุบันและในชื่อของรายงาน

1. บนหน้า **ตัวออกแบบรูปแบบ** ให้เลือกรายการราก **รายงาน**
2. บนแท็บ **การแมป** ให้เลือก **แก้ไขชื่อไฟล์**
3. ในฟิลด์ **สูตร** ป้อน **CONCATENATE (\@"GER\_LABEL:ReportTitle", " - ", DATETIMEFORMAT(SESSIONNOW(), "yyyy-MM-dd hh-mm-ss"))**
4. เลือก **ตกลง** และปิดตัวแก้ไขสูตร
5. เลือก **บันทึก**

### <a name="modify-a-format-to-change-the-order-of-questions"></a><a name="ModifyToOrder"></a>ปรับเปลี่ยนรูปแบบที่จะเปลี่ยนลำดับของคำถาม

คำถามไม่ได้รับการจัดลำดับอย่างถูกต้องในรายงานที่สร้างขึ้น คุณสามารถเปลี่ยนลำดับโดยการแก้ไขรูปแบบ

1. บนหน้า **ตัวออกแบบรูปแบบ** ให้เลือกรายการราก **รายงาน**
2. บนแท็บ **การแมป** ในแผนผังรูปแบบ ให้ขยาย **Report\\Questionnaire\\Question**

    ![องค์ประกอบรูปแบบคำถามของชนิดช่วงในตัวออกแบบการดำเนินงานของ ER](./media/er-quick-start1-bindings3.png)

3. บนแท็บ **การแมป** ให้เลือก **model.Questionnaire**
4. เลือก **เพิ่ม** \> **Functions\\Calculated field** จากนั้นในฟิลด์ **ชื่อ** ให้ป้อน **OrderedQuestions**
5. เลือก **แก้ไขสูตร**
6. ในตัวแก้ไขสูตร ในฟิลด์ **สูตร** ป้อน **ORDERBY (model.Questionnaire.Question, model.Questionnaire.Question.SequenceNumber)** เพื่อจัดลำดับของรายการคำถามของแบบสอบถามปัจจุบันตามหมายเลขลำดับ
7. เลือก **ตกลง** และปิดตัวแก้ไขสูตร
8. เลือก **ตกลง** เพื่อทำให้รายการของฟิลด์ที่คำนวณใหม่เสร็จสมบูรณ์
9. บนแท็บ **การแมป** เลือก **model.Questionnaire.OrderedQuestions**
10. ในแผนผังรูปแบบ เลือก **Excel\\Questionnaire\\Question**
11. เลือก **ผูก** แล้วยืนยันว่าพาธ **model.Questionnaire.Questions** ปัจจุบันมีการแทนที่ด้วยพาธ **model.Questionnaire.OrderedQuestions** ใหม่ในการผูกขององค์ประกอบที่ซ้อนกันทั้งหมด
12. เลือก **บันทึก**

![การผูกองค์ประกอบรูปแบบคำถามกับแหล่งข้อมูล OrderedQuestions ที่ตั้งค่าคอนฟิกในตัวออกแบบการดำเนินงานของ ER](./media/er-quick-start1-bindings4.png)

### <a name="run-a-modified-format-from-er"></a><a name="RunFormatFromER2"></a>เรียกใช้รูปแบบที่ปรับเปลี่ยนจาก ER

ขณะนี้คุณสามารถเรียกใช้รูปแบบที่แก้ไขสำหรับวัตถุประสงค์ในการทดสอบจากกรอบงาน ER

1. ในหน้า **ตัวออกแบบรูปแบบ** เลือก **รัน**
2. ในกล่องโต้ตอบ **พารามิเตอร์ ER** บนแท็บด่วน **เรกคอร์ดที่จะรวม** ให้ตั้งค่าคอนฟิกตัวเลือกการกรองเพื่อให้รวมเฉพาะแบบสอบถาม **SBCCrsExam** เท่านั้น
3. เลือก **ตกลง** เพื่อยืนยันตัวเลือกการกรอง
4. เลือก **ตกลง** เพื่อเรียกใช้รายงาน
5. ตรวจสอบรายงานที่สร้าง

ภาพประกอบต่อไปนี้แสดงรายงานที่สร้างขึ้นในรูปแบบ Excel ซึ่งมีการจัดลำดับคำถามอย่างถูกต้อง

![รายงานที่สร้างขึ้นในรูปแบบ Excel ซึ่งมีคำถามที่จัดลำดับอย่างถูกต้อง](./media/er-quick-start1-report2.png)

### <a name="complete-the-format-design"></a><a name="CompleteFormat"></a>ทำการออกแบบรูปแบบให้เสร็จสมบูรณ์

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. บนหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิกในบานหน้าต่างด้านซ้าย ให้ขยาย **รูปแบบแบบสอบถาม** จากนั้นเลือก **รายงานแบบสอบถาม**
3. บนแท็บด่วน **รุ่น** ให้เลือกรุ่นการตั้งค่าคอนฟิกที่มีสถานะเป็น **แบบร่าง**
4. เลือก **เปลี่ยนแปลงสถานะ** \> **เสร็จสมบูรณ์**

สถานะของรุ่น 1.1 ของการตั้งค่าคอนฟิกนี้มีการเปลี่ยนแปลงจาก **แบบร่าง** เป็น **เสร็จสมบูรณ์** รุ่น 1.1 ไม่สามารถเปลี่ยนแปลงได้อีกต่อไป รุ่นนี้มีรูปแบบที่ตั้งค่าคอนฟิกและสามารถใช้เพื่อพิมพ์รายงานที่กำหนดเองของคุณได้ รุ่น 1.2 ของการตั้งค่าคอนฟิกนี้จะถูกสร้างขึ้นและมีสถานะเป็น **แบบร่าง** คุณสามารถแก้ไขรุ่นนี้เพื่อปรับปรุงรูปแบบของรายงาน **แบบสอบถาม** ของคุณ

![การตั้งค่าคอนฟิก ER ที่แก้ไขได้บนหน้าการตั้งค่าคอนฟิก](./media/er-quick-start1-format-configuration.png)

> [!NOTE]
> รูปแบบที่ตั้งค่าคอนฟิกเป็นการออกแบบรายงาน **แบบสอบถาม** ของคุณ และไม่มีความสัมพันธ์กับอาร์ทิแฟกต์เฉพาะทางการเงิน

## <a name="develop-application-artefacts-to-call-the-designed-report"></a><a name="DevelopCustomCode"></a>พัฒนาอาร์ทิแฟกต์ของแอปพลิเคชันเพื่อเรียกรายงานที่ออกแบบ

ในฐานะผู้ใช้ในบทบาทผู้ดูแลระบบ คุณต้องพัฒนาตรรกะใหม่เพื่อให้สามารถเรียกใช้รูปแบบ ER ที่ตั้งค่าคอนฟิกจากส่วนติดต่อผู้ใช้ (UI) ของแอปพลิเคชันเพื่อสร้างรายงานที่กำหนดเองของคุณได้ ปัจจุบัน ER ไม่มีความสามารถในการตั้งค่าคอนฟิกตรรกะชนิดนี้ ดังนั้น จึงจำเป็นต้องใช้งานวิศวกรรมบางส่วน 

เพื่อพัฒนาตรรกะใหม่ คุณต้องปรับใช้โทโพโลยีที่สนับสนุนการสร้างแบบต่อเนื่อง สำหรับข้อมูลเพิ่มเติม ดู [ปรับใช้โทโพโลยีซึ่งสนับสนุนการสร้างอย่างต่อเนื่องและระบบอัตโนมัติของการทดสอบ](../perf-test/continuous-build-test-automation.md) คุณต้องมีการเข้าถึงไปยังสภาพแวดล้อมการพัฒนาสำหรับโทโพโลยีนี้ สำหรับข้อมูลเพิ่มเติมเกี่ยวกับ ER API ที่มีอยู่ ให้ดูที่ [API กรอบงาน ER](er-apis-app73.md)

### <a name="modify-source-code"></a><a name="ModifySourceCode"></a>ปรับเปลี่ยนโค้ดต้นฉบับ

#### <a name="add-a-data-contract-class"></a><a name="DataContractClass"></a>เพิ่มคลาสสัญญาข้อมูล

เพิ่มคลาส **QuestionnairesErReportContract** ใหม่ลงในโครงการ Microsoft Visual Studio ของคุณ และเขียนโค้ดที่ระบุสัญญาข้อมูลที่ควรใช้ในการเรียกใช้รูปแบบ ER ที่ตั้งค่าคอนฟิก

```xpp
/// <summary>
///     This class is the data contract class for the <c>QuestionnairesErReportDP</c> class.
/// </summary>
/// <remarks>
///    This is the data contract class for the Questionnaires ER report.
/// </remarks>
[
    DataContractAttribute,
    SysOperationContractProcessingAttribute(classStr(QuestionnairesErReportUIBuilder))
    ]
    public class QuestionnairesErReportContract extends ERFormatMappingRunBaseContract implements SysOperationValidatable
{
    ERFormatMappingId formatMapping;

    /// <summary>
    ///    Validates the report parameters.
    /// </summary>
    /// <returns>
    ///    true if no errors; otherwise, false.
    /// </returns>
    public boolean validate()
    {
        boolean ret = true;
        if (!formatMapping)
        {
            ret = checkFailed(strFmt("@SYS26332", new SysDictType(extendedTypeNum(ERFormatMappingId)).label()));
        }
        return ret;
    }
    [
        DataMemberAttribute('FormatMapping'),
        SysOperationLabelAttribute(literalstr("@ElectronicReporting:FormatMapping")),
        SysOperationHelpTextAttribute(literalstr("@ElectronicReporting:FormatMapping"))
    ]
    public ERFormatMappingId parmFormatMapping(ERFormatMappingId _formatMapping = formatMapping)
    {
        formatMapping = _formatMapping;
        return formatMapping;
    }
}
```

#### <a name="add-a-ui-builder-class"></a><a name="UIBuilderClass"></a>เพิ่มคลาสตัวสร้าง UI

เพิ่มคลาส **QuestionnairesErReportUIBuilder** ใหม่ลงในโครงการ Visual Studio ของคุณ และเขียนโค้ดเพื่อสร้างกลองโต้ตอบรันไทม์ที่จะใช้ค้นหารหัสการแมปรูปแบบของรูปแบบ ER ที่ต้องเรียกใช้ โค้ดที่ระบุจะค้นหาเฉพาะรูปแบบ ER ที่มีแหล่งข้อมูลชนิด **รูปแบบข้อมูล** ที่อ้างถึงรูปแบบข้อมูล **[แบบสอบถาม](#DataModeName)** โดยใช้ข้อกำหนด **[ราก](#RootDefinitionName)**

> [!NOTE]
> อีกทางหนึ่งคือ คุณสามารถใช้จุดการรวม ER เพื่อกรองข้อมูลรูปแบบ ER สำหรับข้อมูลเพิ่มเติม ให้ดูที่ [API ที่จะแสดงการค้นหาการแมปรูปแบบ](er-apis-app10-0-11.md#api-to-show-a-format-mapping-lookup)

```xpp
/// <summary>
/// The UIBuilder class for Questionnaires ER report
/// </summary>
class QuestionnairesErReportUIBuilder extends SysOperationAutomaticUIBuilder
{
    public const str ERQuestionnairesModel = 'Questionnaires';
    public const str ERQuestionnairesDataContainer = 'Root';

    /// <summary>
    /// Action after build of the dialog UI.
    /// </summary>
    public void postBuild()
    {
        DialogField formatMapping;
        super();
        formatMapping = this.bindInfo().getDialogField(this.dataContractObject(),
            methodStr(QuestionnairesErReportContract, parmFormatMapping));
        formatMapping.registerOverrideMethod(
            methodStr(FormReferenceControl, lookupReference),
            methodStr(QuestionnairesErReportUIBuilder, formatMappingLookup),
            this);
    }

    /// <summary>
    /// Performs the lookup form for format mapping.
    /// </summary>
    /// <param name="_referenceGroupControl">
    /// The control to perform lookup form.
    /// </param>
    public void formatMappingLookup(FormReferenceControl _referenceGroupControl)
    {
        ERObjectsFactory::createFormatMappingTableLookupForControlAndModel(
            _referenceGroupControl,
            ERQuestionnairesModel,
            ERQuestionnairesDataContainer).performFormLookup();
    }
}
```

#### <a name="add-a-data-provider-class"></a><a name="DataProviderClass"></a>เพิ่มคลาสผู้ให้บริการข้อมูล

เพิ่มคลาส **QuestionnairesErReportDP** ใหม่ลงในโครงการ Visual Studio ของคุณ และเขียนโค้ดที่แนะนำผู้ให้บริการข้อมูลที่ควรใช้ในการเรียกใช้รูปแบบ ER ที่ตั้งค่าคอนฟิก โค้ดที่ระบุรวมเฉพาะสัญญาข้อมูลสำหรับผู้ให้บริการข้อมูลนี้เท่านั้น

```xpp
/// <summary>
/// Data provider class for Questionnaires ER report.
/// </summary>
public class QuestionnairesErReportDP
{
    QuestionnairesErReportContract contract;
    public static QuestionnairesErReportDP construct()
    {
        QuestionnairesErReportDP  dataProvider;
        dataProvider = new QuestionnairesErReportDP();
        return dataProvider;
    }
}
```

#### <a name="add-a-labels-file"></a><a name="LabelsFile"></a>เพิ่มไฟล์ป้ายชื่อ

เพิ่มไฟล์ป้ายชื่อ **QuestionnairesErReportLabels\_en-US** ใหม่ลงในโครงการ Visual Studio ของคุณ และระบุป้ายชื่อต่อไปนี้สำหรับทรัพยากร UI ใหม่:

- ป้ายชื่อ **\@QuestionnairesReport** สำหรับรายการเมนูใหม่ที่มีข้อความต่อไปนี้ในภาษาอังกฤษแบบสหรัฐ (en-US): **รายงานแบบสอบถาม (ให้บริการโดย ER)**
- ป้ายชื่อ **\@QuestionnairesReportBatchJobDescription** สำหรับชื่อชุดงานหากรูปแบบ ER ที่เลือกมีการจัดกำหนดการสำหรับการดำเนินการเป็นแบบชุดงาน

#### <a name="add-a-report-service-class"></a><a name="ServiceClass"></a>เพิ่มคลาสบริการรายงาน

เพิ่มคลาส **QuestionnairesErReportService** ใหม่ลงในโครงการ Visual Studio ของคุณ และเขียนโค้ดที่เรียกรูปแบบ ER ระบุตามรหัสการแมปรูปแบบ และระบุสัญญาข้อมูลเป็นพารามิเตอร์

```xpp
using Microsoft.Dynamics365.LocalizationFramework;
/// <summary>
/// The electronic reporting service class for Questionnaires ER report
/// </summary>
class QuestionnairesErReportService extends SysOperationServiceBase
{
    public const str ERModelDataSourceName = 'model';
    public const str DefaultExportedFileName = 'Questionnaires report';
    public const str ParametersDataSourceName = 'RunTimeParameters';

    /// <summary>
    /// Generates report by using Electronic reporting framework
    /// </summary>
    /// <param name = "_contract">The Questionnaires report contract</param>
    public void generateReportByGER(QuestionnairesErReportContract _contract)
    {
        ERFormatMappingId formatMappingId;
        QuestionnairesErReportDP  dataProvider;
        dataProvider = QuestionnairesErReportDP::construct();
        formatMappingId = _contract.parmFormatMapping();
        if (formatMappingId)
        {
            try
            {
                ERIModelDefinitionParamsAction parameters = new ERModelDefinitionParamsUIActionComposite()
                    .add(new ERModelDefinitionObjectParameterAction(ERModelDataSourceName, ParametersDataSourceName, _contract, true));

                // Call ER to generate the report.
                ERIFormatMappingRun formatMappingRun = ERObjectsFactory::createFormatMappingRunByFormatMappingId(formatMappingId, DefaultExportedFileName);
                if (formatMappingRun.parmShowPromptDialog(true))
                {
                    formatMappingRun.withParameter(parameters);
                    formatMappingRun.withFileDestination(_contract.getFileDestination());
                    formatMappingRun.run();
                }
            }
            catch
            {
                // An error occurred while exporting data.
                error("@SYP4861341");
            }
        }
        else
        {
            // There is no data available.
            info("@SYS300117");
        }
    }
}
```

เมื่อคุณต้องใช้รูปแบบ ER ซึ่งรันข้อมูลของแอปพลิเคชัน คุณต้องตั้งค่าคอนฟิกแหล่งข้อมูลชนิด **รูปแบบข้อมูล** ในการแมปรูปแบบ แหล่งข้อมูลนี้อ้างงถึงส่วนใดส่วนหนึ่งของรูปแบบข้อมูลที่ระบุโดยใช้ข้อกำหนดรากเดียว เมื่อเรียกใช้รูปแบบ ER จะเป็นการเรียกแหล่งข้อมูลนี้เพื่อเข้าถึงการแมปรูปแบบ ER ที่เหมาะสมที่มีการตั้งค่าคอนฟิกสำหรับรูปแบบและข้อกำหนดรากที่กำหนด

ข้อมูลทั้งหมดที่คุณอาจต้องเตรียมในซอร์สโค้ดและที่เก็บซึ่งเป็นส่วนหนึ่งของสัญญาข้อมูลสามารถส่งผ่านไปยังรูปแบบ ER ที่เรียกใช้โดยใช้การแมปรูปแบบ ER ของชนิดนี้ ในการแมปรูปแบบ ER คุณต้องตั้งค่าคอนฟิกแหล่งข้อมูลชนิด **ออบเจ็กต์** ที่อ้างอิงถึงคลาส **[QuestionnairesErReportContract](#DataContractClass)** เมื่อต้องการระบุการแมปรูปแบบ คุณต้องระบุแหล่งข้อมูลที่เรียกการแมปรูปแบบนี้ ในโค้ดที่ระบุ แหล่งข้อมูลนี้ที่ระบุโดยค่าคงที่ **ERModelDataSourceName** ที่มีค่า **[รูปแบบ](#ModelDSName)** เมื่อต้องการระบุแหล่งข้อมูลที่จะใช้ในการแสดงสัญญาข้อมูลในการแมปรูปแบบ คุณต้องระบุชื่อแหล่งข้อมูล ในโค้ดที่ระบุ ชื่อนี้มีการระบุโดยค่าคงคงที่ **ParametersDataSourceName** ที่มีค่า <a name="DataContractDSName"></a>**RunTimeParameters**

> [!NOTE]
> ในสภาพแวดล้อมใหม่ คุณอาจต้องรีเฟรชข้อมูลเมตาของ ER เพื่อให้คลาสชนิดนี้พร้อมใช้งานในตัวออกแบบการแมปรูปแบบ ER สำหรับข้อมูลเพิ่มเติม โปรดดู [ตั้งค่าคอนฟิกกรอบงาน ER](electronic-reporting-er-configure-parameters.md#frequently-asked-questions)

#### <a name="add-a-report-controller-class"></a><a name="ControllerClass"></a>เพิ่มคลาสตัวควบคุมรายงาน

เพิ่มคลาส **QuestionnairesErReportController** ใหม่ลงในโครงการ Visual Studio ของคุณ และเขียนโค้ดที่เรียกใช้รูปแบบ ER ในโหมดซิงโครนัสหรือโหมดชุดงานตามที่คุณต้องการ ในกล่องโต้ตอบที่สร้างขึ้นตามตรรกะของคลาส **QuestionnairesErReportUIBuilder** ที่ระบุ

```xpp
/// <summary>
/// The controller for Questionnaires ER report
/// </summary>
class QuestionnairesErReportController extends ERFormatMappingRunBaseController
{
    /// <summary>
    /// The main entrance of the controller
    /// </summary>
    /// <param name = "args">The arguments</param>
    public static void main(Args args)
    {
        QuestionnairesErReportController operation;
        operation = new QuestionnairesErReportController(
            classStr(QuestionnairesErReportService),
            methodStr(QuestionnairesErReportService, generateReportByGER),
            SysOperationExecutionMode::Synchronous);
        operation.startOperation();
    }

    /// <summary>
    /// Gets caption of the dialog.
    /// </summary>
    /// <returns>Caption of the dialog</returns>
    public ClassDescription defaultCaption()
    {
        ClassDescription batchDescription;
        batchDescription = "Questionnaires report (powered by ER)";
        return batchDescription;
    }
}
```

#### <a name="add-a-menu-item"></a><a name="MenuItem"></a>เพิ่มรายการเมนู

เพิ่มรายการเมนู **QuestionnairesErReport** ใหม่ลงในโครงการ Visual Studio ของคุณ ในคุณสมบัติ **ออบเจ็กต์** รายการเมนูนี้อ้างอิงถึงคลาส **QuestionnairesErReportController** และมีการใช้เพื่อระบุสิทธิ์ของผู้ใช้ในการเลือกและเรียกใช้รูปแบบ ER ในคุณสมบัติ **ป้ายชื่อ** รายการเมนูนี้อ้างอิงถึงป้ายชื่อ **\@QuestionnairesReport** ที่คุณสร้างไว้ก่อนหน้านี้เพื่อให้มีการแสดงข้อความที่ถูกต้องใน UI ของแอปพลิเคชัน

#### <a name="add-a-menu-item-to-a-menu"></a><a name="Menu"></a>เพิ่มรายการเมนูลงในเมนู

เพิ่มเมนู **KM** ที่มีอยู่ลงในโครงการ Visual Studio ของคุณ คุณต้องเพิ่มรายการ **QuestionnairesErReport** ใหม่ของชนิด **ผลลัพธ์** ลงในเมนูนี้ รายการนี้ต้องออ้างอิงถึงรายการเมนู **QuestionnairesErReport** ที่อธิบายไว้ในหัวข้อก่อนหน้านี้

#### <a name="build-a-visual-studio-project"></a><a name="BuildVSProject"></a>สร้างโครงการ Visual Studio

สร้างโครงการของคุณเพื่อทำให้รายการเมนูใหม่พร้อมใช้งานสำหรับผู้ใช้

### <a name="run-a-format-from-the-application"></a><a name="RunFormatFromApp"></a>เรียกใช้รูปแบบจากแอปพลิเคชัน

1. ไปที่ **แบบสอบถาม** \> **ออกแบบ** \> **รายงานแบบสอบถาม (ที่ให้บริการโดย ER)**

    ![การเลือกรายการเมนูรายงานแบบสอบถาม (ที่ให้บริการโดย ER) ในโมดูลแบบสอบถามเพื่อเรียกใช้รูปแบบ ER ที่ตั้งค่าคอนฟิก](./media/er-quick-start1-application-menu-modified.png)

2. ในกล่องโต้ตอบ ในฟิลด์ **การแมปรูปแบบ** เลือก **รายงานแบบสอบถาม**
3. เลือก **ตกลง**
4. ในกล่องโต้ตอบ **พารามิเตอร์รายงานทางอิเล็กทรอนิกส์** บนแท็บด่วน **เรกคอร์ดที่จะรวม** ให้ตั้งค่าคอนฟิกตัวเลือกการกรองเพื่อให้รวมเฉพาะแบบสอบถาม **SBCCrsExam** เท่านั้น
5. เลือก **ตกลง** เพื่อยืนยันตัวเลือกการกรอง
6. เลือก **ตกลง** เพื่อเรียกใช้รายงาน

    ![การระบุเงื่อนไขการเลือกในกล่องโต้ตอบรายงานทางอิเล็กทรอนิกส์](./media/er-quick-start1-report-run-dialog-page.png)

7. ตรวจสอบรายงานที่สร้าง

## <a name="tune-a-designed-er-solution"></a><a name="TuneSolution"></a>ปรับแต่งโซลูชัน ER ที่ออกแบบ

คุณสามารถปรับแต่งโซลูชัน ER ที่ตั้งค่าคอนฟิกไว้เพื่อให้ใช้คลาสตัวให้บริการข้อมูลที่คุณพัฒนาเพื่อเข้าถึงรายละเอียดของรูปแบบ ER ที่กำลังทำงานอยู่ และเพื่อให้ป้อนชื่อของรูปแบบ ER นี้ในรายงานที่สร้างขึ้น

### <a name="modify-a-model-mapping"></a><a name="ModifyModelMapping"></a>ปรับเปลี่ยนการแมปรูปแบบ

#### <a name="add-data-sources-to-access-a-data-contract-object"></a><a name="AddDataSource1"></a>เพิ่มแหล่งข้อมูลที่จะเข้าถึงออบเจ็กต์สัญญาข้อมูล

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. บนหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิกในบานหน้าต่างด้านซ้าย ให้ขยาย **รูปแบบแบบสอบถาม** จากนั้นเลือก **การแมปแบบสอบถาม**
3. เลือก **ตัวออกแบบ** เพื่อเปิดหน้า **การแมปรูปแบบกับแหล่งข้อมูล**
4. เลือก **ตัวออกแบบ** เพื่อเปิดการแมปที่เลือกในตัวออกแบบการแมปรูปแบบ
5. บนหน้า **ตัวออกแบบการแมปรูปแบบ** ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **Dynamics 365 for Operations\\ออบเจ็กต์**
6. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **เพิ่มราก**
7. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ป้อน **[RunTimeParameters](#DataContractDSName)** ตามที่กำหนดในซอร์สโค้ดของคลาส **QuestionnairesErReportService**
8. ในฟิลด์ **คลาส** ป้อน **[QuestionnairesErReportContract](#DataContractClass)** ซึ่งเขียนโค้ดไว้ก่อนหน้านี้
9. เลือก **ตกลง**
10. ขยาย **RunTimeParameters**

แหล่งข้อมูลที่เพิ่มเข้ามาจะให้ข้อมูลเกี่ยวกับรหัสเรกคอร์ดของการแมปรูปแบบ ER ที่กำลังทำงานอยู่

![เพิ่มแหล่งข้อมูลในตัวออกแบบการแมปรูปแบบ ER](./media/er-quick-start1-mapping3.png)

#### <a name="add-a-data-source-to-access-er-format-mapping-records"></a><a name="AddDataSource2"></a>เพิ่มแหล่งข้อมูลที่จะเข้าถึงเรกคอร์ดการแมปรูปแบบ ER

ดำเนินการต่อเพื่อแก้ไขการแมปรูปแบบที่เลือกโดยการเพิ่มแหล่งข้อมูลที่จะเข้าถึงเรกคอร์ดการแมปรูปแบบ ER

1. บนหน้า **ตัวออกแบบการแมปรูปแบบ** ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **Dynamics 365 for Operations\\เรกคอร์ดตาราง**
2. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **เพิ่มราก**
3. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ให้ป้อน **ER1**
4. ในฟิลด์ **ตาราง** ให้ป้อน **ERFormatMappingTable**
5. เลือก **ตกลง**

#### <a name="add-a-data-source-to-access-a-format-mapping-record-of-a-running-er-format"></a><a name="AddDataSource3"></a>เพิ่มแหล่งข้อมูลที่จะเข้าถึงเรกคอร์ดการแมปรูปแบบของรูปแบบ ER ที่กำลังทำงานอยู่

ดำเนินการต่อเพื่อแก้ไขการแมปรูปแบบที่เลือกโดยการเพิ่มแหล่งข้อมูลที่จะเข้าถึงเรกคอร์ดการแมปรูปแบบของรูปแบบ ER ที่กำลังทำงานอยู่

1. บนหน้า **ตัวออกแบบการแมปรูปแบบ** ในบานหน้าต่าง **ชนิดแหล่งข้อมูล** เลือก **Functions\\Calculated field**
2. ในบานหน้าต่าง **แหล่งข้อมูล** เลือก **เพิ่มราก**
3. ในกล่องโต้ตอบ ในฟิลด์ **ชื่อ** ให้ป้อน **ER2**
4. เลือก **แก้ไขสูตร**
5. ในตัวแก้ไขสูตร ในฟิลด์ **สูตร** ป้อน **FIRSTORNULL (FILTER(ER1, ER1.RecId = RunTimeParameters.parmFormatMapping))**
6. เลือก **ตกลง** และปิดตัวแก้ไขสูตร
7. เลือก **ตกลง**

#### <a name="enter-the-name-of-the-running-er-format-in-the-data-model"></a><a name="AddBinding"></a>ป้อนชื่อของรูปแบบ ER ที่กำลังทำงานอยู่ในรูปแบบข้อมูล

ดำเนินการต่อเพื่อแก้ไขการแมปรูปแบบที่เลือกเพื่อให้มีการป้อนชื่อของรูปแบบ ER ที่กำลังทำงานอยู่ในรูปแบบข้อมูล

1. บนหน้า **ตัวออกแบบการแมปรูปแบบ** ในบานหน้าต่าง **รูปแบบข้อมูล** ขยาย **ExecutionContext** แล้วเลือก **ExecutionContext\\FormatName**
2. ในบานหน้าต่าง **รูปแบบข้อมูล** ให้เลือก **แก้ไข** เพื่อตั้งค่าคอนฟิกการผูกข้อมูลสำหรับฟิลด์ของรูปแบบข้อมูลที่เลือก
3. ในตัวแก้ไขสูตร ในฟิลด์ **สูตร** ป้อน **FIRSTORNULL (ER2.'\>Relations'.Format).Name**
4. เลือก **ตกลง** และปิดตัวแก้ไขสูตร

เนื่องจากคุณใช้ฟิลด์ **FormatName** การแมปรูปแบบที่ได้รับการตั้งค่าคอนฟิกในตอนนี้จะแสดงชื่อของรูปแบบ ER ซึ่งเรียกการแมปรูปแบบนี้ในระหว่างการดำเนินการ

![ผูกฟิลด์รูปแบบข้อมูลกับวิธีการของแหล่งข้อมูลที่เพิ่มในตัวออกแบบการแมปรูปแบบ ER](./media/er-quick-start1-mapping4.png)

#### <a name="complete-the-design-of-the-model-mapping"></a><a name="CompleteModelMapping2"></a>ทำการออกแบบการแมปรูปแบบให้เสร็จสมบูรณ์

1. บนหน้า **ตัวออกแบบการแมปรูปแบบ** เลือก **บันทึก**
2. ปิดหน้า
3. ปิดหน้าการแมปรูปแบบง
4. บนหน้า **การตั้งค่าคอนฟิก** ในแผนผังการตั้งค่าคอนฟิก ตรวจสอบให้แน่ใจว่าการตั้งค่าคอนฟิก **การแมปแบบสอบถาม** ยังคงมีการเลือกไว้ จากนั้น บนแท็บด่วน **รุ่น** ให้เลือกรุ่นการตั้งค่าคอนฟิกที่มีสถานะเป็น **แบบร่าง**
5. เลือก **เปลี่ยนแปลงสถานะ** \> **เสร็จสมบูรณ์**

สถานะของรุ่น 1.2 ของการตั้งค่าคอนฟิกนี้มีการเปลี่ยนแปลงจาก **แบบร่าง** เป็น **เสร็จสมบูรณ์** รุ่น 1.2 ไม่สามารถเปลี่ยนแปลงได้อีกต่อไป รุ่นนี้มีการแมปรูปแบบที่ตั้งค่าคอนฟิกและสามารถใช้เป็นข้อมูลพื้นฐานสำหรับการตั้งค่าคอนฟิก ER อื่นๆ รุ่น 1.3 ของการตั้งค่าคอนฟิกนี้จะถูกสร้างขึ้นและมีสถานะเป็น **แบบร่าง** คุณสามารถแก้ไขรุ่นนี้เพื่อปรับปรุงการแมปรูปแบบ **แบบสอบถาม**

### <a name="modify-a-format"></a><a name="ModifyFormat"></a>ปรับเปลี่ยนรูปแบบ

คุณสามารถปรับเปลี่ยนรูปแบบ ER ที่ตั้งค่าคอนฟิกไว้เพื่อให้ชื่อแสดงอยู่ในส่วนท้ายของรายงานที่สร้างขึ้นเมื่อมีการเรียกใช้รูปแบบ ER

#### <a name="add-a-new-format-element"></a><a name="AddFormatElement"></a>เพิ่มองค์ประกอบรูปแบบใหม่

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. บนหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิกในบานหน้าต่างด้านซ้าย ให้ขยาย **รูปแบบแบบสอบถาม** จากนั้นเลือก **รายงานแบบสอบถาม**
3. เลือก **ตัวออกแบบ**
4. บนหน้า **ตัวออกแบบรูปแบบ** ให้เลือกรายการราก **รายงาน**
5. เลือก **เพิ่ม** เพื่อเพิ่มองค์ประกอบรูปแบบที่ซ้อนกันใหม่สำหรับรายการรากของ **รายงาน** ที่เลือก
6. เลือก **Excel\\Footer**
7. ในฟิลด์ **ชื่อ** ให้ป้อน **ส่วนท้าย**
8. เลือก **Report\Footer** แล้วเลือก **เพิ่ม**
9. เลือก **Text\\String**

#### <a name="bind-the-added-format-element"></a><a name="BindAddedFormatElement"></a>ผูกองค์ประกอบรูปแบบที่เพิ่ม

1. บนหน้า **ตัวออกแบบรูปแบบ** บนแท็บ **การแมป** ในแผนผังรูปแบบ สำหรับองค์ประกอบ **Footer\\String** ที่ใช้งานอยู่ เลือก **แก้ไขสูตร**
2. ในตัวแก้ไขสูตร ในฟิลด์ **สูตร** ป้อน **CONCATENATE ("\&C\&10", FORMAT("Generated by'\%1' ER solution", model.ExecutionContext.FormatName))**
3. เลือก **ตกลง** และปิดตัวแก้ไขสูตร
4. เลือก **บันทึก**

ตอนนี้มีการปรับเปลี่ยนรูปแบบที่ตั้งค่าคอนฟิกไว้เพื่อให้ชื่อถูกป้อนลงในส่วนท้ายของรายงานที่สร้างโดยใช้องค์ประกอบ **Footer\\String**

![การเพิ่มองค์ประกอบรูปแบบส่วนท้ายให้กับรูปแบบที่ตั้งค่าคอนฟิกไว้ในตัวออกแบบการดำเนินงานของ ER](./media/er-quick-start1-template-format-structure3.png)

#### <a name="complete-the-format-design"></a><a name="CompleteFormat2"></a>ทำการออกแบบรูปแบบให้เสร็จสมบูรณ์

1. ปิดหน้า **ตัวออกแบบรูปแบบ**
2. บนหน้า **การตั้งค่าคอนฟิก** ในแผนผังการตั้งค่าคอนฟิก ตรวจสอบให้แน่ใจว่าการตั้งค่าคอนฟิก **รายงานแบบสอบถาม** ยังคงมีการเลือกไว้ จากนั้น บนแท็บด่วน **รุ่น** ให้เลือกรุ่นการตั้งค่าคอนฟิกที่มีสถานะเป็น **แบบร่าง**
3. เลือก **เปลี่ยนแปลงสถานะ** \> **เสร็จสมบูรณ์**

สถานะของรุ่น 1.2 ของการตั้งค่าคอนฟิกนี้มีการเปลี่ยนแปลงจาก **แบบร่าง** เป็น **เสร็จสมบูรณ์** รุ่น 1.2 ไม่สามารถเปลี่ยนแปลงได้อีกต่อไป รุ่นนี้มีรูปแบบที่ตั้งค่าคอนฟิกและสามารถใช้เป็นข้อมูลพื้นฐานสำหรับการตั้งค่าคอนฟิก ER อื่นๆ รุ่น 1.3 ของการตั้งค่าคอนฟิกนี้จะถูกสร้างขึ้นและมีสถานะเป็น **แบบร่าง** คุณสามารถแก้ไขรุ่นนี้เพื่อปรับปรุงรายงาน **แบบสอบถาม**

### <a name="run-a-format-from-the-application"></a><a name="RunFormatFromApp2"></a>เรียกใช้รูปแบบจากแอปพลิเคชัน

1. ไปที่ **แบบสอบถาม** \> **ออกแบบ** \> **รายงานแบบสอบถาม (ที่ให้บริการโดย ER)**
2. ในกล่องโต้ตอบ ในฟิลด์ **การแมปรูปแบบ** เลือก **รายงานแบบสอบถาม**
3. เลือก **ตกลง**
4. ในกล่องโต้ตอบ **พารามิเตอร์ ER** บนแท็บด่วน **เรกคอร์ดที่จะรวม** ให้ตั้งค่าคอนฟิกตัวเลือกการกรองเพื่อให้รวมเฉพาะแบบสอบถาม **SBCCrsExam** เท่านั้น
5. เลือก **ตกลง** เพื่อยืนยันตัวเลือกการกรอง
6. เลือก **ตกลง** เพื่อเรียกใช้รายงาน
7. ตรวจทานรายงานที่สร้างในรูปแบบ Excel

โปรดสังเกตว่าส่วนท้ายของรายงานที่สร้างจะมีชื่อของรูปแบบ ER ซึ่งใช้ในการสร้าง

![รายงานที่สร้างในรูปแบบ Excel](./media/er-quick-start1-report4.png)

### <a name="run-a-format-from-er"></a><a name="RunFormatFromER3"></a>เรียกใช้รูปแบบจาก ER

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. บนหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิกในบานหน้าต่างด้านซ้าย ให้ขยาย **รูปแบบแบบสอบถาม** จากนั้นเลือก **รายงานแบบสอบถาม**
3. บนบานหน้าต่างการดำเนินการ เลือก **รัน**
4. ในกล่องโต้ตอบ **พารามิเตอร์รายงานทางอิเล็กทรอนิกส์** บนแท็บด่วน **เรกคอร์ดที่จะรวม** ให้ตั้งค่าคอนฟิกตัวเลือกการกรองเพื่อให้รวมเฉพาะแบบสอบถาม **SBCCrsExam** เท่านั้น
5. เลือก **ตกลง** เพื่อยืนยันตัวเลือกการกรอง
6. เลือก **ตกลง** เพื่อเรียกใช้รายงาน
7. ตรวจทานรายงานที่สร้างในรูปแบบ Excel

โปรดสังเกตว่าส่วนท้ายของรายงานที่สร้างขึ้นไม่มีชื่อของรูปแบบ ER ซึ่งใช้ในการสร้าง เนื่องจากไม่ได้ส่งผ่านอ็อบเจกต์สัญญาข้อมูลไปยังการแมปรูปแบบที่กำลังทำงานอยู่เมื่อมีการเรียกใช้โดยรูปแบบ ER ซึ่งเรียกใช้จาก ER

### <a name="configure-a-format-destination-for-on-screen-preview"></a><a name="ConfigureDestination"></a>ตั้งค่าคอนฟิกปลายทางรูปแบบสำหรับการแสดงตัวอย่างบนหน้าจอ

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **ปลายทางการรายงานทางอิเล็กทรอนิกส์**
2. บนหน้า **ปลายทางการรายงานทางอิเล็กทรอนิกส์** ให้เพิ่มเรกคอร์ดปลายทางสำหรับรูปแบบ ER ของ **รายงานแบบสอบถาม** ที่ตั้งค่าคอนฟิกไว้
3. บนแท็บด่วน **ปลายทางของไฟล์** ตั้งค่า **หน้าจอ** [ปลายทาง](er-destination-type-screen.md) สำหรับส่วนประกอบรูปแบบ **รายงาน** ที่มี [การเพิ่มไว้](#AddFormatRootElement) เป็นองค์ประกอบรากของรูปแบบ ER ของ **รายงานแบบสอบถาม** ที่ตั้งค่าคอนฟิกไว้
4. บนแท็บด่วน **การตั้งค่าการแปลง PDF** ให้ตั้งค่าคอนฟิกปลายทางที่จะแปลงรายงานเป็น [รูปแบบ PDF](electronic-reporting-destinations.md#OutputConversionToPDF) ที่ใช้การจัดวางหน้า **แนวนอน**

![การตั้งค่าคอนฟิกปลายทางของหน้าจอที่กำหนดเองสำหรับรูปแบบ ER บนหน้าปลายทางการรายงานทางอิเล็กทรอนิกส์](./media/er-quick-start1-destination.png)

### <a name="run-a-format-from-the-application-to-preview-it-as-a-pdf-document"></a><a name="RunFormatFromApp3"></a>เรียกใช้รูปแบบจากแอปพลิเคชันเพื่อแสดงตัวอย่างเป็นเอกสาร PDF

1. ไปที่ **แบบสอบถาม** \> **ออกแบบ** \> **รายงานแบบสอบถาม (ที่ให้บริการโดย ER)**
2. ในกล่องโต้ตอบ ในฟิลด์ **การแมปรูปแบบ** เลือก **รายงานแบบสอบถาม**
3. เลือก **ตกลง**
4. ในกล่องโต้ตอบ **พารามิเตอร์รายงานทางอิเล็กทรอนิกส์** บนแท็บด่วน **เรกคอร์ดที่จะรวม** ให้ตั้งค่าคอนฟิกตัวเลือกการกรองเพื่อให้รวมเฉพาะแบบสอบถาม **SBCCrsExam** เท่านั้น
5. เลือก **ตกลง** เพื่อยืนยันตัวเลือกการกรอง

    บนแท็บด่วน **ปลายทาง** สังเกตว่าฟิลด์ **ผลลัพธ์** ตั้งค่าเป็น **หน้าจอ** ถ้าคุณต้องการเปลี่ยนปลายทางที่ตั้งค่าคอนฟิกไว้ ให้เลือก **เปลี่ยน**

    ![กล่องโต้ตอบรันไทม์ของรายงาน ER ซึ่งคุณสามารถเปลี่ยนปลายทางที่ตั้งค่าคอนฟิกได้](./media/er-quick-start1-run-settings.png)

6. เลือก **ตกลง** เพื่อเรียกใช้รายงาน
7. ตรวจทานรายงานที่สร้างในรูปแบบ PDF

    ![การแสดงตัวอย่างบนหน้าจอของรายงานที่สร้างในรูปแบบ PDF](./media/er-quick-start1-preview-PDF.png)

## <a name="additional-resources"></a><a name="References"></a>ทรัพยากรเพิ่มเติม

- [ภาพรวมการรายงานทางอิเล็กทรอนิกส์](general-electronic-reporting.md)
- [ภาษาสูตรในการรายงานทางอิเล็กทรอนิกส์](er-formula-language.md)
- [ออกแบบรายงานหลายภาษา](er-design-multilingual-reports.md)
- [API กรอบงานการรายงานทางอิเล็กทรอนิกส์](er-apis-app73.md)
- [ฟังก์ชัน CASE](er-functions-logical-case.md)
- [ฟังก์ชัน CONCATENATE](er-functions-text-concatenate.md)
- [ฟังก์ชัน DATETIMEFORMAT](er-functions-datetime-datetimeformat.md)
- [ฟังก์ชัน FILTER](er-functions-list-filter.md)
- [ฟังก์ชัน FIRSTORNULL](er-functions-list-firstornull.md)
- [ฟังก์ชัน FORMAT](er-functions-text-format.md)
- [ฟังก์ชัน IF](er-functions-logical-if.md)
- [ฟังก์ชัน ORDERBY](er-functions-list-orderby.md)
- [ฟังก์ชัน SESSIONNOW](er-functions-datetime-sessionnow.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
