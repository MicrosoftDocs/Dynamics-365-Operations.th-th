---
title: ใช้แหล่งข้อมูล DATA COLLECTION ในรูปแบบการรายงานทางอิเล็กทรอนิกส์
description: บทความนี้อธิบายวิธีการใช้แหล่งข้อมูล DATA COLLECTION ในรูปแบบการรายงานทางอิเล็กทรอนิกส์ (ER)
author: kfend
ms.date: 08/23/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User, IT Pro
ms.reviewer: kfend
ms.search.region: Global
ms.author: filatovm
ms.search.validFrom: 2021-01-01
ms.dyn365.ops.version: AX 10.0.16
ms.custom: 58771
ms.assetid: ''
ms.search.form: EROperationDesigner
ms.openlocfilehash: 221cefc1880cdd88a952140424daf24975a575aa
ms.sourcegitcommit: 87e727005399c82cbb6509f5ce9fb33d18928d30
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 08/12/2022
ms.locfileid: "9286193"
---
# <a name="use-data-collection-data-sources-in-electronic-reporting-formats"></a>ใช้แหล่งข้อมูล DATA COLLECTION ในรูปแบบการรายงานทางอิเล็กทรอนิกส์

[!include [banner](../includes/banner.md)]

คุณสามารถใช้ผู้ออกแบบการดำเนินการของกรอบงาน [การรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md) เพื่อกำหนดค่าส่วนประกอบ รูปแบบ ของโซลูชัน ER ซึ่งใช้ในการสร้างเอกสารขาออกในรูปแบบอื่น โครงสร้างลำดับชั้นของส่วนประกอบรูปแบบที่ตั้งค่าคอนฟิกประกอบด้วยองค์ประกอบรูปแบบของชนิดต่างๆ องค์ประกอบรูปแบบเหล่านี้ใช้ในการกรอกเอกสารที่สร้างขึ้นโดยมีข้อมูลที่จำเป็นในขณะใช้งานจริง โดยค่าเริ่มต้น เมื่อคุณรันรูปแบบ ER จะมีการรันใช้องค์ประกอบรูปแบบในลำดับเดียวกับที่แสดงในลำดับชั้นรูปแบบ: ทีละรายการจากบนลงล่าง

เมื่อ ER รันองค์ประกอบรูปแบบที่ประกอบด้วยการผูกข้อมูล สูตรของการผูกข้อมูลนั้นจะถูกรัน และองค์ประกอบรูปแบบจะเพิ่มค่านั้นในเอกสารที่สร้างขึ้น ตัวอย่างเช่น การผูกข้อมูลสามารถส่งผ่านค่าของฟิลด์ รูปแบบข้อมูล ไปยังองค์ประกอบรูปแบบได้ คุณสามารถตั้งค่าคอนฟิกแหล่งข้อมูล DATA COLLECTION เพื่อรวบรวมค่าของฟิลด์รูปแบบข้อมูลขณะรันไทม์ ทำการรวมค่า และเติมเอกสารที่สร้างขึ้นด้วยค่าที่รวบรวม หากต้องการใช้วิธีการนี้ ให้เปลี่ยนการผูกข้อมูลเริ่มต้น เพื่อให้มีการใช้แหล่งข้อมูล DATA COLLECTION ที่ตั้งค่าคอนฟิกเพื่อส่งผ่านค่าของฟิลด์รูปแบบข้อมูลไปยังองค์ประกอบรูปแบบ โดยการส่งผ่านค่าผ่านแหล่งข้อมูล DATA COLLECTION คุณสามารถรวบรวมรายละเอียดที่ต้องใช้เพิ่มเติมได้

เมื่อคุณตั้งค่าคอนฟิกแหล่งข้อมูล DATA COLLECTION ให้ระบุชนิดค่าที่จะจัดการในแหล่งข้อมูล ปัจจุบัน [ชนิดข้อมูล](er-formula-supported-data-types-primitive.md) ต่อไปนี้สนับสนุนเพื่อรวบรวมค่า

- บูลีน
- วัน เดือน
- วันที่และเวลา
- GUID
- Int64
- เลขจำนวนเต็ม
- จำนวนจริง
- สตริง
- เวลา

คุณสามารถใช้วิธีการ `Collect(Value)` ของแหล่งข้อมูล DATA COLLECTION เพื่อส่งผ่านค่าไปยังแหล่งข้อมูลที่จะรวบรวม ในวิธีการนี้ อาร์กิวเมนต์ `Value` เป็นค่าคงที่หรือพาธที่ถูกต้องของฟิลด์แหล่งข้อมูลของชนิดข้อมูลที่เกี่ยวข้อง

ใช้คุณสมบัติ `Result` ของแหล่งข้อมูล DATA COLLECTION เพื่อเข้าถึงรายการของค่าที่รวบรวม คุณสมบัตินี้จะส่งคืน [รายการเรกคอร์ด](er-formula-supported-data-types-composite.md#record-list) เรกคอร์ดของรายการเรกคอร์ดจะมีฟิลด์ `Value` ที่คุณสามารถใช้เพื่อเข้าถึงค่าที่รวบรวม

โดยค่าเริ่มต้น แหล่งข้อมูล DATA COLLECTION จะรวบรวมเฉพาะค่าเฉพาะเท่านั้น

เมื่อต้องการรวบรวมค่าทั้งหมด ให้ตั้งค่าฟิลด์ **รวบรวมค่าทั้งหมด** ของแหล่งข้อมูล DATA COLLECTION ที่ตั้งค่าคอนฟิกเป็น **ใช่** เมื่อตั้งค่าฟิลด์ **รวบรวมค่าทั้งหมด** เป็น **ใช่** คุณสมบัติ `Sum(Flag)` ที่เป็นพารามิเตอร์จะพร้อมใช้งาน คุณสามารถใช้คุณสมบัตินี้เพื่อให้ได้ยอดรวมของค่าที่รวบรวมในปัจจุบันทั้งหมด ในคุณสมบัตินี้ อาร์กิวเมนต์ `Flag` คือ [ค่าบูลีน](er-formula-supported-data-types-primitive.md#boolean) ที่ใช้เพื่อบ่งชี้ว่าต้องรีเซ็ตค่ารวมหรือไม่

- เมื่อระบุค่า **เท็จ** การรวมจะต่อจากยอดที่รวบรวมไว้ก่อนหน้านี้
- เมื่อระบุค่า **จริง** จะมีการเริ่มต้นการรวมใหม่

ปัจจุบันชนิดข้อมูลต่อไปนี้สนับสนุนสำหรับการรวม:

- Int64
- เลขจำนวนเต็ม
- จำนวนจริง

เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับคุณลักษณะนี้ ให้ดำเนินการตัวอย่างต่อไปนี้ให้เสร็จสมบูรณ์

## <a name="example-configure-an-er-format-to-do-counting-and-summing-by-using-a-data-collection-data-source"></a>ตัวอย่าง: ตั้งค่าคอนฟิกรูปแบบ ER เพื่อตรวจนับและรวมโดยใช้แหล่งข้อมูล DATA COLLECTION

ตัวอย่างนี้แสดงวิธีการที่ผู้ใช้ในบทบาทที่ปรึกษาด้านการทำงานของผู้ดูแลระบบหรือการรายงานทางอิเล็กทรอนิกส์สามารถตั้งค่าคอนฟิกรูปแบบ ER ที่มีแหล่งข้อมูล DATA COLLECTION ที่ใช้ในการคํานวณยอดรวมที่รันและรวบรวมมูลค่าที่รวม

กระบวนงานในตัวอย่างนี้สามารถดำเนินงานให้เสร็จสมบูรณ์ได้ในบริษัท USMF ใน Microsoft Dynamics 365 Finance

### <a name="upload-and-use-the-provided-er-solution"></a>อัปโหลดและใช้โซลูชัน ER ที่ระบุ

1. [นำเข้าการกำหนดค่า ER ตัวอย่าง](er-defer-sequence-element.md#import-the-sample-er-configurations)
2. [เรียกใช้ผู้ให้บริการการตั้งค่าคอนฟิก](er-defer-sequence-element.md#activate-a-configurations-provider)
3. [ตรวจทานการแมปแบบจำลองที่นำเข้า](er-defer-sequence-element.md#review-the-imported-model-mapping)
4. [ตรวจทานรูปแบบที่นำเข้า](er-defer-sequence-element.md#review-the-imported-format)
5. [รันรูปแบบที่นำเข้า](er-defer-sequence-element.md#run-the-imported-format)

### <a name="run-the-format-of-the-provided-er-solution"></a>รันรูปแบบของโซลูชัน ER ที่ระบุ

1. ในหน้า **ตัวออกแบบรูปแบบ** เลือก **รัน**
2. ในกล่องโต้ตอบ **พารามิเตอร์ของรายงานทางอิเล็กทรอนิกส์** เลือก **ตกลง**
3. ดาวน์โหลดแและตรวจทานไฟล์ที่เว็บเบราว์เซอร์นำเสนอ

    ![ไฟล์ที่ดาวน์โหลดซึ่งมีผลลัพธ์ของการดําเนินการรูปแบบเริ่มต้น](./media/er-data-collection-data-sources-01.png)

### <a name="modify-the-format-of-the-er-solution-to-calculate-the-running-tax-total"></a>ปรับเปลี่ยนรูปแบบของโซลูชัน ER เพื่อคํานวณยอดรวมภาษีที่รันอยู่

ถ้าปริมาณของธุรกรรมมีขนาดใหญ่กว่าปริมาณในตัวอย่างปัจจุบัน เวลาการรวมอาจเพิ่มขึ้นและทำให้เกิดปัญหาประสิทธิภาพการทำงาน ด้วยการเปลี่ยนแปลงการตั้งค่าของรูปแบบ คุณสามารถช่วยป้องกันปัญหาประสิทธิภาพการทำงานเหล่านี้ได้ เนื่องจากคุณเข้าถึงมูลค่าภาษีเพื่อรวมไว้ในรายงานที่สร้างขึ้น คุณสามารถนำข้อมูลนี้มาใช้อีกครั้งในการรวมมูลค่าภาษีได้

1. ในหน้า **ตัวออกแบบรูปแบบ** ในแท็บ **การแมป** ให้เลือก **เพิ่มราก**
2. ในกล่องโต้ตอบ **เพิ่มแหล่งข้อมูล** ให้เลือก **ฟังก์ชัน** \> **การรวบรวมข้อมูล**
3. ในกล่องโต้ตอบ **คุณสมบัติแหล่งข้อมูล 'การรวบรวมข้อมูล'** ให้ปฏิบัติตามขั้นตอนต่อไปนี้:

    1. ในฟิลด์ **ชื่อ** ให้ป้อน **CollectedTaxValues**
    2. ในฟิลด์ **ประเภทรายการ** ให้เลือก **จำนวนจริง**
    3. ในฟิลด์ **รวบรวมค่าทั้งหมด** ให้เลือก **ใช่**
    4. เลือก **ตกลง**

4. เลือกองค์ประกอบรูปแบบตัวเลข **รายงาน\\รายการ\\เรกคอร์ด\\TaxAmount**

    > [!NOTE]
    > ปัจจุบัน มีการตั้งค่าคอนฟิกการผูกข้อมูล `@.Value` ไว้สำหรับองค์ประกอบนี้ ดังนั้น เอกสารที่สร้างขึ้นถ้ามีการเติมมูลค่าภาษีจากฟิลด์ `model.Data.List.Value`

5. เลือก **แก้ไขสูตร**
6. ในหน้า **ตัวออกแบบสูตร** ให้ปฏิบัติตามขั้นตอนต่อไปนี้:

    1. ในฟิลด์ **สูตร** ให้แทนที่ `@.Value` ด้วย `CollectedTaxValues.Collect(@.Value)`
    2. บันทึกการเปลี่ยนแปลงของคุณ และปิดหน้า

    > [!NOTE]
    > การผูกข้อมูลใหม่จะผ่านมูลค่าภาษีเดียวกันกับเอกสารที่สร้างขึ้น อย่างไรก็ตาม ค่าเหล่านั้นจะถูกรวบรวมในแหล่งข้อมูล **CollectedTaxValues** ด้วย

7. เลือกองค์ประกอบรูปแบบตัวเลข **รายงาน\\รายการ\\เรกคอร์ด\\RunningTotal**
8. เลือก **แก้ไขสูตร**
9. ในหน้า **ตัวออกแบบสูตร** ให้ปฏิบัติตามขั้นตอนต่อไปนี้:

    1. ในฟิลด์ **สูตร** ป้อน `CollectedTaxValues.Sum(false)`
    2. บันทึกการเปลี่ยนแปลงของคุณ และปิดหน้า

    > [!NOTE]
    > การผูกข้อมูลใหม่จะผ่านไปยังเอกสารที่สร้าง ยอดรวมของมูลค่าภาษีที่ป้อนไว้แล้ว

    ![องค์ประกอบตัวเลขที่อัปเดตการผูกข้อมูลในหน้าตัวออกแบบรูปแบบ](./media/er-data-collection-data-sources-02.png)

10. เลือก **บันทึก** แล้วจากนั้น เลือก **รัน**
11. ในกล่องโต้ตอบ **พารามิเตอร์ของรายงานทางอิเล็กทรอนิกส์** เลือก **ตกลง**
12. ดาวน์โหลดแและตรวจทานไฟล์ที่เว็บเบราว์เซอร์นำเสนอ

    ![ไฟล์ที่ดาวน์โหลดซึ่งมีผลลัพธ์ของการดําเนินการรูปแบบที่สามารถปรับเปลี่ยนได้](./media/er-data-collection-data-sources-03.png)

### <a name="modify-the-format-to-evaluate-the-list-of-collected-tax-values"></a>ปรับเปลี่ยนรูปแบบเพื่อประเมินรายการของมูลค่าภาษีที่รวบรวม

1. บนหน้า **ตัวออกแบบรูปแบบ** บนแท็บ **รูปแบบ** ให้เลือกองค์ประกอบรูปแบบตัวเลข **รายงาน\\รายการ\\เรกคอร์ด\\RunningTotal** แล้วปฏิบัติตามขั้นตอนต่อไปนี้:

    1. ในฟิลด์ **ชนิดตัวเลข** ให้เปลี่ยนค่าจาก **จํานวนจริง** เป็น **จํานวนเต็ม**
    2. ในฟิลด์ **รูปแบบตัวเลข** เปลี่ยนค่าจาก **F2** เป็น **F0**

3. บนแท็บ **การแมป** ให้เลือก **แก้ไขสูตร**
4. ในหน้า **ตัวออกแบบสูตร** ให้ปฏิบัติตามขั้นตอนต่อไปนี้:

    1. ในฟิลด์ **สูตร** ป้อน `COUNT(CollectedTaxValues.Result)`
    2. บันทึกการเปลี่ยนแปลงของคุณ และปิดหน้า

    > [!NOTE]
    > การผูกข้อมูลใหม่จะผ่านไปยังเอกสารที่สร้าง จํานวนของเรกคอร์ดในรายการที่มีการรวบรวมมูลค่าภาษี

5. เลือก **บันทึก** แล้วจากนั้น เลือก **รัน**
6. ในกล่องโต้ตอบ **พารามิเตอร์ของรายงานทางอิเล็กทรอนิกส์** เลือก **ตกลง**
7. ดาวน์โหลดแและตรวจทานไฟล์ที่เว็บเบราว์เซอร์นำเสนอ

    ![ไฟล์ที่ดาวน์โหลดซึ่งมีผลลัพธ์ของการดําเนินการรูปแบบที่สามารถปรับเปลี่ยนได้อื่น](./media/er-data-collection-data-sources-04.png)

## <a name="frequently-asked-questions"></a>คำถามที่ถามบ่อย

### <a name="if-i-have-to-calculate-running-totals-and-collect-data-what-is-the-difference-between-using-a-data-collection-data-source-and-using-the-built-in-data-collection-functions"></a>ถ้าต้องคํานวณผลรวมที่รันอยู่และรวบรวมข้อมูล ความแตกต่างระหว่างการใช้แหล่งข้อมูล DATA COLLECTION และการใช้ฟังก์ชัน DATA COLLECTION ในตัวคืออะไร

ทั้งแหล่งข้อมูล DATA COLLECTION และฟังก์ชัน [DATA COLLECTION](er-functions-category-data-collection.md) ในตัวสามารถใช้ได้เพื่อรวบรวมข้อมูล การรวมข้อมูล และการตรวจนับ ตามข้อมูลที่ส่งผ่านไปยังเอกสารขาออกที่สร้างขึ้น อย่างไรก็ตาม เมื่อคุณพยายามตัดสินว่าควรใช้เทคนิคใด คุณต้องพิจารณาถึงจุดต่อไปนี้

| แหล่งข้อมูล | ฟังก์ชันในตัว |
|-------------| ------------------ |
| มีการรวบรวมเฉพาะค่าเท่านั้น | <p>มีการรวบรวมค่าที่มีชื่อ ดังนั้น ยอดรวมสามารถคำนวณสำหรับกลุ่มค่าที่แยกต่างหากได้</p><p>นอกจากนี้ กลุ่มยังสามารถแยกเป็นรายการอีกด้วย</p><p>ค่าข้อความสามารถรวบรวมได้</p> |
| มีการรวบรวมค่าเฉพาะโดยอัตโนมัติ | การตั้งค่าเพิ่มเติมจำเป็นเพื่อแยกรายการค่าเฉพาะออกจากค่าที่รวบรวม |
| ประสิทธิภาพจะขึ้นอยู่กับปริมาณของค่าที่รวบรวม | ในทางปฏิบัติ ประสิทธิภาพจะไม่ขึ้นอยู่กับปริมาณของค่าที่รวบรวม |
| เทคนิคนี้จะใช้ได้กับเอกสารขาออกทุกชนิด | เทคนิคนี้จะใช้ได้เฉพาะกับเอกสารข้อความและเอกสาร XML เท่านั้น |

## <a name="additional-resources"></a>ทรัพยากรเพิ่มเติม

- [ตั้งค่าคอนฟิกรูปแบบเพื่อทำการตรวจนับและการรวม](./tasks/er-format-counting-summing-1.md)
- [เลื่อนการดำเนินการขององค์ประกอบลำดับในรูปแบบการรายงานทางอิเล็กทรอนิกส์](er-defer-sequence-element.md#Example)

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
