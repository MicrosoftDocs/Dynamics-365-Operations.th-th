---
title: เครื่องมือแก้ไขสูตรการรายงานทางอิเล็กทรอนิกส์ขั้นสูง
description: หัวข้อนี้อธิบายวิธีการใช้ตัวแก้ไขสูตรขั้นสูงเพื่อกำหนดค่านิพจน์ในการแม็ปโมเดลการรายงานทางอิเล็กทรอนิกส์ (ER) กับส่วนประกอบรูปแบบ
author: NickSelin
manager: AnnBe
ms.date: 01/22/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ERSolutionTable, ERExpressionDesignerFormula
audience: Application User
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 97423
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-04-01
ms.dyn365.ops.version: AX 10.0.9
ms.openlocfilehash: d183f77da1dda0c4f04e4e48ab3db0133f494a55
ms.sourcegitcommit: 6a70f9ac296158edd065d52a12703b3ce85ce5ee
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 02/03/2020
ms.locfileid: "3015408"
---
# <a name="electronic-reporting-advanced-formula-editor"></a>เครื่องมือแก้ไขสูตรการรายงานทางอิเล็กทรอนิกส์ขั้นสูง

[!include [banner](../includes/banner.md)]

[!include [banner](../includes/preview-banner.md)]

นอกจากนี้ [การรายงานทางอิเล็กทรอนิกส์](general-electronic-reporting.md) [ตัวแก้ไขสูตร](general-electronic-reporting-formula-designer.md) คุณสามารถใช้ตัวแก้ไขสูตรการรายงานทางอิเล็กทรอนิกส์ขั้นสูงเพื่อปรับปรุงประสบการณ์ของการกำหนดค่านิพจน์การรายงานทางอิเล็กทรอนิกส์ (ER) ตัวแก้ไขขั้นสูงใช้เบราว์เซอร์และดำเนินการโดย [ตัวแก้ไข Monaco](https://microsoft.github.io/monaco-editor) คุณลักษณะตัวแก้ไขขั้นสูงที่ใช้บ่อยที่สุดมีการอธิบายไว้ในหัวข้อนี้:

- [การจัดรูปแบบอัตโนมัติของรหัส](#Autoformatting)
- [IntelliSense](#IntelliSense)
- [การทำรหัสให้เสร็จสมบูรณ์](#CodeCompletion)
- [การนำทางรหัส](#CodeNavigation)
- [กำหนดโครงสร้างรหัส](#CodeStructuring)
- [ค้นหาและแทนที่](#FindAndReplace)
- [การวางข้อมูล](#DataPasting)
- [การทำสีที่ไวยากรณ์](#SyntaxColorization)

## <a name="ActivateAdvEditor">เริ่มการใช้งานตัวแก้ไขสูตรขั้นสูง</a>

ทำตามขั้นตอนต่อไปนี้เพื่อเริ่มใช้ตัวแก้ไขสูตรขั้นสูงในอินสแตนซ์ Microsoft Dynamics 365 Finance ของคุณ

1.  ไปที่ **การดูแลระบบองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การกำหนดค่า**
2.  บนหน้า **การกำหนดค่า** บนบานหน้าต่างการดำเนินการ บนแท็บ **การกำหนดค่า** ในกลุ่ม **การตั้งค่าขั้นสูง** เลือก **พารามิเตอร์ผู้ใช้**
3.  กล่องโต้ตอบ **พารามิเตอร์ผู้ใช้** ในส่วน **การติดตามการดำเนินการ** ตั้งค่าพารามิเตอร์ **ตัวแก้ไขสูตรขั้นสูง** เป็น **ใช่**

[![หน้าการตั้งค่าคอนฟิก ER](./media/ER-AdvEditor-Activate.png)](./media/ER-AdvEditor-Activate.png)

> [!NOTE]
> พึงระวังว่าพารามิเตอร์นี้เฉพาะผู้ใช้และเฉพาะบริษัท

## <a name="Autoformatting">การจัดรูปแบบอัตโนมัติของรหัส</a>

เมื่อคุณเขียนนิพจน์ที่ซับซ้อนที่ประกอบด้วยรหัสหลายแถว การเยื้องของบรรทัดที่ป้อนใหม่จะเป็นไปโดยอัตโนมัติตามการเยื้องของแถวก่อนหน้า คุณสามารถเลือกบรรทัดและเปลี่ยนการเยื้องได้โดยพิมพ์ **Tab** หรือ **Shift+Tab**.

[![ตัวแก้ไขสูตร ER](./media/ER-AdvEditor-Indentation.gif)](./media/ER-AdvEditor-Indentation.gif)

การจัดรูปแบบอัตโนมัติช่วยให้คุณสามารถรักษานิพจน์ทั้งหมดให้อยู่ในรูปแบบที่ดีเพื่อให้การบำรุงรักษาง่ายขึ้นและทำให้เข้าใจตรรกะที่กำหนดค่าได้ง่ายขึ้น

## <a name="IntelliSense">IntelliSense</a>

ตัวแก้ไขสนับสนุนการกรอกคำให้เสร็จสมบูรณ์เพื่อช่วยให้คุณเขียนนิพจน์ได้เร็วขึ้นและหลีกเลี่ยงการพิมพ์ผิด เมื่อคุณเริ่มเพิ่มข้อความใหม่ ตัวแก้ไขนำเสนอรายการฟังก์ชันที่สนับสนุนในฟังก์ชัน ER โดยอัตโนมัติซึ่งมีอักขระที่คุณได้ป้อนไว้ คุณยังสามารถแสดงทริกเกอร์ IntelliSense ในสถานที่ใด ๆ ของนิพจน์ที่กำหนดค่าไว้โดยการพิมพ์ **Ctrl+Space**

[![ตัวแก้ไขสูตร ER](./media/ER-AdvEditor-Intelisense.gif)](./media/ER-AdvEditor-Intelisense.gif)

## <a name="CodeCompletion">การทำรหัสให้เสร็จสมบูรณ์</a>

ตัวแก้ไขจัดเตรียมการกรอกรหัสให้สมบูรณ์โดยอัตโนมัติโดย:

- การแทรกวงเล็บปิดเมื่อป้อนวงเล็บเปิดไว้ และทำให้เคอร์เซอร์อยู่ในเครื่องหมายวงเล็บ
- การแทรกสัญลักษณ์คำพูดที่สองเมื่อป้อนตัวแรก และทำให้เคอร์เซอร์อยู่ในเครื่องหมายคำพูด
- การแทรกสัญลักษณ์คำพูดคู่ที่สองเมื่อป้อนตัวแรก และทำให้เคอร์เซอร์อยู่ในเครื่องหมายคำพูด

[![ตัวแก้ไขสูตร ER](./media/ER-AdvEditor-CodeCompletion.gif)](./media/ER-AdvEditor-CodeCompletion.gif)

เมื่อคุณชี้ไปที่วงเล็บที่พิมพ์แล้ว วงเล็บที่สองของคู่นี้จะถูกเน้นโดยอัตโนมัติเพื่อแสดงโครงสร้างที่รองรับ

## <a name="CodeNavigation">การนำทางรหัส</a>

คุณสามารถค้นหาตำแหน่งสัญลักษณ์หรือบรรทัดที่ต้องการในนิพจน์ของคุณโดยพิมพ์คำสั่ง **ไปยัง** โดยใช้ชุดคำสั่งหรือเมนูบริบท

ตัวอย่างเช่น เพื่อข้ามไปยังบรรทัด **8** กระทำได้ดังต่อไปนี้

- กด **Ctrl+G** ป้อนค่า **8** แล้วกด **ป้อน**

  หรือ

- กด**F1** พิมพ์ **G** เลือก **ไปยังบรรทัด** ป้อนค่า **8** แล้วกด **ป้อน**

[![ตัวแก้ไขสูตร ER](./media/ER-AdvEditor-Goto.gif)](./media/ER-AdvEditor-Goto.gif)

## <a name="CodeStructuring">กำหนดโครงสร้างรหัส</a>

รหัสสำหรับฟังก์ชั่นบางอย่าง เช่น [IF](er-functions-logical-if.md) หรือ [CASE](er-functions-logical-case.md) จะถูกจัดโครงสร้างโดยอัตโนมัติ คุณสามารถขยายและยุบขอบเขตที่ซ่อนอยู่ใด ๆ หรือทั้งหมดของรหัสนี้เพื่อลดส่วนที่แก้ไขได้ของนิพจน์ เพื่อเน้นเฉพาะชิ้นส่วนของรหัสที่คุณต้องให้ความสนใจ คำสั่งสลับซ่อน/แสดง สามารถใช้สำหรับสิ่งนั้นได้

ตัวอย่างเช่น ซ่อนทุกภูมิภาค กระทำได้ดังต่อไปนี้

- กด **Ctrl+K**

  หรือ

- กด **F1** กด **FO** เลือก **ซ่อนทั้งหมด** แล้วจึงกด **ป้อน**

หากต้องการแสดงทุกภูมิภาค ให้ทำดังต่อไปนี้:

- กด **Ctrl+J**

  หรือ
  
- กด **F1** พิมพ์ **UN** เลือก **แสดงทั้งหมด** แล้วจึงกด **ป้อน**

[![ตัวแก้ไขสูตร ER](./media/ER-AdvEditor-ToggleFold.gif)](./media/ER-AdvEditor-ToggleFold.gif)

## <a name="FindAndReplace">ค้นหาและแทนที่</a>

หากต้องการค้นหาข้อความบางข้อความ ให้เลือกข้อความในนิพจน์ของคุณ แล้วทำดังต่อไปนี้:

- กด **Ctrl+F** แล้วจึงกด **F3** เพื่อค้นหาข้อความที่ปรากฎขึ้นให้เลือกต่อไป หรือกด **Shift+F3** เพื่อค้นหาการเกิดขึ้นก่อนหน้า

  หรือ
  
- กด **F1**พิมพ์ **F** จากนั้นเลือกตัวเลือกที่ต้องการเพื่อค้นหาข้อความที่เลือก

เพื่อแทนที่ข้อความที่เกิดขึ้นบางข้อความ ให้เลือกข้อความในนิพจน์ของคุณ แล้วทำดังต่อไปนี้:

- กด **Ctrl+H** ป้อนข้อความสำรองและเลือกตัวเลือกการแทนที่ เพื่อแทนที่ข้อความที่เลือกหรือข้อความทั้งหมดที่เกิดขึ้นในนิพจน์ปัจจุบัน

  หรือ
  
- กด **F1**พิมพ์ **R** จากนั้นเลือกตัวเลือกที่ต้องการเพื่อแทนที่ข้อความที่เลือก ป้อนข้อความสำรองและเลือกตัวเลือกการแทนที่ เพื่อแทนที่ข้อความที่เลือกหรือข้อความทั้งหมดที่เกิดขึ้นในนิพจน์ปัจจุบัน

เพื่อเปลี่ยนข้อความที่เกิดขึ้นบางข้อความ ให้เลือกข้อความในนิพจน์ของคุณ แล้วทำดังต่อไปนี้:

- กด **Ctrl+F2** จากนั้นป้อนข้อความแสดงแทน

  หรือ
  
- กด **F1**พิมพ์ **C** จากนั้นเลือกตัวเลือกที่ต้องการเพื่อเปลี่ยนข้อความที่เลือก ป้อนข้อความแสดงแทน

[![ตัวแก้ไขสูตร ER](./media/ER-AdvEditor-Find.gif)](./media/ER-AdvEditor-Find.gif)

## <a name="DataPasting">การวางแหล่งข้อมูลและฟังก์ชั่น</a>

คุณสามารถเลือก **เพิ่มแหล่งข้อมูล** ซึ่งวางไปที่นิพจน์ปัจจุบันซึ่งเป็นแหล่งข้อมูลที่เลือกไว้ในปัจจุบันบนแผงด้านซ้าย **แหล่งข้อมูล** ในทางเดียวกัน คุณสามารถเลือก **เพิ่มฟังก์ชัน** ซึ่งวางไปที่นิพจน์ปัจจุบันซึ่งเป็นฟังก์ชันที่เลือกไว้ในปัจจุบันบนแผงด้านขวา **ฟังก์ชัน** หากคุณใช้ตัวแก้ไขสูตร ER ฟังก์ชันที่เลือกหรือแหล่งข้อมูลที่เลือกจะถูกวางไว้ที่ส่วนท้ายของนิพจน์ที่กำหนดค่าไว้เสมอ เมื่อคุณใช้ตัวแก้ไขสูตร ER ขั้นสูง ฟังก์ชันที่เลือกหรือแหล่งข้อมูลที่เลือกจะสามารถวางไว้ที่ส่วนใดส่วนหนึ่งของนิพจน์ที่กำหนดค่าไว้ได้ คุณจะต้องใช้เคอร์เซอร์เพื่อระบุตำแหน่งที่คุณต้องการวางข้อมูล

[![ตัวแก้ไขสูตร ER](./media/ER-AdvEditor-PasteValue.gif)](./media/ER-AdvEditor-PasteValue.gif)

## <a name="SyntaxColorization">การทำสีที่ไวยากรณ์</a>

ขณะนี้มีการใช้สีที่แตกต่างกันเพื่อเน้นส่วนต่างๆของนิพจน์ต่อไปนี้:

- ข้อความในเครื่องหมายวงเล็บคู่ที่สามารถแสดงป้ายชื่อรหัสของค่าคงที่ข้อความ

[![ตัวแก้ไขสูตร ER](./media/ER-AdvEditor-SyntaxColorization.png)](./media/ER-AdvEditor-SyntaxColorization.png)

## <a name="additional-resources"></a>แหล่งข้อมูลเพิ่มเติม

- [ภาพรวมการรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md)
- [ตัวออกแบบสูตรในการรายงานทางอิเล็กทรอนิกส์](general-electronic-reporting-formula-designer.md)
- [ตัวแก้ไข Monaco](https://microsoft.github.io/monaco-editor)
