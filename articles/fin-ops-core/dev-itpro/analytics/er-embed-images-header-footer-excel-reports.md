---
title: ออกแบบรูปแบบ ER เพื่อสร้างรายงานในรูปแบบ Excel ด้วยรูปภาพแบบฝังในส่วนหัวหรือส่วนท้ายของหน้า
description: หัวข้อนี้อธิบายวิธีการใช้การรายงานทางอิเล็กทรอนิกส์ (ER) เพื่อสร้างเอกสารทางธุรกิจที่มีรูปภาพและรูปทรงแบบฝังในส่วนหัวหรือส่วนท้ายของหน้า
author: NickSelin
ms.date: 06/28/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: EROperationDesigner, ERParameters
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2021-06-01
ms.dyn365.ops.version: 10.0.21
ms.openlocfilehash: 1115be8c33eeaf16c1a533e63b31d87b0fc5f68d6469ff075428f72ac146b2f4
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 08/05/2021
ms.locfileid: "6746646"
---
# <a name="design-an-er-format-to-generate-a-report-in-excel-format-with-embedded-images-in-page-headers-or-footers"></a>ออกแบบรูปแบบ ER เพื่อสร้างรายงานในรูปแบบ Excel ด้วยรูปภาพแบบฝังในส่วนหัวหรือส่วนท้ายของหน้า

[!include[banner](../includes/banner.md)]

หัวข้อนี้จะอธิบายวิธีการที่ผู้ใช้ในบทบาทของผู้ดูแลระบบหรือที่ปรึกษาด้านการรายงานทางอิเล็กทรอนิกส์สามารถดำเนินงานเหล่านี้ได้:

- ตั้งค่าคอนฟิกพารามิเตอร์สำหรับกรอบงาน [การรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md)
- นําเข้า ER [การตั้งค่าคอนฟิก](general-electronic-reporting.md#Configuration) ที่ [มีให้](general-electronic-reporting.md#Provider) โดย Microsoft และใช้ในการสร้าง [ใบแจ้งหนี้ข้อความอิสระ](../../../finance/accounts-receivable/create-free-text-invoice-new.md) ตาม [เท็มเพลต](er-fillable-excel.md#excel-file-component) ในรูปแบบ Microsoft Excel
- สร้างเวอร์ชัน [ที่กำหนดเอง (ที่ได้รับ)](general-electronic-reporting.md#building-a-format-selecting-another-format-as-a-base-customization) ของการตั้งค่าคอนฟิกรูปแบบ ER มาตรฐานที่มีให้โดย Microsoft
- ปรับเปลี่ยนการตั้งค่าคอนฟิกรูปแบบ ER ที่กําหนดเอง เพื่อให้สร้างรายงานใบแจ้งหนี้ข้อความอิสระที่มีรูปภาพโลโกบริษัทในส่วนท้าย

สามารถดำเนินงานกระบวนงานในหัวข้อนี้ให้เสร็จสมบูรณ์ได้ในบริษัท **USMF** ไม่จำเป็นต้องมีการเขียนโค้ด ก่อนที่คุณจะเริ่มต้น ต้องดาวน์โหลดและบันทึกไฟล์ต่อไปนี้

| คำอธิบาย        | ชื่อไฟล์ |
|--------------------|-----------|
| รูปโลโก้บริษัท | [Company logo.png](https://download.microsoft.com/download/8/2/e/82e6bd81-caac-4e9a-bfce-1392ce7c8616/Companylogo.png) |

## <a name="content"></a>ปริมาณความจุ

- [ตั้งค่าคอนฟิกนิติบุคคล](#ConfigureLegalEntity)
- [ตั้งค่าคอนฟิกกรอบงาน ER](#ConfigureFramework)

    - [ตั้งค่าคอนฟิกพารามิเตอร์ ER](#ConfigureParameters)
    - [เปิดใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER](#ActivateProvider)

        - [ตรวจทานรายการของผู้ให้บริการการตั้งค่าคอนฟิก ER](#ReviewProvidersList)
        - [เพิ่มผู้ให้บริการการตั้งค่าคอนฟิก ER ใหม่](#AddProvider)
        - [เปิดใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER ใหม่](#ActivateAddedProvider)

- [นำเข้าไฟล์การตั้งค่าคอนฟิกรูปแบบ ER มาตรฐาน](#ImportERSolution1)

    - [นำเข้าไฟล์การตั้งค่าคอนฟิก ER มาตรฐาน](#ImportERFormat)
    - [ตรวจทานและนำเข้าการตั้งค่าคอนฟิก ER](#ReviewImportedERSolution)

- [พิมพ์ใบแจ้งหนี้ข้อความอิสระโดยใช้รูปแบบ ER มาตรฐาน](#PrintInvoice1)

    - [ตั้งค่าการจัดการงานพิมพ์](#ConfigurePrintManagement1)
    - [พิมพ์ใบแจ้งหนี้ข้อความอิสระ](#ProcessInvoice1)

- [การเลือกกำหนดรูปแบบ ER มาตรฐาน](#CustomizeProvidedFormat)

    - [สร้างรูปแบบที่กำหนดเอง](#DeriveProvidedFormat)
    - [แก้ไขรูปแบบแบบกำหนดเอง](#ConfigureDerivedFormat)
    - [ทำเครื่องหมายรูปแบบที่กำหนดเองเป็นที่สามารถรันได้](#MarkFormatRunnable)

- [พิมพ์ใบแจ้งหนี้ข้อความอิสระโดยใช้รูปแบบ ER ที่กำหนดเอง](#PrintInvoice2)

    - [ตั้งค่าการจัดการงานพิมพ์](#ConfigurePrintManagement2)
    - [พิมพ์ใบแจ้งหนี้ข้อความอิสระ](#ProcessInvoice2)

- [ทรัพยากรเพิ่มเติม](#References)

## <a name="configure-the-legal-entity"></a><a id="ConfigureLegalEntity"></a>ตั้งค่าคอนฟิกนิติบุคคล

1. ไปที่ **การจัดการองค์กร** \> **องค์กร** \> **นิติบุคคล**
2. บนหน้า **นิติบุคคล** บนแท็บด่วน **รูปโลโกของบริษัทรายงาน** ให้เลือก **เปลี่ยน**
3. ในกล่องโต้ตอบ **เลือกไฟล์รูปภาพที่จะอัพโหลด** เลือก **ดู** และเลือกไฟล์ **logo.png ของบริษัท** ที่คุณดาวน์โหลดก่อนหน้านี้
4. เลือก **บันทึก** แล้วจากนั้น ปิดหน้า **นิติบุคคล**

![รูปภาพโลโกบริษัทที่เลือกบนหน้านิติบุคคล](./media/er-embed-images-header-footer-excel-reports-company-logo-image.png)

## <a name="configure-the-er-framework"></a><a id="ConfigureFramework"></a>ตั้งค่าคอนฟิกกรอบงาน ER

ในฐานะผู้ใช้ในบทบาทที่ปรึกษาการทำงานของการรายงานทางอิเล็กทรอนิกส์ คุณต้องตั้งค่าคอนฟิกชุดพารามิเตอร์ ER ที่ น้อยที่สุดก่อนที่คุณจะสามารถเริ่มต้นการใช้กรอบงาน ER เพื่อออกแบบรุ่นที่กำหนดเองของรูปแบบ ER มาตรฐาน

### <a name="configure-er-parameters"></a><a id="ConfigureParameters"></a>ตั้งค่าคอนฟิกพารามิเตอร์ ER

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. บนหน้า **การตั้งค่าคอนฟิกเฉพาะ** ในส่วน **ลิงก์ที่เกี่ยวข้อง** ให้เลือก **พารามิเตอร์การรายงานทางอิเล็กทรอนิกส์**
3. ในหน้า **พารามิเตอร์การรายงานทางอิเล็กทรอนิกส์** บนแท็บ **ทั่วไป** ตั้งค่าตัวเลือก **เปิดใช้งานโหมดการออกแบบ** เป็น **ใช่**
4. บนแท็บ **เอกสารแนบ** ให้ตั้งค่าพารามิเตอร์ต่อไปนี้:

    - ในฟิลด์ **การตั้งค่าคอนฟิก** ให้เลือกชนิด **ไฟล์** สำหรับบริษัท **USMF**
    - ในฟิลด์ **ที่เก็บงานถาวร** **ชั่วคราว** **พื้นฐาน** และ **อื่นๆ** ให้เลือกชนิด **ไฟล์**

สำหรับข้อมูลเพิ่มเติมเกี่ยวกับพารามิเตอร์ ER ให้ดูที่ [ตั้งค่าคอนฟิกกรอบงาน ER](electronic-reporting-er-configure-parameters.md)

### <a name="activate-an-er-configuration-provider"></a><a id="ActivateProvider"></a>เปิดใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER

มีการทำเครื่องหมายการตั้งค่าคอนฟิก ER ทั้งหมดที่มีการเพิ่มเป็นเจ้าของโดยผู้ให้บริการการตั้งค่าคอนฟิก ER ผู้ให้บริการการตั้งค่าคอนฟิก ER ที่เปิดใช้งานในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** จะใช้เพื่อวัตถุประสงค์นี้ ดังนั้นคุณต้องเรียกใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER ในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** ก่อนที่คุณจะเริ่มต้นการเพิ่มหรือแก้ไขการตั้งค่าคอนฟิก ER

> [!NOTE]
> การตั้งค่าคอนฟิก ER สามารถแก้ไขได้ได้โดยเจ้าของการตั้งค่าคอนฟิกเท่านั้น ก่อนที่จะแก้ไขการตั้งค่าคอนฟิก ER ต้องมีการเรียกใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER ในพื้นที่ทำงาน **การรายงานทางอิเล็กทรอนิกส์** ที่เหมาะสม

#### <a name="review-the-list-of-er-configuration-providers"></a><a id="ReviewProvidersList"></a>ตรวจทานรายการของผู้ให้บริการการตั้งค่าคอนฟิก ER

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. บนหน้า **การตั้งค่าคอนฟิกเฉพาะ** ในส่วน **ลิงก์ที่เกี่ยวข้อง** ให้เลือก **ผู้ให้บริการการตั้งค่าคอนฟิก**
3. บนหน้า **ตารางของผู้ให้บริการการตั้งค่าคอนฟิก** แต่ละเรกคอร์ดผู้ให้บริการจะมีชื่อและ URL ที่ไม่ซ้ำกัน ตรวจทานเนื้อหาของหน้านี้ ถ้ามีเรกคอร์ดสำหรับ **Litware, inc.** (`https://www.litware.com`) อยู่แล้ว ให้ข้ามขั้นตอนถัดไป [เพิ่มผู้ให้บริการการตั้งค่าคอนฟิก ER ใหม่](#AddProvider)

#### <a name="add-a-new-er-configuration-provider"></a><a id="AddProvider"></a>เพิ่มผู้ให้บริการการตั้งค่าคอนฟิก ER ใหม่

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. บนหน้า **การตั้งค่าคอนฟิกเฉพาะ** ในส่วน **ลิงก์ที่เกี่ยวข้อง** ให้เลือก **ผู้ให้บริการการตั้งค่าคอนฟิก**
3. ในหน้า **ผู้ให้บริการการตั้งค่าคอนฟิก** เลือก **ใหม่**
4. ในฟิลด์ **ชื่อ** ให้ป้อน **Litware, Inc.**
5. ในฟิลด์ **ที่อยู่อินเทอร์เน็ต** ให้ป้อน `https://www.litware.com`
6. เลือก **บันทึก**

#### <a name="activate-the-new-er-configuration-provider"></a><a id="ActivateAddedProvider"></a>เปิดใช้งานผู้ให้บริการการตั้งค่าคอนฟิก ER ใหม่

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. ในหน้า **การตั้งค่าคอนฟิกเฉพาะ** ในส่วน **ผู้ให้บริการการตั้งค่าคอนฟิก** ให้เลือกไทล์ **Litware, inc.** แล้วเลือก **กำหนดเป็นใช้งานอยู่**

สำหรับข้อมูลเพิ่มเติมเกี่ยวกับผู้ให้บริการการตั้งค่าคอนฟิก ER ให้ดูที่ [สร้างผู้ให้บริการการตั้งค่าคอนฟิก และทำเครื่องหมายเป็นใช้งานอยู่](tasks/er-configuration-provider-mark-it-active-2016-11.md)

## <a name="import-the-standard-er-format-configurations"></a><a id="ImportERSolution1"></a>นำเข้าไฟล์การตั้งค่าคอนฟิกรูปแบบ ER มาตรฐาน

### <a name="import-the-standard-er-configurations"></a><a id="ImportERFormat"></a>นำเข้าการตั้งค่าคอนฟิก ER มาตรฐาน

เมื่อต้องการเพิ่มการตั้งค่าคอนฟิก ER มาตรฐานให้กับอินสแตนซ์ปัจจุบันของ Dynamics 365 Finance คุณต้องนำเข้าจาก [ที่เก็บ](general-electronic-reporting.md#Repository) ER ที่ได้รับการตั้งค่าคอนฟิกสำหรับอินสแตนซ์นั้น

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. ในหน้า **การตั้งค่าคอนฟิกเฉพาะ** ในส่วน **ผู้ให้บริการการตั้งค่าคอนฟิก** ให้เลือกไทล์ **Microsoft** แล้วเลือก **ที่เก็บ** เพื่อดูรายการของที่เก็บสำหรับผู้ให้บริการ **Microsoft**
3. บนหน้า **ที่เก็บการตั้งค่าคอนฟิก** เลือกที่เก็บของชนิด **ส่วนกลาง** และจากนั้นเลือก **เปิด** ถ้าคุณได้รับพร้อมต์ให้ตรวจสอบเพื่อเชื่อมต่อกับ [Regulatory Configuration Service](../../../finance/localizations/rcs-overview.md) ให้ทำตามคำแนะนำการตรวจสอบ
4. บนหน้า **ที่เก็บการตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิกในบานหน้าต่างด้านซ้าย ให้เลือกการตั้งค่าคอนฟิกรูปแบบ **ใบแจ้งหนี้ข้อความอิสระ (Excel)**
5. บนแท็บด่วน **รุ่น** เลือกรุ่นล่าสุด (ตัวอย่างเช่น **240.112**) ของการตั้งค่าคอนฟิก ER ที่เลือก
6. เลือก **นำเข้า** เพื่อดาวน์โหลดเวอร์ชันที่เลือกจากที่เก็บส่วนกลางไปยังอินสแตนซ์การเงินปัจจุบัน

![การนําเข้าการตั้งค่าคอนฟิก ER มาตรฐาน บนหน้าที่เก็บการตั้งค่าคอนฟิก](./media/er-embed-images-header-footer-excel-reports-import-solution.png)

> [!TIP]
> ถ้าคุณมีปัญหาในการเข้าถึง [ที่เก็บส่วนกลาง](er-download-configurations-global-repo.md) คุณสามารถ [ดาวน์โหลดการตั้งค่าคอนฟิก](download-electronic-reporting-configuration-lcs.md) จาก Microsoft Dynamics Lifecycle Services (LCS) แทน

### <a name="review-the-imported-er-configurations"></a><a id="ReviewImportedERSolution"></a>ตรวจทานและนำเข้าการตั้งค่าคอนฟิก ER

1. ไปที่ **การจัดการองค์กร** \> **พื้นที่ทำงาน** \> **การรายงานทางอิเล็กทรอนิกส์**
2. บนหน้า **การตั้งค่าคอนฟิกการแปลเป็นภาษาท้องถิ่น** ในส่วน **การตั้งค่าคอนฟิก** เลือกไทล์ **การตั้งค่าคอนฟิกการรายงาน**
3. บนหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิกในบานหน้าต่างด้านซ้าย ให้ขยาย **แบบจำลองใบแจ้งหนี้**
4. นอกเหนือจากรูปแบบ ER ของ **ใบแจ้งหนี้ข้อความอิสระ (Excel)** ที่เลือก มีการนำเข้าการตั้งค่าคอนฟิก ER ที่จำเป็นอื่นๆ ด้วย ตรวจสอบให้แน่ใจว่าการตั้งค่าคอนฟิก ER ต่อไปนี้จะพร้อมใช้งานในแผนภูมิการตั้งค่าคอนฟิก:

    - **แบบจำลองใบแจ้งหนี้** - การตั้งค่าคอนฟิกนี้มีส่วนประกอบ ER ของ [แบบจำลองข้อมูล](general-electronic-reporting.md#data-model-and-model-mapping-components) ซึ่งแสดงถึงโครงสร้างข้อมูลของโดเมนธุรกิจของการออกใบแจ้งหนี้
    - **การแม็ปแบบจำลองใบแจ้งหนี้** – การตั้งค่าคอนฟิกนี้มีส่วนประกอบ ER [การแม็ปแบบจำลอง](general-electronic-reporting.md#data-model-and-model-mapping-components) ที่อธิบายวิธีการกรอกข้อมูลแบบจำลองข้อมูลด้วยข้อมูลของแอปพลิเคชันที่รันไทม์
    - **ใบแจ้งหนี้ข้อความอิสระ (Excel)** – การตั้งค่าคอนฟิกนี้มีส่วนประกอบของ [รูปแบบ](general-electronic-reporting.md#FormatComponentOutbound) และการแม็ปรูปแบบ ER ส่วนประกอบรูปแบบจะระบุโครงร่างรายงาน โดยยึดตามเท็มเพลตในรูปแบบ Excel ส่วนประกอบการแม็ปรูปแบบมีแหล่งข้อมูลแบบจำลองและระบุวิธีการใช้เแหล่งข้อมูลนี้เพื่อกรอกข้อมูลในโครงร่างรายงานในขณะรันไทม์

![การตั้งค่าคอนฟิก ER ที่นำเข้าในหน้าการตั้งค่าคอนฟิก](./media/er-embed-images-header-footer-excel-reports-imported-solution.png)

## <a name="print-a-free-text-invoice-by-using-the-standard-er-format"></a><a id="PrintInvoice1"></a>พิมพ์ใบแจ้งหนี้ข้อความอิสระโดยใช้รูปแบบ ER มาตรฐาน

### <a name="set-up-print-management"></a><a id="ConfigurePrintManagement1"></a>ตั้งค่าการจัดการงานพิมพ์

1. ไปที่ **บัญชีลูกหนี้** \> **ใบแจ้งหนี้** \> **ใบแจ้งหนี้ข้อความอิสระทั้งหมด**
2. บนหน้า **ใบแจ้งหนี้ข้อความอิสระ** ให้เลือกใบแจ้งหนี้ **FTI-00000002** จากนั้น บนบานหน้าต่างการดำเนินการ บนแท็บ **ใบแจ้งหนี้** ในกลุ่ม **การจัดการการพิมพ์** ให้เลือก **การจัดการการพิมพ์**
3. บนหน้า **การตั้งค่าการจัดการการพิมพ์** ในแผนภูมิด้านซ้าย ให้ขยาย **โมดูล - บัญชีลูกหนี้ \> เอกสาร \> ใบแจ้งหนี้ข้อความอิสระ** แล้วเลือก รายการ **ต้นฉบับ \<Default\>**
4. ในฟิลด์ **รูปแบบรายงาน** ให้เลือก **ใบแจ้งหนี้ข้อความอิสระ (Excel)**
5. เลือกคีย์ **Esc** เพื่อออกจากหน้า **การตั้งค่าการจัดการการพิมพ์** และกลับไปที่หน้า **ใบแจ้งหนี้ข้อความอิสระ**

![การตั้งค่าการจัดการงานพิมพ์ของใบแจ้งหนี้ข้อความอิสระในรูปแบบ ER มาตรฐาน ในหน้าการตั้งค่าการจัดการพิมพ์](./media/er-embed-images-header-footer-excel-reports-print-management.png)

### <a name="print-a-free-text-invoice"></a><a id="ProcessInvoice1"></a>พิมพ์ใบแจ้งหนี้ข้อความอิสระ

1. บนหน้า **ใบแจ้งหนี้ข้อความอิสระ** ตรวจสอบให้แน่ใจว่าได้เลือกใบแจ้งหนี้ **FTI-00000002** จากนั้น บนบานหน้าต่างการดำเนินการ บนแท็บ **ใบแจ้งหนี้** ในกลุ่ม **เอกสาร** ให้เลือก **พิมพ์** \> **ที่เลือกไว้**
2. ดาวน์โหลดใบแจ้งหนี้ที่สร้างขึ้นในรูปแบบ Excel และเปิดเพื่อดูตัวอย่าง
3. โปรดสังเกตว่า ในรูปโครงสร้างของเท็มเพลต Excel ที่สอดคล้องกับรูปแบบ ER ที่ระบุ ส่วนท้ายของหน้าของใบแจ้งหนี้ที่สร้างขึ้นจะมีข้อมูลเกี่ยวกับหมายเลขหน้าปัจจุบันและจํานวนหน้าทั้งหมดในรายงาน

![ใบแจ้งหนี้ข้อความอิสระที่สร้าง](./media/er-embed-images-header-footer-excel-reports-print-invoice1.gif)

## <a name="customize-the-standard-er-format"></a><a id="CustomizeProvidedFormat"></a>การเลือกกำหนดรูปแบบ ER มาตรฐาน

คุณสามารถใช้การตั้งค่าคอนฟิก ER ที่ให้โดย Microsoft เพื่อสร้างใบแจ้งหนี้ข้อความอิสระในรูปแบบ Excel ได้ อย่างไรก็ตาม คุณต้องเพิ่มการป้อนเองเพื่อวางรูปภาพโลโกบริษัทในส่วนท้ายของหน้าของใบแจ้งหนี้ที่สร้าง

ในกรณีนี้ ในฐานะตัวแทนของ Litware, Inc. คุณต้องสร้าง (ที่ได้รับมา) การตั้งค่าคอนฟิกรูปแบบ ER ใหม่ ที่เป็นไปตามการตั้งค่าคอนฟิก **ใบแจ้งหนี้ข้อความอิสระ (Excel)** ที่ Microsoft- มีให้

### <a name="create-a-custom-format"></a><a id="DeriveProvidedFormat"></a>สร้างรูปแบบที่กำหนดเอง

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. บนหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิกในบานหน้าต่างด้านซ้าย ให้ขยาย **แบบจำลองใบแจ้งหนี้** และจากนั้น เลือก **ใบแจ้งหนี้ข้อความอิสระ (Excel)** Litware, Inc. จะใช้รุ่นที่นำเข้า (ตัวอย่างเช่น **240.112**) ของการตั้งค่าคอนฟิกรูปแบบ ER นี้เป็นพื้นฐานสำหรับรุ่นที่กำหนดเอง
3. เลือก **สร้างการตั้งค่าคอนฟิก** เพื่อเปิดกล่องโต้ตอบแบบหล่นลง ใช้กล่องโต้ตอบนี้ในการสร้างการตั้งค่าคอนฟิกใหม่สำหรับรูปแบบการชำระเงินที่กำหนดเอง
4. ในกลุ่มฟิลด์ **สร้าง** ให้เลือกตัวเลือก **ได้รับมาจากชื่อ: ใบแจ้งหนี้ข้อความอิสระ (Excel), Microsoft**
5. ในฟิลด์ **ชื่อ** ให้ป้อน **ใบแจ้งหนี้ข้อความอิสระ (Excel) แบบกำหนดเอง**
6. เลือก **สร้างการตั้งค่าคอนฟิก**

![การสร้างการตั้งค่าคอนฟิกให้กับรูปแบบการการจ่ายภาษีศุลกากรในกล่องโต้ตอบแบบหล่นลงของการสร้างการตั้งค่าคอนฟิก](./media/er-embed-images-header-footer-excel-reports-add-derived-format.png)

มีการสร้างเวอร์ชัน 240.112.1 ของการตั้งค่าคอนฟิกรูปแบบ ER ที่กําหนดเองของ **ใบแจ้งหนี้ข้อความอิสระ (Excel)** รุ่นนี้มี [สถานะ](general-electronic-reporting.md#component-versioning) ของ **แบบร่าง** และสามารถแก้ไขได้ เนื้อหาปัจจุบันของรูปแบบ ER แบบกำหนดเองของคุณตรงกับเนื้อหาของรูปแบบที่ Microsoft ให้ไว้

![รุ่นใหม่ของการตั้งค่าคอนฟิกรูปแบบ ER ที่สร้างขึ้นบนหน้าการตั้งค่าคอนฟิก](./media/er-embed-images-header-footer-excel-reports-derived-format-configuration1.png)

### <a name="edit-the-custom-format"></a><a id="ConfigureDerivedFormat"></a>แก้ไขรูปแบบแบบกำหนดเอง

ตั้งค่าคอนฟิกรูปแบบที่กําหนดเองของคุณ เพื่อให้รูปภาพโลโกของบริษัทอยู่ในส่วนท้ายในหน้าทุกหน้าของรายงาน

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. บนหน้า **การตั้งค่าคอนฟิก** ในแผนภูมิการตั้งค่าคอนฟิกในบานหน้าต่างด้านซ้าย ให้ขยาย **แบบจำลองการชำระเงิน** และจากนั้น เลือก **ใบแจ้งหนี้ข้อความอิสระ (Excel) แบบกำหนดเอง**
3. บนแท็บด่วน **รุ่น** เลือกรุ่น **240.112.1** ของการตั้งค่าคอนฟิกที่เลือก
4. เลือก **ตัวออกแบบ**
5. บนหน้า **ตัวออกแบบรูปแบบ** ให้เลือก **แสดงรายละเอียด** เพื่อดูข้อมูลเพิ่มเติมเกี่ยวกับองค์ประกอบรูปแบบ
6. ขยายและตรวจทานองค์ประกอบต่อไปนี้:

    - องค์ประกอบ **ใบแจ้งหนี้ข้อความอิสระ** ของชนิด **Excel** องค์ประกอบนี้ใช้ในการสร้างใบแจ้งหนี้ในรูปแบบสมุดงาน Excel
    - องค์ประกอบ **ใบแจ้งหนี้ข้อความอิสระ \\ ใบแจ้งหนี้** ของชนิด **แผ่นงาน** องค์ประกอบนี้ใช้เพื่อสร้างเวิร์กชีตของสมุดงาน Excel ที่สร้างขึ้น
    - องค์ประกอบ **ใบแจ้งหนี้ข้อความอิสระ \\ ใบแจ้งหนี้ \\ ส่วนท้าย** ของชนิด **ส่วนท้าย** องค์ประกอบนี้ใช้ในการเติมส่วนท้ายของใบแจ้งหนี้

7. เลือกองค์ประกอบ **ใบแจ้งหนี้ข้อความอิสระ \\ ใบแจ้งหนี้ \\ ส่วนท้าย**

    ![องค์ประกอบส่วนท้ายในโปรแกรมออกแบบการดำเนินงาน ER](./media/er-embed-images-header-footer-excel-reports-derived-format0.png)

    > [!NOTE]
    > ส่วนท้ายทุกหน้าของใบแจ้งหนี้ที่สร้างขึ้นจะมีข้อมูลเกี่ยวกับหมายเลขหน้าปัจจุบันและจํานวนหน้าทั้งหมดในรายงาน เมื่อเห็น องค์ประกอบ **ใบแจ้งหนี้ข้อความอิสระ \\ ใบเจ้งหนี้ \\ ส่วนท้าย** จะไม่มีองค์ประกอบรอง ดังนั้น เท็มเพลต Excel ที่ใช้อยู่จึงถูกตั้งค่าคอนฟิกให้แสดงรายละเอียดการแบ่งหน้าในกึ่งกลางส่วนท้ายของรายงานทุกฉบับ

8. เลือก **เพิ่ม** แล้วเลือกชนิดของ **Excel \\ รูปภาพ** ขององค์ประกอบรูปแบบที่คุณกำลังเพิ่ม:

    1. ในฟิลด์ **การจัดแนว** เลือก **ขวา**
    2. ในฟิลด์ **ปรับสเกลความสูง** ให้เลือก **สัมพัทธ์**
    3. ในฟิลด์ **ปรับสเกลเป็นเปอร์เซ็นต์** ให้ป้อน **70**
    4. เลือก **ตกลง**

        > [!NOTE]
        > องค์ประกอบ **Excel \\ รูปภาพ** จะใช้เพื่อเพิ่มรูปภาพโลโกของบริษัท และปรับแนวด้านขวาของส่วนท้ายของหน้า

    ![คุณสมบัติขององค์ประกอบรูปภาพในกล่องโต้ตอบคุณสมบัติส่วนประกอบ](./media/er-embed-images-header-footer-excel-reports-derived-format1.png)

9. ในแผนภูมิโครงสร้างรูปแบบทางด้านซ้าย ให้เลือกองค์ประกอบ **รูปภาพ** ที่คุณเพิ่งเพิ่ม และบนแท็บ **การแม็ป** ให้ขยายแหล่งข้อมูล **แบบจำลอง**
10. ขยาย **model.Payment** \> **model.InvoiceBase \> model.InvoiceBase.CompanyInfo** แล้วเลือกฟิลด์แหล่งข้อมูล **model.InvoiceBase.CompanyInfo.Logo** ฟิลด์แหล่งข้อมูลของชนิด [คอนเทนเนอร์](er-formula-supported-data-types-composite.md#container) จะแสดงรูปภาพโลโกของบริษัทเป็นเนื้อหาของสื่อ
11. เลือก **ผูก** ขณะนี้ องค์ประกอบรูปแบบ **รูปภาพ** ผูกอยู่กับฟิลด์แหล่งข้อมูล **model.InvoiceBase.CompanyInfo.Logo** ดังนั้น เมื่อรันไทม์ จะมีรูปภาพโลโกบริษัทอยู่ในส่วนท้ายของใบแจ้งหนี้ที่สร้าง

    ![องค์ประกอบรูปแบบรูปภาพผูกอยู่กับฟิลด์แหล่งข้อมูล model.InvoiceBase.CompanyInfo.Logo ในโปรแกรมออกแบบการดำเนินงาน ER](./media/er-embed-images-header-footer-excel-reports-derived-format2.png)

12. เลือก **บันทึก** แล้วปิดหน้า **โปรแกรมออกแบบ**

### <a name="mark-the-custom-format-as-runnable"></a><a id="MarkFormatRunnable"></a>ทำเครื่องหมายรูปแบบที่กำหนดเองเป็นที่สามารถรันได้

เนื่องจากมีการสร้างรูปแบบที่กำหนดเองของคุณรุ่นแรกแล้ว และมีสถานะเป็น **แบบร่าง** คุณสามารถรันรูปแบบนี้เพื่อวัตถุประสงค์ในการทดสอบได้ เมื่อต้องการรันรายงาน ประมวลผลการชำระเงินให้แก่ผู้จัดจำหน่ายโดยใช้วิธีการชำระเงินที่อ้างอิงถึงรูปแบบ ER แบบกำหนดเองของคุณ โดยค่าเริ่มต้น เมื่อคุณเรียกใช้รูปแบบ ER จากแอปพลิเคชัน จะมีเฉพาะรุ่นที่มีสถานะเป็น **เสร็จสมบูรณ์** หรือ **ใช้ร่วมกัน** เท่านั้นที่ [ได้รับการพิจารณา](general-electronic-reporting.md#component-versioning) ลักษณะการทำงานนี้ช่วยป้องกันไม่ให้มีการใช้รูปแบบ ER ที่มีการออกแบบที่ยังไม่เสร็จสิ้น อย่างไรก็ตามสำหรับการรันการทดสอบของคุณ คุณสามารถบังคับให้แอปพลิเคชันใช้เวอร์ชันของรูปแบบ ER ของคุณที่มีสถานะเป็น **แบบร่าง** ด้วยวิธีนี้คุณสามารถปรับรุ่นของรูปแบบปัจจุบันถ้าจำเป็นต้องมีการปรับเปลี่ยนใดๆ สำหรับข้อมูลเพิ่มเติม ให้ดูที่ [การใช้งาน](electronic-reporting-destinations.md#applicability)

หากต้องการใช้รุ่นแบบร่างของรูปแบบ ER คุณต้องทำเครื่องหมายรูปแบบ ER ให้ชัดเจน

1. ไปที่ **การจัดการองค์กร** \> **การรายงานทางอิเล็กทรอนิกส์** \> **การตั้งค่าคอนฟิก**
2. ในหน้า **การตั้งค่าคอนฟิก** บนบานหน้าต่างการดำเนินการ บนแท็บ **การตั้งค่าคอนฟิก** ในกลุ่ม **การตั้งค่าล่วงหน้า** เลือก **พารามิเตอร์ผู้ใช้**
3. ในกล่องโต้ตอบ **พารามิเตอร์ผู้ใช้** ให้ตั้งค่าตัวเลือก **เรียกใช้การตั้งค่า** เป็น **ใช่** และจากนั้น เลือก **ตกลง**
4. เลือก **แก้ไข** เพื่อทำให้หน้าปัจจะบันสามารถแก้ไขได้ จากนั้น บนหน้าการตั้งค่าคอนฟิกในแผนภูมิการตั้งค่าคอนฟิกในบานหน้าต่างด้านซ้าย ให้เลือก **ใบแจ้งหนี้ข้อความอิสระ (Excel) แบบกำหนดเอง**
5. ตั้งค่าตัวเลือก **เรียกใช้แบบร่าง** เป็น **ใช่**

![การกําหนดรูปแบบที่กําหนดเองเป็นสามารถรันได้ บนหน้าการตั้งค่าคอนฟิก](./media/er-embed-images-header-footer-excel-reports-derived-format-configuration2.png)

## <a name="print-a-free-text-invoice-by-using-the-custom-er-format"></a><a id="PrintInvoice2"></a>พิมพ์ใบแจ้งหนี้ข้อความอิสระโดยใช้รูปแบบ ER ที่กำหนดเอง

### <a name="set-up-print-management"></a><a id="ConfigurePrintManagement2"></a>ตั้งค่าการจัดการงานพิมพ์

1. ไปที่ **บัญชีลูกหนี้** \> **ใบแจ้งหนี้** \> **ใบแจ้งหนี้ข้อความอิสระทั้งหมด**
2. บนหน้า **ใบแจ้งหนี้ข้อความอิสระ** ให้เลือกใบแจ้งหนี้ **FTI-00000002** จากนั้น บนบานหน้าต่างการดำเนินการ บนแท็บ **ใบแจ้งหนี้** ในกลุ่ม **การจัดการการพิมพ์** ให้เลือก **การจัดการการพิมพ์**
3. บนหน้า **การตั้งค่าการจัดการการพิมพ์** ในแผนภูมิด้านซ้าย ให้ขยาย **โมดูล - บัญชีลูกหนี้** \> **เอกสาร** \> **ใบแจ้งหนี้ข้อความอิสระ**  แล้วเลือก รายการ **ต้นฉบับ** **\<Default\>**
4. ในฟิลด์ **รูปแบบรายงาน** ให้เลือก **ใบแจ้งหนี้ข้อความอิสระ (Excel) แบบกำหนดเอง**
5. เลือก **Esc** เพื่อออกจากหน้า **การตั้งค่าการจัดการการพิมพ์** และกลับไปที่หน้า **ใบแจ้งหนี้ข้อความอิสระ**

### <a name="print-a-free-text-invoice"></a><a id="ProcessInvoice2"></a>พิมพ์ใบแจ้งหนี้ข้อความอิสระ

1. บนหน้า **ใบแจ้งหนี้ข้อความอิสระ** ตรวจสอบให้แน่ใจว่าได้เลือกใบแจ้งหนี้ **FTI-00000002** จากนั้น บนบานหน้าต่างการดำเนินการ บนแท็บ **ใบแจ้งหนี้** ในกลุ่ม **เอกสาร** ให้เลือก **พิมพ์** \> **ที่เลือกไว้**
2. ดาวน์โหลดใบแจ้งหนี้ที่สร้างขึ้นในรูปแบบ Excel และเปิดเพื่อดูตัวอย่าง
3. โปรดสังเกตว่า ตามโครงสร้างของรูปแบบ ER ที่กําหนดเอง ส่วนท้ายของหน้าของใบแจ้งหนี้ที่สร้างขึ้นจะมีรูปภาพโลโกของบริษัท นอกเหนือจากข้อมูลเกี่ยวกับการแบ่งหน้าของรายงาน

![ใบแจ้งหนี้ข้อความอิสระที่สร้างขึ้นที่มีรูปภาพโลโกบริษัทในส่วนท้ายของหน้า](./media/er-embed-images-header-footer-excel-reports-print-invoice2.gif)

## <a name="additional-resources"></a><a id="References"></a>ทรัพยากรเพิ่มเติม

- [ออกแบบการตั้งค่าคอนฟิกสำหรับการสร้างเอกสารในรูปแบบ Excel](er-fillable-excel.md)
- [ฝังข้อมูลและรูปร่างในเอกสารที่คุณสร้างโดยใช้ ER](electronic-reporting-embed-images-shapes.md)
