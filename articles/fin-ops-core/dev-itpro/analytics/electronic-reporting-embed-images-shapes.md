---
title: ฝังข้อมูลและรูปร่างในเอกสารที่คุณสร้างโดยใช้ ER
description: หัวข้อนี้อธิบายวิธีการใช้เครื่องมือการรายงานทางอิเล็กทรอนิกส์ เพื่อสร้างเอกสารธุรกิจที่มีรูปภาพและรูปทรงแบบฝังอยู่
author: NickSelin
ms.date: 04/23/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: EROperationDesigner, ERParameters
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 27621
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: July 2017 update
ms.openlocfilehash: bfa8137de7b782ba80a0d80c987a96c37b3a7d86
ms.sourcegitcommit: c08a9d19eed1df03f32442ddb65a2adf1473d3b6
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 07/06/2021
ms.locfileid: "6361428"
---
# <a name="embed-images-and-shapes-in-documents-that-you-generate-by-using-er"></a>ฝังข้อมูลและรูปร่างในเอกสารที่คุณสร้างโดยใช้ ER

[!include [banner](../includes/banner.md)]

คุณสามารถใช้เครื่องมือการรายงานทางอิเล็กทรอนิกส์ (ER) เพื่อออกแบบรายงานที่คุณสามารถรันเพื่อสร้างเอกสารอิเล็กทรอนิกส์ที่ต้องใช้ คุณสามารถใช้เอกสาร Microsoft Excel หรือ Microsoft Word เพื่อระบุโครงร่างของรายงานได้ ตัวออกแบบการดำเนินงาน ER ช่วยให้คุณสามารถแนบเอกสาร Excel หรือ Word เป็นเท็มเพลตสำหรับรายงาน องค์ประกอบที่มีชื่อในเท็มเพลตที่แนบจะเชื่อมโยงกับองค์ประกอบรูปแบบของรายงาน ER องค์ประกอบรูแปบบของรายงาน ถูกเชื่อมโยงไปยังแหล่งข้อมูล องค์ประกอบเหล่านี้จะระบุข้อมูลที่จะถูกป้อนลงในเอกสารที่สร้างขึ้นในขณะทำงาน

ฟังก์ชันใหม่นี้เกินกว่าความสามารถ ER ที่มีอยู่ในการสร้างเอกสารในรูปแบบ Microsoft Office สำหรับข้อมูลเพิ่มเติม ให้เล่นคู่มืองานต่อไปนี้ คุณสามารถดูคู่มืองานเหล่านี้ภายใต้กระบวนการทางธุรกิจ 7.5.4.3 Acquire/Develop IT service/solution components (10677)

- ER ออกแบบการตั้งค่าคอนฟิกสำหรับการสร้างรายงานในรูปแบบ OPENXML
- ER ออกแบบการตั้งค่าคอนฟิกสำหรับการจัดทำรายงานในรูปแบบ Microsoft WORD

## <a name="embed-an-image-in-an-excel-document"></a>ฝังรูปภาพในเอกสาร Excel

### <a name="embed-an-image-in-an-excel-worksheet"></a>ฝังรูปภาพในเวิร์กชีต Excel

ขั้นแรก คุณต้องเพิ่มตัวยึดสำหรับรูปภาพในเอกสาร Excel เปิดสมุดงาน Excel และเพิ่มรูปภาพเป็นตัวยึดสำหรับรูปที่คุณจะเพิ่มในภายหลัง จากนั้นใช้เครื่องมือ ER เพื่อเพิ่มการตั้งค่าคอนฟิกรูปแบบ ER ใหม่ เพื่อรวมรายงานที่คุณออกแบบอยู่ แนบสมุดงาน Excel เป็นเท็มเพลตไว้สำหรับรูปแบบของรายงาน แล้วนําเข้าเนื้อหาของสมุดงานลงในรูปแบบ ER จะมีการสร้างนิยามรูปแบบโดยอัตโนมัติ ตัวยึดรูปภาพที่คุณเพิ่มจะรวมอยู่ในนิยามรูปแบบ ER เป็นองค์ประกอบ **CELL**

> [!NOTE]
> คุณสามารถระบุนิยามรูปแบบด้วยตนเองแทนการนําเข้า เมื่อคุณบันทึกการเปลี่ยนแปลง รูปแบบจะได้รับการตรวจสอบความถูกต้อง

จากนั้น ให้ผูกองค์ประกอบ **CELL** ของรูปแบบ ER กับฟิลด์จากแหล่งข้อมูลของรูปแบบที่ให้ข้อมูลของรูปภาพในรูปแบบฐานสองขณะรันไทม์ เมื่อใช้รูปแบบข้อมูล ER เป็นแหล่งข้อมูลของรูปแบบ ชนิดข้อมูลของฟิลด์ต้องเป็น [คอนเทนเนอร์](er-formula-supported-data-types-composite.md#container) ปัจจุบัน ฟิลด์รูปแบบข้อมูล ER ที่มีชนิดข้อมูล [คอนเทนเนอร์](er-formula-supported-data-types-composite.md#container) สามารถผูกกับแหล่งข้อมูลหลายชนิดที่ส่งคืนรูปภาพในรูปแบบฐานสอง คุณสามารถเข้าถึงฟิลด์ในตารางข้อมูลและไฟล์ที่ถูกแนบกับเรกคอร์ดของตารางข้อมูลได้ โดยใช้กรอบงานการจัดการเอกสาร

> [!IMPORTANT]
> - ถ้าคุณต้องการเติมตัวยึดรูปภาพในเอกสารที่คุณสร้างโดยใช้เท็มเพลต Excel รูปแบบ ER ต้องมีองค์ประกอบ **CELL** ที่อ้างอิงถึงองค์ประกอบรูปภาพที่มีชื่อในเท็มเพลต Excel มิฉะนั้น ตัวยึดรูปภาพจะไม่ปรากฏในผลลัพธ์ของรายงาน ถ้าการผูกองค์ประกอบ **CELL** ไม่ส่งคืนข้อมูลขณะรันไทม์ เอกสารที่สร้างขึ้นจะแสดงตัวยึดรูปภาพจากเท็มเพลต เมื่อต้องการซ่อนรูปภาพในเอกสารที่คุณสร้างขึ้น ให้กําหนดองค์ประกอบ **CELL** และระบุว่านิพจน์ **การเปิดใช้งาน** ควรส่งคืนค่า **FALSE**
> - ในเท็มเพลต Excel ให้ใช้ชื่อเฉพาะกับทุกองค์ประกอบ องค์ประกอบเหล่านี้รวมรูปภาพและเซลล์ ถ้าคุณใช้ชื่อองค์ประกอบซ้ำกัน เนื้อหาของรายงานที่สร้างขึ้นจะไม่ชัดเจนและสับสน

### <a name="embed-images-in-the-header-and-footer-of-an-excel-worksheet"></a>ฝังรูปภาพในส่วนหัวและส่วนท้ายของเวิร์กชีต Excel

ใช้เอกสารสมุดงาน Excel เป็นเท็มเพลตเพื่อระบุโครงร่างของรายงาน สมุดงานอาจประกอบด้วยเวิร์กชีตหลายเวิร์กชีต โดยแต่ละเวิร์กชีตสามารถออกแบบได้เพื่อให้มีส่วนหัวและส่วนท้าย Excel สนับสนุนรูปภาพในส่วนหัวและส่วนท้ายของทุกเวิร์กชีตได้มากถึงสามรูป รูปภาพสามารถวางด้านซ้าย ขวา หรือกึ่งกลาง

ใน Finance Release 10.0.21 คุณสามารถจัดการรูปภาพส่วนหัวและส่วนท้ายที่สร้างขึ้นโดยโซลูชัน ER ที่มีเท็มเพลต Excel

ถ้าคุณต้องการให้รูปภาพเริ่มต้นปรากฏในส่วนหัวหรือส่วนท้ายของเอกสารที่สร้าง คุณสามารถเพิ่มรูปภาพในส่วนหัวหรือส่วนท้ายของเวิร์กชีตของเท็มเพลต ER ได้ หากต้องการเข้าถึงรูปภาพนี้ในรูปแบบ ER ของคุณ คุณต้องเพิ่มส่วนประกอบ **รูปภาพ** ภายใต้ส่วนประกอบ [ส่วนหัว](er-fillable-excel.md#header-component) หรือ [ส่วนท้าย](er-fillable-excel.md#footer-component) ของรูปแบบ ตั้งค่าคอนฟิกการปรับแนวของส่วนประกอบ **รูปภาพ** ตามความเหมาะสม 

คุณยังสามารถใช้ส่วนประกอบ **รูปภาพ** เพื่อวางรูปภาพลงในส่วนหัวหรือส่วนท้ายของเอกสารที่สร้างขณะรันไทม์ได้ ถึงแม้ว่าเท็มเพลตจะไม่มีรูปภาพเริ่มต้น เพื่อระบุเนื้อหาของสื่อที่ควรลงในส่วนหัวหรือส่วนท้ายของเอกสารที่สร้างขึ้นเป็นรูปภาพใหม่หรือแทนที่รูปภาพเริ่มต้น คุณต้องผูกส่วนประกอบ **รูปภาพ** เข้ากับแหล่งข้อมูลชนิด [คอนเทนเนอร์](er-formula-supported-data-types-composite.md#container) ที่แสดงถึงรูปภาพในรูปแบบฐานสอง

ส่วนประกอบ **ส่วนหัว** หรือ **ส่วนท้าย** ทุกตัว สามารถมีส่วนประกอบ **รูปภาพ** หนึ่งส่วนสำหรับการปรับแนวที่สนับสนุน ได้แก่: **ซ้าย** **กลาง** และ **ขวา**

คุณสมบัติ **ปรับขนาดความสูง** ของส่วนประกอบ **รูปภาพ** ช่วยให้คุณสามารถใช้การผูกข้อมูลที่มีการตั้งค่าคอนฟิก เพื่อควบคุมขนาดของรูปภาพ:

- เลือก **ต้นฉบับ** เพื่อรักษาขนาดเริ่มต้นของรูปภาพ
- เลือก **สัมพันธ์** กับสเกลความสูงของรูปภาพในสัดส่วนกับความสูงของส่วนหัวหรือส่วนท้ายที่มีรูปภาพนั้น

    - ในกรณีนี้ ต้องกําหนดความสูงของรูปภาพเป็นเปอร์เซ็นต์ของส่วนหัวหรือส่วนท้ายหลัก
    - ถ้าค่าการปรับสเกลเกินกว่า 100 เปอร์เซ็นต์ รูปภาพอาจทับซ้อนกับพื้นที่ข้อมูลของเวิร์กชีตที่สอดคล้องกัน
    - ถ้าความสูงของรูปภาพมีการเปลี่ยนแปลงเมื่อมีการใช้การปรับสเกล ความกว้างจะเปลี่ยนไปเพื่อรักษาอัตราส่วนกว้างยาวเดิมของรูปภาพด้วย

- เลือก **สัมบูรณ์** เพื่อปรับขนาดรูปภาพตามค่าความสูงและความกว้าง (พิกเซล) ที่ให้ไว้ในตอนออกแบบ

    - ถ้าความสูงที่ระบุเกินกว่าความสูงของส่วนหัวหรือส่วนท้ายหลัก รูปภาพอาจทับซ้อนกับพื้นที่ข้อมูลของเวิร์กชีตที่สอดคล้องกัน

คุณยังสามารถใช้คุณสมบัติ **เปิดใช้งาน** ของส่วนประกอบ **รูปภาพ** เพื่อควบคุมการมองเห็นได้ของรูปภาพที่วางอยู่ในเอกสารที่สร้าง โดยใช้ส่วนประกอบนี้

> [!NOTE]
> คุณต้องใช้ตัวออกแบบรูปแบบ ER เพื่อเพิ่มส่วนประกอบ **รูปภาพ** ในรูปแบบ ER ที่แก้ไขได้ คุณไม่สามารถเพิ่มส่วนประกอบเมื่อคุณใช้พื้นที่งาน [การจัดการเอกสารทางธุรกิจ](er-business-document-management.md) เพื่อแก้ไขเท็มเพลตของเอกสารทางธุรกิจ

หากต้องการทราบเกี่ยวกับฟังก์ชันนี้ ให้ปฏิบัติตามขั้นตอนใน [การออกแบบรูปแบบ ER เพื่อสร้างรายงานในรูปแบบ Excel ที่มีรูปภาพแบบฝังในส่วนหัวหรือส่วนท้ายของหน้า](er-embed-images-header-footer-excel-reports.md)

## <a name="embed-a-shape-in-an-excel-document"></a>ฝังรูปร่างในเอกสาร Excel

ขั้นแรก คุณต้องเพิ่มตัวยึดสำหรับรูปร่างในเอกสาร Excel เปิดสมุดงาน Excel และเลือก **รูปร่าง** **กล่องข้อความ** หรือ **WordArt** เป็นตัวยึดรูปของรูปร่าง จากนั้นใช้เครื่องมือ ER เพื่อเพิ่มการตั้งค่าคอนฟิกรูปแบบ ER ใหม่ เพื่อรวมรายงานที่คุณออกแบบอยู่ แนบสมุดงาน Excel เป็นเท็มเพลตไว้สำหรับรูปแบบของรายงาน แล้วนําเข้าเนื้อหาของสมุดงานลงในรูปแบบ ER จะมีการสร้างนิยามรูปแบบโดยอัตโนมัติ ตัวยึดรูปร่างที่คุณเพิ่มจะรวมอยู่ในนิยามรูปแบบ ER เป็นองค์ประกอบ **CELL** ที่อ้างอิงถึงองค์ประกอบรูปร่าง Excel ที่ตั้งชื่อไว้

> [!NOTE]
> คุณสามารถระบุนิยามรูปแบบด้วยตนเองแทนการนําเข้า เมื่อคุณบันทึกการเปลี่ยนแปลง รูปแบบจะได้รับการตรวจสอบความถูกต้อง

จากนั้น ให้ผูกองค์ประกอบ **CELL** ในรูปแบบ ER กับฟิลด์จากแหล่งข้อมูลของรูปแบบที่ให้ข้อมูลขณะรันไทม์ สามารถแปลงข้อมูลนี้เป็นสตริงข้อความได้ เมื่อองค์ประกอบ **CELL** ในรูปแบบ ER อ้างถึงองค์ประกอบรูปร่างในเท็มเพลต Excel ที่สนับสนุนข้อความ ข้อความที่ให้ไว้โดยผ่านการผูกนี้เมื่อรันไทม์จะแสดงขึ้นในรูปร่างในเอกสารที่สร้างขึ้น

> [!IMPORTANT]
> - ถ้าคุณต้องการใช้เท็มเพลต Excel ที่มีตัวยึดรูปร่างเพื่อสร้างเอกสารใหม่ รูปแบบ ER ต้องมีองค์ประกอบ **CELL** ที่อ้างอิงถึงองค์ประกอบรูปร่าง Excel มิฉะนั้น ตัวยึดรูปร่างจะไม่ปรากฏในผลลัพธ์ของรายงาน ถ้าการผูกองค์ประกอบ **CELL** ที่อ้างอิงถึงองค์ประกอบรูปร่าง Excel ที่ตั้งชื่อไว้ไม่ส่งคืนข้อมูลที่รันไทม์ เอกสารที่สร้างขึ้นจะแสดงข้อความของตัวยึดระยะของรูปร่างจากเท็มเพลต Excel เมื่อต้องการซ่อนรูปร่างในเอกสารที่คุณสร้างขึ้น ให้กําหนดองค์ประกอบ **CELL** ที่จะอ้างถึงองค์ประกอบรูปร่าง Excel ที่ตั้งชื่อ และระบุว่านิพจน์ **การเปิดใช้งาน** ควรส่งคืนค่า **FALSE**
> - ในเท็มเพลต Excel ให้ใช้ชื่อเฉพาะกับทุกองค์ประกอบ องค์ประกอบเหล่านี้รวมรูปร่างและเซลล์ ถ้าคุณใช้ชื่อองค์ประกอบซ้ำกัน เนื้อหาของรายงานที่สร้างขึ้นจะไม่ชัดเจนและสับสน

## <a name="embed-an-image-in-a-word-document"></a>ฝังรูปภาพในเอกสาร Word
> [!IMPORTANT]
> คุณสามารถกลับมาใช้รูปแบบ ER ที่ใช้เท็มเพลต Excel อีกครั้ง เพื่อสร้างเอกสารที่มีรูปภาพแบบฝังอยู่ด้วยได้ ในรูปแบบ ER ให้ตรวจสอบให้แน่ใจว่าได้ระบุชื่อให้กับองค์ประกอบ **CELL** ซึ่งอ้างอิงถึงองค์ประกอบรูปภาพที่ตั้งชื่อไว้ใน Excel และผูกกับแหล่งข้อมูลที่จะส่งคืนรูปภาพขณะรันไทม์

ก่อนอื่น คุณต้องตั้งค่าคอนฟิกโครงร่างของเอกสาร Word ใช้ตัวควบคุม **เนื้อหารูปภาพ** เพื่อสร้างตัวยึดสำหรับรูปภาพที่ฝัง หากต้องการเข้าถึงตัวควบคุมนี้ คุณต้องให้แท็บ **นักพัฒนา** มองเห็นได้บน Word Ribbon ก่อน

จากนั้น ให้ลบเท็มเพลต Excel ออกจากรูปแบบ ER และแนบเอกสารเท็มเพลต Word อัพเดตการอ้างอิงถึงเท็มเพลตและบันทึกการเปลี่ยนแปลงของคุณ โครงสร้างของรูปแบบ ER ปัจจุบันที่ได้รับการบันทึกไปยังเท็มเพลต Word เป็นส่วน XML แบบกำหนดเองใหม่ ที่มีชื่อว่า **รายงาน**

จากนั้น ให้บันทึกเท็มเพลต Word ของรูปแบบ ER ปัจจุบันลงในคอมพิวเตอร์ของคุณ เปิดเท็มเพลต และเปิดบานหน้าต่าง **การแม็ป XML** ค้นหาส่วน XML แบบกำหนดเองที่ชื่อ **รายงาน** แล้วชี้ไปที่องค์ประกอบ **CELL** ในรายงาน ER ที่ผูกกับแหล่งข้อมูลที่ส่งคืนรูปภาพในรูปแบบฐานสอง แม็ปสินค้าของส่วน XML นี้กับตัวควบคุม **เนื้อหาของรูปภาพ** ที่เลือก และบันทึกการเปลี่ยนแปลงของคุณ

[![ฝังรูปภาพ](./media/embed-images-shapes-01.png)](./media/embed-images-shapes-01.png)

สุดท้าย ให้ลบเท็มเพลต Word ออกจากรูปแบบ ER และแนบเอกสาร Word ที่มีส่วน XML แบบกำหนดเองที่แม็ปไว้ อัพเดตการอ้างอิงรูปแบบเป็นเท็มเพลต และบันทึกการเปลี่ยนแปลงที่คุณเปลี่ยนแปลงให้กับรูปแบบ ER นี้

## <a name="more-information"></a>ข้อมูลเพิ่มเติม
เมื่อต้องการสร้างความคุ้นเคยกับรายละเอียดของคุณลักษณะนี้ ให้แสดงชุดคู่มืองาน **ER จัดสร้างรายงานในรูปแบบ MS Office ด้วยรูปภาพแบบฝัง** คู่มืองานเหล่านี้แสดงวิธีการฝังรูปภาพของโลโกบริษัทและลายเซ็นของบุคคลที่ได้รับอนุมัติในการตรวจสอบการชำระเงิน ที่สร้างขึ้นโดยใช้เครื่องมือ ER ในเอกสาร Excel และ Word

ตารางต่อไปนี้แสดงรายการไฟล์ที่ต้องใช้เพื่อให้คู่มืองานทำการ **ER สร้างรายงานในรูปแบบ MS Office พร้อมด้วยรูปภาพแบบฝัง** ให้เสร็จสมบูรณ์ ดาวน์โหลดและบันทึกไฟล์ zip ลงในคอมพิวเตอร์ของคุณ

| คำอธิบาย                                          | ชื่อไฟล์                   |
|------------------------------------------------------|-----------------------------|
| การตั้งค่าคอนฟิกแบบจำลองข้อมูล ER                          | [Model for cheques.xml](https://download.microsoft.com/download/6/e/a/6ea166fd-1382-4fdb-8dcb-0f13379f9c8e/Modelforcheques.xml)       |
| การตั้งค่าคอนฟิกรูปแบบ ER                              | [Cheques printing format.xml](https://download.microsoft.com/download/1/7/c/17c301e3-c4ee-4886-ae75-440fcc002c8c/Chequesprintingformat.xml) |
| รูปโลโก้บริษัท                                   | [Company logo.png](https://download.microsoft.com/download/8/2/e/82e6bd81-caac-4e9a-bfce-1392ce7c8616/Companylogo.png)            |
| รูปภาพลายเซ็น                                      | [Signature image.png](https://download.microsoft.com/download/5/0/9/509151b3-06fc-4870-9408-7c9a43b72771/Signatureimage.png)         |
| รูปภาพลายเซ็นอื่น                          | [Signature image 2.png](https://download.microsoft.com/download/3/0/0/30045bf1-0ff6-4215-9162-b77c2f5dcc7c/Signatureimage2.png)       |
| เท็มเพลต Microsoft Word สำหรับการพิมพ์เช็คการชำระเงิน  | [Cheque template Word.docx](https://download.microsoft.com/download/4/4/d/44d9d255-9ad1-42fe-87db-23f319fd8e89/ChequetemplateWord.docx)   |
| เท็มเพลต Microsoft Excel สำหรับการพิมพ์เช็คการชำระเงิน | [Cheque template.xlsx](https://download.microsoft.com/download/1/f/6/1f671963-73aa-48d5-ae69-45f21fe7dfb4/Cheque%20template.xlsx)        |

รูปภาพต่อไปนี้แสดงตัวอย่างเอกสารที่พิมพ์เพื่อทดสอบการตรวจสอบการชำระเงิน ที่สร้างขึ้นจากเท็มเพลต Excel

[![งานพิมพ์ทดสอบการตรวจสอบการชำระเงิน](./media/embed-images-shapes-02.png)](./media/embed-images-shapes-02.png)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
