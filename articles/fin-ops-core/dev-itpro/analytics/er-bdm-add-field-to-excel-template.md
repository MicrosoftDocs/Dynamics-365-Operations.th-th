---
title: เพิ่มฟิลด์ใหม่ลงในเทมเพลตเอกสารทางธุรกิจใน Microsoft Excel
description: บทความนี้ให้ข้อมูลเกี่ยวกับวิธีการเพิ่มฟิลด์ใหม่ลงในเทมเพลตเอกสารทางธุรกิจใน Microsoft Excel โดยใช้คุณลักษณะการจัดการเอกสารทางธุรกิจ
author: NickSelin
ms.date: 11/15/2019
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERBDWorkspace, ERBDParameters, ERBDTemplateEditor
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2019-10-01
ms.dyn365.ops.version: 10.0.7
ms.openlocfilehash: 8395a87e88ebbd1942c87da0cecebe6d25bdf625
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 06/03/2022
ms.locfileid: "8869415"
---
# <a name="add-new-fields-to-a-business-document-template-in-microsoft-excel"></a>เพิ่มฟิลด์ใหม่ลงในแม่แบบเอกสารทางธุรกิจใน Microsoft Excel

[!include[banner](../includes/banner.md)]

คุณสามารถเพิ่มฟิลด์ใหม่ให้กับแม่แบบที่ใช้เพื่อสร้างเอกสารทางธุรกิจในรูปแบบ Microsoft Excel ได้ คุณสามารถเพิ่มฟิลด์เหล่านี้เป็นตัวยึดตำแหน่งที่จะใช้ในการกรอกเอกสารที่สร้างขึ้นโดยมีข้อมูลที่จำเป็นจากใบสมัคร สำหรับทุกฟิลด์ที่คุณเพิ่ม คุณสามารถระบุการผูกข้อมูลกับแหล่งข้อมูล เพื่อระบุว่าจะป้อนข้อมูลใบสมัครใดจะถูกป้อนในฟิลด์ เมื่อมีการใช้แม่แบบเพื่อสร้างเอกสารทางธุรกิจ

เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับคุณลักษณะนี้ ให้ดำเนินการตัวอย่างในบทความนี้ให้เสร็จสมบูรณ์ ตัวอย่างนี้แสดงวิธีการอัพเดตแม่แบบ เพื่อกรอกข้อมูลในฟิลด์ในฟอร์มใบแจ้งหนี้ข้อความอิสระที่สร้างขึ้น

## <a name="configure-business-document-management-to-edit-templates"></a>ตั้งค่าคอนฟิกการจัดการเอกสารทางธุรกิจเพื่อแก้ไขแม่แบบ

เนื่องจากการจัดการเอกสารทางธุรกิจ (BDM) ถูกสร้างขึ้นที่ด้านบนของกรอบงาน [ภาพรวมการรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md) คุณต้องตั้งค่าคอนฟิกพารามิเตอร์ ER และ BDM ที่จำเป็นก่อนที่คุณจะสามารถเริ่มต้นการทำงานกับ BDM

1.  ลงชื่อเข้าใช้อินสแตนซ์ของ Microsoft Dynamics 365 Finance ในฐานะผู้ดูแลระบบ
2.  ดำเนินการขั้นตอนต่อไปนี้ให้เสร็จสมบูรณ์จากตัวอย่างในบทความ [ภาพรวมของการจัดการเอกสารทางธุรกิจ](er-business-document-management.md):

    1.  ตั้งค่าคอนฟิกพารามิเตอร์ ER
    2.  เปิด BDM

ขณะนี้คุณสามารถเริ่มต้นการใช้ BDM เพื่อแก้ไขแม่แบบเอกสารทางธุรกิจได้

## <a name="import-er-solutions-that-contain-a-template"></a>นำเข้าโซลูชันของ ERที่มีแม่แบบ

ตัวอย่างในขั้นตอนนี้ใช้โซลูชันของ ER ที่เผยแพร่อย่างเป็นทางการ คุณต้องนำเข้าการตั้งค่าคอนฟิกของ ER ของโซลูชันนี้ในอินสแตนซ์ปัจจุบันของ Finance

การตั้งค่าคอนฟิกรูปแบบของ ER **ใบแจ้งหนี้ข้อความอิสระ (Excel)** ของโซลูชันนี้ประกอบด้วยแม่แบบเอกสารทางธุรกิจในรูปแบบ Excel ที่สามารถแก้ไขได้โดยใช้ BDM นำเข้ารุ่นล่าสุดของการตั้งค่าคอนฟิกการจัดรูปแบบของ ER นี้จาก Microsoft Dynamics Lifecycle Service (LCS) มีการนำเข้าการตั้งค่าคอนฟิกแบบจำลองข้อมูลของ ER และการแม็ปแบบจำลองของ ER โดยอัตโนมัติ

สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวีธีการนำเข้าการตั้งค่าคอนฟิก ER ดู [จัดการวงจรการใช้งานการตั้งค่าคอนฟิก ER](general-electronic-reporting-manage-configuration-lifecycle.md)

![หน้าไลบรารีสินทรัพย์ที่ใช้ร่วมกันของ LCS](./media/BDM-AddFldExcel-LCS.png)

### <a name="edit-the-er-solution-template"></a>แก้ไขแม่แบบเริ่มต้นแบบของ ER

1.  ลงชื่อเข้าใช้ในฐานะผู้ใช้ที่มีสิทธิ์เข้าถึงพื้นที่ทำงาน **การจัดการเอกสารทางธุรกิจ**
2.  เปิดพื้นที่ทำงาน **การจัดการเอกสารทางธุรกิจ**

    ![พื้นที่ทำงานของการจัดการเอกสารทางธุรกิจ](./media/BDM-AddFldExcel-Workspace.png)

3.  ในกริด ให้เลือกแม่แบบ **ใบแจ้งหนี้ข้อความอิสระ (Excel)**
4.  ในบานหน้าต่างด้านขวา ให้เลือก **แม่แบบใหม่** เพื่อสร้างแม่แบบใหม่ที่ยึดตามแม่แบบที่เลือก
5.  ในฟิลด์ **ชื่อเรื่อง** ให้ป้อน **ใบแจ้งหนี้ข้อความอิสระ (Excel) Contoso** เป็นชื่อของแม่แบบใหม่
6.  เลือก **ตกลง** เพื่อยืนยันการเริ่มต้นของกระบวนการแก้ไข

เพจโปรแกรมแก้ไขแม่แบบ BDM ปรากฏขึ้น คุณสามารถใช้ Microsoft 365 เพื่อแก้ไขแม่แบบที่เลือกแบบออนไลน์ในตัวควบคุมฝังตัว

![หน้าโปรแกรมแก้ไขแม่แบบ BDM](./media/BDM-AddFldExcel-EditableTemplate.png)

### <a name="add-the-label-for-a-new-field-to-the-template"></a>เพิ่มป้ายชื่อสำหรับฟิลด์ใหม่ให้กับแม่แบบ

1.  บนหน้าโปรแกรมแก้ไขแม่แบบ BDM บน Excel ribbon บนแท็บ **มุมมอง** ให้เลือกกล่องกาเครื่องหมาย **หัวข้อและเส้นตาราง** สำหรับแม่แบบ Excel ที่สามารถแก้ไขได้

    ![กล่องกาเครื่องหมายหัวข้อและเส้นตารางที่เลือก](./media/BDM-AddFldExcel-EditableTemplate2.png)

2.  เลือกเซลล์ **E8:F8**
3.  บน Excel ribbon บนแท็บ **หลัก** เลือก **ผสาน & กึ่งกลาง** เพื่อผสานเซลล์ที่เลือกเข้ากับ **E8:F8** ใหม่ที่ผสาน
4.  ในเซลล์ **E8:F8** ที่ผสาน ป้อน **URL**
5.  เลือกเซลล์ **E7:F7** ที่ผสาน เลือก **รูปแบบจิตรกร** แล้วเลือกเซลล์ **E8: F8** ที่ผสาน เพื่อจัดรูปแบบในลักษณะเดียวกับที่ใช้กับเซลล์ **E7: F7** ที่ผสาน

    ![ป้ายชื่อสำหรับฟิลด์ใหม่ที่เพิ่มให้กับแม่แบบ](./media/BDM-AddFldExcel-EditableTemplate3.png)

### <a name="format-the-template-to-reserve-space-for-a-new-field"></a>การจัดรูปแบบแม่แบบเพื่อจองพื้นที่สำหรับฟิลด์ใหม่

1.  บนหน้าโปรแกรมแก้ไขแม่แบบ BDM เลือกเซลล์ **G8:H8** ที่ผสาน
2.  บน Excel ribbon บนแท็บ **หลัก** เลือก **ผสาน & กึ่งกลาง** เพื่อผสานเซลล์ที่เลือกเข้ากับ **G8:H8** ใหม่ที่ผสาน
3.  เลือกเซลล์ **G7:H7** ที่ผสาน เลือก **รูปแบบจิตรกร** แล้วเลือกเซลล์ **G8:H8** ที่ผสาน เพื่อจัดรูปแบบในลักษณะเดียวกับที่ใช้กับเซลล์ **G7:H7** ที่ผสาน

    ![พื้นที่ที่จองไว้สำหรับฟิลด์ใหม่](./media/BDM-AddFldExcel-EditableTemplate4.png)

4.  ในฟิลด์กล่อง **ชื่อ** เลือก **CompanyInfo**

    ช่วง **CompanyInfo** ของแม่แบบ Excel ปัจจุบัน จะเก็บฟิลด์ทั้งหมดที่จะใช้ในการเติมข้อมูลส่วนหัวของรายงานที่สร้างขึ้น โดยมีรายละเอียดของบริษัทปัจจุบันเป็นฝ่ายผู้ขาย

    ![ช่วง CompanyInfo ที่เลือก](./media/BDM-AddFldExcel-SelectCompanyInfoRange.png)

### <a name="add-a-new-field-to-the-template"></a>เพิ่มฟิลด์ใหม่ให้กับแม่แบบ

1.  บนเพจ **โปรแกรมแก้ไขแม่แบบ BDM** บนบานหน้าต่างการดำเนินการ ให้เลือก **แสดงรูปแบบ**
2.  ในบานหน้าต่าง **โครงสร้างแม่แบบ** เลือก **เพิ่ม**

    > [!NOTE]
    > คุณต้องปรับปรุงส่วนของแม่แบบที่คุณต้องการใช้เป็นฟิลด์ใหม่ คุณได้ทำการปรับปรุงนี้โดยการจัดรูปแบบเซลล์ **G8:H8** ที่ผสาน

    ![การเพิ่มฟิลด์ใหม่ให้กับแม่แบบ](./media/BDM-AddFldExcel-AddCell.png)

3.  เลือก **Excel\เซลล์** เพื่อเพิ่มฟิลด์ใหม่เป็นเซลล์ในแม่แบบ

    คุณสามารถเลือก **Excel\ช่วง** ถ้าคุณต้องการเพิ่มช่วงใหม่ให้กับแม่แบบ ช่วงที่ป้อนอาจประกอบด้วยหลายเซลล์ คุณสามารถเพิ่มเซลล์เหล่านี้ในภายหลังได้
    
    โปรดสังเกตว่า แม่แบบ **CompanyInfo** จะถูกเลือกโดยอัตโนมัติในบานหน้าต่าง **โครงสร้างแม่แบบ** เนื่องจากเป็นส่วนประกอบหลักที่เหมาะสมที่สุดในโครงสร้างแม่แบบปัจจุบันสำหรับฟิลด์ที่คุณกำลังเพิ่ม
    
4.  ในฟิลด์ **ช่วงของ Excel** ให้ป้อน **CompanyURL_Value**
5.  เลือก **ตกลง**

    ![ฟิลด์ CompanyURL_Value ที่เพิ่มเข้าในโครงสร้างแม่แบบ](./media/BDM-AddFldExcel-EditableTemplate5.png)

6.  ในบานหน้าต่าง **โครงสร้างแม่แบบ** ให้เลือกปุ่มจุดไข่ปลา (...) แล้วเลือก **แสดงการผูกข้อมูล**

    ![แสดงการผูกข้อมูลที่เลือก](./media/BDM-AddFldExcel-ShowBindings.png)

    ขณะนี้บานหน้าต่าง **โครงสร้างแม่แบบ** จะแสดงแหล่งข้อมูลที่มีอยู่ในรูปแบบของ ER ที่เน้น

7.  เลือก **CompanyInfo_Value** เป็นฟิลด์ที่คุณวางแผนที่จะผูกกับแหล่งข้อมูลของรูปแบบของ ER ที่เน้น
8.  ในส่วน **แหล่งข้อมูล** ของบานหน้าต่าง **โครงสร้างแม่แบบ** ขยาย **แบบจำลอง \> InvoiceBase \> CompanyInfo**
9.  ภายใต้ **CompanyInfo** เลือกรายการ **WebsiteURI**

    ![รายการ WebsiteURI ที่เลือก](./media/BDM-AddFldExcel-BindURL.png)

10. เลือก **ผูก**
11. ในบานหน้าต่าง **โครงสร้างแม่แบบ** เลือก **บันทึก** แล้วปิดเพจโปรแกรมแก้ไขแม่แบบ BDM

ในพื้นที่ทำงาน **การจัดการเอกสารทางธุรกิจ** แท็บ **แม่แบบ** ในบานหน้าต่างด้านขวาแสดงแม่แบบที่อัพเดต ในกริด ให้สังเกตว่าฟิลด์ **สถานะ** สำหรับแม่แบบที่แก้ไขถูกเปลี่ยนเป็น **ร่าง** และฟิลด์ **การปรับปรุง** จะไม่ว่างเปล่าอีกต่อไป การเปลี่ยนแปลงเหล่านี้บ่งชี้ว่ากระบวนการของการแก้ไขของแม่แบบนี้ได้เริ่มต้นแล้ว

![แม่แบบที่แก้ไขแล้วในพื้นที่ทำงานการจัดการเอกสารทางธุรกิจ](./media/BDM-AddFldExcel-Workspace2.png)

## <a name="review-company-settings"></a>ตรวจทานการตั้งค่าบริษัท

1.  ไปที่ **การจัดการองค์กร \> องค์กร \> นิติบุคคล**
2.  บนแท็บด่วน **ข้อมูลการติดต่อ** โปรดตรวจสอบว่ามีการป้อน URL ของบริษัท

![URL ของบริษัทที่ป้อนบนหน้านิติบุคคล](./media/BDM-AddFldExcel-CompanyInfo.png)

## <a name="generate-business-documents-to-test-the-updated-template"></a>สร้างเอกสารทางธุรกิจเพื่อทดสอบแม่แบบที่อัพเดต

1.  ในใบสมัคร ให้เปลี่ยนบริษัทเป็น **USMF** และไปที่ **บัญชีลูกหนี้ \> ใบแจ้งหนี้ \> ใบแจ้งหนี้ข้อความอิสระทั้งหมด**
2.  เลือกใบแจ้งหนี้ **FTI-00000002** แล้วจากนั้น เลือก **การจัดการการพิมพ์**
3.  ในบานหน้าต่างด้านซ้าย ให้ขยาย **โมดูล - บัญชีลูกหนี้ \> เอกสาร \> ใบแจ้งหนี้ข้อความอิสระ**
4.  ภายใต้ **ใบแจ้งหนี้ข้อความอิสระ** ให้เลือกระดับ **เอกสารต้นฉบับ** เพื่อระบุขอบเขตของใบแจ้งหนี้สำหรับการประมวลผล
5.  ในบานหน้าต่างด้านขวา ในฟิลด์ **รูปแบบรายงาน** ให้เลือกแม่แบบ **ใบแจ้งหนี้ข้อความอิสระ (Excel) Contoso** สำหรับระดับเอกสารที่ระบุ

    ![เทมเพลตใบแจ้งหนี้ข้อความอิสระ (Excel) ของ Contoso ที่เลือกไว้](./media/BDM-AddFldExcel-PrintMngtSetting.png)

6.  กด **Esc** เพื่อปิดหน้าปัจจุบัน
7.  เลือก **พิมพ์ \> ที่เลือก**
8.  ดาวน์โหลดเอกสารที่สร้างขึ้น และเปิดเอกสารใน Excel

    ![ใบแจ้งหนี้ข้อความอิสระใน Excel](./media/BDM-AddFldExcel-PreviewReport.png)

เท็มเพลตที่ปรับเปลี่ยนจะถูกใช้ในการสร้างรายงานใบแจ้งหนี้ข้อความอิสระสำหรับรายการที่เลือก เมื่อต้องการวิเคราะห์วิธีการที่รายงานนี้ได้รับผลกระทบจากการเปลี่ยนแปลงที่คุณสร้างแม่แบบ รันรายงานนี้ในรอบเวลาของแอพลิเคชันหนึ่งได้ทันที หลังจากที่คุณปรับเปลี่ยนแม่แบบในรอบเวลาของแอพลิเคชันอื่น

## <a name="related-links"></a>ลิงค์ที่เกี่ยวข้อง

[ภาพรวมการรายงานทางอิเล็กทรอนิกส์ (ER)](general-electronic-reporting.md)

[ภาพรวมของการจัดการเอกสารทางธุรกิจ](er-business-document-management.md)

[ออกแบบการตั้งค่าคอนฟิกสำหรับการสร้างรายงานในรูปแบบ OPENXML](tasks/er-design-reports-openxml-2016-11.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]