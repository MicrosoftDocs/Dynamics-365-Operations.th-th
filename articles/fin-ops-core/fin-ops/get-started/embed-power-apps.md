---
title: Power Apps ที่ฝังไว้
description: หัวข้อนี้อธิบายวิธีการฝัง Power Apps ไปยังไคลเอนต์เพื่อเสริมฟังก์ชันของผลิตภัณฑ์
author: jasongre
manager: AnnBe
ms.date: 12/02/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: FormRunConfigurationAddPAControl, FormRunConfigurationEditPAControl
audience: Application User, Developer, IT Pro
ms.reviewer: sericks
ms.search.scope: Operations, Core
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2018-02-28
ms.dyn365.ops.version: Platform update 14
ms.openlocfilehash: 90422a34499dab7302ad7722cf84d40e1815991c
ms.sourcegitcommit: 3c1eb3d89c6ab9bd70b806ca42ef9df74cf850bc
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 02/12/2020
ms.locfileid: "3042953"
---
# <a name="embed-microsoft-power-apps"></a>Microsoft Power Apps ที่ฝังไว้

[!include [banner](../includes/banner.md)]

Finance and Operations สนับสนุนการรวมกับ Microsoft Power Apps ซึ่งเป็นการบริการสำหรับนักพัฒนาและผู้ใช้ที่ไม่ใช่ด้านเทคนิคในการสร้างแอปธุรกิจที่กำหนดเองสำหรับอุปกรณ์มือถือ แท็บเล็ต และเว็บโดยไม่ต้องเขียนโค้ด Power Apps พัฒนาโดยคุณ องค์กรของคุณ หรือระบบแวดล้อมที่กว้างขึ้น ต่อมาจะสามารถฝังตัวใน Finance and Operations เพื่อเพิ่มฟังก์ชันการทำงานของผลิตภัณฑ์ ตัวอย่างเช่น คุณอาจสร้างแอปจาก Power Apps เพื่อเสริมแอป Finance and Operations ด้วยข้อมูลที่ดึงมาจากระบบอื่น

เพื่อเรียนรู้เพิ่มเติมเกี่ยวกับ Power Apps ที่ฝัง ดูวิดีโอสั้นๆ [วิธีการฝัง Power Apps](https://www.youtube.com/watch?v=x3qyA1bH-NY)

## <a name="adding-an-embedded-app-from-power-apps-to-a-page"></a>การเพิ่มแอปที่ฝังจาก Power Apps ไปยังหน้าหนึ่ง

### <a name="overview"></a>ภาพรวม

ก่อนที่จะฝังแอป Power Apps ลงในไคลเอนต์ อันดับแรกคุณต้องค้นหาหรือสร้างแอปด้วยภาพและ/หรือฟังก์ชันการทำงานที่ต้องการ เราจะไม่อธิบายกระบวนการโดยละเอียดสำหรับการสร้างแอปที่นี่ หัวข้อ [บทนำไปยัง Power Apps](https://docs.microsoft.com/powerapps/getting-started) คือจุดเริ่มต้นที่ดี ถ้าคุณเพิ่งเริ่มใช้กับ Power Apps

เมื่อคุณพร้อมที่จะฝังแอปเฉพาะ คุณสามารถเลือกระหว่างหนึ่งในสองวิธีในการเข้าถึงแอปในหน้าใดหน้าหนึ่งที่มีเส้นทางเหมาะสมกับสถานการณ์ของคุณมากขึ้น วิธีการแรกคือ โดยใช้ปุ่ม Power Apps ที่ได้ถูกเพิ่มลงในบานหน้าต่างการดำเนินการมาตรฐาน แอปที่เพิ่มโดยใช้กลไกนี้จะปรากฏเป็นรายการเมนูภายในปุ่มเมนู Power Apps เมื่อเลือกแล้ว รายการเมนูเหล่านี้แต่ละรายการจะเปิดบานหน้าต่างด้านข้างที่มีแอปฝังอยู่ อีกทางเลือกหนึ่ง คุณอาจเลือกที่จะฝังแอปลงบนหน้าโดยตรงในแท็บใหม่ FastTab แผ่นหรือเป็นส่วนใหม่ในพื้นที่ทำงาน

เมื่อกำหนดค่าแอปที่ฝังไว้แล้ว คุณสามารถเลือกฟิลด์เดียวที่คุณต้องการส่งเป็นบริบทไปยังแอป สิ่งนี้ทำให้แอปสามารถตอบสนองตามข้อมูลที่คุณกำลังดูอยู่

### <a name="details"></a>รายละเอียด

คำแนะนำต่อไปนี้แสดงวิธีการฝังแอปจาก Power Apps ลงในเว็บไคลเอ็นต์

1. ไปที่หน้าที่คุณต้องการฝังแอป สิ่งนี้จะเป็นหน้าเดียวกับหน้าที่มีข้อมูลใด ๆ ที่จำเป็นต้องส่งผ่านไปยังแอปเหมือนกับข้อมูลป้อนเข้า
2. เปิดบานหน้าต่าง **เพิ่มแอปจาก Power Apps** :

    - คลิก **ตัวเลือก** แล้วจึงเลือก **ปรับหน้านี้ให้เป็นแบบส่วนตัว** ใต้เมนู **แทรก** เลือก **Power Apps** สุดท้ายให้เลือกขอบเขตที่คุณต้องการเพิ่มแอป หากคุณต้องการฝังแอปภายใต้ปุ่มเมนู Power Apps ให้เลือกบานหน้าต่างการดำเนินการ หากคุณต้องการฝังแอปลงบนหน้าโดยตรงให้เลือกแท็บ FastTab แผ่นหรือส่วนที่เหมาะสม (ถ้าคุณอยู่ในพื้นที่ทำงาน)
    - หากแอปเข้าถึงได้โดยใช้ปุ่มเมนู Power Apps อีกวิธีหนึ่งคุณสามารถคลิกปุ่มเมนู **Power Apps** ในบานหน้าต่างการดำเนินการมาตรฐาน แล้วเลือก **เพิ่มแอป**

3. กำหนดค่าแอปที่ฝังไว้:

    - ฟิลด์ **ชื่อ** บ่งชี้ข้อความแสดงปุ่มหรือแท็บที่จะมีแอปที่ฝังอยู่ บ่อยครั้งคุณอาจต้องการทำชื่อแอปในฟิลด์นี้ซ้ำ
    - **รหัสแอป** เป็น GUID สำหรับแอปที่คุณต้องการฝัง ในการดึงค่านี้ ให้หาแอปใน [web.powerapps.com](https://web.powerapps.com) จากนั้นหาตำแหน่งฟิลด์ **รหัสแอป** ภายใต้ **รายละเอียด**
    - สำหรับ **บริบทการป้อนข้อมูลสำหรับแอป** คุณสามารถเลือกฟิลด์ที่มีข้อมูลที่คุณต้องการส่งผ่านไปยังแอปเป็นข้อมูลป้อนเข้า ดูส่วนต่อไปในหัวข้อนี้ที่มีชื่อว่า [การสร้างแอปที่ใช้ประโยชน์ข้อมูลที่ส่งจากแอป Finance and Operations](#building-an-app-that-leverages-data-sent-from-finance-and-operations-apps) สำหรับรายละเอียดเกี่ยวกับวิธีที่แอปสามารถเข้าถึงข้อมูลที่ส่งมาจากแอป Finance and Operations
    - เลือกขนาด **แอปพลิเคชัน** ที่ตรงกับชนิดของแอปที่คุณฝังไว้อยู่ เลือก **Thin** สำหรับแอปที่สร้างขึ้นสำหรับอุปกรณ์มือถือและ **Wide** สำหรับแอปที่สร้างขึ้นสำหรับแท็บเล็ต สิ่งนี้ทำให้แน่ใจว่ามีการจัดสรรพื้นที่เพียงพอสำหรับแอปที่ฝังไว้
    - FastTab **เอนทิตีทางกฎหมาย** ให้ความสามารถในการเลือกแอปที่พร้อมใช้งานสำหรับเอนทิตีทางกฎหมาย ค่าเริ่มต้น คือ การทำให้แอปสามารถเข้าถึงเอนทิตีทางกฎหมายได้ทั้งหมด ตัวเลือกนี้จะมีพร้อมใช้งานเมื่อคุณลักษณะ [มุมมองที่บันทึกไว้](saved-views.md) ถูกปิดใช้งาน 

4. หลังจากการยืนยันว่าการตั้งค่าคอนฟิกถูกต้อง คลิก **แทรก** เพื่อฝัง PowerApp บนหน้า คุณจะได้รับแจ้งให้รีเฟรชเบราว์เซอร์เพื่อดูแอปใบสั่งที่ฝังอยู่

## <a name="sharing-an-embedded-app"></a>การใช้แอปที่ฝังไว้ร่วมกัน

หลังจากคุณฝังแอปลงในหน้าและยืนยันว่าแอปทำงานอย่างถูกต้องกับบริบทข้อมูลใด ๆ ที่ส่งผ่านจากหน้านั้น คุณอาจต้องการแบ่งปันสิ่งนี้กับผู้ใช้รายอื่นในระบบ ซึ่งสามารถทำได้ในสองวิธีที่แตกต่างกัน โดยใช้ความสามารถในการตั้งค่าส่วนบุคคลของผลิตภัณฑ์:

- สถานการณ์จำลองที่แนะนำคือ ผ่านผู้ดูแลระบบ ผู้ซึ่งสามารถกำหนดการตั้งค่าส่วนบุคคลให้กับผู้ใช้ทั้งหมดหรือชุดย่อยของผู้ใช้ได้
- อีกทางหนึ่งคือ คุณสามารถส่งออกการกำหนดเป็นแบบส่วนบุคคลของหน้าของคุณได้ ส่งไปยังผู้ใช้อย่างน้อยหนึ่งราย และให้ผู้ใช้ดังกล่าวแต่ละรายนำเข้าการเปลี่ยนแปลงเหล่านั้น แถบเครื่องมือการตั้งค่าส่วนบุคคลมีการดำเนินการที่ช่วยให้คุณสามารถส่งออกและนำเข้าการตั้งค่าส่วนบุคคล

ดู [กำหนดประสบการณ์ผู้ใช้เป็นแบบส่วนบุคคล](personalize-user-experience.md) สำหรับรายละเอียดเพิ่มเติมเกี่ยวกับความสามารถในการกำหนดประสบการณ์ผู้ใช้เป็นแบบส่วนบุคคลในผลิตภัณฑ์และวิธีการใช้

## <a name="building-an-app-that-leverages-data-sent-from-finance-and-operations-apps"></a>การสร้างแอปที่ใช้ประโยชน์จากข้อมูลที่ส่งมาจากแอป Finance and Operations 

ส่วนสำคัญของการสร้างแอปจาก Power Apps ที่จะถูกฝังอยู่ในแอป Finance and Operations คือ การใช้ข้อมูลที่ป้อนเข้าจากแอปพลิเคชันนั้น จากประสบการณ์การพัฒนา Power Apps ข้อมูลที่ป้อนเข้าที่ส่งผ่านจากแอป Finance and Operations สามารถเข้าถึงได้โดยใช้ตัวแปร Param ("EntityId")

ตัวอย่างเช่น ในฟังก์ชั่น OnStart ของแอป คุณสามารถตั้งค่าข้อมูลป้อนเข้าจากแอป Finance and Operations เป็นตัวแปรดังนี้:

```powerapps
If(!IsBlank(Param("EntityId")), Set(FinOpsInput, Param("EntityId")), Set(FinOpsInput, ""));
```

## <a name="viewing-an-app"></a>การดูแอป

ในการดูแอปที่ฝังในหน้าในแอป Finance and Operations เพียงแค่ไปที่หน้าที่มีแอปที่ฝังไว้ จำไว้ว่าแอปสามารถเข้าถึงได้โดยใช้ปุ่ม Power Apps ในบานหน้าต่างการดำเนินการมาตรฐาน หรือสามารถปรากฏโดยตรงบนหน้าในแท็บใหม่ FastTab แผ่นหรือเป็นส่วนใหม่ในพื้นที่ทำงาน เมื่อผู้ใช้พยายามโหลดแอปบนหน้าครั้งแรก ผู้ใช้จะได้รับแจ้งให้ลงชื่อเข้าใช้เพื่อให้แน่ใจว่าผู้ใช้มีสิทธิ์ที่เหมาะสมในการใช้แอป

## <a name="editing-an-embedded-app"></a>การแก้ไขแอปที่ฝังไว้

หลังจากที่ฝังแอปลงบนหน้า คุณอาจต้องทำการเปลี่ยนแปลงบางอย่างในการกำหนดค่าของแอป ตัวอย่างเช่น คุณอาจต้องการแก้ไขป้ายชื่อที่เชื่อมโยงกับแอปที่ฝังอยู่หรือสร้างแอปรุ่นใหม่ และคุณจำเป็นต้องปรับปรุงรหัสแอปให้บ่งชี้ไปที่การปรับปรุงล่าสุด

ทำตามขั้นตอนเหล่านี้เพื่อแก้ไขการกำหนดค่าของแอปที่ฝังอยู่:

1. ไปที่บานหน้าต่าง **การแก้ไขแอป**

    - หากเข้าถึงแอปที่ฝังไว้ผ่านปุ่มเมนู Power Apps ให้คลิกขวาที่ปุ่มเมนู Power Apps และเลือก **ปรับให้เป็นแบบส่วนตัว** เลือกแอปที่คุณต้องการกำหนดค่าจากเมนูแบบหล่นลง **เลือกแอป** 
    - หากแอปที่ฝังไว้ปรากฏบนเพจโดยตรง ให้เลือก **ตัวเลือก** แล้วจึงเลือก **ปรับหน้านี้ให้เป็นแบบส่วนตัว** ใช้เครื่องมือ **เลือก** คลิกแอปที่ฝังไว้

2. ทำการปรับเปลี่ยนที่จำเป็นสำหรับการกำหนดค่าแอป แล้วคลิก **บันทึก** 

## <a name="removing-an-app"></a>ลบแอป

หลังจากที่ฝังแอปลงบนหน้า มีสองวิธีในการลบ หากจำเป็น:

- ไปที่บานหน้าต่าง **แก้ไขแอป** โดยใช้คำแนะนำก่อนหน้าจากส่วน [การแก้ไขแอปที่ฝังไว้](#editing-an-embedded-app) ในหัวข้อนี้ ยืนยันว่าบานหน้าต่างได้แสดงข้อมูลสำหรับแอปที่ฝังไว้ที่คุณต้องการลบ แล้วคลิกปุ่ม **ลบ** 
- เนื่องจากแอปที่ฝังอยู่นั้นถูกบันทึกเป็นข้อมูลส่วนบุคคล การล้างข้อมูลส่วนบุคคลในหน้าของคุณจะลบแอปที่ฝังไว้ในหน้านั้นด้วย โปรดทราบว่า การล้างการตั้งค่าส่วนบุคคลของเพจเป็นแบบถาวร และไม่สามารถยกเลิกได้ หากต้องการลบการตั้งค่าส่วนบุคคลของคุณในหน้า ให้เลือก **ตัวเลือก** แล้วจึง **ปรับหน้านี้ให้เป็นแบบส่วนตัว** และสุดท้ายคลิกปุ่ม **ล้างข้อมูล** หลังจากการรีเฟรชเบราเซอร์ของคุณ การกำหนดเป็นแบบส่วนบุคคลก่อนหน้านี้ทั้งหมดสำหรับหน้านี้จะถูกเอาออก ดู [กำหนดประสบการณ์ผู้ใช้นี้เป็นแบบส่วนบุคคล](personalize-user-experience.md) สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการปรับปรุงหน้าโดยใช้การกำหนดเป็นแบบส่วนบุคคล

## <a name="appendix"></a>ภาคผนวก

### <a name="developer-control-over-where-an-app-can-be-embedded"></a>นักพัฒนาควบคุมตำแหน่งที่สามารถฝังแอปไว้ได้

ตามค่าเริ่มต้น ผู้ใช้สามารถฝังแอปในหน้าใดก็ได้ภายใต้ปุ่มเมนู Power Apps หรือฝังโดยตรงบนหน้าในแท็บใหม่ FastTab แผ่นหรือเป็นส่วนใหม่ในพื้นที่ทำงาน อย่างไรก็ตามหากจำเป็น นักพัฒนาสามารถกำหนดค่าคุณลักษณะนี้เพื่ออนุญาตให้ฝังแอปเฉพาะบางหน้าได้โดยใช้วิธีการดังต่อไปนี้:

- **isPowerAppPersonalizationEnabled** – หากวิธีนี้คืนค่าเท็จสำหรับหน้าเฉพาะ ปุ่มเมนู Power Apps จะไม่ปรากฏขึ้น และผู้ใช้จะไม่สามารถฝังแอปที่ใดก็ได้ในหน้านี้รวมถึงที่เป็นแท็บ
- **isPowerAppTabPersonalizationEnabled** – หากวิธีนี้คืนค่าเท็จสำหรับหน้าเฉพาะ ผู้ใช้จะไม่สามารถฝังแอปโดยตรงบนหน้าที่เป็นแท็บ FastTab หรือส่วนรูปแบบพาโนรามา ผู้ใช้จะยังคงสามารถฝังแอปผ่านปุ่มเมนู Power Apps หากการฝังได้รับอนุญาตบนหน้านั้น

ตัวอย่างต่อไปนี้แสดงคลาสใหม่ที่มีสองวิธีที่จำเป็นในการกำหนดค่าที่ที่สามารถฝังแอปได้

```powerapps
[ExtensionOf(classStr(FormRunConfigurationPowerAppsConfiguration))]

public final class ClassTest_Extension
{
    public static boolean isPowerAppPersonalizationEnabled(str pageName)
    {
        var result = next isPowerAppPersonalizationEnabled(pageName);
        return result;
    }
    
    public static boolean isPowerAppTabPersonalizationEnabled(str pageName)
    {
        var result = next isPowerAppTabPersonalizationEnabled(pageName);
        return result;
    }
}
```
