---
title: งานล้างข้อมูลรายการคงเหลือสำหรับการจัดการคลังสินค้า
description: หัวข้อนี้จะอธิบายงานล้างข้อมูลรายการคงเหลือ ซึ่งช่วยปรับปรุงประสิทธิภาพของระบบโดยการระบุและการลบเรกคอร์ดที่เกี่ยวข้อง แต่ไม่จำเป็น
author: perlynne
manager: tfehr
ms.date: 04/23/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: SysOperationTemplateForm
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: perlynne
ms.search.validFrom: 2020-04-03
ms.dyn365.ops.version: Release 10.0.12
ms.openlocfilehash: 93c77434a912554dab486b42c0c9fffd68cf9435
ms.sourcegitcommit: eaf330dbee1db96c20d5ac479f007747bea079eb
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 02/15/2021
ms.locfileid: "5226014"
---
# <a name="warehouse-management-on-hand-entries-cleanup-job"></a><span data-ttu-id="16c02-103">งานล้างข้อมูลรายการคงเหลือสำหรับการจัดการคลังสินค้า</span><span class="sxs-lookup"><span data-stu-id="16c02-103">Warehouse management on-hand entries cleanup job</span></span>

<span data-ttu-id="16c02-104">ประสิทธิภาพของการสอบถามที่ใช้ในการคำนวณปริมาณคงคลังคงเหลือจะได้รับผลกระทบจากจำนวนของเรกคอร์ดในตารางที่เกี่ยวข้อง</span><span class="sxs-lookup"><span data-stu-id="16c02-104">The performance of queries that are used to calculate on-hand inventory is affected by the number of records in the tables that are involved.</span></span> <span data-ttu-id="16c02-105">วิธีหนึ่งที่จะช่วยปรับปรุงประสิทธิภาพการทำงานคือ ลดจำนวนเรกคอร์ดที่ฐานข้อมูลต้องพิจารณา</span><span class="sxs-lookup"><span data-stu-id="16c02-105">One way to help improve the performance is to reduce the number of records that the database must consider.</span></span>

<span data-ttu-id="16c02-106">หัวข้อนี้อธิบายงานล้างข้อมูลรายการคงเหลือ ซึ่งลบเรกคอร์ดที่ไม่จำเป็นในตาราง InventSum และ WHSInventReserve</span><span class="sxs-lookup"><span data-stu-id="16c02-106">This topic describes the on-hand entries cleanup job, which deletes unneeded records in the InventSum and WHSInventReserve tables.</span></span> <span data-ttu-id="16c02-107">ตารางเหล่านี้จัดเก็บข้อมูลปริมาณคงคลังคงเหลือสำหรับสินค้าที่เปิดใช้งานสำหรับการประมวลผลการจัดการคลังสินค้า</span><span class="sxs-lookup"><span data-stu-id="16c02-107">These tables store on-hand information for items that are enabled for warehouse management processing.</span></span> <span data-ttu-id="16c02-108">(สินค้าเหล่านี้เรียกว่าสินค้า WHS) การลบเรกคอร์ดเหล่านี้อาจปรับปรุงประสิทธิภาพการทำงานของการคำนวณปริมาณคงคลังคงเหลืออย่างมาก</span><span class="sxs-lookup"><span data-stu-id="16c02-108">(These items are referred to as WHS items.) Deletion of these records can significantly improve the performance of on-hand calculations.</span></span>

## <a name="what-the-cleanup-job-does"></a><span data-ttu-id="16c02-109">งานการล้างข้อมูลมีอะไรบ้าง</span><span class="sxs-lookup"><span data-stu-id="16c02-109">What the cleanup job does</span></span>

<span data-ttu-id="16c02-110">งานล้างข้อมูลรายการคงเหลือจะลบเรกคอร์ดใดๆ ในตาราง WHSInventReserve และ InventSum ซึ่งค่าฟิลด์ทั้งหมดเป็น *0* (ศูนย์)</span><span class="sxs-lookup"><span data-stu-id="16c02-110">The on-hand entries cleanup job deletes any records in the WHSInventReserve and InventSum tables where all the field values are *0* (zero).</span></span> <span data-ttu-id="16c02-111">คุณสามารถลบเรกคอร์ดเหล่านี้ได้ เนื่องจากไม่มีส่วนร่วมกับข้อมูลปริมาณคงคลังคงเหลือ</span><span class="sxs-lookup"><span data-stu-id="16c02-111">These records can be deleted because they don't contribute to the on-hand information.</span></span> <span data-ttu-id="16c02-112">งานจะลบเฉพาะเรกคอร์ดที่อยู่ใต้ระดับ **ที่ตั้ง**</span><span class="sxs-lookup"><span data-stu-id="16c02-112">The job deletes only records that are below the **Location** level.</span></span>

<span data-ttu-id="16c02-113">ถ้าอนุญาตให้มีสินค้าคงคลังที่มีอยู่จริงที่เป็นค่าลบ งานการล้างข้อมูลอาจไม่สามารถลบรายการที่เกี่ยวข้องทั้งหมดได้</span><span class="sxs-lookup"><span data-stu-id="16c02-113">If negative physical inventory is allowed, the cleanup job might not be able to delete all the relevant entries.</span></span> <span data-ttu-id="16c02-114">เหตุผลสำหรับข้อจำกัดนี้คืองานต้องอนุญาตสำหรับสถานการณ์จำลองพิเศษ ซึ่งป้ายทะเบียนมีหลายหมายเลขลำดับประจำสินค้า และหนึ่งในหมายเลขลำดับประจำสินค้าจะกลายเป็นค่าลบ</span><span class="sxs-lookup"><span data-stu-id="16c02-114">The reason for this limitation is that the job must allow for a special scenario where a license plate has multiple serial numbers, and one of those serial numbers has become negative.</span></span> <span data-ttu-id="16c02-115">ตัวอย่างเช่น ระบบจะมีปริมาณคงคลังคงเหลือเป็นศูนย์ที่ระดับป้ายทะเบียน เมื่อป้ายทะเบียนมี +1 ชิ้นเป็นเครื่องหมายเลขลำดับประจำสินค้า 1 และ – 1 ชิ้น เป็นหมายเลขลำดับประจำสินค้า 2</span><span class="sxs-lookup"><span data-stu-id="16c02-115">For example, the system will have zero on hand at the license plate level when a license plate has +1 pcs of serial number 1 and –1 pcs of serial number 2.</span></span> <span data-ttu-id="16c02-116">สำหรับสถานการณ์จำลองพิเศษนี้ งานจะเป็นการลบแบบกว้างครั้งแรก ซึ่งจะพยายามลบออกจากระดับที่ต่ำกว่าก่อน</span><span class="sxs-lookup"><span data-stu-id="16c02-116">For this special scenario, the job does a breadth-first deletion, where it tries to delete from lower levels first.</span></span>

## <a name="schedule-and-configure-the-cleanup-job"></a><span data-ttu-id="16c02-117">จัดกำหนดการและตั้งค่าคอนฟิกงานการล้างข้อมูล</span><span class="sxs-lookup"><span data-stu-id="16c02-117">Schedule and configure the cleanup job</span></span>

<span data-ttu-id="16c02-118">งานการล้างข้อมูลรายการคงเหลือจะพร้อมใช้งานที่ **การจัดการสินค้าคงคลัง \> งานประจำงวด \> การล้างข้อมูล \> การล้างข้อมูลรายการคงเหลือสำหรับการจัดการคลังสินค้า**</span><span class="sxs-lookup"><span data-stu-id="16c02-118">The on-hand entries cleanup job is available at **Inventory management \> Periodic tasks \> Clean up \> Warehouse management on-hand entries cleanup**.</span></span> <span data-ttu-id="16c02-119">ใช้การตั้งค่างานมาตรฐานเพื่อควบคุมขอบเขตและกำหนดการสำหรับการเรียกใช้งาน</span><span class="sxs-lookup"><span data-stu-id="16c02-119">Use the standard job settings to control the scope and schedule for running the job.</span></span> <span data-ttu-id="16c02-120">นอกจากนี้ ยังมีการตั้งค่าต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="16c02-120">In addition, the following settings are provided:</span></span>

- <span data-ttu-id="16c02-121">**ลบถ้าไม่มีการอัปเดตเป็นเวลาหลายวัน** – ป้อนจำนวนวันต่ำสุดที่งานควรรอก่อนที่จะลบรายการคงเหลือที่ลดลงเป็นศูนย์</span><span class="sxs-lookup"><span data-stu-id="16c02-121">**Delete if not updated for this many days** – Enter the minimum number of days that the job should wait before it deletes an on-hand entry that has dropped to zero quantity.</span></span> <span data-ttu-id="16c02-122">ใช้การตั้งค่านี้เพื่อช่วยลดความเสี่ยงในการลบรายการปริมาณคงเหลือที่ยังคงใช้อยู่</span><span class="sxs-lookup"><span data-stu-id="16c02-122">Use this setting to help reduce the risk of deleting on-hand entries that are still being used.</span></span> <span data-ttu-id="16c02-123">ถ้าคุณต้องการให้การล้างข้อมูลเกิดขึ้นโดยเร็วที่สุด ให้ป้อน *0* (ศูนย์) หรือปล่อยฟิลด์นี้ว่างไว้</span><span class="sxs-lookup"><span data-stu-id="16c02-123">If you want cleanup to occur as soon as possible, either enter *0* (zero) or leave the field blank.</span></span>
- <span data-ttu-id="16c02-124">**เวลาที่ใช้ในการดำเนินการสูงสุด (ชั่วโมง)** – ป้อนเวลาดำเนินการสูงสุดของงานการล้างข้อมูล ในหน่วยชั่วโมง</span><span class="sxs-lookup"><span data-stu-id="16c02-124">**Maximum execution time (hours)** – Enter the maximum execution time of the cleanup job, in hours.</span></span> <span data-ttu-id="16c02-125">ถ้างานดำเนินการไม่เสร็จสมบูรณ์ก่อนเวลาดำเนินการสูงสุดผ่านไป ระบบจะบันทึกงานที่เสร็จสมบูรณ์แล้วจึงปิดตัวเอง</span><span class="sxs-lookup"><span data-stu-id="16c02-125">If the job isn't completed before this time passes, it will save the work that it has completed so far and then close itself.</span></span> <span data-ttu-id="16c02-126">ความสามารถนี้มีความเกี่ยวข้องโดยเฉพาะอย่างยิ่งสำหรับการใช้งานที่มีการใช้สินค้าคงคลังสูง</span><span class="sxs-lookup"><span data-stu-id="16c02-126">This capability is especially relevant for implementations that have high inventory use.</span></span> <span data-ttu-id="16c02-127">ในกรณีเหล่านี้ คุณควรจัดตารางเวลางานให้เรียกใช้บางครั้ง เมื่อการโหลดของระบบเบาที่สุดเท่าที่จะเป็นไปได้</span><span class="sxs-lookup"><span data-stu-id="16c02-127">In these cases, you should schedule the job to run at times when the system load is as light as possible.</span></span> <span data-ttu-id="16c02-128">ถ้าคุณต้องการให้ชุดงานดำเนินการต่อไปจนกว่าจะเสร็จสมบูรณ์ ให้ป้อน *0* (ศูนย์) หรือปล่อยฟิลด์นี้ว่างไว้</span><span class="sxs-lookup"><span data-stu-id="16c02-128">If you want the batch job to continue to run until it's completed, either enter *0* (zero) or leave the field blank.</span></span> <span data-ttu-id="16c02-129">การตั้งค่านี้จะพร้อมใช้งานเฉพาะเมื่องานลักษณะการทำงานที่เกี่ยวข้อง [มีการเปิดใช้ในระบบของคุณ](#max-execution-time) เท่านั้น</span><span class="sxs-lookup"><span data-stu-id="16c02-129">This setting is available only if the related feature has been [turned on in your system](#max-execution-time).</span></span>

<span data-ttu-id="16c02-130">ถึงแม้ว่าคุณจะสามารถเรียกใช้งานได้ในช่วงเวลาทำการปกติ เราขอแนะนำให้คุณเรียกใช้งานนอกเวลาทำงาน</span><span class="sxs-lookup"><span data-stu-id="16c02-130">Although you can run the job during regular business hours, we recommend that you run it outside working hours.</span></span> <span data-ttu-id="16c02-131">ด้วยวิธีนี้ คุณจะช่วยป้องกันความขัดแย้งที่อาจเกิดขึ้นได้ ถ้าผู้ใช้กำลังทำงานกับเรกคอร์ดที่กำลังล้างข้อมูล</span><span class="sxs-lookup"><span data-stu-id="16c02-131">In this way, you help prevent conflicts that can occur if a user is working with a record that is also being cleaned up.</span></span>

<span data-ttu-id="16c02-132">ถ้างานพยายามลบเรกคอร์ดสำหรับสินค้าในขณะที่มีการใช้เรกคอร์ดดังกล่าวโดยผู้ใช้รายอื่นข้อผิดพลาดการชะงักงันจะเกิดขึ้นสำหรับงานการล้างข้อมูล หรือผู้ใช้</span><span class="sxs-lookup"><span data-stu-id="16c02-132">If the job tries to delete a record for an item while that record is being used by another user, a deadlock error occurs for either the cleanup job or the user.</span></span>

<span data-ttu-id="16c02-133">เมื่องานรัน งานจะมีขนาดที่ยืนยันเป็น 100</span><span class="sxs-lookup"><span data-stu-id="16c02-133">When the job runs, it has a commit size of 100.</span></span> <span data-ttu-id="16c02-134">กล่าวอีกอย่างหนึ่งคือ จะพยายามยืนยันครั้งเดียวสำหรับทุกการลบ 100 ครั้ง</span><span class="sxs-lookup"><span data-stu-id="16c02-134">In other words, it will try to commit one time for every 100 deletions.</span></span> <span data-ttu-id="16c02-135">อย่างไรก็ตาม เนื่องจากมีการลบบางอย่างที่มีการตั้งค่าอยู่ อาจมีเหตุการณ์ที่มากกว่า 100 เรกคอร์ดสามารถลบออกได้ในธุรกรรมเดียวกัน</span><span class="sxs-lookup"><span data-stu-id="16c02-135">However, because some deletions are set-based, there might be scenarios where more than 100 records can be deleted in the same transaction.</span></span> <span data-ttu-id="16c02-136">ดังนั้น การเลื่อนระดับล็อคยังคงอาจเกิดขึ้นในบางครั้ง</span><span class="sxs-lookup"><span data-stu-id="16c02-136">Therefore, lock escalations can still sometimes occur.</span></span>

## <a name="possible-user-impact"></a><span data-ttu-id="16c02-137">ผลกระทบของผู้ใช้ที่เป็นไปได้</span><span class="sxs-lookup"><span data-stu-id="16c02-137">Possible user impact</span></span>

<span data-ttu-id="16c02-138">ผู้ใช้อาจได้รับผลกระทบ หากงานล้างข้อมูลรายการคงเหลือลบเรกคอร์ดทั้งหมดสำหรับระดับที่กำหนด (เช่น ระดับป้ายทะเบียน)</span><span class="sxs-lookup"><span data-stu-id="16c02-138">Users might be affected if the on-hand entries cleanup job deletes all the records for a given level (such as the license plate level).</span></span> <span data-ttu-id="16c02-139">ในกรณีนี้ ฟังก์ชันสำหรับการดูสินค้าคงคลังที่มีอยู่ก่อนหน้านี้พร้อมใช้งานบนป้ายทะเบียนอาจไม่ทำงานตามที่คาดไว้ เนื่องจากไม่มีรายการคงเหลือที่เกี่ยวข้องอีกต่อไป</span><span class="sxs-lookup"><span data-stu-id="16c02-139">In this case, the functionality for seeing that inventory was previously available on-hand at a license plate might not work as expected because the relevant on-hand entries are no longer available.</span></span> <span data-ttu-id="16c02-140">ตัวอย่างเช่น สามารถพบได้ในกรณีต่อไปนี้</span><span class="sxs-lookup"><span data-stu-id="16c02-140">This can, for example, be experienced in the following situations:</span></span>

- <span data-ttu-id="16c02-141">ในรายการ **รายการปริมาณคงคลังคงเหลือ** เมื่อผู้ใช้ยกเลิกการเลือกเงื่อนไข **ปริมาณ \<\> 0** หรือเลือกธุรกรรมที่ **ปิดเงื่อนไข** ในการตั้งค่า **การแสดงมิติ**</span><span class="sxs-lookup"><span data-stu-id="16c02-141">On the **On-hand list**, when the user deselects the condition **Quantity \<\> 0** or selects the condition **Closed transactions** in the **Dimensions display** settings.</span></span>
- <span data-ttu-id="16c02-142">ในรายงาน **สินค้าคงคลังทางกายภาพตามมิติสินค้าคงคลัง** ในรอบระยะเวลาที่ผ่านมา เมื่อผู้ใช้ตั้งค่าพารามิเตอร์ **ณ วันที่**</span><span class="sxs-lookup"><span data-stu-id="16c02-142">In a **Physical inventory by inventory dimension** report for past periods, when the user sets the **As of date** parameter.</span></span>

<span data-ttu-id="16c02-143">อย่างไรก็ตาม การปรับปรุงประสิทธิภาพที่งานการล้างข้อมูลมีควรรวมไว้เป็นขาดทุนเล็กๆ เหล่านี้ในฟังก์ชันการล้างข้อมูล</span><span class="sxs-lookup"><span data-stu-id="16c02-143">However, the performance improvement that the cleanup job provides should make up for these small losses in functionality.</span></span>

## <a name="make-the-maximum-execution-time-setting-available"></a><a name="max-execution-time"></a> <span data-ttu-id="16c02-144">ทำให้การตั้งค่าเวลาดำเนินการสูงสุดพร้อมใช้งาน</span><span class="sxs-lookup"><span data-stu-id="16c02-144">Make the Maximum execution time setting available</span></span>

<span data-ttu-id="16c02-145">โดยค่าเริ่มต้น การตั้งค่า **เวลาดำเนินการสูงสุด** ไม่พร้อมใช้งาน</span><span class="sxs-lookup"><span data-stu-id="16c02-145">By default, the **Maximum execution time** setting isn't available.</span></span> <span data-ttu-id="16c02-146">ถ้าคุณต้องการใช้ คุณต้องใช้ [การจัดการลักษณะการทำงาน](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) เพื่อเปิดใช้งานลักษณะการทำงานที่เกี่ยวข้องในระบบของคุณ</span><span class="sxs-lookup"><span data-stu-id="16c02-146">If you want to use it, you must use [feature management](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) to turn on the related feature in your system.</span></span> <span data-ttu-id="16c02-147">ในพื้นที่ทำงาน **การจัดการคุณลักษณะ** มีการแสดงรายการคุณลักษณะในวิธีต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="16c02-147">In the **Feature management** workspace, the feature is listed in the following way:</span></span>

- <span data-ttu-id="16c02-148">**โมดูล:** *การจัดการคลังสินค้า*</span><span class="sxs-lookup"><span data-stu-id="16c02-148">**Module:** *Warehouse management*</span></span>
- <span data-ttu-id="16c02-149">**ชื่อลักษณะการทำงาน:** *เวลาที่ใช้ในการดำเนินการสูงสุดสำหรับงานล้างข้อมูลรายการคงเหลือของการจัดการคลังสินค้า*</span><span class="sxs-lookup"><span data-stu-id="16c02-149">**Feature name:** *Maximum execution time for the warehouse management on-hand entries cleanup job*</span></span>


[!INCLUDE[footer-include](../../includes/footer-banner.md)]