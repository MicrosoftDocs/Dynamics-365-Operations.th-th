---
title: "การซิงโครไนส์ของใบสั่งขายโดยตรงระหว่าง Sales และ Finance and Operations"
description: "หัวข้อนี้กล่าวถึงเท็มเพลตและงานพื้นฐานที่จะใช้ในการซิงโครไนส์ใบสั่งขายโดยตรงระหว่าง Microsoft Dynamics 365 for Sales และ Microsoft Dynamics 365 for Finance and Operations"
author: ChristianRytt
manager: AnnBe
ms.date: 03/13/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
ms.search.form: 
audience: Application User, IT Pro
ms.reviewer: yuyus
ms.search.scope: Core, Operations
ms.custom: 
ms.assetid: 
ms.search.region: global
ms.search.industry: 
ms.author: crytt
ms.dyn365.ops.version: July 2017 update
ms.search.validFrom: 2017-07-8
ms.translationtype: HT
ms.sourcegitcommit: a0739304723d19b910388893d08e8c36a1f49d13
ms.openlocfilehash: e26244ffc380291a40edfbd2c2cb5911b0d8b3cb
ms.contentlocale: th-th
ms.lasthandoff: 03/26/2018

---

# <a name="synchronization-of-sales-orders-directly-between-sales-and-finance-and-operations"></a>การซิงโครไนส์ของใบสั่งขายโดยตรงระหว่าง Sales และ Finance and Operations

[!INCLUDE [banner](../includes/banner.md)]

หัวข้อนี้กล่าวถึงเท็มเพลตและงานพื้นฐานที่จะใช้ในการซิงโครไนส์ใบสั่งขายโดยตรงระหว่าง Microsoft Dynamics 365 for Sales และ Microsoft Dynamics 365 for Finance and Operations

## <a name="templates-and-tasks"></a>เท็มเพลตและงาน

เมื่อต้องการเข้าถึงเท็มเพลตที่พร้อมใช้งาน เปิด [ศูนย์การจัดการ PowerApps](https://preview.admin.powerapps.com/dataintegration) เลือก **โครงการ** จากนั้น ในมุมบนด้านขวา เลือก **โครงการใหม่** เพื่อเลือกเท็มเพลตสาธารณะ

เท็มเพลตและงานพื้นฐานต่อไปนี้จะถูกใช้ในการซิงโครไนส์ใบสั่งขายโดยตรงระหว่าง Sales และ Finance and Operations:

- **ชื่อของเท็มเพลตในการรวมข้อมูล:** 

    - ใบสั่งขาย (Sales ไปยัง Fin and Ops) - ตรง
    - ใบสั่งขาย (Fin and Ops ไปยัง Sales) - ตรง

- **ชื่อของงานในโครงการการรวมข้อมูล:**

    - OrderHeader
    - OrderLine

จำเป็นต้องทำงานการซิงโครไนส์ต่อไปนี้ก่อน จึงจะสามารถดำเนินการซิงโครไนส์ของส่วนหัวและรายการของใบแจ้งหนี้การขายได้:

- ผลิตภัณฑ์ (Fin and Ops ไปยัง Sales) - ตรง
- บัญชี (Sales ไปยัง Fin and Ops) - ตรง (ถ้าใช้)
- ผู้ติดต่อไปยังลูกค้า (Sales ไปยัง Fin and Ops) - ตรง (ถ้าใช้)

## <a name="entity-set"></a>การตั้งค่าเอนทิตี้

| Finance and Operations  | ใบสั่งขาย             |
|-------------------------|-------------------|
| ส่วนหัวของใบสั่งขาย CDS | SalesOrders       |
| รายการในใบสั่งขาย CDS   | SalesOrderDetails |

## <a name="entity-flow"></a>ขั้นตอนเอนทิตี้

มีการสร้างใบสั่งขายใน Sales และมีการซิงโครไนส์ไปยัง Finance and Operations เมื่อมีการทริกเกอร์ **รันโครงการ** สำหรับโครงการที่ขึ้นกับเท็มเพลต **ใบสั่งขาย (Sales ไปยัง Fin and Ops)** คุณสามารถเรียกใช้และซิงโครไนส์ใบสั่งขายจาก Sales ได้เท่านั้น เมื่อ **สั่งซื้อผลิตภัณฑ์** ประกอบด้วยผลิตภัณฑ์ที่ถูกจัดเก็บอยู่ภายนอก ดังนั้น จึงอาจไม่มีผลิตภัณฑ์ที่เขียนเพิ่ม หลังจากที่มีการเรียกใช้ใบสั่ง ใบสั่งขายกลายเป็นแบบอ่านอย่างเดียวในอินเทอร์เฟสผู้ใช้ (UI) ณ จุดนั้น โปรแกรมปรับปรุงถูกสร้างจาก Finance and Operations หลังจากที่ใบสั่งขายที่มีสถานะเป็น **ยืนยันแล้ว** โครงการที่ขึ้นกับเท็มเพลต **ใบสั่งขาย (Fin and Ops ไปยัง Sales) - ตรง** สามารถถูกใช้ในการซิงโครไนส์การอัพเดตหรือสถานะการเติมสินค้าจาก Finance and Operations ไปยัง Sales

คุณไม่ต้องสร้างใบสั่งใน Sales คุณสามารถสร้างใบสั่งขายใหม่ขึ้นได้ใน Finance and Operations แทน หลังจากที่ใบสั่งขายที่มีสถานะเป็น **ยืนยันแล้ว** จะถูกซิงโครไนส์กับการขายตามที่อธิบายไว้ในย่อหน้าก่อนหน้านี้

ใน Finance and Operations ตัวกรองในเท็มเพลตช่วยรับรองว่า เฉพาะใบสั่งขายที่เกี่ยวข้องเท่านั้นจะถูกรวมอยู่ในการซิงโครไนส์:

- ในใบสั่งขาย ทั้งลูกค้าที่สั่งซื้อและที่ออกใบแจ้งหนี้ต้องมีต้นกำเนิดมาจาก Sales ที่จะถูกรวมอยู่ในการซิงโครไนส์ ใน Finance and Operations ฟิลด์ **OrderingCustomerIsExternallyMaintained** และ **InvoiceCustomerIsExternallyMaintained** ถูกใช้ในการกรองใบสั่งขายจากเอนทิตีข้อมูล
- ใบสั่งขายใน Finance and Operations ต้องได้รับการยืนยัน เฉพาะใบสั่งขายที่ยืนยันแล้วหรือใบสั่งขายที่มีสถานะการประมวลผลสูง เช่น **จัดส่งแล้ว** หรือ **ออกใบแจ้งหนี้แล้ว** จะถูกซิงค์ไปยัง Sales
- หลังจากสร้างหรือปรับเปลี่ยนใบสั่งขาย ชุดงาน **คำนวณยอดขายรวม** ใน Finance and Operations จะต้องถูกดำเนินการ ใบสั่งขายที่ซึ่งยอดขายรวมถูกคำนวณเท่านั้น จะถูกซิงโครไนส์กับ Sales

## <a name="freight-tax"></a>อัตราภาษีค่าขนส่ง

Sales ไม่สนับสนุนภาษีที่ระดับส่วนหน้า เนื่องจากมีการจัดเก็บภาษีในระดับรายการ เพื่อสนับสนุนภาษีที่ระดับส่วนหน้าจาก Finance and Operations เช่น ภาษีในค่าขนส่ง ระบบจะซิงโครไนส์ภาษีไปยัง Sales เป็นผลิตภัณฑ์เขียนเพิ่มที่ชื่อ **ภาษีค่าขนส่ง** และที่มียอดภาษีจาก Finance and Operations ด้วยวิธีนี้ การคำนวณราคามาตรฐานใน Sales สามารถถูกใช้สำหรับผลรวมได้ แม้ว่าจะมีภาษีที่ระดับส่วนหน้าจาก Finance and Operations

## <a name="discount-calculation-and-rounding"></a>การคำนวณส่วนลดและการปัดเศษ

รูปแบบการคำนวณส่วนลดใน Sales แตกต่างจากแบบจำลองการคำนวณส่วนลดใน Finance and Operations ใน Finance and Operations ยอดส่วนลดขั้นสุดท้ายในรายการขายอาจเป็นผลของชุดของเปอร์เซ็นต์ส่วนลดและยอดส่วนลด ถ้ายอดเงินส่วนลดขั้นสุดท้ายนี้ถูกหารด้วยปริมาณในรายการ การปัดเศษสามารถเกิดขึ้นได้ อย่างไรก็ตาม การปัดเศษนี้จะไม่ถูกพิจารณา หากยอดส่วนลดที่ถูกปัดเศษถูกซิงโครไนส์กับ Sales เพื่อช่วยรับรองว่า ยอดเงินส่วนลดทั้งหมดจากรายการขายใน Finance and Operations ถูกซิงโครไนส์กับ Sales อย่างถูกต้อง ยอดเงินเต็มจำนวนต้องถูกซิงโครไนส์โดยไม่มีการหารด้วยปริมาณสำหรับรายการ ดังนั้น คุณต้องกำหนด **วิธีการคำนวณส่วนลด** เป็น **สินค้าในรายการ** ใน Sales

เมื่อมีการซิงโครไนส์รายการใบสั่งขายจาก Sales ไปยัง Finance and Operations จะมีการใช้ยอดส่วนลดในรายการเต็มจำนวน เนื่องจาก Finance and Operations ไม่มีฟิลด์ที่สามารถจัดเก็บยอดส่วนลดเต็มจำนวนสำหรับรายการได้ ปริมาณถูกหารด้วยปริมาณและจัดเก็บไว้ในฟิลด์ **ส่วนลดต่อรายการ** การปัดเศษใดๆ ที่เกิดขึ้นระหว่างการหารนี้ จะถูกจัดเก็บในฟิลด์ **ค่าธรรมเนียมการขาย** ในรายการขาย

### <a name="example"></a>ตัวอย่าง

**การซิงโครไนส์จาก Sales ไปยัง Finance and Operations**

- **Sales:** ปริมาณ = 3 ส่วนลดต่อรายการ = $10.00
- **Finance and Operations:**ปริมาณ = 3 ยอดเงินส่วนลดต่อรายการ = $3.33 ค่าธรรมเนียมการขาย =-$0.01 

**การซิงโครไนส์จาก Finance and Operations ไปยัง Sales**

- **Finance and Operations:**ปริมาณ = 3 ยอดเงินส่วนลดต่อรายการ = $3.33 ค่าธรรมเนียมการขาย =-$0.01
- **Sales:** ปริมาณ = 3 ส่วนลดต่อรายการ = (3 × $3.33) + $0.01 = $10.00

## <a name="prospect-to-cash-solution-for-sales"></a>โซลูชันผู้ที่มีแนวโน้มจะเป็นลูกค้าเป็นเงินสดสำหรับ Sales

ฟิลด์ใหม่ได้ถูกเพิ่มลงในเอนทิตี้ **ใบสั่ง** และแสดงขึ้นบนหน้า:

- **ถูกรักษาไว้ภายนอก** – ตั้งค่าตัวเลือกนี้เป็น **ใช่** เมื่อใบสั่งมาจาก Finance and Operations
- **สถานะการประมวลผล** – ฟิลด์นี้แสดงสถานะการประมวลผลใบสั่งใน Finance and Operations ค่าที่พร้อมใช้งานมีดังต่อไปนี้

    - **ร่าง** – สถานะเริ่มต้นเมื่อใบสั่งถูกสร้างขึ้นใน Sales ใน Sales เฉพาะใบสั่งที่มีสถานะการประมวลผลนี้เท่านั้นสามารถถูกแก้ไขได้
    - **เปิดใช้งาน** – สถานะหลังจากใบสั่งถูกเรียกใช้ใน Sales โดยการใช้ปุ่ม **เรียกใช้**
    - **วันที่ยืนยัน**
    - **บันทึกการจัดส่ง**
    - **ออกใบแจ้งหนี้แล้ว**
    - **เบิกสินค้าแล้ว**
    - **เบิกสินค้าแล้วบางส่วน**
    - **บรรจุแล้วบางส่วน**
    - **จัดส่งสินค้าแล้ว**
    - **จัดส่งแล้วบางส่วน**
    - **ออกใบแจ้งหนี้แล้วบางส่วน**
    - **ยกเลิก**

การตั้งค่า **มีเฉพาะผลิตภัณฑ์ที่รักษาไว้ภายนอก** ถูกใช้ในระหว่างการเรียกใช้ใบสั่ง เพื่อติดตามได้อย่างสม่ำเสมอว่าใบสั่งขายประกอบด้วยผลิตภัณฑ์ที่รักษาไว้ภายนอกทั้งหมดหรือไม่ ถ้าใบสั่งขายประกอบด้วยผลิตภัณฑ์ที่รักษาไว้ภายนอกทั้งหมด ผลิตภัณฑ์จะมีการจัดเก็บอยู่ใน Finance and Operations การตั้งค่าระบบนี้ช่วยรับประกันว่า คุณจะไม่เรียกใช้และพยายามที่จะซิงโครไนส์รายการใบสั่งขายที่มีผลิตภัณฑ์ที่ไม่รู้จักใน Finance and Operations

ปุ่ม **สร้างใบแจ้งหนี้** **ยกเลิกใบสั่ง** **คำนวณใหม่** **เรียกดูผลิตภัณฑ์** และ **ค้นหาที่อยู่** บนหน้า **ใบสั่งขาย** ถูกซ่อนไว้สำหรับใบสั่งที่รักษาไว้ภายนอก เนื่องจากใบแจ้งหนี้จะถูกสร้างขึ้นใน Finance and Operations และซิงค์ไปยัง Sales ใบสั่งเหล่านี้จะไม่สามารถถูกแก้ไขได้ เนื่องจากข้อมูลในใบสั่งขายจะถูกซิงโครไนส์จาก Finance and Operations หลังจากการเรียกใช้

สถานะของใบสั่งขายจะยังคง **ใช้งานอยู่** เพื่อช่วยรับประกันว่า การเปลี่ยนแปลงจาก Finance and Operations สามารถดำเนินไปยังใบสั่งขายใน Sales ได้ เพื่อควบคุมลักษณะการทำงานนี้ ตั้งค่าค่า **Statecode \[สถานะ\]** เริ่มต้น เป็น **ใช้งานอยู่** ในโครงการการรวมข้อมูล

## <a name="preconditions-and-mapping-setup"></a>การตั้งค่าเงื่อนไขเบื้องต้นและการแม็ป

ก่อนที่คุณจะซิงโครไนส์ใบสั่งขาย จำเป็นที่คุณต้องปรับปรุงการตั้งค่าต่อไปนี้ในระบบ:

### <a name="setup-in-sales"></a>การตั้งค่าใน Sales

- ต้องแน่ใจว่ามีการตั้งค่าสิทธิ์สำหรับทีมงานที่ผู้ใช้จากชุดการเชื่อมต่อของคุณใน Sales ถูกกำหนดให้ ถ้าคุณกำลังใช้ข้อมูลสาธิต โดยปกติผู้ใช้จะมีการเข้าถึงของผู้ดูแลระบบ แต่ทีมงานจะไม่มีการเข้าถึงของผู้ดูแลระบบ ถ้าทีมงานไม่มีการเข้าถึงของผู้ดูแลระบบ เมื่อคุณรันโครงการจากการรวมข้อมูล คุณจะได้รับข้อความแสดงข้อผิดพลาดที่แจ้งว่า หลักทีมงานขาดหายไป

    ไปที่ **การตั้งค่า** &gt; **ความปลอดภัย** &gt; **ทีมงาน** เลือกทีมที่เกี่ยวข้อง เลือก **จัดการบทบาท** และเลือกบทบาทที่มีสิทธิ์ที่เหมาะสม เช่น **ผู้ดูแลระบบ**

- เพื่อให้แน่ใจว่าการคำนวณส่วนลดในทั้ง Sales and Finance and Operations ถูกต้อง **วิธีการคำนวณส่วนลด** ต้องถูกกำหนดเป็น **สินค้าในรายการ**
- ไปยัง **การตั้งค่า** &gt; **การจัดการ** &gt; **การตั้งค่าระบบ** &gt; **Sales** และต้องมั่นใจว่ามีใช้การตั้งค่าต่อไปนี้:

    - ตัวเลือก **ใช้ระบบคำนวณการให้รางวัล** ถูกตั้งค่าเป็น **ใช่**
    - ฟิลด์ **วิธีการคำนวณส่วนลด** ถูกกำหนดเป็น **สินค้าในรายการ**

### <a name="setup-in-finance-and-operations"></a>ตั้งค่าใน Finance and Operations

- ไปยัง **การขายและการตลาด** &gt; **งานประจำงวด** &gt; **คำนวณยอดขายรวม** และตั้งค่างานที่จะรันเป็นชุดงาน ตั้งค่าตัวเลือก **คำนวณผลรวมสำหรับใบสั่งขาย** เป็น **ใช่** ขั้นตอนนี้สำคัญ เนื่องจากเฉพาะใบสั่งขายที่ซึ่งยอดขายรวมถูกคำนวณ จะถูกซิงโครไนส์กับ Sales ความถี่ของชุดงานควรถูกปรับให้เข้ากับความถี่ของการซิงโครไนส์ใบสั่งขาย

### <a name="setup-in-the-sales-orders-sales-to-fin-and-ops---direct-data-integration-project"></a>การตั้งค่าในใบสั่งขาย (Sales ไปยัง Fin and Ops) - โครงการการรวมข้อมูลโดยตรง

- ต้องแน่ใจว่าการแม็ปที่ต้องการ มีอยู่สำหรับ **Shipto\_country** ไปยัง **DeliveryAddressCountryRegionISOCode** คุณสามารถทำให้ค่าเริ่มต้นว่างเปล่าได้ในแผนผังค่า เพื่อหลีกเลี่ยงการพิมพ์ประเทศสำหรับใบสั่งประจำชาติ ตั้งค่าด้านซ้ายเป็น 'ว่าง' และตั้งค่าด้านขวาเป็นประเทศหรือภูมิภาคที่ต้องการ

    ค่าของเท็มเพลตคือ แผนผังค่าที่มีการแม็ปหลายประเทศหรือภูมิภาค และที่ซึ่ง 'ว่าง' = US

### <a name="setup-in-the-sales-orders-fin-and-ops-to-sales---direct-data-integration-project"></a>การตั้งค่าในใบสั่งขาย (Fin and Ops ไปยัง Sales) - โครงการการรวมข้อมูลโดยตรง

#### <a name="salesheader-task"></a>งาน SalesHeader

- จำเป็นต้องใช้รายการราคาเพื่อสร้างใบสั่งใน Sales อัพเดตแผนผังค่าสำหรับ **pricelevelid.name \[ชื่อรายการราคา\]** ไปยังรายการราคาที่ใช้ใน Sales สำหรับแต่ละสกุลเงิน คุณสามารถใช้รายการราคาเริ่มต้นสำหรับสกุลเงินเดียวกัน อีกทางหนึ่งคือ ถ้าคุณมีรายการราคาในหลายสกุลเงิน คุณสามารถใช้แผนผังค่าได้

    ค่าเท็มเพลตเริ่มต้นสำหรับ **pricelevelid.name \[ชื่อรายการราคา\]** คือ **CRM Service USA (ตัวอย่าง)**

#### <a name="salesline-task"></a>งาน SalesLine

- ตรวจสอบให้แน่ใจว่าแผนผังค่าที่ต้องการสำหรับ **SalesUnitSymbol** ใน Finance and Operations มีอยู่
- ตรวจสอบให้แน่ใจว่า มีการกำหนดหน่วยที่จำเป็นใน Sales

    ค่าเท็มเพลตที่มีแผนผังค่าถูกกำหนดสำหรับ **SalesUnitSymbol** ไปยัง **oumid.name**

## <a name="template-mapping-in-data-integration"></a>การแม็ปเท็มเพลตในการรวมข้อมูล

> [!NOTE]
> ฟิลด์ **เงื่อนไขการชำระเงิน**, **เงื่อนไขการขนส่ง**, **เงื่อนไขการจัดส่ง**, **วิธีการขนส่ง** และ **วิธีการจัดส่ง** ไม่ได้เป็นส่วนหนึ่งของการแม็ปเริ่มต้น หากต้องการแม็ปฟิลด์เหล่านี้ คุณต้องตั้งค่าการแม็ปค่าที่เกี่ยวข้องกับข้อมูลในองค์กรที่เอนทิตี้ซิงโครไนส์ระหว่าง

ภาพประกอบต่อไปนี้แสดงตัวอย่างของการแม็ปเท็มเพลตในการรวมข้อมูล

> [!NOTE]
> การแม็ปแสดงว่าข้อมูลฟิลด์ใดที่จะถูกซิงโครไนส์จาก Sales ไปยัง Finance and Operations หรือจาก Finance and Operations ไปยัง Sales

### <a name="sales-orders-fin-and-ops-to-sales---direct-orderheader"></a>ใบสั่งขาย (Fin and Ops ไปยัง Sales) - ตรง: OrderHeader

[![การแม็ปเท็มเพลตในการรวมข้อมูล](./media/sales-order-direct-template-mapping-data-integrator-1.png)](./media/sales-order-direct-template-mapping-data-integrator-1.png)

### <a name="sales-orders-fin-and-ops-to-sales---direct-orderline"></a>ใบสั่งขาย (Fin and Ops ไปยัง Sales) - ตรง: OrderLine

[![การแม็ปเท็มเพลตในการรวมข้อมูล](./media/sales-order-direct-template-mapping-data-integrator-2.png)](./media/sales-order-direct-template-mapping-data-integrator-2.png)

### <a name="sales-orders-sales-to-fin-and-ops---direct-orderheader"></a>ใบสั่งขาย (Sales ไปยัง Fin and Ops) - ตรง: OrderHeader

[![การแม็ปเท็มเพลตในการรวมข้อมูล](./media/sales-order-direct-template-mapping-data-integrator-3.png)](./media/sales-order-direct-template-mapping-data-integrator-3.png)

### <a name="sales-orders-sales-to-fin-and-ops---direct-orderline"></a>ใบสั่งขาย (Sales ไปยัง Fin and Ops) - ตรง: OrderLine

[![การแม็ปเท็มเพลตในการรวมข้อมูล](./media/sales-order-direct-template-mapping-data-integrator-4.png)](./media/sales-order-direct-template-mapping-data-integrator-4.png)

## <a name="related-topics"></a>หัวข้อที่เกี่ยวข้อง

[ผู้ที่มีแนวโน้มจะเป็นลูกค้าเป็นเงินสด](prospect-to-cash.md)

