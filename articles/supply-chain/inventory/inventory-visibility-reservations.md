---
title: การจองการแสดงผลสินค้าคงคลัง
description: หัวข้อนี้จะอธิบายวิธีการตั้งค่าคุณลักษณะการจองเพื่อสร้างการจอง ใช้การจอง และ/หรือยกเลิกการจองปริมาณสินค้าคงคลังที่ระบุโดยใช้การแสดงผลสินค้าคงคลัง
author: yufeihuang
ms.date: 08/02/2021
ms.topic: article
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: yufeihuang
ms.search.validFrom: 2021-08-02
ms.dyn365.ops.version: 10.0.21
ms.openlocfilehash: 4a85520c0911bb7eed5842b3fd5bd706009351e5
ms.sourcegitcommit: ecd4c148287892dcd45656f273401315adb2805e
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 09/18/2021
ms.locfileid: "7500366"
---
# <a name="inventory-visibility-reservations"></a>การจองการแสดงผลสินค้าคงคลัง

[!include [banner](../includes/banner.md)]
[!INCLUDE [cc-data-platform-banner](../../includes/cc-data-platform-banner.md)]

หัวข้อนี้จะอธิบายวิธีการตั้งค่าคุณลักษณะการจองเพื่อสร้างการจอง ใช้การจอง และ/หรือยกเลิกการจองปริมาณสินค้าคงคลังที่ระบุโดยใช้การแสดงผลสินค้าคงคลัง

การจองจะเลือกปริมาณของสินค้าคงคลังที่จะใช้ในอนาคต เมื่อคุณสร้างการจองสินค้า ระบบจะป้องกันใบสั่งอื่นๆ ไม่ให้จองหรือใช้สินค้าที่จองไว้จนกว่าการจองจะถูกใช้หรือไม่ได้จองสินค้าไว้ การจองถูกสร้างขึ้น ใช้ และยกเลิกโดยใช้การเรียก API ไปยังบริการการแสดงผลสินค้าคงคลัง

คุณสามารถเลือกที่จะตั้งค่า Microsoft Dynamics 365 Supply Chain Management (และระบบอื่นๆ ของบุคคลที่สาม) เพื่อออฟเซ็ตปริมาณที่จองไว้โดยอัตโนมัติโดยใช้การแสดงผลสินค้าคงคลัง ปริมาณออฟเซ็ตจะถูกลบออกจากเรกคอร์ดการจองในการแสดงผลสินค้าคงคลัง

เมื่อคุณเปิดคุณลักษณะการจอง Supply Chain Management จะพร้อมที่จะออฟเซ็ตการจองสินค้าโดยอัตโนมัติซึ่งสร้างขึ้นโดยใช้การแสดงผลสินค้าคงคลัง

## <a name="turn-on-and-set-up-the-reservation-feature"></a><a name="turn-on"></a>เปิดและตั้งค่าคุณลักษณะการจอง

หากต้องการเปิดคุณลักษณะการจอง ให้ทำตามขั้นตอนเหล่านี้

1. เข้าสู่ระบบ Power Apps และเปิด **การแสดงผลสินค้าคงคลัง**
1. เปิดหน้า **การตั้งค่าคอนฟิก**
1. บนแท็บ **การจัดการคุณลักษณะ** ให้เปิดคุณลักษณะ *OnHandReservation*
1. ลงชื่อเข้าใช้ Supply Chain Management
1. ไปที่พื้นที่ทำงาน **[การจัดการคุณลักษณะ](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md)** และเปิดใช้งานคุณลักษณะ *การรวมการแสดงผลสินค้าคงคลังกับออฟเซ็ตการจอง* (ต้องการรุ่น 10.0.22 หรือใหม่กว่า)
1. ไปที่ **การบริหารสินค้าคงคลัง \> การตั้งค่า \> พารามิเตอร์การรวมการแสดงผลสินค้าคงคลัง** เปิดแท็บ **ออฟเซ็ตการจอง** และตั้งค่าต่อไปนี้:
    - **เปิดใช้งานออฟเซ็ตการจอง** – ตั้งค่าเป็น *ใช่* เพื่อเปิดใช้งานฟังก์ชันนี้
    - **ตัวปรับเปลี่ยนออฟเซ็ตการจอง** – เลือกสถานะรายการความเคลื่อนไหวของสินค้าคงคลังที่จะออฟเซ็ตการจองบนการแสดงผลสินค้าคงคลัง การตั้งค่านี้จะระบุระยะการประมวลผลใบสั่งที่ทริกเกอร์ออฟเซ็ต ขั้นจะติดตามโดยสถานะรายการความเคลื่อนไหวของสินค้าคงคลังของใบสั่ง เลือกจากวิธีใดวิธีหนึ่งต่อไปนี้
        - *ในใบสั่ง* – ในสถานะ *ธุรกรรม* ใบสั่งจะส่งคำขอออฟเซ็ตเมื่อสร้างใบสั่ง ปริมาณออฟเซ็ตจะเป็นปริมาณของใบสั่งที่สร้างขึ้น
        - *จอง* - สำหรับสถานะ *จองธุรกรรมที่สั่งไว้* ใบสั่งจะส่งคำขอออฟเซ็ตเมื่อจอง เบิกสินค้า ลงรายการบัญชีบันทึกการจัดส่ง แล้วหรือออกใบแจ้งหนี้แล้ว คำขอจะถูกทริกเกอร์เพียงครั้งเดียว และในขั้นตอนแรกเมื่อกระบวนการดังกล่าวเกิดขึ้น ปริมาณออฟเซ็ตจะเป็นปริมาณที่สถานะรายการความเคลื่อนไหวของสินค้าคงคลังถูกเปลี่ยนจาก *อยู่ระหว่างการสั่ง* เป็น *สั่งสำรองแล้ว* (หรือสถานะหลังจากนั้น) ในบรรทัดใบสั่งที่ตรงกัน

## <a name="use-the-reservation-feature-in-inventory-visibility"></a>ใช้คุณลักษณะการจองในการแสดงผลสินค้าคงคลัง

เมื่อคุณเรียก API การจอง ระบบจะบันทึกการจองสินค้าและปริมาณที่ระบุ คุณต้องกําหนดลำดับชั้นการจองและลงรายการบัญชีคำขอที่ตรงกับลำดับชั้นของการจอง การจองสามารถทำได้โดยการเรียกใช้ API การจองโดยตรง

### <a name="configure-the-reservation-hierarchy"></a>ตั้งค่าคอนฟิกลำดับชั้นการจอง

ลำดับชั้นการจองจะอธิบายถึงลำดับของมิติที่ต้องระบุเมื่อจอง โดยจะทำงานในลักษณะเดียวกับที่ลำดับชั้นของดัชนีจะทำงานสำหรับการสอบถามปริมาณคงคลังคงเหลือ

ลำดับชั้นการจองอาจแตกต่างจากลำดับชั้นของดัชนี ความเป็นอิสระนี้จะช่วยให้คุณสามารถดําเนินการจัดการประเภท โดยที่ผู้ใช้สามารถแบ่งมิติออกเป็นรายละเอียด เพื่อระบุความต้องการในการใช้การจองที่ละเอียดมากขึ้น

เมื่อต้องการตั้งค่าคอนฟิกลำดับชั้นการจองแบบชั่วคราวใน Power Apps ให้เปิดหน้า **การตั้งค่าคอนฟิก** แล้วบนแท็บ **ลำดับชั้นการจองแบบชั่วคราว** ให้ตั้งค่าลำดับชั้นการจองด้วยการเพิ่มและ/หรือปรับเปลี่ยนมิติและระดับลำดับชั้นของมิติ

ลำดับชั้นของการจองแบบชั่วคราวของคุณควรมี `SiteId` และ `LocationId` เป็นส่วนประกอบ เนื่องจากเป็นส่วนประกอบในการสร้างการตั้งค่าคอนฟิกพาร์ติชัน

ลำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการเพิ่มและตั้งค่าคอนฟิกการจอง ให้ดูที่ [การตั้งค่าคอนฟิกการจอง](inventory-visibility-configuration.md#reservation-configuration)

### <a name="call-the-reservation-api"></a>เรียก API การจอง

มีการจองในบริการการแสดงผลสินค้าคงคลังโดยส่งคำขอ POST ไปยัง URL ของบริการ เช่น `/api/environment/{environment-ID}/onhand/reserve`

สำหรับการจอง เนื้อหาของคำขอต้องมีรหัสองค์กร รหัสผลิตภัณฑ์ ปริมาณที่จองไว้ และมิติ เมื่อสร้างรหัสการจองเฉพาะให้กับเรกคอร์ดการจองแต่ละเรกคอร์ด เรกคอร์ดการจองมีชุดเฉพาะของรหัสผลิตภัณฑ์และมิติ

เมื่อคุณเรียกใช้ API การจอง คุณสามารถควบคุมการตรวจสอบความถูกต้องของการจองได้โดยการระบุพารามิเตอร์ `ifCheckAvailForReserv` แบบบูลีนในเนื้อหาคำขอ ค่า `True` หมายความว่าการตรวจสอบความถูกต้องนั้นต้องระบุ ในขณะที่ค่า `False` หมายความว่าการตรวจสอบความถูกต้องนั้นไม่จำเป็น ค่าเริ่มต้นคือ `True`

ถ้าคุณต้องการยกเลิกการจองหรือยกเลิกการจองปริมาณสินค้าคงคลังที่ระบุ ให้ตั้งค่าปริมาณเป็นค่าลบและตั้งค่าพารามิเตอร์ `ifCheckAvailForReserv` เป็น `False` เพื่อข้ามการตรวจสอบความถูกต้อง

ต่อไปนี้เป็นตัวอย่างเนื้อหาของคำขอ

```json
# Url
# replace {RegionShortName} and {EnvironmentId} with your value
https://inventoryservice.{RegionShortName}-il301.gateway.prod.island.powerapps.com/api/environment/{EnvironmentId}/onhand/reserve

# Method
Post

# Header
# replace {access_token} with the one get from security service
Api-version: "1.0"
Content-Type: "application/json"
Authorization: "Bearer {access_token}"

# Body
{
    "id": "id-bike-0001",
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "SiteId": "1",
        "LocationId": "11",
        "ColorId": "Red",
        "SizeId": "small"
    },
    "quantityDataSource": "iv",
    "modifier": "SoftReservOrdered",
    "quantity": 1,
    "ifCheckAvailForReserv": true
}
```

## <a name="offset-reservations-in-supply-chain-management"></a>ออฟเซ็ตการจองใน Supply Chain Management

สำหรับสถานะรายการความเคลื่อนไหวของสินค้าคงคลังที่มีตัวปรับเปลี่ยนออฟเซ็ตส่วนสํารองที่ระบุ การอัปเดตธุรกรรมจะหักลบเรกคอร์ดการจองที่สัมพันธ์กันเมื่อเป็นไปตามเงื่อนไขต่อไปนี้ทั้งหมด

- รหัสการจองบนรายการความเคลื่อนไหวของสินค้าคงคลังตรงกับรหัสการจองของเรกคอร์ดการจองในบริการการแสดงผลสินค้าคงคลัง
- มิติของรายการความเคลื่อนไหวของสินค้าคงคลังตรงกับมิติของเรกคอร์ดการจองในบริการการแสดงผลสินค้าคงคลัง
- การเปลี่ยนแปลงในสถานะรายการความเคลื่อนไหวของสินค้าคงคลังจะทริกเกอร์ออฟเซ็ตของการจองเมื่อสถานะรายการความเคลื่อนไหวของสินค้าคงคลังสะท้อนถึงข้อเท็จจริงที่ว่ากระบวนการใบสั่งเสร็จสมบูรณ์แล้วหรือข้ามไป

ปริมาณออฟเซ็ตจะเป็นไปตามปริมาณสินค้าคงคลังที่ระบุไว้ในรายการความเคลื่อนไหวของสินค้าคงคลัง ออฟเซ็ตจะไม่มีผลหากไม่มีปริมาณที่จองไว้เหลืออยู่ในบริการการแสดงผลสินค้าคงคลัง

### <a name="set-up-the-reservation-offset-modifier"></a>ตั้งค่าตัวปรับเปลี่ยนออฟเซ็ตการจอง

หากคุณยังไม่ได้ตั้งค่าตัวปรับเปลี่ยนการจอง ให้ตั้งค่าตัวปรับเปลี่ยนการจองตามที่อธิบายไว้ใน [เปิดและตั้งค่าคุณลักษณะการจอง](#turn-on)

### <a name="set-up-reservation-ids"></a>ตั้งค่ารหัสการจอง

รหัสการจองจะระบุเรกคอร์ดการจองในการแสดงผลสินค้าคงคลังโดยไม่ซ้ำ ใน Supply Chain Management ผู้ใช้จะวางการจองสินค้าในบรรทัดใบสั่งเพื่อเลือกออฟเซ็ตของเรกคอร์ดการจองที่ตรงกัน

เมื่อต้องการตั้งค่ารหัสการจองใน Supply Chain Management ให้ปฏิบัติตามขั้นตอนต่อไปนี้

1. เปิดใบสั่งขาย (ตัวอย่างเช่น จากหน้า **ใบสั่งขายทั้งหมด**)
1. บนแท็บด่วน **รายการใบสั่งขาย** เลือก เพิ่มรายการใบสั่ง
1. บนแท็บด่วน **รายการใบสั่งขาย** บนแถบเครื่องมือ ให้เลือก **อัปเดตรายการ \> สินค้าคงคลัง \> การรวมการแสดงผลสินค้าคงคลัง**
1. ป้อนรหัสการจองที่เกี่ยวข้อง

การเปลี่ยนแปลงสถานะสินค้าคงคลังตรงกับการตั้งค่าตัวปรับเปลี่ยนออฟเซ็ต
