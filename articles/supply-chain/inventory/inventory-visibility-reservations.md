---
title: การจองใน Inventory Visibility
description: บทความนี้จะอธิบายวิธีการตั้งค่าคุณลักษณะการจองเพื่อสร้างการจอง ใช้การจอง และ/หรือยกเลิกการจองปริมาณสินค้าคงคลังที่ระบุโดยใช้การแสดงผลสินค้าคงคลัง
author: yufeihuang
ms.date: 11/04/2022
ms.topic: article
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: yufeihuang
ms.search.validFrom: 2021-08-02
ms.dyn365.ops.version: 10.0.21
ms.openlocfilehash: 0ae0589f8bac7ebf9b43cf0f3bc02680d324b29b
ms.sourcegitcommit: 49f8973f0e121eac563876d50bfff00c55344360
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 11/14/2022
ms.locfileid: "9762753"
---
# <a name="inventory-visibility-reservations"></a>การจองใน Inventory Visibility

[!include [banner](../includes/banner.md)]

บทความนี้อธิบายกรณีทั่วไปในการใช้การจองแบบชั่วคราว และอธิบายวิธีการตั้งค่าใน Inventory Visibility ซึ่งจะรวมข้อมูลเกี่ยวกับวิธีการสร้างการจองแบบชั่วคราว ออฟเซ็ตเมื่อมีการใช้จริง และปรับหรือยกเลิกการจองปริมาณสินค้าคงคลังที่ระบุ

## <a name="sample-use-case-for-soft-reservation"></a>กรณีตัวอย่างที่ใช้สำหรับการจองแบบชั่วคราว

การจองแบบชั่วคราวช่วยให้องค์กรบรรลุแหล่งแห่งความจริงเดียวสำหรับสินค้าคงคลังที่พร้อมใช้งาน โดยเฉพาะในระหว่างกระบวนการเติมสินค้าตามใบสั่ง ฟังก์ชันนี้มีประโยชน์กับองค์กรที่มีเงื่อนไขต่อไปนี้:

- องค์กรที่มีอย่างน้อยสองระบบที่ต่างกันที่รับในสั่งขาออกโดยตรง
- องค์การเข้มงวดและต้องการป้องกันการจองสินค้าคงคลังของผลิตภัณฑ์ซ้ำ ซึ่งสามารถเกิดขึ้นได้หากมีหลายระบบที่สามารถทำการจองเกินของสินค้าชิ้นสุดท้ายในสต๊อก สถานการณ์นี้ได้รับการป้องกันเมื่อระบบใบสั่งทั้งหมดสามารถเรียก API การจองแบบชั่วคราวในทันทีไปยัง Inventory Visibility ซึ่งแสดงแหล่งความจริงแหล่งเดียวที่พร้อมใช้งานของสินค้าคงคลัง

[<img src="media/inventory-visibility-soft-reservation.png" alt="Inventory Visibility soft reservation." title="การจองแบบชั่วคราวของ Inventory Visibility" width="720" />](media/inventory-visibility-soft-reservation.png)

ภาพประกอบก่อนหน้านี้แสดงวิธีการทำงานของการจองแบบชั่วคราว และไฮไลต์ที่การดําเนินงานต่อไปนี้

- ระดับสินค้าคงคลังเริ่มต้นของคุณจะถูกซิงค์กับ Inventory Visibility จาก Microsoft Dynamics 365 Supply Chain Management
- มีการลงรายการบัญชีการจองแบบชั่วคราวจากช่องทางหรือระบบใบสั่งแต่ละช่องทางของคุณไปยัง Inventory Visibility Inventory Visibility จะตรวจสอบความถูกต้องของความพร้อมของสินค้าคงคลัง และพยายามจองแบบชั่วคราว หากการจองแบบชั่วคราวเสร็จสิ้น Inventory Visibility จะเพิ่มในปริมาณที่จองแบบชั่วคราว หักลบออกจากปริมาณที่มีอยู่ของการจองสินค้า (AFR) และตอบสนองต่อรหัสการจองแบบชั่วคราว
- ขณะนี้ ปริมาณสินค้าคงคลังทางกายภาพของคุณยังคงเท่าเดิม
- จากนั้นคุณสามารถซิงค์ใบสั่งการจองแบบชั่วคราวใบเดียวหรือรวม (รายการใบสั่ง) ไปยัง Supply Chain Management เพื่อจองทรัพยากรแบบตายตัว และนำออกใช้ไปยังคลังสินค้า หรืออัปเดตปริมาณสินค้าคงคลังขั้นสุดท้าย
- คุณสามารถตั้งค่าระบบให้ [ออฟเซ็ตการจองสินค้าแบบชั่วคราว](#offset-scm) เมื่อมีการอัปเดตสินค้าคงคลังทางกายภาพใน Supply Chain Management

การจองแบบชั่วคราวมักจะถูกสร้างขึ้น ใช้ และยกเลิก โดยใช้การเรียก API ไปยังบริการ Inventory Visibility

> [!NOTE]
> คุณสามารถเลือกที่จะตั้งค่า Supply Chain Management (และระบบอื่นๆ ของบุคคลที่สาม) เพื่อออฟเซ็ตปริมาณที่จองไว้โดยอัตโนมัติโดยใช้การแสดงผลสินค้าคงคลัง ปริมาณออฟเซ็ตจะถูกลบออกจากเรกคอร์ดการจองในการแสดงผลสินค้าคงคลัง
>
> โดยค่าเริ่มต้น ฟังก์ชันออฟเซ็ตจะเปิดขึ้นโดยอัตโนมัติ เมื่อคุณเปิดใช้งานคุณลักษณะการจองแบบชั่วคราว

## <a name="turn-on-and-set-up-the-reservation-feature"></a><a name="turn-on"></a>เปิดและตั้งค่าคุณลักษณะการจอง

หากต้องการเปิดคุณลักษณะการจอง ให้ทำตามขั้นตอนเหล่านี้

1. ลงชื่อเข้าใช้ Power Apps และเปิด **Inventory Visibility**
1. เปิดหน้า **การตั้งค่าคอนฟิก**
1. บนแท็บ **การจัดการคุณลักษณะ** ให้เปิดคุณลักษณะ *OnHandReservation*
1. ลงชื่อเข้าใช้สภาพแวดล้อม Supply Chain Management ของคุณ
1. ไปที่พื้นที่ทำงาน **[การจัดการคุณลักษณะ](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md)** และเปิดใช้งานคุณลักษณะ *การรวมการแสดงผลสินค้าคงคลังกับออฟเซ็ตการจอง* (ต้องการรุ่น 10.0.22 หรือใหม่กว่า)
1. ไปที่ **การบริหารสินค้าคงคลัง \> การตั้งค่า \> พารามิเตอร์การรวมการแสดงผลสินค้าคงคลัง** เปิดแท็บ **ออฟเซ็ตการจอง** และตั้งค่าต่อไปนี้:

    - **เปิดใช้งานออฟเซ็ตการจอง** – ตั้งค่าเป็น *ใช่* เพื่อเปิดใช้งานฟังก์ชันนี้
    - **ตัวปรับเปลี่ยนออฟเซ็ตการจอง** – เลือกสถานะตัวปรับเปลี่ยนออฟเซ็ตการจองที่จะออฟเซ็ตการจอง ที่สร้างขึ้นใน Inventory Visibility การตั้งค่านี้จะระบุระยะการประมวลผลใบสั่งที่ทริกเกอร์ออฟเซ็ต ขั้นจะติดตามโดยสถานะรายการความเคลื่อนไหวของสินค้าคงคลังของใบสั่ง เลือกค่าใดค่าหนึ่งต่อไปนี้

        - *อยู่ระหว่างการสั่ง* – ใบสั่งที่มีสถานะ *อยู่ระหว่างการสั่ง* จะส่งคำขอออฟเซ็ตเมื่อถูกสร้างขึ้้น ปริมาณออฟเซ็ตจะเป็นปริมาณของใบสั่งที่สร้างขึ้น (บรรทัด)
        - *สํารอง* – ใบสั่งที่มีสถานะ *สํารอง* จะส่งการร้องขอออฟเซ็ตเมื่อใบสั่งถูกจองไว้หรือถูกจองทางกายภาพ เมื่อคุณออฟเซ็ตที่สถานะ *สำรอง* ใบสั่งจะส่งการร้องขอออฟเซ็ตไปที่สถานะสินค้าคงคลังใหม่ใดๆ ที่ใกล้กับการเบิกสินค้าที่จองไว้ที่สุด (ตัวอย่างเช่น เบิกสินค้า ลงรายการบัญชีบันทึกการจัดส่ง แล้ว หรือออกใบแจ้งหนี้แล้ว) ลักษณะการทำงานนี้จะเกิดขึ้นแม้ว่าคุณจะข้ามการจองสินค้าใน Supply Chain Management และไปยังสถานะสินค้าคงคลังอื่นต่อไป (ตัวอย่างเช่น ถ้าคุณข้ามจากออกใช้ไปยังคลังสินค้าเพื่อเบิกสินค้าและจัดส่ง) การร้องขอจะถูกทริกเกอร์เพียงครั้งเดียว ถ้ามีการทริกเกอร์เมื่อเบิกสินค้า จะไม่ทำซ้ำการออฟเซ็ตเมื่อมีการลงรายการบัญชีบันทึกการจัดส่ง ปริมาณออฟเซ็ตจะเป็นปริมาณเดียวกันกับปริมาณของสถานะธุรกรรมสินค้าคงคลังเมื่อการออฟเซ็ตถูกทริกเกอร์ (กล่าวคือ *สั่งให้สำรอง*/*จองทางกายภาพ* หรือสถานะหลังจากนั้น ในบรรทัดใบสั่งที่ตรงกัน)

1. ลงชื่อเข้าใช้แอป Inventory Visibility ไปที่หน้า **การตั้งค่าคอนฟิก** จากนั้น บนแท็บ **การจองแบบชั่วคราว** ให้ทบทวนลำดับชั้นการจองแบบชั่วคราวเริ่มต้น เพิ่มมิติใหม่ไปยังลำดับชั้นตามความต้องการ
1. ในส่วน **การแมปการตั้งค่าการจองแบบชั่วคราว** ดูการตั้งค่าเริ่มต้น ตามค่าเริ่มต้น ปริมาณสินค้าคงคลังที่จองแบบชั่วคราวจะถูกบันทึกโดยเทียบกับการวัดทางกายภาพ `softreservephysical` ของแหล่งข้อมูล `iv` การวัดที่มีการคำนวณที่ *พร้อมสำหรับการจอง* ถูกแมปกับ `availabletoreserve` ถ้าคุณต้องการอัปเดตการวัดที่คํานวณ `availabletoreserve` ให้ไปที่หน้า **การตั้งค่าคอนฟิก** แล้วบนแท็บ **การวัดที่คํานวณ** ให้ขยายและแก้ไขการวัดที่คํานวณ

สำหรับข้อมูลเพิ่มเติม ให้ดูที่ [กำหนดค่าการแสดงผลสินค้าคงคลัง](inventory-visibility-configuration.md)

> [!NOTE]
> ลำดับชั้นการจองจะอธิบายถึงลำดับของมิติที่ต้องระบุเมื่อจอง ซึ่งทำงานเช่นเดียวกับลำดับชั้นของดัชนีสำหรับการสอบถามสินค้าคงคลังคงเหลือ แต่จะใช้โดยอิสระเพื่อให้ผู้ใช้สามารถระบุรายละเอียดมิติ เพื่อให้การจองชัดเจนยิ่งขึ้น
>
> ลำดับชั้นของการจองแบบชั่วคราวของคุณควรมี `SiteId` และ `LocationId` เป็นส่วนประกอบ เนื่องจากเป็นส่วนประกอบในการสร้างการตั้งค่าคอนฟิกพาร์ติชันของ Inventory Visibility

ลำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการเพิ่มและตั้งค่าคอนฟิกการจอง ให้ดูที่ [การตั้งค่าคอนฟิกการจอง](inventory-visibility-configuration.md#reservation-configuration)

## <a name="use-the-reservation-feature-in-inventory-visibility"></a>ใช้คุณลักษณะการจองในการแสดงผลสินค้าคงคลัง

เมื่อคุณเรียก API การจอง ระบบจะบันทึกการจองสินค้าและปริมาณที่ระบุ

ต่อไปนี้เป็นตัวอย่างสถานการณ์และเนื้อหาการสอบถาม API ตัวอย่าง บริษัท Contoso ขายผลิตภัณฑ์ D0002 (Cabinet) จากเว็บไซต์ e-commerce ของบริษัท ลูกค้าวางใบสั่งขายตู้สีแดงขนาดเล็กผ่านเว็บไซต์ Contoso ตัดสินใจที่จะตอบสนองใบสั่งนี้โดยใช้มิติต่อไปนี้

- รหัสองค์กร = usmf
- ไซต์ = 1
- คลังสินค้า = 11
- ผลิตภัณฑ์ = D0002
- สี = สีแดง
- ขนาด = เล็ก

Contoso ตั้งค่าการเชื่อมต่อ API ไปยัง Inventory Visibility จากระบบ e-commerce ของตนเองแล้ว เมื่อได้รับใบสั่ง ระบบจะทริกเกอร์การเรียก API โดยทันที เพื่อทำการจองแบบชั่วคราวสำหรับตู้ใน Inventory Visibility

### <a name="create-soft-reservations-using-the-reservation-api"></a>สร้างการจองแบบชั่วคราวโดยใช้ API การจอง

มีการจองในบริการการแสดงผลสินค้าคงคลังโดยส่งคำขอ POST ไปยัง URL ของบริการ เช่น `/api/environment/{environmentId}/onhand/reserve`

สำหรับการจอง เนื้อหาของคำขอต้องมีรหัสองค์กร รหัสผลิตภัณฑ์ ปริมาณที่จองไว้ และมิติ

เมื่อคุณเรียกใช้ API การจอง คุณสามารถควบคุมการตรวจสอบความถูกต้องของการจองได้โดยการระบุพารามิเตอร์ `ifCheckAvailForReserv` แบบบูลีนในเนื้อหาคำขอ ค่า `True` หมายความว่าการตรวจสอบความถูกต้องนั้นต้องระบุ ในขณะที่ค่า `False` หมายความว่าการตรวจสอบความถูกต้องนั้นไม่จำเป็น ค่าเริ่มต้นคือ `True`

ถ้าคุณต้องการยกเลิกการจองหรือยกเลิกการจองปริมาณสินค้าคงคลังที่ระบุ ให้ตั้งค่าปริมาณเป็นค่าลบและตั้งค่าพารามิเตอร์ `ifCheckAvailForReserv` เป็น `False` เพื่อข้ามการตรวจสอบความถูกต้อง

ต่อไปนี้เป็นตัวอย่างเนื้อหาการร้องขอที่อ้างอิงใบสั่งขายในบริบทก่อนหน้า

```json
# Url

#Replace {endpoint} with your system endpoint.
    {endpoint}/api/environment/{environmentId}/onhand/reserve

# Method
Post

# Header
# replace {access_token} with the one get from security service
Api-version: "1.0"
Content-Type: "application/json"
Authorization: "Bearer {access_token}"

# Body
{
    "id": "Testrequest-0005",
    "organizationId": "usmf",
    "productId": "D0002",
    "dimensions": {
        "SiteId": "1",
        "LocationId": "11",
        "ColorId": "red",
        "SizeId": "small"
    },
    "quantityDataSource": "iv",
    "modifier": "softreservphysical",
    "quantity": 1,
    "ifCheckAvailForReserv": true
}
```

การร้องขอการจองสินค้าแบบชั่วคราวที่เสร็จเรียบร้อยแล้วส่งคืน *รหัสการจองแบบชั่วคราว* สำหรับแต่ละเรกคอร์ดการจอง รหัสการจองแบบชั่วคราวไม่ใช่รหัสเฉพาะของเรกคอร์ดการจองแบบชั่วคราวแต่ละรายการ แต่ชุดของรหัสผลิตภัณฑ์และค่ามิติที่เชื่อมโยงกับการร้องขอการจองแบบชั่วคราว คุณสามารถบันทึกรหัสการจองแบบชั่วคราวในบรรทัดใบสั่ง เมื่อคุณซิงค์ใบสั่งที่จองไว้ไปยัง Supply Chain Management หรือระบบ ERP อีกระบบหนึ่งเพื่อออฟเซ็ต

### <a name="offset-soft-reservations-in-supply-chain-management"></a><a name="offset-scm"></a>ออฟเซ็ตการจองแบบชั่วคราวใน Supply Chain Management

คุณสามารถออฟเซ็ตปริมาณที่จองแบบชั่วคราวได้หลังจากหักปริมาณตามใบสั่งนั้นใน Supply Chain Management หรือระบบ ERP อีกระบบหนึ่ง Inventory Visibility มีการรวมออฟเซ็ตการจองแบบชั่วคราวแบบสำเร็จรูปกับ Supply Chain Management

ให้ปฏิบัติตามขั้นตอนเหล่านี้ เพื่อออฟเซ็ตการจองแบบชั่วคราว

1. ลงชื่อเข้าใช้ Supply Chain Management
1. ไปยัง **การขายและการตลาด \> ใบสั่งขาย \> ใบสั่งขายทั้งหมด**
1. บนบานหน้าต่างการดำเนินการ เลือก **สร้าง**
1. สร้างใบสั่งขายภายนอกอีกครั้ง และเพิ่มรายการขายที่ใช้ค่ารหัสผลิตภัณฑ์ องค์กร ไซต์ คลังสินค้า และมิติเดียวกันทั้งหมด
1. บนแท็บด่วน **รายการใบสั่งขาย** ให้เลือกบรรทัดการขายที่คุณเพิ่งป้อน จากนั้น บนแถบเครื่องมือ ให้เลือก **สินค้าคงคลัง \> รหัสการจอง**
1. ทำตามขั้นตอนเหล่านี้

    - คัดลอกรหัสการจองแบบชั่วคราวในการตอบสนองการร้องขอการจองสินค้าแบบชั่วคราวของคุณ และวางลงในฟิลด์ **รหัสการจอง**
    - ปล่อยฟิลด์ **รหัสการจอง** ว่างไว้ แต่เลือกกล่องกาเครื่องหมาย **ออฟเซ็ตอัตโนมัติของบริการสินค้าคงคลัง** ระบบจะระบุผลิตภัณฑ์และมิติของผลิตภัณฑ์ที่จะออฟเซ็ตโดยอัตโนมัติ ตามรหัสสินค้าและค่ามิติที่ป้อนในบรรทัดที่เลือก

1. เลือก **ตกลง**
1. ในขณะที่บรรทัดการขายเดียวกันยังคงถูกเลือก จองปริมาณที่สั่ง โดยการเลือก **สินค้าคงคลัง \> การจอง** บนแถบเครื่องมือของแท็บด่วน **รายการใบสั่งขาย**
1. ถ้าก่อนหน้านี้คุณตั้งค่าฟิลด์ **ตัวปรับเปลี่ยนออฟเซ็ตการจอง** เป็น *จองแล้ว* ออฟเซ็ตจะถูกทริกเกอร์ เมื่อรายการใบสั่งมีสถานะ *จองสินค้าจริง* หรือ *สำรองสินค้าที่สั่ง* ชุดงานจะรันหนึ่งครัั้งเพื่อซิงค์การร้องขอออฟเซ็ตจาก Supply Chain Management ไปยัง Inventory Visibility

> [!NOTE]
> สำหรับสถานะธุรกรรมที่มีตัวปรับเปลี่ยนออฟเซ็ตส่วนสํารองที่ระบุ การอัปเดตธุรกรรมจะหักลบเรกคอร์ดการจองที่สัมพันธ์กันเมื่อเป็นไปตามเงื่อนไขต่อไปนี้ทั้งหมด
>
> - รหัสการจองบนธุรกรรมสินค้าคงคลังตรงกับรหัสการจองของเรกคอร์ดการจองใน Inventory Visibility
> - มิติของการมองเห็นสินค้าคงคลังตรงกับมิติของเรกคอร์ดการจองใน Inventory Visibility
> - การเปลี่ยนแปลงในสถานะรายการความเคลื่อนไหวของสินค้าคงคลังจะทริกเกอร์ออฟเซ็ตของการจองเมื่อสถานะรายการความเคลื่อนไหวของสินค้าคงคลังสะท้อนถึงข้อเท็จจริงที่ว่ากระบวนการใบสั่งเสร็จสมบูรณ์แล้วหรือข้ามไป

ปริมาณออฟเซ็ตจะเป็นไปตามปริมาณสินค้าคงคลังที่ระบุไว้ในธุรกรรมสินค้าคงคลังที่เกี่ยวข้อง ออฟเซ็ตจะมีผลเฉพาะหากปริมาณที่จองไว้ยังคงอยู่ใน Inventory Visibility

### <a name="cancel-or-revert-a-soft-reservation"></a>ยกเลิกหรือแปลงกลับการจองแบบชั่วคราว

ถ้าบรรทัดใบสั่งต้นฉบับถูกยกเลิกหรือลบ และคุณต้องแปลงกลับการจอแบบชั่วคราวที่สอดคล้องกัน ให้ลงรายการบัญชีปริมาณค่าลบซึ่งมีข้อมูลเดียวกันทุกรายการในเนื้อหาการสอบถาม API ของคุณ
