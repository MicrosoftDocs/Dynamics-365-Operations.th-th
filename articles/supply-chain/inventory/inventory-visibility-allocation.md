---
title: การปันส่วนสินค้าคงคลังใน Inventory Visibility
description: บทความนี้อธิบายวิธีการตั้งค่าและใช้คุณลักษณะการปันส่วนสินค้าคงคลัง ซึ่งช่วยให้คุณตั้งค่าสินค้าคงคลังที่จัดสรรไว้เพิ่มเติมเพื่อให้แน่ใจว่าคุณสามารถตอบสนองช่องทางหรือลูกค้าได้มากที่สุด
author: yufeihuang
ms.date: 11/04/2022
ms.topic: article
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: yufeihuang
ms.search.validFrom: 2022-05-13
ms.dyn365.ops.version: 10.0.27
ms.openlocfilehash: 449ca0616405ba589b92fba1ef078a4350d1e3b1
ms.sourcegitcommit: 49f8973f0e121eac563876d50bfff00c55344360
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 11/14/2022
ms.locfileid: "9762684"
---
# <a name="inventory-visibility-inventory-allocation"></a>การปันส่วนสินค้าคงคลังใน Inventory Visibility

[!include [banner](../includes/banner.md)]

## <a name="business-background-and-purpose"></a>ประวัติธุรกิจและวัตถุประสงค์

องค์กรมักต้องปันส่วนปริมาณคงคลังคงเหลือไปยังช่องทางการขาย กลุ่มลูกค้า ภูมิภาค และเหตุการณ์โปรโมชันที่สําคัญที่สุด เพื่อให้มั่นใจว่าสินค้าคงคลังที่ปันส่วนล่วงหน้าจะได้รับการป้องกันจากการใช้อื่นใด และสามารถใช้ผ่านทางธุรกรรมการขายที่เกี่ยวข้องกับการปันส่วนเท่านั้น การปันส่วนสินค้าคงคลังในการมองเห็นสินค้าคงคลังเป็นส่วนประกอบของกระบวนการวางแผนการงานขาย และเกิดขึ้นก่อนกิจกรรมการขายจริงใดๆ จะเกิดขึ้นหรือสร้างใบสั่งขาย

ตัวอย่างเช่น บริษัทที่ชื่อ Contoso ผลิตจักรยานที่เป็นที่นิยม โชคไม่ดี เนื่องจากการหยุดชะงักของห่วงโซ่อุปทานเมื่อเร็วๆ นี้ส่งผลกระทบต่อสินค้าคงคลังที่อยู่ระหว่างส่งต่อทั้งหมดของจักรยานนั้น Contoso มีสินค้าคงคลังคงเหลือที่จํากัดเท่านั้น และต้องใช้อย่างดีที่สุด Contoso ดำเนินการทั้งการขายผ่านระบบออนไลน์และการขายในร้านค้า ในช่องทางการขายแต่ละช่องทาง บริษัทมีคู่ค้าบริษัทที่สําคัญสองสามราย (มาร์เก็ตเพลสและผู้ค้าปลีกขนาดใหญ่) ที่ต้องการให้ระบบบันทึกสินค้าคงคลังที่มีอยู่เฉพาะส่วนของบริษัทบันทึกอยู่ ดังนั้น บริษัทจักรยานต้องสามารถจัดสมดุลการกระจายสต็อกระหว่างช่องทางต่างๆ และจัดการความคาดหวังของคู่ค้าระดับ VIP ด้วย วิธีที่ดีที่สุดในการบรรลุเป้าหมายทั้งสองอย่างคือ การใช้การปันส่วนสินค้าคงคลัง เพื่อให้แต่ละช่องทางและผู้ค้าปลีกสามารถได้รับปริมาณที่ปันส่วนเฉพาะที่สามารถขายให้แก่ผู้บริโภคในภายหลังได้

การปันส่วนสินค้าคงคลังมีวัตถุประสงค์ทางธุรกิจพื้นฐานสองอย่างคือ

- **การป้องกันสินค้าคงคลัง (การตกแต่งสินค้าคงคลัง)** – องค์กรต้องการปันส่วนสินค้าคงคลังที่จํากัดหรือจํากัดล่วงหน้าให้กับช่องทาง ภูมิภาค ลูกค้า VIP และบริษัทในเครือที่จัดลำดับความสำคัญ คุณลักษณะการปันส่วนที่มองเห็นได้ของสินค้าคงคลังจะป้องกันสินค้าคงคลังที่ปันส่วนเพื่อให้การปันส่วน การจอง หรือความต้องการการขายอื่นๆ อื่นๆ ไม่ส่งผลกระทบต่อสินค้าคงคลังที่ปันส่วนก่อนหน้านี้
- **ตัวควบคุม Oversell** – คุณลักษณะการปันส่วนการมองเห็นสินค้าคงคลังมีวัตถุประสงค์เพื่อจํากัดปริมาณที่ปันส่วนไว้ก่อนหน้านี้ เพื่อให้ฝ่ายรับสินค้า (ตัวอย่างเช่น ช่องทางหรือกลุ่มลูกค้า) จะไม่ใช้ทรัพยากรเหล่านี้เกินเมื่อธุรกรรมการขายจริงที่ยึดตามการจองทรัพยากรแบบไม่จํากัดมีผลบังคับใช้

## <a name="allocation-definition-in-inventory-visibility-service"></a>นิยามการปันส่วนในบริการการมองเห็นสินค้าคงคลัง

### <a name="allocation-virtual-pool"></a>กลุ่มเสมือนของการปันส่วน

แม้ว่าคุณลักษณะในการมองเห็นสินค้าคงคลังไม่ได้ตั้งค่าเพิ่มเติมปริมาณสินค้าคงคลังที่มีอยู่จริง แต่จะอ้างอิงถึงปริมาณสินค้าคงคลังที่มีอยู่จริงเพื่อกําหนดปริมาณกลุ่มเสมือน *ที่พร้อมใช้งานในการปันส่วน* เริ่มต้น การปันส่วนสินค้าคงคลังในการมองเห็นสินค้าคงคลังเป็นการปันส่วนรแบบไม่ตายตัว ซึ่งเกิดขึ้นก่อนธุรกรรมการขายจริงและไม่ขึ้นอยู่กับใบสั่งขาย ตัวอย่างเช่น คุณสามารถปันส่วนสต็อกให้กับช่องทางการขายที่สําคัญที่สุดของคุณหรือผู้ค้าปลีกขนาดใหญ่ก่อนที่จะมีลูกค้าปลายทางเข้าไปที่ช่องทางการขายหรือร้านค้าปลีกเพื่อซื้อ

### <a name="difference-between-inventory-allocation-and-soft-reservation"></a>ความแตกต่างระหว่างการปันส่วนสินค้าคงคลังและการจองสินค้าคงคลังแบบชั่วคราว

[การจองแบบชั่วคราว](inventory-visibility-reservations.md) โดยทั่วไปจะเชื่อมโยงกับธุรกรรมการขายจริง (บรรทัดใบสั่งขาย) สามารถใช้ได้ทั้งการปันส่วนและการจองแบบชั่วคราวโดยอิสระ แต่ถ้าคุณต้องการใช้พร้อมกัน ควรทำการจองแบบชั่วคราวหลังจากการปันส่วน เราขอแนะนำว่าคุณควรเลือกการปันส่วนสินค้าคงคลังก่อน แล้วจึงทำการจองแบบชั่่วคราวเปรียบเทียบกับปริมาณิที่ถูกปันส่วนเพื่อให้ใกล้เคียงกับปริมาณการใช้งานในเวลาจริงเทียบกับการปันส่วน สำหรับข้อมูลเพิ่มเติม ดูที่ [ใช้เป็นการจองแบบไม่ตายตัว](#consume-to-soft-reserved)"

คุณลักษณะการปันส่วนสินค้าคงคลังจะยอมให้ผู้วางแผนการขายหรือผู้จัดการบัญชีหลักสามารถจัดการและปันส่วนสินค้าคงคลังที่สําคัญล่วงหน้า ระหว่างกลุ่มการปันส่วนต่างๆ (เช่น ช่องทาง ภูมิภาค และกลุ่มลูกค้า) และยังสนับสนุนการติดตามแบบเรียลไทม์ การปรับปรุง และการวิเคราะห์ปริมาณการใช้กับปริมาณที่ปันส่วน เพื่อให้แน่ใจว่าสามารถเติมสินค้าหรือปันส่วนอีกครั้งตรงเวลาได้ ความสามารถในการมองเห็นแบบเรียลไทม์ในการปันส่วน ปริมาณการใช้ และยอดดุลการปันส่วนเป็นสิ่งที่สําคัญโดยเฉพาะอย่างยิ่งในเหตุการณ์การขายด่วนหรือโปรโมชัน

## <a name="terminology"></a>คำศัพท์

เงื่อนไขและแนวคิดต่อไปนี้มีประโยชน์ในการสนทนาของการปันส่วนสินค้าคงคลัง:

- **กลุ่มการปันส่วน** – กลุ่มที่เป็นเจ้าของการปันส่วน เช่น ช่องทางการขาย กลุ่มลูกค้า หรือชนิดใบสั่ง
- **ค่ากลุ่มการปันส่วน** – ค่าของกลุ่มการปันส่วนแต่ละกลุ่ม ตัวอย่างเช่น *เว็บ* หรือ *ร้านค้า* อาจเป็นมูลค่าของกลุ่มการปันส่วนช่องทางการขาย ในขณะที่ *VIP* หรือ *ปกติ* อาจเป็นมูลค่าของกลุ่มการปันส่วนของลูกค้า
- **ลำดับชั้นการปันส่วน** – วิธีรวมกลุ่มการปันส่วนในลักษณะตามลำดับชั้น ตัวอย่างเช่น คุณสามารถกําหนด *ช่องทาง* เป็นระดับลำดับชั้น 1 *ภูมิภาค* เป็นระดับ 2 และ *กลุ่มลูกค้า* เป็นระดับ 3 ในระหว่างการปันส่วนสินค้าคงคลัง คุณต้องเป็นไปตามลำดับชั้นการปันส่วน เมื่อคุณระบุค่าของกลุ่มการปันส่วน ตัวอย่างเช่น คุณอาจปันส่วนจักรยานสีแดง 200 คัน ให้กับช่องทาง *เว็บ* ภูมิภาค *ลอนดอน* และกลุ่มลูกค้า *VIP*
- **พร้อมใช้งานเพื่อปันส่วน** – *กลุ่มทั่วไปเสมือน* ที่บ่งชี้ปริมาณที่พร้อมใช้งานเพื่อการปันส่วนเพิ่มเติม เป็นการวัดที่คํานวณที่คุณสามารถกําหนดได้โดยอิสระโดยใช้สูตรของคุณเอง ถ้าคุณยังใช้คุณลักษณะการจองทรัพยากรแบบไม่ตายตัวด้วย ขอแนะนำว่าคุณควรใช้สูตรเดียวกันเพื่อคํานวณ available-to-allocate และ available-to-reserve
- **ปันส่วน** – หน่วยวัดทางกายภาพที่แสดงโควตาที่ปันส่วน ซึ่งกลุ่มการปันส่วนสามารถใช้ จะหักลดในเวลาเดียวกันกับที่มีการเพิ่มปริมาณที่ใช้
- **ใช้แล้ว** – การวัดทางกายภาพที่บ่งชี้ว่าปริมาณที่ใช้ไปเทียบกับปริมาณที่ปันส่วนเดิม เมื่อบวกตัวเลขเข้าในหน่วยวัดทางกายภาพนี้ การวัดทางกายภาพที่ปันส่วนจะลดลงโดยอัตโนมัติ

แผนภาพต่อไปนี้แสดงลำดับงานธุรกิจสำหรับการปันส่วนสินค้าคงคลัง

![ลำดับงานธุรกิจสำหรับการปันส่วนสินค้าคงคลัง](media/inventory-visibility-allocation-flow.png "ลำดับงานธุรกิจสำหรับการปันส่วนสินค้าคงคลัง")

รูปภาพประกอบต่อไปนี้จะแสดงลำดับชั้นการปันส่วนและกลุ่มการปันส่วน *กลุ่มทั่วไปเสมือน* ที่แสดงไว้ที่นี่คือปริมาณที่พร้อมใช้งานที่จะปันส่วน

[<img src="media/inventory-visibility-allocation-hierarchy.png" alt="Inventory Visibility allocation hierarchy." title="ลำดับชั้นการปันส่วนการมองเห็นสินค้าคงคลัง" width="720" />](media/inventory-visibility-allocation-hierarchy.png)

## <a name="set-up-inventory-allocation"></a>ตั้งค่าการปันส่วนสินค้าคงคลัง

คุณลักษณะการปันส่วนสินค้าคงคลังจะประกอบด้วยส่วนประกอบต่อไปนี้

- แหล่งข้อมูลที่เกี่ยวข้องกับการปันส่วน การวัดทางกายภาพ และการวัดที่คํานวณได้ที่กําหนดล่วงหน้า
- กลุ่มการปันส่วนที่สามารถปรับค่าได้สูงสุดแปดระดับ
- ชุดของ Application Programming Interface (API) การปันส่วน:

    - ปันส่วน
    - ปันส่วนใหม่
    - ยกเลิกการปันส่วน
    - ใช้
    - การสอบถาม

คุณลักษณะของกระบวนการตั้งค่าคอนฟิการปันส่วนมีสามขั้นตอนดังนี้

- เปิดใช้งานคุณลักษณะในแอป Inventory Visibility โดยไปที่ **การกำหนดค่า \> การจัดการและการตั้งค่าคุณลักษณะ \> การปันส่วน**
- ตั้งค่า [แหล่งข้อมูล](inventory-visibility-configuration.md#data-source-configuration) และ [การวัด](inventory-visibility-configuration.md#data-source-configuration-physical-measures)
- ตั้งค่าชื่อกลุ่มการปันส่วนและลำดับชั้น

### <a name="predefined-data-source"></a>แหล่งข้อมูลที่กำหนดไว้ล่วงหน้า

เมื่อคุณเปิดใช้งานคุณลักษณะการปันส่วนและเรียกใช้ API การอัปเดตการตั้งค่าคอนฟิก การมองเห็นได้ของสินค้าคงคลังจะสร้างแหล่งข้อมูลที่กําหนดล่วงหน้าหนึ่งแหล่งและการวัดเริ่มต้นหลายตัว

แหล่งข้อมูลที่ชื่อ `@iv` ซึ่งรวมถึงชุดของการวัดทางกายภาพเริ่มต้น คุณสามารถดูได้จากแอป Inventory Visibility โดยไปที่ **การกำหนดค่า \> แหล่งข้อมูล** คุณควรเห็น **แหล่งข้อมูล - @IV** ขยายแหล่งข้อมูล `@iv` เพื่อดูรายการของหน่วยวัดทางกายภาพเริ่มต้นดังนี้

- `@iv`

    - `@allocated`
    - `@cumulative_allocated`
    - `@consumed`
    - `@cumulative_consumed`

เลือกแท็บ **การวัดที่คํานวณได้** เพื่อดูการวัดที่คํานวณได้แรกเริ่ม ซึ่งตั้งชื่อเป็น `@iv.@available_to_allocate`

- `@iv`

    - `@iv.@available_to_allocate` = `??` – `??` – `@iv.@allocated`

### <a name="add-other-physical-measures-to-the-available-to-allocate-calculated-measure"></a>เพิ่มการวัดทางกายภาพอื่นๆ ในการวัดที่คํานวณได้พร้อมปันส่วน

เมื่อต้องการใช้การปันส่วน คุณต้องตั้งค่าสูตรอย่างถูกต้องสำหรับการวัดที่คํานวณได้ซึ่งพร้อมใช้งานเพื่อปันส่วน (`@iv.@available_to_allocate`) ตัวอย่างเช่น คุณมีแหล่งข้อมูล `fno` และการวัด `onordered` แหล่งข้อมูล และแหล่งข้อมูล `pos` และการวัด `inbound` และคุณต้องการปันส่วนปริมาณคงคลังคงเหลือให้กับผลรวมของ `fno.onordered` และ `pos.inbound` ในกรณีนี้ `@iv.@available_to_allocate` ควรมี `pos.inbound` และ `fno.onordered` อยู่ในสูตร นี่คือตัวอย่าง:

`@iv.@available_to_allocate` = `fno.onordered` + `pos.inbound` – `@iv.@allocated`

> [!NOTE]
> แหล่งข้อมูลคือ `@iv` คือแหล่งข้อมูลที่กําหนดล่วงหน้า และการวัดทางกายภาพที่กําหนดใน `@iv` โดยใช้ชื่อหน้า `@` เป็นการวัดที่กําหนดล่วงหน้า หน่วยวัดเหล่านี้เป็นการตั้งค่าคอนฟิกที่กําหนดล่วงหน้าของคุณลักษณะ ดังนั้นอย่าเปลี่ยนหรือลบการตั้งค่าคอนฟิกเหล่านั้น หรือคุณอาจประสบกับข้อผิดพลาดที่ไม่คาดคิดเมื่อใช้คุณลักษณะการปันส่วน
>
> คุณสามารถเพิ่มการวัดทางกายภาพใหม่ที่การวัดที่คํานวณได้ล่วงหน้า `@iv.@available_to_allocate` แต่คุณต้องไม่เปลี่ยนชื่อ

### <a name="manage-allocation-groups"></a>จัดการกลุ่มการปันส่วน

ชื่อกลุ่มการปันส่วนสามารถตั้งค่าได้สูงสุดแปดชื่อ กลุ่มมีลำดับชั้น ทำตามขั้นตอนต่อไปนี้เพื่อดูกลุ่มและอัปเดตกลุ่มการปันส่วน

1. ลงชื่อเข้าใช้สภาพแวดล้อม Power Apps ของคุณ และเปิด **การแสดงผลสินค้าคงคลัง**
1. เปิดหน้า **การตั้งค่าคอนฟิก** แล้วบนแท็บ **การปันส่วน** ให้เลือก **แก้ไขการตั้งค่าคอนฟิก** ตามค่าเริ่มต้น จะมีลำดับชั้นการปันส่วนที่มีสี่ชั้น ได้แก่ `Channel` (ชั้นบนสุด) `customerGroup` (ชั้นที่สอง) `Region` (ชั้นที่สาม) และ `OrderType` (ชั้นที่สี่)
1. คุณสามารถลบกลุ่มการปันส่วนที่มีอยู่ โดยเลือก **X** ถัดจากกลุ่มการปันส่วนนั้น คุณยังสามารถเพิ่มกลุ่มการปันส่วนใหม่เข้าในลำดับชั้นได้ ด้วยการป้อนชื่อของแต่ละกลุ่มใหม่โดยตรงในฟิลด์

    > [!IMPORTANT]
    > ต้องระวังเมื่อคุณลบหรือเปลี่ยนการแมปลำดับชั้นของการปันส่วน สําหรับแนวทาง ให้ดูที่ [เคล็ดลับสําหรับการใช้การปันส่วน](#allocation-tips)

1. เมื่อคุณตั้งค่าคอนฟิกกลุ่มการปันส่วนและการตั้งค่าลำดับชั้นเสร็จสิ้นแล้ว บันทึกการเปลี่ยนแปลงของคุณ แล้วเลือก **อัปเดตการตั้งค่าคอนฟิก** ที่ด้านขวาบน ค่าของกลุ่มการปันส่วนที่ตั้งค่าคอนฟิกจะได้รับการอัปเดตเมื่อคุณสร้างการปันส่วนโดยใช้อินเทอร์เฟสผู้ใช้หรือ API POST (/api<wbr>/environment<wbr>/\{environmentId\}<wbr>/allocation<wbr>/allocate) รายละเอียดเกี่ยวกับทั้งสองวิธีการมีอยู่ในตอนท้ายของบทความนี้

ถ้าคุณใช้ชื่อกลุ่มสี่ชื่อและตั้งค่าเป็น \[`channel`, `customerGroup`, `region`, `orderType`\] ชื่อเหล่านี้จะมีผลบังคับใช้กับการร้องขอที่เกี่ยวข้องกับการปันส่วน เมื่อคุณเรียก API การอัปเดตการตั้งค่าคอนฟิก

### <a name="tips-for-using-allocation"></a><a name="allocation-tips"></a>เคล็ดลับในการใช้การปันส่วน

- สำหรับผลิตภัณฑ์ทุกรายการ ฟังก์ชัน allocation ควรจะใช้ใน *ระดับมิติ* เดียวกันตามลำดับชั้นของดัชนีผลิตภัณฑ์ที่คุณตั้งค่าใน [การตั้งค่าคอนฟิกตามลำดับชั้นของดัชนีผลิตภัณฑ์](inventory-visibility-configuration.md#index-configuration) ตัวอย่างเช่น สมมุติว่าลำดับชั้นดัชนีของคุณคือ \[`Site`, `Location`, `Color`, `Size`\] ถ้าคุณปันส่วนปริมาณบางอย่างให้กับผลิตภัณฑ์หนึ่งในระดับมิติ \[`Site`, `Location`, `Color`\] ในครั้งถัดไปที่คุณต้องการปันส่วนผลิตภัณฑ์นี้ คุณควรปันส่วนที่ระดับเดียวกัน ด้วย \[`Site`, `Location`, `Color`\] ถ้าคุณใช้ระดับ \[`Site`, `Location`, `Color`, `Size`\] หรือ \[`Site`, `Location`\] ข้อมูลจะไม่สอดคล้องกัน
- **การปรับเปลี่ยนกลุ่มการปันส่วนและลำดับชั้น:** ถ้ามีข้อมูลการปันส่วนอยู่ในระบบอยู่แล้ว การลบกลุ่มการปันส่วนที่มีอยู่หรือการยกลำดับชั้น ของกลุ่มการปันส่วน จะรบกวนการแมปที่มีอยู่ระหว่างกลุ่มการปันส่วน ดังนั้น ต้องแน่ใจว่าได้ล้างข้อมูลเก่าทั้งหมดด้วยตนเอง ก่อนที่คุณจะอัปเดตการตั้งค่าคอนฟิกใหม่ของคุณ อย่างไรก็ตาม เนื่องจากการเพิ่มกลุ่มการปันส่วนใหม่ไปยังลำดับล่างสุด ไม่ส่งผลกระทบต่อการแมปที่มีอยู่ คุณจะไม่ต้องการล้างข้อมูล
- การปันส่วนจะเสร็จสิ้นเฉพาะเมื่อผลิตภัณฑ์มีปริมาณเป็น `available_to_allocate` บวกเท่านั้น
- เมื่อต้องการปันส่วนผลิตภัณฑ์จากกลุ่ม *ระดับการปันส่วน* สูงไปยังกลุ่มย่อย ให้ใช้ API ของ `Reallocate` ตัวอย่างเช่น คุณมีลำชั้นกลุ่มการปันส่วน \[`channel`, `customerGroup`, `region`, `orderType`\] และคุณต้องการปันส่วนผลิตภัณฑ์บางรายการจากกลุ่มการปันส่วน \[Online, VIP\] ไปยังกลุ่มการปันส่วน \[Online, VIP, EU\] ให้ใช้ API `Reallocate` เพื่อย้ายปริมาณ ถ้าคุณใช้ API `Allocate` API จะปันส่วนปริมาณจากกลุ่มทั่วไปเสมือน
- เมื่อต้องการดูความพร้อมใช้งานของผลิตภัณฑ์โดยรวม (กลุ่มทั่วไป) ให้ใช้ API [ปริมาณคงคลังคงเหลือของการสอบถาม](inventory-visibility-api.md#query-on-hand) เพื่อร้องขอยอดสินค้าคงคลัง *ที่พร้อมจะปันส่วน* จากนั้นคุณสามารถตัดสินใจปันส่วนตามข้อมูลนี้ได้

## <a name="use-the-allocation-api"></a><a name="using-allocation-api"></a>ใช้ API การปันส่วน

ปัจจุบัน API การปันส่วนห้ารายการเปิดอยู่

- **POST /api<wbr>/environment<wbr>/\{environmentId\}<wbr>/allocation<wbr>/allocate** – API นี้ถูกใช้เพื่อสร้างการปันส่วนเริ่มต้น
- **POST /api<wbr>/environment<wbr>/\{environmentId\}<wbr>/allocation<wbr>/unallocate** – API นี้ถูกใช้เพื่อแปลงหรือลบปริมาณที่ปันส่วน
- **POST /api<wbr>/environment<wbr>/\{environmentId\}<wbr>/allocation<wbr>/reallocate** – API นี้ถูกใช้เพื่อย้ายปริมาณที่ปันส่วนจากการปันส่วนที่มีอยู่ไปยังกลุ่มการปันส่วนอื่นๆ
- **POST /api<wbr>/environment<wbr>/\{environmentId\}<wbr>/allocation<wbr>/consume** – API นี้ถูกใช้เพื่อหักลด (ใช้) ปริมาณที่ปันส่วน
- **POST /api<wbr>/environment<wbr>/\{environmentId\}<wbr>/allocation<wbr>/query** – API นี้ใช้เพื่อตรวจสอบเรกคอร์ดการปันส่วนที่มีอยู่ โดยเทียบกับกลุ่มการปันส่วนและลำดับชั้น

### <a name="allocate"></a>ปันส่วน

เรียกใช้ API `Allocate` เพื่อปันส่วนผลิตภัณฑ์ที่มีมิติเฉพาะ ต่อไปนี้เป็น Schema ของเนื้อหาคำขอ

```json
{
    "id": "string",
    "productId": "string",
    "dimensionDataSource": "string",
    "groups": {
        "groupA": "string",
        "groupB": "string",
        "groupC": "string"
    },
    "quantity": 0,
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    }
}
```

ตัวอย่างเช่น คุณต้องการปันส่วนปริมาณ 10 รายการให้กับผลิตภัณฑ์ *จักรยาน* ไซต์ *1* สถานที่ *11* สี *แดง* ช่องทาง *ออนำลน์* กลุ่มลูกค้า *VIP* และภูมิภาค *US* เมื่อต้องการปันส่วนนี้ คุณสามารถเรียกใช้ที่มีเนื้อหาต่อไปนี้

```json
{
    "id": "test101",
    "productId": "Bike",
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
    "quantity": 10,
    "organizationId": "usmf",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    }
}
```

ปริมาณต้องมากกว่า 0 (ศูนย์)

### <a name="unallocate"></a>ยกเลิกการปันส่วน

ใช้ API `Unallocate` เพื่อกลับรายการการดําเนินงาน `Allocate` ไม่อนุญาตให้ใช้ปริมาณค่าลบในการดําเนินงาน `Allocate` เนื้อหาของ `Unallocate` จะเหมือนกับเนื้อหาของ `Allocate`

### <a name="reallocate"></a>ปันส่วนใหม่

ใช้ API `Reallocate` เพื่อย้ายปริมาณที่ปันส่วนบางรายการไปยังชุดข้อมูลกลุ่มอื่น ต่อไปนี้เป็น Schema ของเนื้อหาคำขอ

```json
{
    "id": "string",
    "productId": "string",
    "dimensionDataSource": "string",
    "sourceGroups": {
        "groupA": "string",
        "groupB": "string",
        "groupC": "string"
    },
    "groups": {
        "groupD": "string",
        "groupE": "string",
        "groupF": "string"
    },
    "quantity": 0,
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    }
}
```

ตัวอย่างเช่น คุณสามารถย้ายจักรยาน 2 คัน ที่มีมิติ \[site=1, location=11, color=red\] จากกลุ่มการปันส่วน \[Online, VIP, US\] ไปยังกลุ่มการปันส่วน \[Online, VIP, EU\] โดยการเรียก API `Reallocate` และระบุข้อความเนื้อหาต่อไปนี้

```json
{
    "id": "test102",
    "productId": "Bike",
    "sourceGroups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "EU"
    },
    "quantity": 2,
    "organizationId": "usmf",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    }
}
```

### <a name="consume"></a>ใช้

ใช้ API `Consume` เพื่อลงรายการบัญชีปริมาณการใช้วัสดุเทียบกับการปันส่วน ตัวอย่างเช่น คุณอาจใช้ API นี้เพื่อย้ายปริมาณที่ปันส่วนไปยังบางการวัดจริง ต่อไปนี้เป็น Schema ของเนื้อหาคำขอ

```json
{
    "id": "string",
    "productId": "string",
    "dimensionDataSource": "string",
    "groups": {
        "groupA": "string",
        "groupB": "string",
        "groupC": "string"
    },
    "quantity": 0,
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    },
    "physicalMeasures": {
        "datasource1": {
            "measure": "string" // Addition or Subtraction
        }
    }
}
```

ตัวอย่างเช่น มีจักรยานที่ปันส่วน 8 คัน ที่มีมิติ \[site=1, location=11, color=red\] สำหรับกลุ่มการปันส่วน \[Online, VIP, US\] สูตร available-to-allocate ต่อไปนี้ถูกใช้:

`@iv.@available_to_allocate` = `fno.onordered` + `pos.inbound` – `@iv.@allocated`

จักรยาน 8 คันมีการปันส่วนจากการวัด `pos.inbound`

ขณะนี้ มีการขายจักรยานสามคันแล้ว และได้มาจากกลุ่มการปันส่วน เมื่อต้องการลงทะเบียนการย้ายนี้ คุณสามารถเรียกใช้ที่มีเนื้อความคำขอต่อไปนี้

```json
{
    "id": "test103",
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
    "quantity": 3,
    "physicalMeasures": {
        "pos": {
            "inbound": "Subtraction"
        }
    }
}
```

หลังจากการเรียกใช้นี้ ปริมาณที่ปันส่วนของผลิตภัณฑ์จะลดลงเป็น 3 นอกจากนี้ การมองเห็นสินค้าคงคลังจะสร้างเหตุการณ์การเปลี่ยนแปลงปริมาณคงคลังคงเหลือที่ `pos.inbound` = *-3* หรือคุณสามารถเก็บรักษาค่า `pos.inbound` ตามที่ใช้และใช้ปริมาณที่ปันส่วน อย่างไรก็ตาม ในกรณีนี้ คุณต้องสร้างการวัดทางกายภาพอื่นเพื่อรักษาปริมาณที่ใช้ไปหรือใช้การวัด `@iv.@consumed` ที่กําหนดล่วงหน้า

ในคำขอนี้ ให้สังเกตว่าการวัดทางกายภาพที่คุณใช้ในเนื้อหาคำขอใช้ควรใช้ชนิดตัวแก้ไขที่ตรงข้าม (การบวกเพิ่มหรือการหักลบ) เปรียบเทียบกับชนิดตัวแก้ไขที่ใช้ในการวัดที่คํานวณ ดังนั้น ในเนื้อหาการใช้นี้ `iv.inbound` จะใช้ค่า `Subtraction` ไม่ใช่ `Addition`

แหล่งข้อมูล `fno` ไม่สามารถใช้ในเนื้อหาการใช้ตามที่อ้างสิทธิ์เสมอว่าการมองเห็นสินค้าคงคลังไม่สามารถเปลี่ยนข้อมูลใดๆ ของแหล่งข้อมูล `fno` ได้ ผังลำดับข้อมูลเป็นแบบทางเดียว ซึ่งหมายความว่าการเปลี่ยนแปลงปริมาณทั้งหมดสำหรับแหล่งข้อมูล `fno` ต้องมาจากสภาพแวดล้อม Supply Chain Management ของคุณ

### <a name="consume-as-a-soft-reservation"></a><a name="consume-to-soft-reserved"></a>ใช้เป็นการจองทรัพยากรแบบไม่ตายตัว

API `Consume` สามารถใช้ปริมาณที่ปันส่วนเป็นการจองแบบไม่ตายตัว ในกรณีนี้ การดําเนินงาน `Consume` จะลดปริมาณที่ปันส่วน แล้วดําเนินการจองแบบไม่ตายตัวให้กับปริมาณนั้น หากต้องการใช้วิธีการนี้ คุณต้องใช้งานคุณลักษณะ [การจองแบบไม่ตายตัว](inventory-visibility-reservations.md) ของการมองเห็นสินค้าคงคลังด้วย

ตัวอย่างเช่น คุณได้ตั้งค่าการวัดทางกายภาพของการจองแบบชั่วคราว เป็น `iv.softreserved` สูตรต่อไปนี้จะใช้กับการวัดที่คํานวณได้ available-to-reserve

`iv.available_to_reserve` = `fno.onordered` + `pos.inbound` – `iv.softreserved`

เมื่อต้องการใช้การตั้งค่านี้โดยใช้คุณลักษณะการปันส่วน ให้เพิ่ม `@iv.@allocated` ใน `iv.available_to_reserve` เพื่อผลิตสูตรต่อไปนี้

`iv.available_to_reserve` = `fno.onordered` + `pos.inbound` – `iv.softreserved` – `@iv.@allocated`

จากนั้นอัปเดต `@iv.@available_to_allocate` เป็นค่าเดียวกัน

เมื่อคุณต้องการใช้ปริมาณ 3 และจองปริมาณนี้โดยตรง คุณสามารถเรียกใช้ที่มีเนื้อหาคำขอต่อไปนี้

```json
{
    "id": "???",
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
    "quantity": 3,
    "physicalMeasures": {
        "iv": {
            "softreserved": "Addition"
        }
    }
}
```

ในคำขอนี้ ให้สังเกตง่า `iv.softreserved` มีค่า `Addition` ไม่ใช่ `Subtraction`

### <a name="query"></a>การสอบถาม

ใช้ API `Query` เพื่อดึงข้อมูลที่เกี่ยวข้องกับการปันส่วนจากผลิตภัณฑ์บางรายการ คุณสามารถใช้ตัวกรองมิติและตัวกรองกลุ่มการปันส่วนเพื่อทำผลลัพธ์ให้แคบลง มิติต้องตรงกับที่คุณต้องการดึงข้อมูลอย่างแม่นยำ ตัวอย่างเช่น \[site=1, location=11\] จะมีผลลัพธ์ที่ไม่เกี่ยวข้องเปรียบเทียบกับ \[site=1, location=11, color=red\]

```json
{
    "productId": "string",
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    },
    "groups": {
        "additionalProp1": "string",
        "additionalProp2": "string",
        "additionalProp3": "string"
    },
}
```

ตัวอย่างเช่น ใช้ฟิลด์ \[site=1, location=11, color=red\] และกลุ่มที่ว่างเปล่าเพื่อที่จะได้รับเรกคอร์ดการปันส่วนทั้งหมด

```json
{
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
}
```

ใช้ \[site=1, location=11, color=red\] และกลุ่ม \[channel=Online, customerGroup=VIP, region=US\] เพื่อที่จะได้รับเรกคอร์ดการปันส่วนของกลุ่มนี้:

```json
{
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "groups": {
        "channel": "Web",
        "customerGroup": "VIP",
        "region": "US"
    },
}
```

## <a name="use-the-allocation-user-interface"></a>ใช้อินเทอร์เฟสผู้ใช้การปันส่วน

คุณสามารถจัดการการปันส่วนด้วยตนเองผ่านอินเทอร์เฟสผู้ใช้โดยการเปิดแอป Inventory Visibility และไปที่ **การมองเห็นสถานะการดำเนินงาน \> การปันส่วน** จากที่นั่น คุณสามารถปฏิบัติการใดๆ ที่อธิบายไว้ในส่วนย่อยต่อไปนี้

### <a name="create-an-allocation"></a>สร้างการปันส่วน

ปฏิบัติตามขั้นตอนต่อไปนี้เพื่อสร้างการปันส่วนจากหน้า **การปันส่วน** ของแอป Inventory Visibility

1. เลือก **การปันส่วน**
1. ตั้งค่าฟิลด์พื้นฐาน มิติ และค่ากลุ่มการปันส่วนเป้าหมาย (เมื่อคุณเลือกรวบรวมแหล่งข้อมูลในส่วน **มิติ** ก่อนอื่นให้ใช้รายการแบบหล่นลงเพื่อระบุมิติ (ตัวอย่างเช่น `siteId`) จากนั้นป้อนค่ามิติในฟิลด์ที่ปรากฏ)
1. เลือก **ส่ง**

### <a name="consume-an-allocation"></a>ใช้การปันส่วน

เลือก **ใช้** เพื่อใช้การปันส่วน เพื่อให้แน่ใจว่าคุณจะใช้ภายในกลุ่มการปันส่วนและลำดับชั้นที่ถูกต้อง ให้ป้อนชุดขององค์กรและรายละเอียดมิติเดียวกันกับที่คุณป้อนเมื่อคุณสร้างการปันส่วน

### <a name="reallocate-an-allocation"></a>ปันส่วนการปันส่วนใหม่

เลือก **ปันส่วนใหม่** เพื่อย้ายปริมาณที่ปันส่วนที่มีอยู่จากชุดกลุ่มการปันส่วนหนึ่งไปยังชุดกลุ่มการปันส่วนอื่น

### <a name="query-existing-allocations"></a>สอบถามการปันส่วนที่มีอยู่

เลือก **การสอบถาม** แล้วป้อนค่าผลิตภัณฑ์ องค์กร มิติ และกลุ่มการปันส่วน เพื่อดูผลการสอบถามของการปันส่วนที่มีอยู่
