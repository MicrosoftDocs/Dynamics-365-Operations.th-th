---
title: "ใช้ Add-in ของ Excel"
description: "หัวข้อนี้อธิบายวิธีการเปิดข้อมูลเอนทิตีใน Microsoft Excel และจากนั้นดู อัพเดต และแก้ไขข้อมูลโดยใช้ Add-in ของ Microsoft Dynamics Office สำหรับ Excel"
author: ChrisGarty
manager: AnnBe
ms.date: 04/11/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User
ms.reviewer: sericks
ms.search.scope: Core, Operations
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: cgarty
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: HT
ms.sourcegitcommit: a8b5a5af5108744406a3d2fb84d7151baea2481b
ms.openlocfilehash: e0e3e86820e0857b320d832c3bf3c94757667919
ms.contentlocale: th-th
ms.lasthandoff: 04/13/2018

---

# <a name="use-the-excel-add-in"></a>ใช้ Add-in ของ Excel

[!include [banner](../includes/banner.md)]

หัวข้อนี้อธิบายวิธีการเปิดข้อมูลเอนทิตีใน Microsoft Excel และจากนั้นดู อัพเดต และแก้ไขข้อมูลโดยใช้ Add-in ของ Microsoft Dynamics Office สำหรับ Excel เมื่อต้องการเปิดเอนทิตีข้อมูล คุณสามารถเริ่มจาก Excel หรือ Microsoft Dynamics 365 for Finance and Operations อย่างใดอย่างหนึ่ง

โดยการเปิดข้อมูลเอนทิตีใน Excel คุณสามารถดูและแก้ไขข้อมูลได้อย่างรวดเร็วและอย่างง่ายดายโดยใช้ Add-in ของ Excel Add-in นี้จำเป็นต้องมี Microsoft Excel 2016

> [!NOTE]
> หากผู้เช่า Microsoft Azure Active Directory (Azure AD) ของคุณถูกตั้งค่าคอนฟิกให้ใช้ Active Directory Federation Services (AD FS) คุณต้องแน่ใจว่ามีการใช้การอัพเดตเดือนพฤษภาคม 2016 สำหรับ Office เพื่อให้ Add-in ของ Excel สามารถนำคุณเข้าสู่ระบบได้อย่างถูกต้อง

เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับการใช้ add-in ของ Excel ให้ดูวิดีโอ [สร้างเท็มเพลต Excel สำหรับหัวข้อและรูปแบบรายการใน Dynamics 365 for Finance and Operations](https://youtu.be/RTicLb-6dbI) แบบย่อ

## <a name="open-entity-data-in-excel-when-you-start-from-finance-and-operations"></a>เปิดข้อมูลเอนทิตีใน Excel เมื่อคุณเริ่มการทำงานจาก Finance and Operations
1. ในหน้าใน Finance and Operations เลือก **เปิดใน Microsoft Office**

    ถ้าแหล่งข้อมูลราก (ตาราง) สำหรับหน้าเหมือนกับแหล่งข้อมูลรากสำหรับเอนทิตีใดๆ ตัวเลือก **เปิดใน Excel** จะถูกสร้างขึ้นสำหรับหน้านั้น สามารถดูตัวเลือก **เปิดใน Excel**ได้ในหน้าที่ใช้บ่อย เช่น **ผู้จัดจำหน่ายทั้งหมด** และ **ลูกค้าทั้งหมด**
 
2. เลือกตัวเลือก **เปิดใน Excel** และเปิดสมุดงานที่สร้างขึ้น สมุดงานนี้มีข้อมูลการผูกข้อมูลสำหรับเอนทิตี ตัวชี้ไปยังสภาพแวดล้อมของคุณ และตัวชี้ไปยัง Add-in ของ Excel
3. ใน Excel เลือก **เปิดใช้งานการแก้ไข** เพื่อเปิดใช้งาน Add-in ของ Excel เพื่อให้รัน Add-in ของ Excel จะทำงานในบานหน้าต่างด้านขวาของหน้าต่าง Excel
4. ถ้าคุณกำลังเรียกใช้ Add-in ของ Excel เป็นครั้งแรก เลือก **เชื่อถือ Add-in นี้**
5. ถ้าคุณได้รับการพร้อมท์ให้เข้าสู่ระบบ เลือก **เข้าสู่ระบบ** และจากนั้นเข้าสู่ระบบโดยใช้ข้อมูลประจำตัวเดียวกับที่คุณใช้เพื่อเข้าสู่ Finance and Operations Add-in ของ Excel จะใช้บริบทการลงชื่อเข้าใช้ก่อนหน้าจาก Internet Explorer และจะลงชื่อเข้าใช้ให้กับคุณโดยอัตโนมัติ ถ้าสามารถทำได้ ดังนั้น ให้ตรวจสอบชื่อผู้ใช้ในมุมขวาด้านบนของ Add-in ของ Excel

Add-in ของ Excel จะอ่านข้อมูลสำหรับเอนทิตีที่คุณเลือกโดยอัตโนมัติ หมายเหตุว่าไม่มีข้อมูลใดๆ ในสมุดงานจนกระทั่ง Add-in ของ Excel มีการอ่าน

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a>เปิดข้อมูลเอนทิตีใน Excel เมื่อคุณเริ่มการทำงานจาก Excel
1. ใน Excel บนแท็บ **แทรก** ในกลุ่ม **Add-in** เลือก **ร้านค้า** เพื่อเปิด Office Store
2. ใน Office Store ค้นหาโดยใช้คำสำคัญ **ไดนามิก** และเลือก **เพิ่ม** ถัดจาก **Microsoft Dynamics Office Add-in** (the Excel add-in)
3. ถ้าคุณกำลังเรียกใช้ Add-in ของ Excel เป็นครั้งแรก เลือก **เชื่อถือ Add-in นี้** เพื่อเปิดใช้งาน Add-in ของ Excel เพื่อให้รัน Add-in ของ Excel จะทำงานในบานหน้าต่างด้านขวาของหน้าต่าง Excel
4. เลือก **เพิ่มข้อมูลเซิร์ฟเวอร์** เพื่อเปิดบานหน้าต่าง **ตัวเลือก**
5. ในเบราเซอร์ของคุณ คัดลอก URL ของอินสแตนซ์ Finance and Operations เป้าหมายของคุณ วางลงในฟิลด์ **URL ของเซิร์ฟเวอร์** และจากนั้นลบทุกอย่างหลังชื่อโฮสต์ URL ที่เป็นผลลัพธ์ควรมีเพียงชื่อโฮสต์เดียว

    ตัวอย่างเช่น ถ้า URL คือ `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage` ลบทุกอย่างยกเว้น `https://xxx.dynamics.com`

6. เลือก **ตกลง** แล้วเลือก **ใช่** เพื่อยืนยันการเปลี่ยนแปลง Add-in ของ Excel ถูกรีสตาร์ทและโหลดข้อมูลเมตา

    ปุ่ม **การออกแบบ** พร้อมใช้งานแล้วในขณะนี้ ถ้า Add-in ของ Excel มีปุ่ม **โหลดแอปเพล็ต** คุณอาจไม่ได้เข้าสู่ระบบในฐานะผู้ใช้ที่ถูกต้อง สำหรับข้อมูลเพิ่มเติม ดู "มีการแสดงปุ่มโหลดแอปเพล็ต" ในส่วน [การแก้ไขปัญหาเบื้องต้น](https://docs.microsoft.com/en-us/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting) ของหัวข้อนี้

7. เลือก **การออกแบบ** Add-in ของ Excel ดึงข้อมูลเมตาของเอนทิตี
8. เลือก **เพิ่มตาราง** รายการของเอนทิตีปรากฏขึ้น เอนทิตีจะแสดงรายการในรูปแบบ "ชื่อ - ป้ายชื่อ"
9. เลือกเอนทิตีในรายการ เช่น **ลูกค้า - ลูกค้า** แล้วเลือก **ถัดไป**
10. เมื่อต้องการเพิ่มฟิลด์จากรายการ **ฟิลด์ที่มีพร้อมใช้งาน** ไปยังรายการ **ฟิลด์ที่เลือก** ให้เลือกฟิลด์ และจากนั้นเลือก **เพิ่ม** อีกทางหนึ่งคือ ดับเบิลคลิกที่ฟิลด์ในรายการ **ฟิลด์ที่พร้อมใช้งาน**
11. หลังจากที่คุณได้เพิ่มฟิลด์ไปยังรายการ **ฟิลด์ที่เลือก** แล้ว โปรดตรวจสอบให้แน่ใจว่าเคอร์เซอร์อยู่ในตำแหน่งที่ถูกต้องในแผ่นงาน (ตัวอย่างเช่น เซลล์ A1) และจากนั้นเลือก **เสร็จสิ้น** แล้วเลือก **เสร็จสิ้น** เพื่อออกจากการออกแบบ
12. เลือก **รีเฟรช** เพื่อดึงชุดข้อมูล

## <a name="view-and-update-entity-data-in-excel"></a>ดูและอัพเดตข้อมูลเอนทิตีใน Excel
หลังจาก Add-in ของ Excel อ่านข้อมูลเอนทิตีลงในสมุดงาน คุณสามารถอัพเดตข้อมูลได้ตลอดเวลาโดยการเลือก **รีเฟรช** ใน Add-in ของ Excel

## <a name="edit-entity-data-in-excel"></a>แก้ไขข้อมูลของเอนทิตีใน Excel
คุณสามารถเปลี่ยนแปลงข้อมูลเอนทิตีได้ตามที่คุณต้องการ แล้วเผยแพร่กลับมาโดยการเลือก **เผยแพร่** ใน Add-in ของ Excel เมื่อต้องการแก้ไขเรกคอร์ด เลือกเซลล์ในแผ่นงาน และจากนั้นเปลี่ยนค่าในเซลล์ เมื่อต้องการเพิ่มเรกคอร์ดใหม่ ให้ทำตามขั้นตอนเหล่านี้:

- คลิกที่ใดก็ได้ในตารางแหล่งข้อมูล และจากนั้นเลือก **สร้าง** ใน Add-in ของ Excel
- คลิกที่ใดก็ได้ในแถวสุดท้ายของตารางแหล่งข้อมูล และจากนั้นกดแป้น Tab จนกว่าเคอร์เซอร์จะย้ายออกจากคอลัมน์สุดท้ายของแถวนั้น และแถวใหม่ถูกสร้างขึ้น
- คลิกที่ใดก็ได้ในแถวโดยทันทีที่ด้านล่างตารางแหล่งข้อมูล และเริ่มป้อนข้อมูลในเซลล์ เมื่อคุณย้ายโฟกัสออกจากเซลล์นั้น ตารางแหล่งข้อมูลจะขยายเพื่อรวมแถวใหม่
- สำหรับการผูกฟิลด์ของเรกคอร์ดหัวข้อ ให้เลือกฟิลด์ใดฟิลด์หนึ่ง และเลือก **สร้าง** ใน Add-in ของ Excel

หมายเหตุว่าคุณสามารถสร้างเรกคอร์ดใหม่ได้ถ้าคีย์และฟิลด์บังคับทั้งหมดถูกผูกไว้ในแผ่นงาน หรือค่าเริ่มต้นถูกกรอกข้อมูลโดยใช้เงื่อนไขตัวกรองเท่านั้น

เมื่อต้องการลบเรกคอร์ด ให้ทำตามขั้นตอนเหล่านี้:

- คลิกขวาที่หมายเลขแถวที่อยู่ถัดจากแถวของแผ่นงานที่ควรถูกลบ และจากนั้นเลือก **ลบ**
- คลิกขวาที่ใดก็ได้ในแถวของแผ่นงานที่ควรถูกลบ และจากนั้นเลือก **ลบ** &gt; **แถวของตาราง**

ถ้าแหล่งข้อมูลถูกเพิ่มเป็นแหล่งข้อมูลที่เกี่ยวข้อง จะมีการเผยแพร่หัวข้อก่อนรายการ ถ้ามีการขึ้นต่อกันระหว่างแหล่งข้อมูลอื่นๆ คุณอาจต้องเปลี่ยนลำดับการเผยแพร่ค่าเริ่มต้น เมื่อต้องการเปลี่ยนลำดับการเผยแพร่ ใน add-in ของ Excel เลือกปุ่ม **ตัวเลือก** (สัญลักษณ์เกียร์) และจากนั้น บน FastTab **ตัวเชื่อมต่อข้อมูล** เลือก **ตั้งค่าคอนฟิกการเผยแพร่ใบสั่ง**

## <a name="add-or-remove-columns"></a>เพิ่มหรือเอาคอลัมน์ออก
คุณสามารถใช้ตัวออกแบบในการปรับปรุงคอลัมน์ที่ถูกเพิ่มไปยังแผ่นงานโดยอัตโนมัติ

> [!NOTE]
> ถ้าปุ่ม **ออกแบบ** ไม่ปรากฏด้านล่างของปุ่ม **ตัวกรอง** ใน add-in ของ Excel คุณต้องเปิดใช้งานตัวออกแบบแหล่งข้อมูล เลือกปุ่ม **ตัวเลือก** (สัญลักษณ์เกียร์) และจากนั้นเลือกกล่องกาเครื่องหมาย **เปิดใช้งานการออกแบบ**

1. ใน Add-in ของ Excel เลือก **ออกแบบ** แหล่งข้อมูลทั้งหมดมีแสดงรายการไว้
2. ถัดจากแหล่งข้อมูล เลือกปุ่ม **แก้ไข** (สัญลักษณ์ดินสอ)
3. ในรายการ **ฟิลด์ที่เลือก** ปรับรายการของฟิลด์ตามที่คุณต้องการ:

    - เมื่อต้องการเพิ่มฟิลด์จากรายการ **ฟิลด์ที่มีพร้อมใช้งาน** ไปยังรายการ **ฟิลด์ที่เลือก** ให้เลือกฟิลด์ และจากนั้นเลือก **เพิ่ม** อีกทางหนึ่งคือ ดับเบิลคลิกที่ฟิลด์ในรายการ **ฟิลด์ที่พร้อมใช้งาน**
    - เมื่อต้องการเอาฟิลด์ออกจากรายการ **ฟิลด์ที่เลือก** เลือกฟิลด์ และจากนั้นเลือก **เอาออก** อีกวิธีหนึ่งคือ คลิกที่ฟิลด์สองครั้ง
    - เมื่อต้องการเปลี่ยนลำดับของฟิลด์ในรายการ **ฟิลด์ที่เลือก** เลือกฟิลด์ และจากนั้นเลือก **ขึ้น** หรือ **ลง**

4. เมื่อต้องการนำการเปลี่ยนแปลงของคุณไปใช้กับแหล่งข้อมูล เลือก **อัพเดต** แล้วเลือก **เสร็จสิ้น** เพื่อออกจากการออกแบบ
5. ถ้าคุณเพิ่มฟิลด์ (คอลัมน์) แล้ว ให้เลือก **รีเฟรช** เพื่อดึงชุดข้อมูลที่อัพเดตแล้ว

## <a name="copy-environment-data"></a>คัดลอกข้อมูลสภาพแวดล้อม

ข้อมูลที่ถูกอ่านลงในสมุดงานจากสภาพแวดล้อมเดียว สามารถถูกคัดลอกไปยังสภาพแวดล้อมอื่นได้ อย่างไรก็ตาม คุณไม่สามารถเพียงแค่เปลี่ยน URL การเชื่อมต่อ เนื่องจากแคชข้อมูลในสมุดงานจะดำเนินต่อเพื่อจัดการข้อมูลในฐานะข้อมูลที่มีอยู่ คุณต้องใช้ฟังก์ชัน Copy Environment Data เพื่อการเผยแพร่ข้อมูลไปยังสภาพแวดล้อมใหม่ในฐานะข้อมูลใหม่แทน

1. เลือกปุ่ม **ตัวเลือก** (สัญลักษณ์เกียร์) จากนั้นบน FastTab **ตัวเชื่อมต่อข้อมูล** เลือก **Copy Environment Data** 
2. ป้อนเซิร์ฟเวอร์ URL สำหรับสภาพแวดล้อมใหม่ 
3. เลือก **ตกลง** แล้วเลือก **ใช่** เพื่อยืนยันการดำเนินการ add-in ของ Excel จะถูกรีสตาร์ท และเชื่อมต่อกับสภาพแวดล้อมใหม่ ข้อมูลที่มีอยู่ใดๆ ในสมุดงานจะถือเป็นข้อมูลใหม่

    หลังจาก add-in ของ Excel ถูกรีสตาร์ท กล่องข้อความแจ้งว่า สมุดงานอยู่ในโหมดสำเนาสภาพแวดล้อม

4. เมื่อต้องการคัดลอกข้อมูลไปยังสภาพแวดล้อมใหม่ในฐานะข้อมูลใหม่ เลือก **เผยแพร่** เพื่อยกเลิกการดำเนินการคัดลอกสภาพแวดล้อม และตรวจทานข้อมูลที่มีอยู่ในสภาพแวดล้อมใหม่ เลือก **รีเฟรช**

## <a name="troubleshooting"></a>การแก้ไขปัญหา
มีปัญหาบางอย่างที่สามารถแก้ไขได้ผ่านขั้นตอนง่ายๆ

- **มีการแสดงปุ่มโหลดแอปเพล็ต** – ถ้า Add-in ของ Excel มีปุ่ม **โหลดแอปเพล็ต** หลังจากที่คุณเข้าสู่ระบบ คุณอาจไม่ได้เข้าสู่ระบบในฐานะผู้ใช้ที่ถูกต้อง เมื่อต้องการแก้ไขปัญหานี้ โปรดตรวจสอบว่าชื่อผู้ใช้ที่ถูกต้องปรากฏอยู่ในมุมขวาด้านบนของ Add-in ของ Excel หรือไม่ ถ้าชื่อผู้ใช้ที่ไม่ถูกต้องปรากฏขึ้น ให้เลือก ลงชื่อออก และจากนั้นลงชื่อเข้าใช้กลับเข้าไป
- **คุณได้รับข้อความ "ไม่ได้รับอนุญาต"** – ถ้าคุณได้รับข้อความ "ไม่ได้รับอนุญาต" ในขณะที่ Add-in ของ Excel กำลังโหลดข้อมูลเมตา บัญชีผู้ใช้ที่มีการลงชื่อเข้าใช้ไปยัง Add-in ของ Excel จะไม่มีสิทธิ์ในการใช้บริการ อินสแตนซ์ หรือฐานข้อมูลที่เป็นเป้าหมาย เมื่อต้องการแก้ไขปัญหานี้ โปรดตรวจสอบว่าชื่อผู้ใช้ที่ถูกต้องปรากฏอยู่ในมุมขวาด้านบนของ Add-in ของ Excel หรือไม่ ถ้าชื่อผู้ใช้ที่ไม่ถูกต้องปรากฏขึ้น ให้เลือก ลงชื่อออก และจากนั้นลงชื่อเข้าใช้กลับเข้าไป
- **เว็บเพจที่ว่างเปล่าที่ถูกแสดงขึ้นเหนือ Excel** – ถ้าเว็บเพจที่ว่างเปล่าถูกเปิดขึ้นในระหว่างกระบวนการเข้าสู่ระบบ บัญชีนั้นจำเป็นต้องมี AD FS แต่รุ่นของ Excel ที่กำลังเรียกใช้ Add-in ของ Excel ไม่ใช่รุ่นที่ใหม่พอที่จะโหลดกล่องโต้ตอบการเข้าสู่ระบบได้ เมื่อต้องการแก้ไขปัญหานี้ ให้อัพเดตรุ่นของ Excel ที่คุณใช้อยู่ เมื่อต้องการอัพเดตรุ่นของ Excel เมื่อคุณอยู่ในองค์กรที่อยู่ในช่องทางรอการตัดบัญชี ใช้ [เครื่องมือการปรับใช้ Office](https://technet.microsoft.com/library/jj219422.aspx) เพื่อ [ย้ายจากช่องทางรอการตัดบัญชีไปยังช่องทางปัจจุบัน](https://technet.microsoft.com/library/mt455210.aspx)

