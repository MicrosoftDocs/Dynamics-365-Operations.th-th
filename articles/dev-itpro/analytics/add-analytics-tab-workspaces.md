---
title: "เพิ่มการวิเคราะห์ไปยังพื้นที่ทำงานโดยการใช้ Power BI ที่ฝัง"
description: "หัวข้อนี้แสดงวิธีการฝังรายงาน Power BI บนแท็บการวิเคราะห์ของพื้นที่ทำงาน"
author: tjvass
manager: AnnBe
ms.date: 06/21/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
audience: Application user, IT Pro
ms.reviewer: robinr
ms.search.scope: Operations, Platform, UnifiedOperations
ms.search.region: Global
ms.author: tjvass
ms.search.validFrom: 2017-06-30
ms.dyn365.ops.intro: Platform update 8
ms.dyn365.ops.version: July 2017 update
ms.translationtype: HT
ms.sourcegitcommit: fc8102d945faf9ad533f57ec1a45b0e0dc344963
ms.openlocfilehash: d36abbf7c08c56d84ed83dbec1bfa33f30b47ef5
ms.contentlocale: th-th
ms.lasthandoff: 09/29/2017

---

# <a name="add-analytics-to-workspaces-by-using-power-bi-embedded"></a>เพิ่มการวิเคราะห์ไปยังพื้นที่ทำงานโดยการใช้ Power BI ที่ฝัง

[!include[banner](../includes/banner.md)]

> [!NOTE]
> คุณลักษณะนี้ได้รับการสนับสนุนใน Dynamics 365 for Finance and Operations (เวอร์ชัน 7.2 และเวอร์ชันหลังจากนั้น)

# <a name="introduction"></a>คำนำ
หัวข้อนี้แสดงวิธีการฝังรายงาน Microsoft Power BI บนแท็บ **การวิเคราะห์** ของพื้นที่ทำงาน สำหรับตัวอย่างที่กำหนดที่นี่ เราจะขยายพื้นที่ทำงาน **การจัดการการจอง** ในแอพลิเคชันการจัดการยานพาหนะเพื่อฝังพื้นที่ทำงานการวิเคราะห์บนแท็บ **การวิเคราะห์**

# <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น
+ เข้าถึงสภาพแวดล้อมนักพัฒนาที่รันการอัพเดตแพลตฟอร์ม 8 หรือรุ่นที่ใหม่กว่า
+ รายงานเชิงวิเคราะห์ (ไฟล์ .pbix) ที่ถูกสร้างโดยใช้ Microsoft Power BI Desktop และที่มีแบบจำลองข้อมูลที่ต้นทางมาจากฐานข้อมูลร้านค้าเอนทิตี้

# <a name="overview"></a>ภาพรวม
ไม่ว่าคุณจะขยายพื้นที่ทำงานของแอพลิเคชันที่มีอยู่ หรือใช้พื้นที่ทำงานใหม่ของคุณเอง คุณสามารถใช้มุมมองการวิเคราะห์แบบฝังเพื่อจัดส่งมุมมองที่ชาญฉลาดและเชิงโต้ตอบของข้อมูลธุรกิจของคุณ กระบวนการสำหรับการเพิ่มแท็บพื้นที่ทำงานเชิงวิเคราะห์มีสี่ขั้นตอน

1. เพิ่มไฟล์ .pbix เป็นทรัพยากร Dynamics 365
2. กำหนดแท็บพื้นที่ทำงานเชิงวิเคราะห์
3. ฝังทรัพยากร .pbix บนแท็บพื้นที่ทำงาน
4. ตัวเลือก: เพิ่มส่วนขยายเพื่อกำหนดมุมมองเอง

> [!NOTE]
> สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการสร้างรายงานเชิงวิเคราะห์ ให้ดูที่ [เริ่มต้นใช้งานด้วย Power BI Desktop](https://powerbi.microsoft.com/en-us/documentation/powerbi-desktop-getting-started/) หน้านี้คือแหล่งข้อมูลเชิงลึกที่ดีเยี่ยมที่สามารถช่วยคุณในการสร้างโซลูชันการรายงานเชิงวิเคราะห์ที่น่าสนใจ

# <a name="add-a-pbix-file-as-a-resource"></a>เพิ่มไฟล์ .pbix เป็นทรัพยากร
ก่อนที่คุณจะเริ่มต้น คุณจะต้องสร้างหรือดูรายงาน Power BI ที่คุณจะฝังในพื้นที่ทำงาน สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการสร้างรายงานเชิงวิเคราะห์ ให้ดูที่ [เริ่มต้นใช้งานด้วย Power BI Desktop](https://powerbi.microsoft.com/en-us/documentation/powerbi-desktop-getting-started/)
 
ทำตามขั้นตอนเหล่านี้เพื่อเพิ่มไฟล์ .pbix เป็นวัตถุโครงการ Visual Studio

1. สร้างโครงการใหม่ในแบบจำลองที่เหมาะสม
2. ใน Solution Explorer เลือกโครงการ คลิกขวา แล้วเลือก **เพิ่ม** > **รายการใหม่**
3. ในกล่องโต้ตอบ **เพิ่มรายการใหม่** ภายใต้ **วัตถุการดำเนินงาน** เลือกเท็มเพลต **ทรัพยากร**
4. ป้อนชื่อที่จะใช้เป็นการอ้างอิงรายงานในข้อมูลเมตาของ X++ และคลิก **เพิ่ม**

    ![เพิ่มกล่องโต้ตอบรายการใหม่](media/analytical-workspace-add.png)

5. ค้นหาไฟล์ .pbix ที่ประกอบด้วยข้อกำหนดของรายงานเชิงวิเคราะห์ และจากนั้น คลิก **เปิด**

    ![เลือกกล่องโต้ตอบไฟล์ทรัพยากร](media/analytical-workspace-select-resource.png)
  
หลังจากที่คุณได้เพิ่มไฟล์ .pbix เป็นทรัพยากร Dynamics 365 แล้ว คุณสามารถฝังรายงานในพื้นที่ทำงาน และเพิ่มลิงค์โดยตรงโดยใช้รายการเมนู

# <a name="add-a-tab-control-to-an-application-workspace"></a>เพิ่มตัวควบคุมแท็บไปยังพื้นที่ทำงานของแอพลิเคชัน
ในตัวอย่างนี้ เราจะขยายพื้นที่ทำงาน **การจัดการการจอง** ในแบบจำลองการจัดการยานพาหนะโดยการเพิ่มแท็บ **การวิเคราะห์** ไปยังคำนิยามของแบบฟอร์ม **FMClerkWorkspace**
 
ภาพประกอบต่อไปนี้แสดงลักษณะแบบฟอร์ม **FMClerkWorkspace** ในตัวออกแบบใน Microsoft Visual Studio

![แบบฟอร์ม FMClerkWorkspace ก่อนที่จะเปลี่ยนแปลง](media/analytical-workspace-definition-before.png)

ทำตามขั้นตอนเหล่านี้เพื่อขยายแบบฟอร์มคำนิยามสำหรับพื้นที่ทำงาน **การจัดการการจอง**

1. เปิดตัวออกแบบแบบฟอร์มเพื่อขยายคำนิยามการออกแบบ
2. ในข้อกำหนดของการออกแบบ เลือกองค์ประกอบบนสุดที่มีชื่อว่า **ออกแบบ | รูปแบบ: พื้นที่ในการดำเนินงาน**
3. คลิกขวา จากนั้นเลือก **สร้าง** > **แท็บ** เพื่อเพิ่มตัวควบคุมใหม่ที่ชื่อว่า **FormTabControl1**
4. ในตัวออกแบบแบบฟอร์ม เลือก **FormTabControl1**
5. คลิกขวา จากนั้นเลือก **หน้าแท็บใหม่** เพื่อเพิ่มหน้าแท็บใหม่
6. เปลี่ยนชื่อหน้าแท็บเป็นบางสิ่งที่สำคัญ เช่น **พื้นที่ทำงาน**
7. ในตัวออกแบบแบบฟอร์ม เลือก **FormTabControl1**
8. คลิกขวา แล้วเลือก **หน้าแท็บใหม่**
9. เปลี่ยนชื่อหน้าแท็บเป็นบางสิ่งที่สำคัญ เช่น **การวิเคราะห์**
10. ในตัวออกแบบแบบฟอร์ม เลือก **การวิเคราะห์ (หน้าแท็บ)**
11. ตั้งค่าคุณสมบัติ **คำอธิบาย** เป็น **การวิเคราะห์**
12. คลิกขวาตัวควบคุม จากนั้นเลือก **สร้าง** > **กลุ่ม** เพื่อเพิ่มตัวควบคุมกลุ่มแบบฟอร์มใหม่
13. เปลี่ยนกลุ่มแบบฟอร์มเป็นบางสิ่งที่สำคัญ เช่น **powerBIReportGroup**
14. ในแบบฟอร์ม เลือก **PanoramaBody (แท็บ)** แล้วลากตัวควบคุมไปยังแท็บ **พื้นที่ทำงาน**
15. ในข้อกำหนดของการออกแบบ เลือกองค์ประกอบบนสุดที่มีชื่อว่า **ออกแบบ | รูปแบบ: พื้นที่ในการดำเนินงาน**
16. คลิกขวา แล้วเลือก **เอารูปแบบออก**
17. คลิกขวาอีกครั้ง จากนั้นเลือก **เพิ่มรูปแบบ** > **แท็บของพื้นที่ทำงาน**
18. ดำเนินการสร้างเพื่อตรวจสอบการเปลี่ยนแปลงของคุณ
 
ภาพประกอบต่อไปนี้แสดงลักษณะของการออกแบบหลังจากที่มีการใช้การเปลี่ยนแปลงเหล่านี้

![FMClerkWorkspace หลังจากมีการเปลี่ยนแปลง](media/analytical-workspace-definition-after.png)

หลังจากที่คุณได้เพิ่มตัวควบคุมแบบฟอร์มที่จะใช้เพื่อฝังรายงานพื้นที่ทำงาน คุณต้องกำหนดขนาดของตัวควบคุมหลักเพื่อให้รองรับกับโครงร่าง โดยค่าเริ่มต้น ทั้งหน้า **บานหน้าต่างตัวกรอง** และหน้า **แท็บ** จะปรากฏในรายงาน อย่างไรก็ตาม คุณสามารถเปลี่ยนการมองเห็นได้ของตัวควบคุมเหล่านี้ตามความเหมาะสมสำหรับผู้ใช้ปลายทางของรายงาน
 
> [!NOTE]
> สำหรับพื้นที่ทำงานแบบฝัง เราขอแนะนำให้คุณใช้ส่วนขยายเพื่อซ่อนทั้งหน้า **บานหน้าต่างตัวกรอง** และหน้า **แท็บ** เพื่อความสอดคล้องกัน
 
เมื่อถึงขั้นตอนนี้ คุณได้ทำการขยายคำนิยามแบบฟอร์มแอพลิเคชันเสร็จสมบูรณ์แล้ว สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการใช้ส่วนขยายเพื่อทำการเลือกกำหนด ให้ดูที่ [การเลือกกำหนด: การโอเวอร์เลย์และการขยายออก](../extensibility/customization-overlayering-extensions.md)

# <a name="add-x-business-logic-to-embed-a-viewer-control"></a>เพิ่มตรรกะทางธุรกิจ X++ เพื่อฝังการควบคุมตัวแสดง
ทำตามขั้นตอนเหล่านี้เพื่อเพิ่มตรรกะทางธุรกิจที่เริ่มต้นการควบคุม Report Viewer ที่ฝังอยู่ในพื้นที่ทำงาน **การจัดการการจอง**

1. เปิดตัวออกแบบแบบฟอร์ม **FMClerkWorkspace** เพื่อขยายคำนิยามการออกแบบ
2. กด F7 เพื่อเข้าถึงรหัสเบื้องหลังคำนิยามของรหัส
3. ให้เพิ่มรหัส X++ ต่อไปนี้

    ```
    [Form] 
    public class FMClerkWorkspace extends FormRun
    {
        private boolean initReportControl = true;     
        protected void initAnalyticalReport()
        {
            if (!initReportControl)
            {
                return;
            }
            // Note: secure entry point into the Workspace's Analytics report
            if (Global::hasMenuItemAccess(menuItemDisplayStr(FMClerkWorkspace), MenuItemType::Display))
            {
                FMPBIWorkspaceController controller = new FMPBIWorkspaceController();
                PBIReportHelper::initializeReportControl('FMPBIWorkspaces', powerBIReportGroup);
            }
            initReportControl = false;
    }
        /// <summary>
        /// Initializes the form.
        /// </summary>
        public void init()
        {
            super();
            this.initAnalyticalReport();
        }
    }
    ```

4. ดำเนินการสร้างเพื่อตรวจสอบการเปลี่ยนแปลงของคุณ

ในขณะนี้คุณได้ทำงานในการเพิ่มตรรกะทางธุรกิจเพื่อเริ่มต้นการควบคุม Report Viewer แบบฝังเสร็จสมบูรณ์แล้ว ภาพประกอบต่อไปนี้แสดงลักษณะของพื้นที่ทำงานหลังจากที่มีการใช้การเปลี่ยนแปลงเหล่านี้

![รายงานที่ฝังอยู่ในพื้นที่ทำงาน](media/analytical-workspace-final.png)

> [!NOTE]
> คุณสามารถเข้าถึงมุมมองการดำเนินงานที่มีอยู่ได้โดยใช้แท็บพื้นที่ทำงานที่อยู่ด้านล่างชื่อหน้า

# <a name="reference"></a>ข้อมูลอ้างอิง

## <a name="pbireporthelperinitializereportcontrol-method"></a>วิธีการ PBIReportHelper.initializeReportControl
ส่วนนี้แสดงข้อมูลเกี่ยวกับคลาสตัวช่วยที่ใช้ในการฝังรายงาน Power BI (ทรัพยากร .pbix) ในการควบคุมกลุ่มแบบฟอร์ม

### <a name="syntax"></a>ไวยากรณ์
```
public static void initializeReportControl(
     str                 _resourceName,
     FormGroupControl    _formGroupControl,
     str                 _defaultPageName = '',
     boolean             _showFilterPane = false,
     boolean             _showNavPane = false,
     List                _defaultFilters = new List(Types::Class))
```

### <a name="parameters"></a>พารามิเตอร์

| ชื่อ | คำอธิบาย |
|---|---|
| ชื่อทรัพยากร | ชื่อของทรัพยากร .pbix |
| formGroupControl | การควบคุมกลุ่มแบบฟอร์มเพื่อใช้กับการควบคุมรายงาน Power BI |
| defaultPageName | ชื่อหน้าเริ่มต้น |
| showFilterPane | ค่าบูลีนที่บ่งชี้ว่าควรแสดงบานหน้าต่างตัวกรอง (**จริง**) หรือ (**เท็จ**) ที่ซ่อนอยู่ |
| showNavPane | ค่าบูลีนที่บ่งชี้ว่าควรแสดงบานหน้าต่างนำทาง (**จริง**) หรือ (**เท็จ**) ที่ซ่อนอยู่ |
| defaultFilters | ตัวกรองเริ่มต้นสำหรับรายงาน Power BI |

