---
title: ออกแบบการตั้งค่าคอนฟิกสำหรับการสร้างรายงานในรูปแบบ OPENXML ของ ER (พฤศจิกายน 2016)
description: หัวข้อนี้อธิบายวิธีที่ผู้ใช้ในบทบาทผู้ดูแลระบบหรือนักพัฒนาการรายงานทางอิเล็กทรอนิกส์ สามารถสร้างการตั้งค่าคอนฟิกการรายงานทางอิเล็กทรอนิกส์ใหม่ (ER) ซึ่งประกอบด้วยเท็มเพลตสำหรับการสร้างเอกสารทางอิเล็กทรอนิกส์ในรูปแบบ OPENXML
author: NickSelin
manager: AnnBe
ms.date: 08/12/2019
ms.topic: business-process
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ERWorkspace, ERVendorPart, ERSolutionRepositoryTable, ERSolutionRepositoryCreateDropDialog, ERSolutionImport,  ERSolutionTable, ERSolutionCreateDropDialog, EROperationDesigner, ERDataSourceAddDropDialog, ERModelGroupByFunctionEditor, VendPaymMode, LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: d1229c89f43f9ded955dadf2f4d87825c9ab4e71
ms.sourcegitcommit: e552111e148a80544a3468da60ea0464f02a658d
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 08/15/2019
ms.locfileid: "1875283"
---
# <a name="er-design-a-configuration-for-generating-reports-in-openxml-format-november-2016"></a>ออกแบบการตั้งค่าคอนฟิกสำหรับการสร้างรายงานในรูปแบบ OPENXML ของ ER (พฤศจิกายน 2016)

[!include [task guide banner](../../includes/task-guide-banner.md)]

หัวข้อนี้อธิบายวิธีที่ผู้ใช้ในบทบาทผู้ดูแลระบบหรือนักพัฒนาการรายงานทางอิเล็กทรอนิกส์ สามารถสร้างการตั้งค่าคอนฟิกการรายงานทางอิเล็กทรอนิกส์ใหม่ (ER) ซึ่งประกอบด้วยเท็มเพลตสำหรับการสร้างเอกสารทางอิเล็กทรอนิกส์ในรูปแบบ OPENXML การตั้งค่าคอนฟิกนี้จะถูกใช้สำหรับการประมวลผลการชำระเงินของผู้จัดจำหน่าย

ในตัวอย่างนี้ คุณจะสร้างการตั้งค่าคอนฟิกสำหรับบริษัทตัวอย่าง ซึ่งคือ Litware, Inc. ขั้นตอนเหล่านี้สามารถถูกดำเนินการได้ในบริษัท GBSI 

เพื่อทำตามขั้นตอนเหล่านี้ อันดับแรกคุณต้องทำตามขั้นตอนในกระบวนงาน "สร้างผู้ให้บริการการตั้งค่าคอนฟิก และทำเครื่องหมายว่าใช้งานอยู่" คุณยังต้องมีไฟล์ Excel ซึ่งจะถูกนำเข้าเมื่อมีการสร้างเท็มเพลต สามารถเข้าถึงไฟล์นี้ได้จาก [เท็มเพลตของรายงานการชำระเงิน](https://go.microsoft.com/fwlink/?linkid=862266)


## <a name="upload-the-payments-data-model-configuration"></a>อัพโหลดการตั้งค่าคอนฟิกแบบจำลองข้อมูลการชำระเงิน
1. ในบานหน้าต่างนำทาง ไปที่ **โมดูล > การจัดการองค์กร > พื้นที่ทำงาน > การรายงานทางอิเล็กทรอนิกส์**
2. ในรายการ ให้ทำเครื่องหมายเลือกผู้ให้บริการการตั้งค่าคอนฟิกสำหรับบริษัทตัวอย่าง Litware, Inc. หากคุณไม่เห็นผู้ให้บริการการตั้งค่าคอนฟิกนี้ ก่อนอื่นคุณต้องดำเนินขั้นตอนต่างๆ ใน [สร้างผู้ให้บริการการตั้งค่าคอนฟิก และทำเครื่องหมายเป็น ใช้งานอยู่](er-configuration-provider-mark-it-active-2016-11.md)ให้สำเร็จ
3. เลือก **กำหนดเป็นใช้งานอยู่**
4. เลือก **ที่เก็บ** เลือกที่เก็บสำหรับชนิดทรัพยากรการดำเนินงาน ถ้าพร้อมใช้งาน ถ้าพร้อมใช้งาน ให้ข้ามขั้นตอนต่อไปนี้เกี่ยวกับการสร้างที่เก็บใหม่  
5. เลือก **เพิ่ม** เพื่อเปิดกล่องโต้ตอบการวาง
6. ในฟิลด์ **ชนิดที่เก็บของการตั้งค่าคอนฟิก** ป้อน `Operations resourcesdd`
7. เลือก **สร้างที่เก็บ**
8. เลือก **ตกลง**
9. เลือก **เปิด**
10. ในแผนภูมิ เลือก **แบบจำลองการชำระเงิน**
11. เลือก **นำเข้า** นำเข้าแบบจำลองข้มูลนี้ ซึ่งจะถูกใช้เป็นแหล่งข้อมูลในการตั้งค่าคอนฟิกรูปแบบใหม่ ให้ข้ามขั้นตอนนี้ถ้าการตั้งค่าคอนฟิกนี้ไดุถูกนำเข้าแล้ว  
12. เลือก **ใช่**
13. ปิดหน้าที่จนกว่าคุณจะกลับไปที่หน้าการรายงานทางอิเล็กทรอนิกส์

## <a name="create-a-new-format-configuration"></a>สร้างการตั้งค่าคอนฟิกรูปแบบใหม่
1. เลือก **การตั้งค่าคอนฟิกการรายงาน**
2. ในแผนภูมิ เลือก **แบบจำลองการชำระเงิน**
3. เลือก **สร้างการตั้งค่าคอนฟิก** เพื่อเปิดกล่องโต้ตอบการวาง
4. ในฟิลด์ **ใหม่** ป้อน `Format based on data model PaymentModel` สร้างรูปแบบที่เป็นไปตามแบบจำลองข้อมูลของแบบจำลองการชำระเงิน
5. ในฟิลด์ **ชื่อ** ให้พิมพ์ `Sample worksheet report` รายงานแผ่นงานตัวอย่าง  
6. ในฟิลด์ **คำอธิบาย** ให้พิมพ์ `Sample worksheet report for vendors’ payments`. รายงานแผ่นงานตัวอย่างสำหรับการชำระเงินของผู้จัดจำหน่าย  
7. ในฟิลด์ **คำนิยามแบบจำลองข้อมูล** ให้ป้อนหรือเลือกค่า เลือกข้อกำหนด **การเริ่มต้นการโอนย้ายเครดิตของลูกค้า**  
8. เลือก **สร้างการตั้งค่าคอนฟิก**

## <a name="design-a-new-document-in-openxml-worksheet-format"></a>ออกแบบเอกสารใหม่ในรูปแบบแผ่นงาน OPENXML
1. ในแผนภูมิ เลือก **แบบจำลองการชำระเงิน\รายงานแผ่นงานตัวอย่าง**
2. เลือก **ตัวออกแบบ**
3. ในบานหน้าต่างการดำเนินการ เลือก **นำเข้า**
4. เลือก **นำเข้าจาก Excel**
5. เลือก **เอกสารแนบ** แนบเอกสาร Excel ที่มีอยู่เป็นเท็มเพลต  
6. เลือก **ใหม่**
7. เลือก **ไฟล์** ชี้ไปที่ไฟล์ Excel ที่มีอยู่  
8. ปิดหน้า
9. ในฟิลด์ **เท็มเพลต** ให้ป้อนหรือเลือกค่า เลือกไฟล์ Excel ที่แนบมาเพื่อใช้เป็นเท็มเพลต  
10. เลือก **ตกลง** โปรดทราบว่าส่วนประกอบรูปแบบ ER ได้ถูกสร้างขึ้นในรูปแบบการออกแบบตามโครงสร้างของเอกสาร MS Excel อ้างอิง (ช่วงที่มีชื่อ)  

## <a name="create-a-new-data-source-to-calculate-totals-by-currency-codes"></a>สร้างแหล่งข้อมูลใหม่เพื่อคำนวณผลรวมโดยรหัสสกุลเงิน
1. เลือกแท็บ **การแมป**  
2. เลือก **เพิ่มราก** เพื่อเปิดกล่องโต้ตอบการวาง
3. ในแผนภูมิ ให้เลือก **Functions\Group by**
4. ในฟิลด์ **ชื่อ** ให้พิมพ์ `PaymentByCurrency`
5. เลือก **แก้ไขกลุ่มโดย**
6. ในแผนภูมิ ขยาย **แบบจำลอง** จากนั้น เลือก **model\Payments**
7. เลือก **เพิ่มฟิลด์ไปยัง**
8. เลือก **สิ่งที่จะจัดกลุ่ม**
9. ในแผนภูมิ ขยาย **model\Payments** จากนั้น เลือก **model\Payments\Currency**
10. เลือก **เพิ่มฟิลด์ไปยัง**
11. เลือก **ฟิลด์ที่ถูกจัดกลุ่ม**
12. ในแผนภูมิ เลือก **model\Payments\Instructed Amount(InstructedAmount)**
13. เลือก **เพิ่มฟิลด์ไปยัง** แล้วเลือก **ฟิลด์การรวม**
14. ในฟิลด์ **วิธีการ** ให้เลือกหนึ่งตัวเลือก เลือกฟังก์ชัน **การรวม SUM**  
15. ในฟิลด์ **ชื่อ** ให้พิมพ์ `TotalInstructuredAmount`
16. เลือก **บันทึก**
17. ปิดหน้า
18. เลือก **ตกลง**

## <a name="map-format-components-to-data-sources"></a>แม็ปส่วนประกอบรูปแบบกับแหล่งข้อมูล
1. ในแผนภูมิ เลือก **model\Payments\Initiating Party(InitiatingParty)\Name** และ **Excel\ReportHeader\CompanyName**
2. เลือก **ผูก**
3. ในแผนภูมิ เลือก **model\Payments\Creditor\Identification\Source ID(SourceID)** และ **Excel\PaymLines\VendAccountName**
4. เลือก **ผูก**
5. ในแผนภูมิ ให้เลือก **model\Payments\Creditor\Name** และ **Excel\PaymLines\VendName**
6. เลือก **ผูก**
7. ในแผนภูมิ ให้เลือก **model\Payments\Creditor Agent(CreditorAgent)\Name** และ **Excel\PaymLines\Bank**
8. เลือก **ผูก**
9. ในแผนภูมิ ให้เลือก **model\Payments\Creditor Agent(CreditorAgent)\Routing Number(RoutingNumber)** และ **Excel\PaymLines\RoutingNumber**
10. เลือก **ผูก**
11. ในแผนภูมิ เลือก **model\Payments\Creditor Account(CreditorAccount)\Identification\Number** และ **Excel\PaymLines\AccountNumber**
12. เลือก **ผูก**
13. ในแผนภูมิ เลือก **model\Payments\Instructed Amount(InstructedAmount)** และ **Excel\PaymLines\Debit**
14. เลือก **ผูก**
15. ในแผนภูมิ เลือก **model\Payments\Currency** และ **Excel\PaymLines\Currency**
16. เลือก **ผูก**
17. ในแผนภูมิ เลือก **PaymentByCurrency\grouped\Currency** และ **Excel\SummaryLines\SummaryCurrency**
18. เลือก **ผูก**
19. ในแผนภูมิ เลือก **PaymentByCurrency\aggregated\TotalInstructuredAmount** และ **Excel\SummaryLines\SummaryAmount**
20. เลือก **ผูก**
21. ในแผนภูมิ เลือก **PaymentByCurrency** และ **Excel\SummaryLines**
22. เลือก **ผูก**
23. ในแผนภูมิ เลือก **model\Payments** และ **Excel\PaymLines**
24. เลือก **ผูก**
25. เลือก **บันทึก** จากนั้นปิดหน้า

## <a name="use-the-created-configuration-for-payments-processing"></a>ใช้การตั้งค่าคอนฟิกที่สร้างขึ้นสำหรับการประมวลผลการชำระเงิน
1. เลือก **เปลี่ยนแปลงสถานะ**
2. เลือก **เสร็จสมบูรณ์**
3. เลือก **ตกลง**
4. ในบานหน้าต่างนำทาง ไปที่ **โมดูล > บัญชีเจ้าหนี้ > การตั้งค่าการชำระเงิน > วิธีการชำระเงิน**
5. ใช้ตัวกรองด่วนเพื่อกรองข้อมูลในฟิลด์ **วิธีการชำระเงิน** ด้วยค่า **อิเล็กทรอนิกส์**
6. เลือก **แก้ไข**
7. ขยายส่วน **รูปแบบของไฟล์**
8. เลือก **ใช่** ในฟิลด์ **รายงานทางอิเล็กทรอนิกส์ทั่วไป**
9. ในฟิลด์ **การตั้งค่าคอนฟิกรูปแบบการส่งออก** ให้ป้อนหรือเลือกค่า เลือกการตั้งค่าคอนฟิก **รายงานแผ่นงานตัวอย่าง**  
10. เลือก **บันทึก**
11. ปิดหน้า

## <a name="use-the-created-configuration-for-testing-of-payment-journals-processing"></a>ใช้การตั้งค่าคอนฟิกที่สร้างสำหรับการทดสอบการประมวลผลสมุดรายวันการชำระเงิน
1. ในบานหน้าต่างนำทาง ไปที่ **โมดูล > บัญชีเจ้าหนี้ > การชำระเงิน > สมุดรายวันการชำระเงิน**
2. เลือก **ใหม่** เพื่อสร้างสมุดรายวันการชำระเงินใหม่
3. ในฟิลด์ **ชื่อ** ให้พิมพ์ **VendPay**
4. เลือก **รายการ**
5. ในฟิลด์ **บัญชี** ให้ระบุค่า `GB_SI_000001`
6. ตั้งค่า **เดบิต** เป็น `1000`
7. เลือก **ใหม่**
8. ในฟิลด์ **บัญชี** ให้ระบุค่า `GB_SI_000005`
9. ตั้งค่า **เดบิต** เป็น `2000`
10. ในฟิลด์ **สกุลเงิน** ให้พิมพ์ `EUR`
11. ในฟิลด์ **บัญชีตรงข้าม** ระบุ ค่า `GBSI OPER`
12. ในฟิลด์ **วิธีการชำระเงิน** พิมพ์ `Electronic`
13. เลือก **บันทึก**
14. เลือก **สร้างการชำระเงิน**
15. ในฟิลด์ **วิธีการชำระเงิน** พิมพ์ `Electronic`
16. ในฟิลด์ **ชื่อไฟล์** พิมพ์ `Payments` 
17. ในฟิลด์ **บัญชีธนาคาร** พิมพ์ `GBSI OPER`
18. เลือก **ตกลง** จากนั้น เลือก **ตกลง** อีกครั้ง ตรวจทานแผ่นงานที่สร้าง ซึ่งรวมถึงรายละเอียดของรายการชำระเงิน และยอดรวมสำหรับรหัสสกุลเงินแต่ละรายการที่ใช้ในข้อความการชำระเงินนี้  

