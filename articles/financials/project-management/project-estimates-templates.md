---
title: ซิงโครไนส์การประเมินโครงการโดยตรงจาก Project Service Automation ไปยัง Finance and Operations
description: หัวข้อนี้อธิบายเท็มเพลตและงานพื้นฐานที่ใช้ในการทำให้ข้อมูลการประเมินชั่วโมงโครงการและการประเมินค่าใช้จ่ายโครงการจาก Microsoft Dynamics 365 for Project Service Automation ไปยัง Microsoft Dynamics 365 for Finance and Operations ตรงกันโดยตรง
author: KimANelson
manager: AnnBe
ms.date: 07/20/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations
ms.custom: 87983
ms.assetid: b454ad57-2fd6-46c9-a77e-646de4153067
ms.search.region: Global
ms.author: knelson
ms.search.validFrom: 2016-11-28
ms.dyn365.ops.version: AX 7.3.0
ms.openlocfilehash: 6bdf139ddd0faa7ba2c9c14b93286eff0ef757fe
ms.sourcegitcommit: 8b4b6a9226d4e5f66498ab2a5b4160e26dd112af
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 08/01/2019
ms.locfileid: "1846014"
---
# <a name="synchronize-project-estimates-directly-from-project-service-automation-to-finance-and-operations"></a>ซิงโครไนส์การประเมินโครงการโดยตรงจาก Project Service Automation ไปยัง Finance and Operations

[!include[banner](../includes/banner.md)]

หัวข้อนี้อธิบายเท็มเพลตและงานพื้นฐานที่ใช้ในการทำให้ข้อมูลการประเมินชั่วโมงโครงการและการประเมินค่าใช้จ่ายโครงการจาก Microsoft Dynamics 365 for Project Service Automation ไปยัง Dynamics 365 for Finance and Operations ตรงกันโดยตรง

> [!NOTE]
> - การรวมงานโครงการ ประเภทธุรกรรมค่าใช้จ่าย การประเมินชั่วโมง การประเมินค่าใช้จ่าย และการล็อคฟังก์ชัน พร้อมใช้งานใน Microsoft Dynamics 365 for Finance and Operations รุ่น 8.0
> - การรวมรายการจริงพร้อมใช้งานใน Microsoft Dynamics 365 for Finance and Operations รุ่น 8.0.1 หรือรุ่นที่ใหม่กว่า
> - ถ้าคุณกำลังใช้ Microsoft Dynamics 365 for Finance and Operations, Enterprise Edition 7.3.0 หลังจากที่คุณติดตั้ง KB 4132657 และ KB 4132660 คุณจะสามารถใช้เท็มเพลตเพื่อรวมงานโครงการ ค่าใช้จ่ายประเภทธุรกรรม การประเมินชั่วโมง การประเมินค่าใช้จ่าย และค่าที่เกิดขึ้นจริงได้ และสามารถตั้งค่าคอนฟิกการล็อคฟังก์ชันได้ ถ้าคุณต้องตั้งค่าการกระจายการลงบัญชี เราขอแนะนำให้ คุณติดตั้ง KB 4131710 ด้วย

## <a name="data-flow-for-project-service-automation-to-finance-and-operations"></a>โฟลว์ข้อมูลสำหรับ Project Service Automation ไปยัง Finance and Operations

โซลูชันการรวม Project Service Automation ไปยัง Finance and Operations ใช้คุณลักษณะการรวมข้อมูล เพื่อซิงโครไนส์ข้อมูลระหว่างอินสแตนซ์ของ Project Service Automation และ Finance and Operations เท็มเพลตการรวมที่พร้อมใช้งานกับคุณลักษณะการรวมข้อมูล เปิดใช้งานโฟลว์ของข้อมูลเกี่ยวกับการประมาณการชั่วโมงของโครงการและการประมาณการค่าใช้จ่ายของโครงการจาก Project Service Automation ไปยัง Finance and Operations

ภาพประกอบต่อไปนี้แสดงวิธีการซิงโครไนส์ข้อมูลระหว่าง Project Service Automation และ Finance and Operations

[![โฟลว์ข้อมูลสำหรับการรวม Project Service Automation กับ Finance and Operations](./media/ProjectEstimatesFlow.png)](./media/ProjectEstimatesFlow.png)

## <a name="project-hour-estimates"></a>การประเมินชั่วโมงโครงการ

### <a name="template-and-tasks"></a>เท็มเพลตและงาน

เพื่อเข้าถึงเท็มเพลตที่พร้อมใช้งาน ในศูนย์การจัดการ Microsoft PowerApps เลือก **โครงการ** และจากนั้น ที่มุมขวาบน เลือก **โครงการใหม่** เพื่อเลือกเท็มเพลตสาธารณะ

เท็มเพลตและงานพื้นฐานต่อไปนี้จะถูกใช้ในการซิงโครไนส์การประมาณการชั่วโมงของโครงการจาก Project Service Automation ไปยัง Finance and Operations:

- **ชื่อของเท็มเพลตในการรวมข้อมูล:** การประมาณการชั่วโมงของโครงการ (PSA ไปยัง Fin and Ops)
- **ชื่อของงานในโครงการ:**

    - ความสัมพันธ์ของธุรกรรม
    - การประเมินค่าใช้จ่าย

### <a name="entity-set"></a>การตั้งค่าเอนทิตี้

| Project Service Automation | Finance and Operations                        |
|----------------------------|-----------------------------------------------|
| งานโครงการ              | เอนทิตี้การรวมสำหรับประมาณการชั่วโมงของโครงการ |

### <a name="entity-flow"></a>ขั้นตอนเอนทิตี้

มีการจัดการการประมาณการชั่วโมงของโครงการใน Project Service Automation และมีการซิงโครไนส์ไปยัง Finance and Operations เป็นการคาดการณ์ชั่วโมงของโครงการ

### <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น

ก่อนที่การซิงโครไนส์ของการประมาณการชั่วโมงของโครงการจะสามารถเกิดขึ้นได้ คุณต้องซิงโครไนส์โครงการ งานโครงการ และประเภทธุรกรรมค่าใช้จ่ายโครงการ

### <a name="power-query"></a>Power Query

ในเท็มเพลตที่การประเมินชั่วโมงโครงการ คุณต้องใช้ Microsoft Power Query for Excel เพื่อทำให้งานเหล่านี้เสร็จสมบูรณ์:

- ตั้งค่ารหัสแบบจำลองการคาดการณ์เริ่มต้นที่จะใช้ เมื่อการรวมสร้างการคาดการณ์ชั่วโมงใหม่
- กรองเรกคอร์ดเฉพาะทรัพยากรใดๆ ออก ในงานที่จะไม่รวมในการคาดการณ์ชั่วโมง
- กรองแถวของประเภทธุรกรรมว่างใดๆ ออก ความล้มเหลวในการทำงานนี้ให้เสร็จสมบูรณ์อาจส่งผลต่อการคาดการณ์ชั่วโมงที่ไม่ถูกต้อง

#### <a name="set-the-default-forecast-model-id"></a>ตั้งค่ารหัสแบบจำลองการคาดการณ์เริ่มต้น

ในการอัพเดตรหัสแบบจำลองการคาดการณ์เริ่มต้นในเท็มเพลต คลิกลูกศร **แม็ป** เพื่อเปิดการแม็ป จากนั้น เลือกลิงก์ **การกรองข้อมูลและแบบสอบถามขั้นสูง**

- ถ้าคุณกำลังใช้เท็มเพลตการประเมินชั่วโมงโครงการเริ่มต้น (PSA ไปยัง Fin and Ops) เลือก **เงื่อนไขที่แทรก** ในรายการของ **ขั้นตอนที่ใช้** ในรายการ **ฟังก์ชัน** แทนที่ **O\_forecast** ด้วยชื่อของรหัสแบบจำลองการคาดการณ์ที่ควรจะใช้กับการรวม เท็มเพลตเริ่มต้นมีรหัสแบบจำลองการคาดการณ์จากข้อมูลสาธิต
- ถ้าคุณกำลังสร้างเท็มเพลตใหม่ คุณต้องเพิ่มคอลัมน์นี้ ใน Power Query เลือก **เพิ่มคอลัมน์แบบมีเงื่อนไข** และป้อนชื่อสำหรับคอลัมน์ใหม่ เช่น **ModelID** ป้อนเงื่อนไขสำหรับคอลัมน์ ที่ซึ่งถ้างานโครงการไม่ใช่ null แล้ว \<ป้อนรหัสแบบจำลองการคาดการณ์\>; นอกจากนั้นเป็น null

#### <a name="filter-out-resource-specific-records"></a>กรองเรกคอร์ดเฉพาะทรัพยากรออก

เท็มเพลตการประมาณชั่วโมงของโครงการ (PSA ไปยัง Fin and Ops) มีตัวกรองเริ่มต้นที่ลบเรกคอร์ดเฉพาะทรัพยากรใดๆ ออก ถ้าคุณสร้างเท็มเพลตของคุณเอง คุณต้องเพิ่มตัวกรองนี้ เลือกลิงก์ **การสอบถามและการกรองขั้นสูง** เพื่อกรองในคอลัมน์ **msdyn\_islinetask** เพื่อให้มีการรวมเฉพาะเรกคอร์ด **เท็จ**

#### <a name="filter-out-empty-transaction-category-rows"></a>กรองแถวของประเภทธุรกรรมว่างออก

คุณต้องเพิ่มตัวกรองข้อมูลเพื่อลบแถวใดๆ ที่มีประเภทธุรกรรมที่ว่างเปล่า จำเป็นต้องมีงานนี้ โดยไม่คำนึงถึงว่าคุณกำลังใช้เท็มเพลตเริ่มต้น หรือกำลังสร้างเท็มเพลตของคุณเอง ตัวกรองข้อมูลนี้ลบแถวสรุปใดๆ จาก Project Service Automation ที่อาจทำให้การคาดการณ์ชั่วโมงใน Finance and Operations ไม่ถูกต้อง เลือกลิงก์ **การสอบถามและการกรองขั้นสูง** เพื่อกรองข้อมูลเรกคอร์ด null ออก ในคอลัมน์ **msdyn\_transactioncategory\_value**

### <a name="template-mapping-in-data-integration"></a>การแม็ปเท็มเพลตในการรวมข้อมูล

ภาพประกอบต่อไปนี้แสดงตัวอย่างของการแม็ปงานเท็มเพลตในการรวมข้อมูล การแม็ปแสดงข้อมูลฟิลด์ที่จะถูกซิงโครไนส์จาก Project Service Automation ไปยัง Finance and Operations

[![การแม็ปเท็มเพลต](./media/ProjectHourEstimatesMapping.jpg)](./media/ProjectHourEstimatesMapping.jpg)

## <a name="project-expense-estimates"></a>การประเมินค่าใช้จ่ายสำหรับโครงการ

### <a name="template-and-tasks"></a>เท็มเพลตและงาน

เท็มเพลตและงานพื้นฐานต่อไปนี้ถูกใช้ในการซิงโครไนส์การประมาณการค่าใช้จ่ายของโครงการจาก Project Service Automation ไปยัง Finance and Operations:

- **ชื่อของเท็มเพลตในการรวมข้อมูล:** การประมาณการค่าใช้จ่ายของโครงการ (PSA ไปยัง Fin and Ops)
- **ชื่อของงานในโครงการ:**

    - ความสัมพันธ์ของธุรกรรม 
    - การประเมินค่าใช้จ่าย

### <a name="entity-set"></a>การตั้งค่าเอนทิตี้

| Project Service Automation | Finance and Operations                                   |
|----------------------------|----------------------------------------------------------|
| การเชื่อมต่อธุรกรรม    | เอนทิตี้การรวมสำหรับความสัมพันธ์ของธุรกรรมของโครงการ |
| รายการประเมิน             | เอนทิตี้การรวมสำหรับประมาณการค่าใช้จ่ายของโครงการ         |

### <a name="entity-flow"></a>ขั้นตอนเอนทิตี้

มีการจัดการการประมาณการค่าใช้จ่ายของโครงการใน Project Service Automation และมีการซิงโครไนส์ไปยัง Finance and Operations เป็นการคาดการณ์ค่าใช้จ่ายของโครงการ

### <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น

ก่อนที่การซิงโครไนส์ของการประมาณค่าใช้จ่ายของโครงการจะสามารถเกิดขึ้นได้ คุณต้องซิงโครไนส์โครงการ งานโครงการ และประเภทธุรกรรมค่าใช้จ่ายโครงการ

### <a name="power-query"></a>Power Query

ในเท็มเพลตการประเมินค่าใช้จ่ายของโครงการ คุณต้องใช้ Power Query เพื่อทำงานต่อไปนี้ให้เสร็จสมบูรณ์:

- กรองเพื่อรวมเฉพาะเรกคอร์ดรายการประเมินค่าใช้จ่ายเท่านั้น
- ตั้งค่ารหัสแบบจำลองการคาดการณ์เริ่มต้นที่จะใช้ เมื่อการรวมสร้างการคาดการณ์ชั่วโมงใหม่
- แปลงชนิดการเรียกเก็บเงิน
- แปลงชนิดธุรกรรม

#### <a name="filter-to-include-only-expense-estimate-lines"></a>กรองเพื่อรวมเฉพาะรายการประเมินค่าใช้จ่ายเท่านั้น

เท็มเพลตการประมาณการค่าใช้จ่ายของโครงการ (PSA ไปยัง Fin and Ops) มีตัวกรองข้อมูลเริ่มต้น ที่รวมรายการค่าใช้จ่ายในการรวมเท่านั้น ถ้าคุณสร้างเท็มเพลตของคุณเอง คุณต้องเพิ่มตัวกรองนี้ เลือกงาน **ความสัมพันธ์ของธุรกรรม** และจากนั้นคลิกลูกศร **แม็ป** เพื่อเปิดการแม็ป เลือกลิงก์ **การกรองข้อมูลและแบบสอบถามขั้นสูง** กรองคอลัมน์ **msdyn\_transactiontype1** เพื่อให้รวมเฉพาะ **msdyn\_estimateline**

#### <a name="set-the-default-forecast-model-id"></a>ตั้งค่ารหัสแบบจำลองการคาดการณ์เริ่มต้น

ในการอัพเดตรหัสแบบจำลองการคาดการณ์เริ่มต้นในเท็มเพลต เลือกงาน **การประเมินค่าใช้จ่าย** และจากนั้น คลิกลูกศร **แม็ป** เพื่อเปิดการแม็ป เลือกลิงก์ **การกรองข้อมูลและแบบสอบถามขั้นสูง**

- ถ้าคุณกำลังใช้เท็มเพลตการประเมินค่าใช้จ่ายโครงการเริ่มต้น (PSA ไปยัง Fin and Ops) ใน Power Query เลือก **เงื่อนไขที่แทรก** แรก จากส่วน **ขั้นตอนที่ใช้** ในรายการ **ฟังก์ชัน** แทนที่ **O\_forecast** ด้วยชื่อของรหัสแบบจำลองการคาดการณ์ที่ควรจะใช้กับการรวม เท็มเพลตเริ่มต้นมีรหัสแบบจำลองการคาดการณ์จากข้อมูลสาธิต
- ถ้าคุณกำลังสร้างเท็มเพลตใหม่ คุณต้องเพิ่มคอลัมน์นี้ ใน Power Query เลือก **เพิ่มคอลัมน์แบบมีเงื่อนไข** และป้อนชื่อสำหรับคอลัมน์ใหม่ เช่น **ModelID** ป้อนเงื่อนไขสำหรับคอลัมน์ ที่ซึ่งถ้ารหัสรายการประเมินไม่ใช่ null แล้ว \<ป้อนรหัสแบบจำลองการคาดการณ์\>; นอกจากนั้นเป็น null

#### <a name="transform-the-billing-types"></a>แปลงชนิดการเรียกเก็บเงิน

เท็มเพลตการประมาณการค่าใช้จ่ายของโครงการ (PSA ไปยัง Fin and Ops) รวมคอลัมน์แบบมีเงื่อนไขที่ถูกใช้เพื่อแปลงชนิดการเรียกเก็บเงินที่ได้รับจาก Project Service Automation ในระหว่างการรวม ถ้าคุณสร้างเท็มเพลตของคุณเอง คุณต้องเพิ่มคอลัมน์แบบมีเงื่อนไขนี้ เลือกลิงก์ **การสอบถามและการกรองขั้นสูง** เลือก **เพิ่มคอลัมน์แบบมีเงื่อนไข** ป้อนชื่อสำหรับคอลัมน์ใหม่ เช่น **BillingType** จากนั้นป้อนเงื่อนไขต่อไปนี้:

ถ้า **msdyn\_billingtype** = 192350000 แล้ว **ไม่สามารถเรียกเก็บค่าใช้จ่ายได้**  
นอกจากนั้นถ้า **msdyn\_billingtype** = 192350001 แล้ว **สามารถเรียกเก็บค่าใช้จ่ายได้**  
นอกจากนั้นถ้า **msdyn\_billingtype** = 192350002 แล้ว **เพิ่มเติม**  
นอกจากนั้น **NotAvailable**

#### <a name="transform-the-transaction-types"></a>แปลงชนิดธุรกรรม

เท็มเพลตการประมาณการค่าใช้จ่ายของโครงการ (PSA ไปยัง Fin and Ops) รวมคอลัมน์แบบมีเงื่อนไขที่ถูกใช้เพื่อแปลงชนิดธุรกรรมที่ได้รับจาก Project Service Automation ในระหว่างการรวม ถ้าคุณสร้างเท็มเพลตของคุณเอง คุณต้องเพิ่มคอลัมน์แบบมีเงื่อนไขนี้ เลือกลิงก์ **การสอบถามและการกรองขั้นสูง** เลือก **เพิ่มคอลัมน์แบบมีเงื่อนไข** ป้อนชื่อสำหรับคอลัมน์ใหม่ เช่น **TransactionType** จากนั้นป้อนเงื่อนไขต่อไปนี้:

ถ้า **msdyn\_transactiontypecode** = 192350000 แล้ว **ต้นทุน**  
นอกจากนั้นถ้า **msdyn\_transactiontypecode** = 192350005 แล้ว **Sales**  
นอกจากนั้น **null**

### <a name="template-mapping-in-data-integration"></a>การแม็ปเท็มเพลตในการรวมข้อมูล

ภาพประกอบต่อไปนี้แสดงตัวอย่างของการแม็ปงานเท็มเพลตในการรวมข้อมูล การแม็ปแสดงข้อมูลฟิลด์ที่จะถูกซิงโครไนส์จาก Project Service Automation ไปยัง Finance and Operations

[![การแม็ปเท็มเพลต](./media/ExpenseEstimateTransactionRelationshipsMapping.jpg)](./media/ExpenseEstimateTransactionRelationshipsMapping.jpg)

[![การแม็ปเท็มเพลต](./media/ExpenseEstimatesMapping.jpg)](./media/ExpenseEstimatesMapping.jpg)
