---
title: "ซิงโครไนส์การประเมินโครงการจาก Project Service Automation โดยตรง ไปยังการคาดการณ์โครงการใน Finance and Operations"
description: "หัวข้อนี้อธิบายเท็มเพลตและงานพื้นฐานที่จะใช้ในการซิงโครไนส์การประมาณการชั่วโมงของโครงการและการประมาณการค่าใช้จ่ายของโครงการโดยตรงจาก Microsoft Dynamics 365 for Project Service Automation ไปยัง Microsoft Dynamics 365 for Finance and Operations"
author: KimANelson
manager: AnnBe
ms.date: 04/02/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
audience: Application User
ms.reviewer: twheeloc
ms.search.scope: Core, Operations
ms.custom: 87983
ms.assetid: b454ad57-2fd6-46c9-a77e-646de4153067
ms.search.region: Global
ms.author: knelson
ms.search.validFrom: 2016-11-28
ms.dyn365.ops.version: AX 7.3.0
ms.translationtype: HT
ms.sourcegitcommit: bd8feff598cf80ca675c7d2b5dda636799b19e29
ms.openlocfilehash: 90501f40da0fdc66ad087b3bd746c908cc25711b
ms.contentlocale: th-th
ms.lasthandoff: 05/29/2018

---
# <a name="synchronize-project-estimates-from-project-service-automation-directly-to-project-forecasts-in-finance-and-operations"></a>ซิงโครไนส์การประเมินโครงการจาก Project Service Automation โดยตรง ไปยังการคาดการณ์โครงการใน Finance and Operations

หัวข้อนี้อธิบายเท็มเพลตและงานพื้นฐานที่จะใช้ในการซิงโครไนส์การประมาณการชั่วโมงของโครงการและการประมาณการค่าใช้จ่ายของโครงการโดยตรงจาก Microsoft Dynamics 365 for Project Service Automation ไปยัง Microsoft Dynamics 365 for Finance and Operations

> [!NOTE]
> การรวมงานโครงการ ประเภทธุรกรรมค่าใช้จ่าย การประเมินชั่วโมง การประเมินค่าใช้จ่าย และการล็อคฟังก์ชัน พร้อมใช้งานใน Dynamics 365 for Finance and Operations รุ่น 8.0


## <a name="data-flow-for-project-service-automation-to-finance-and-operations"></a>โฟลว์ข้อมูลสำหรับ Project Service Automation ไปยัง Finance and Operations

โซลูชันการรวม Project Service Automation ไปยัง Finance and Operations ใช้คุณลักษณะการรวมข้อมูล เพื่อซิงโครไนส์ข้อมูลระหว่างอินสแตนซ์ของ Project Service Automation และ Finance and Operations เท็มเพลตการรวมที่พร้อมใช้งานกับคุณลักษณะการรวมข้อมูล เปิดใช้งานโฟลว์ของข้อมูลเกี่ยวกับการประมาณการชั่วโมงของโครงการและการประมาณการค่าใช้จ่ายของโครงการจาก Project Service Automation ไปยัง Finance and Operations

ภาพประกอบต่อไปนี้แสดงวิธีการซิงโครไนส์ข้อมูลระหว่าง Project Service Automation และ Finance and Operations

[![โฟลว์ข้อมูลสำหรับการรวม Project Service Automation กับ Finance and Operations](./media/ProjectEstimatesFlow.png)](./media/ProjectEstimatesFlow.png)


## <a name="templates-and-tasks"></a>เท็มเพลตและงาน

เมื่อต้องการเข้าถึงเท็มเพลตที่พร้อมใช้งาน ในศูนย์การจัดการ Microsoft PowerApps เลือก **โครงการ** และจากนั้น ในมุมบนด้านขวา เลือก **โครงการใหม่** เพื่อเลือกเท็มเพลตสาธารณะ

เท็มเพลตและงานพื้นฐานต่อไปนี้จะถูกใช้ในการซิงโครไนส์การประมาณการชั่วโมงของโครงการจาก Project Service Automation ไปยัง Finance and Operations:

-  **ชื่อของเท็มเพลตในการรวมข้อมูล:** การประมาณการชั่วโมงของโครงการ (PSA ไปยัง Fin and Ops)

-  **ชื่อของงานในโครงการ:** 
    - ความสัมพันธ์ของธุรกรรม 
    - การประเมินค่าใช้จ่าย

## <a name="entity-set"></a>การตั้งค่าเอนทิตี้

| Project Service Automation      | Finance and Operations                          |
|---------------------------------|-------------------------------------------------|
| งานโครงการ                   | เอนทิตี้การรวมสำหรับประมาณการชั่วโมงของโครงการ   |

## <a name="entity-flow"></a>ขั้นตอนเอนทิตี้

มีการจัดการการประมาณการชั่วโมงของโครงการใน Project Service Automation และมีการซิงโครไนส์ไปยัง Finance and Operations เป็นการคาดการณ์ชั่วโมงของโครงการ

## <a name="preconditions"></a>เงื่อนไขเบื้องต้น

ก่อนที่การซิงโครไนส์ของการประมาณการชั่วโมงของโครงการจะสามารถเกิดขึ้นได้ คุณต้องซิงโครไนส์โครงการ งานโครงการ และประเภทธุรกรรมค่าใช้จ่ายโครงการ

## <a name="power-query"></a>Power Query

คุณต้องใช้ Microsoft Power Query ในเท็มเพลตที่การประเมินชั่วโมงโครงการกับ:
- ตั้งค่า **รหัสแบบจำลองการคาดการณ์** ที่จะใช้เมื่อการรวมสร้างการคาดการณ์ชั่วโมงใหม่
- กรองเรกคอร์ดเฉพาะของทรัพยากรใดๆ ออก ภายในงานที่จะไม่รวมในการคาดการณ์ชั่วโมง
- กรองแถวของประเภทธุรกรรมว่างใดๆ ออก ความล้มเหลวในการทำเช่นนี้อาจส่งผลต่อการคาดการณ์ชั่วโมงที่ไม่ถูกต้อง

### <a name="forecast-model-id"></a>รหัสแบบจำลองการคาดการณ์
ในการอัพเดตรหัสแบบจำลองการคาดการณ์เริ่มต้นในเท็มเพลต คลิกลูกศร **แม็ป** เพื่อเปิดการแม็ป เลือกที่จะเปิดการกรองข้อมูลและแบบสอบถามขั้นสูง
- ถ้าคุณกำลังใช้เท็มเพลตการประเมินชั่วโมง Microsoft Project (PSA ไปยัง Fin and Ops) เริ่มต้น เลือกส่วน **เงื่อนไขที่แทรก** ใน **ขั้นตอนที่ใช้** ในรายการ **ฟังก์ชัน** แทนที่ **O_forecast** ด้วยชื่อของ **รหัสแบบจำลองการคาดการณ์** ที่ควรจะใช้กับการรวม เท็มเพลตเริ่มต้นมีรหัสแบบจำลองการคาดการณ์จากข้อมูลสาธิต
- ถ้าคุณกำลังสร้างเท็มเพลตใหม่ คุณต้องเพิ่มคอลัมน์นี้ เลือก **เพิ่มคอลัมน์แบบมีเงื่อนไข** และตั้งชื่อคอลัมน์ เช่น ModelID ป้อนเงื่อนไขสำหรับคอลัมน์ที่ถ้าภารกิจของโครงการไม่ใช่ null แล้ว <enter the forecast model ID>; อื่นเป็น null

### <a name="filter-out-resource-specific-records"></a>กรองเรกคอร์ดเฉพาะของทรัพยากรออก
เท็มเพลตการประมาณการชั่วโมงของโครงการ (PSA ไปยัง Fin and Ops) มีตัวกรองเริ่มต้นที่ลบเรกคอร์ดเฉพาะของทรัพยากรใดๆ ถ้าคุณสร้างเท็มเพลตของคุณเอง คุณต้องเพิ่มตัวกรองนี้ ในแบบฟอร์มการสอบถามขั้นสูงและการกรอง เลือกที่จะกรองในคอลัมน์ **msdyn_islinetask** เพื่อรวมเฉพาะเรกคอร์ด **เท็จ**

### <a name="filter-out-empty-transaction-category-rows"></a>กรองแถวของประเภทธุรกรรมว่างออก
คุณต้องเพิ่มตัวกรองข้อมูลเพื่อลบแถวใดๆ ด้วยประเภทธุรกรรมว่างเปล่า ซึ่งจำเป็น โดยไม่คำนึงถึงว่าคุณกำลังใช้เท็มเพลตเริ่มต้น หรือกำลังสร้างเท็มเพลตของคุณเอง ตัวกรองข้อมูลนี้จะลบแถวสรุปใดๆ ที่มาจาก Project Service Automation ที่อาจทำให้การคาดการณ์ชั่วโมงใน Finance and Operations ไม่ถูกต้อง ในแบบฟอร์มการสอบถามขั้นสูงและการกรอง เลือกเพื่อกรองข้อมูลเรกคอร์ด null ออก ในคอลัมน์ **msdyn_transactioncategory_value**

## <a name="template-mapping-in-data-integration"></a>การแม็ปเท็มเพลตในการรวมข้อมูล

ภาพประกอบต่อไปนี้แสดงตัวอย่างของการแม็ปงานเท็มเพลตในการรวมข้อมูล การแม็ปแสดงข้อมูลฟิลด์ที่จะถูกซิงโครไนส์จาก Project Service Automation ไปยัง Finance and Operations

[![การแม็ปเท็มเพลต](./media/ProjectHourEstimatesMapping.jpg)](./media/ProjectHourEstimatesMapping.jpg)

เท็มเพลตและงานพื้นฐานต่อไปนี้จะถูกใช้ในการซิงโครไนส์การประมาณการค่าใช้จ่ายของโครงการจาก Project Service Automation ไปยัง Finance and Operations:

-  **ชื่อของเท็มเพลตในการรวมข้อมูล:** การประมาณการค่าใช้จ่ายของโครงการ (PSA ไปยัง Fin and Ops)
-  **ชื่อของงานในโครงการ:** 
     - ความสัมพันธ์ของธุรกรรม 
     - การประเมินค่าใช้จ่าย

## <a name="entity-set"></a>การตั้งค่าเอนทิตี้

| Project Service Automation      | Finance and Operations                                     |
|---------------------------------|------------------------------------------------------------|
| การเชื่อมต่อธุรกรรม         | เอนทิตีการรวมสำหรับความสัมพันธ์ของธุรกรรมของโครงการ   |
| รายการประเมิน                  | เอนทิตีการรวมสำหรับการประมาณการค่าใช้จ่ายของโครงการ           |

## <a name="entity-flow"></a>ขั้นตอนเอนทิตี้

มีการจัดการการประมาณการค่าใช้จ่ายของโครงการใน Project Service Automation และมีการซิงโครไนส์ไปยัง Finance and Operations เป็นการคาดการณ์ค่าใช้จ่ายของโครงการ

## <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น

ก่อนที่การซิงโครไนส์ของการประมาณค่าใช้จ่ายของโครงการจะสามารถเกิดขึ้นได้ คุณต้องซิงโครไนส์โครงการ งานโครงการ และประเภทธุรกรรมค่าใช้จ่ายโครงการ

## <a name="power-query"></a>Power Query

คุณต้องใช้ Microsoft Power Query ในเท็มเพลตการประเมินค่าใช้จ่ายของโครงการกับ:
- กรองเพื่อรวมเฉพาะเรกคอร์ดรายการประเมินค่าใช้จ่ายเท่านั้น
- ตั้งค่า **รหัสแบบจำลองการคาดการณ์** ที่จะใช้เมื่อการรวมสร้างการคาดการณ์ชั่วโมงใหม่
- แปลงชนิดการเรียกเก็บเงิน
- แปลงชนิดธุรกรรม

### <a name="filter-to-include-only-expense-estimate-lines"></a>กรองเพื่อรวมเฉพาะรายการประเมินค่าใช้จ่ายเท่านั้น
การประมาณการค่าใช้จ่ายของโครงการ (PSA ไปยัง Fin and Ops) มีตัวกรองข้อมูลเริ่มต้น เพื่อรวมรายการค่าใช้จ่ายในการรวมเท่านั้น ถ้าคุณสร้างเท็มเพลตของคุณเอง คุณต้องเพิ่มตัวกรองนี้ เลือกภารกิจความสัมพันธ์ของธุรกรรม และคลิกลูกศร **แม็ป** เลือก **การกรองข้อมูลและแบบสอบถามขั้นสูง** กรองคอลัมน์ **msdyn_transactiontype1** เพื่อให้รวมเฉพาะ **msdyn_estimateline**

### <a name="forecast-model-id"></a>รหัสแบบจำลองการคาดการณ์
ในการอัพเดตรหัสแบบจำลองการคาดการณ์เริ่มต้นในเท็มเพลต สำหรับงานการประเมินค่าใช้จ่าย คลิกลูกศร **แม็ป** เพื่อเปิดการแม็ป เลือกที่จะเปิดการกรองข้อมูลและแบบสอบถามขั้นสูง
- ถ้าคุณกำลังใช้เท็มเพลตการประเมินค่าใช้จ่าย Microsoft Project (PSA ไปยัง Fin and Ops) เริ่มต้น เลือก **เงื่อนไขที่แทรก** แรก ในส่วน **ขั้นตอนที่ใช้** ในรายการ **ฟังก์ชัน** แทนที่ **O_forecast** ด้วยชื่อของ **รหัสแบบจำลองการคาดการณ์** ที่ควรจะใช้กับการรวม เท็มเพลตเริ่มต้นมีรหัสแบบจำลองการคาดการณ์จากข้อมูลสาธิต
- ถ้าคุณกำลังสร้างเท็มเพลตใหม่ คุณต้องเพิ่มคอลัมน์นี้ เลือก **เพิ่มคอลัมน์แบบมีเงื่อนไข** และตั้งชื่อคอลัมน์ เช่น ModelID ป้อนเงื่อนไขสำหรับคอลัมน์ที่ถ้ารหัสรายการประเมินไม่ใช่ null แล้ว < enter the forecast model ID >; อื่นเป็น null

### <a name="transform-the-billing-types"></a>แปลงชนิดการเรียกเก็บเงิน
เท็มเพลตการประมาณการค่าใช้จ่ายของโครงการ (PSA ไปยัง Fin and Ops) มีคอลัมน์แบบมีเงื่อนไขที่เพิ่มเข้าไปเพื่อแปลงชนิดการเรียกเก็บเงินที่ได้รับจาก Project Service Automation ในระหว่างการรวม
- ถ้าคุณสร้างเท็มเพลตของคุณเอง คุณต้องเพิ่มคอลัมน์แบบมีเงื่อนไขนี้ ในแบบฟอร์มการสอบถามขั้นสูงและการกรอง เลือก **เพิ่มคอลัมน์แบบมีเงื่อนไข** ตั้งชื่อคอลัมน์ เช่น "BillingType" เงื่อนไขที่จะป้อนมีดังต่อไปนี้:

    ถ้า **msdyn_billingtype** = 192350000 แล้ว **NonChargeable** หรือถ้า **msdyn_billingtype** = 192350001 แล้ว **คิดค่าธรรมเนียมได้** หรือถ้า **msdyn_billingtype** =192350002 แล้ว **คำลงท้าย** หรือ **NotAvailable**

### <a name="transform-the-transaction-types"></a>แปลงชนิดธุรกรรม
เท็มเพลตการประมาณการค่าใช้จ่ายของโครงการ (PSA ไปยัง Fin and Ops) มีคอลัมน์แบบมีเงื่อนไขที่เพิ่มเข้าไปเพื่อแปลงชนิดธุรกรรมที่ได้รับจาก Project Service Automation ในระหว่างการรวม
- ถ้าคุณสร้างเท็มเพลตของคุณเอง คุณต้องเพิ่มคอลัมน์แบบมีเงื่อนไขนี้ ในแบบฟอร์มการสอบถามขั้นสูงและการกรอง เลือก **เพิ่มคอลัมน์แบบมีเงื่อนไข** ตั้งชื่อคอลัมน์ เช่น "TransactionType" ให้ป้อนเงื่อนไขดังต่อไปนี้: ถ้า **msdyn_transactiontypecode** = 192350000 แล้ว **ต้นทุน** หรือถ้า **msdyn_transactiontypecode** = 192350005 แล้ว **การขาย** หรือ **null**

## <a name="template-mapping-in-data-integration"></a>การแม็ปเท็มเพลตในการรวมข้อมูล

ภาพประกอบต่อไปนี้แสดงตัวอย่างของการแม็ปงานเท็มเพลตในการรวมข้อมูล การแม็ปแสดงข้อมูลฟิลด์ที่จะถูกซิงโครไนส์จาก Project Service Automation ไปยัง Finance and Operations

[![การแม็ปเท็มเพลต](./media/ExpenseEstimateTransactionRelationshipsMapping.jpg)](./media/ExpenseEstimateTransactionRelationshipsMapping.jpg)

[![การแม็ปเท็มเพลต](./media/ExpenseEstimatesMapping.jpg)](./media/ExpenseEstimatesMapping.jpg)




