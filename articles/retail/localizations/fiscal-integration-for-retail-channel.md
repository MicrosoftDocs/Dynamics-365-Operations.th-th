---
title: ภาพรวมของการรวมทางบัญชีสำหรับช่องทาง Retail
description: หัวข้อนี้อธิบายภาพรวมของความสามารถของการรวมทางบัญชีที่พร้อมใช้งานใน Microsoft Dynamics 365 for Retail
author: josaw
manager: annbe
ms.date: 02/01/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailFunctionalityProfile, RetailFormLayout, RetailParameters
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.search.region: Global
ms.search.industry: Retail
ms.author: v-kikozl
ms.search.validFrom: 2019-1-16
ms.dyn365.ops.version: 10
ms.openlocfilehash: 2dc977e3c53b1f15b41b095f586861b67c973a6d
ms.sourcegitcommit: 68df883200b5c477ea1799cc28d3ef467cd29202
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 02/07/2019
ms.locfileid: "377146"
---
# <a name="overview-of-fiscal-integration-for-retail-channels"></a>ภาพรวมของการรวมทางบัญชีสำหรับช่องทาง Retail

[!include [banner](../includes/banner.md)]

## <a name="introduction"></a>คำนำ

หัวข้อนี้เป็นภาพรวมของความสามารถของการรวมทางบัญชีที่พร้อมใช้งานใน Microsoft Dynamics 365 for Retail การรวมทางบัญชีรวมการรวมที่มีอุปกรณ์และบริการทางบัญชีที่หลากหลาย ที่เปิดใช้งานการลงทะเบียนทางบัญชีของการขายปลีกที่เกี่ยวข้องกับกฎหมายทางบัญชีท้องถิ่น ที่มีเป้าหมายที่การป้องกันการฉ้อโกงภาษีในอุตสาหกรรมการขายปลีก นี่คือสถานการณ์จำลองทั่วไปบางส่วนที่สามารถครอบคลุมได้โดยใช้การรวมทางบัญชี: 

- ลงทะเบียนการขายปลีกในอุปกรณ์ทางบัญชีที่ถูกเชื่อมต่อกับ Retail point of sale (POS) เช่น เครื่องพิมพ์ทางบัญชี และพิมพ์ใบเสร็จทางบัญชีสำหรับลูกค้า
- ส่งข้อมูลอย่างปลอดภัยซึ่งเกี่ยวข้องกับการขายและการส่งคืนที่เสร็จสมบูรณ์ใน Retail POS ไปยัง Web Service ภายนอกที่ถูกดำเนินการโดยหน่วยงานภาษี
- ช่วยรับประกันความไม่เปลี่ยนแปลงของข้อมูลธุรกรรมการขายผ่านลายเซ็นดิจิทัล

ฟังก์ชันการรวมทางบัญชีใน Retail คือกรอบงานที่ให้โซลูชันทั่วไปสำหรับการพัฒนาและการแก้ไข/ปรับปรุงตามคำสั่งเพิ่มเติมของการรวมระหว่าง Retail POS และอุปกรณ์และบริการทางบัญชี นอกจากนี้ ฟังก์ชันยังสนับสนุนตัวอย่างการรวมทางบัญชีที่สนับสนุนสถานการณ์จำลองการขายปลีกพื้นฐานสำหรับประเทศหรือเขตเฉพาะ และทำงานกับอุปกรณ์และบริการทางบัญชีเฉพาะ ตัวอย่างการรวมทางบัญชีประกอบด้วยส่วนขยายที่หลากหลายขององค์ประกอบ Retail และถูกรวมในชุดสินค้าการพัฒนาซอฟท์แวร์ (SDK) ของ Retail สำหรับข้อมูลเพิ่มเติมเกี่ยวกับตัวอย่างการรวมทางบัญชีที่พร้อมใช้งานใน Retail SDK ดู [ตัวอย่างการรวมทางบัญชีใน Retail SDK](#fiscal-integration-samples-in-the-retail-sdk) สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการติดตั้ง และใช้ Retail SDK ดู [ภาพรวม SDK ของการขายปลีก](../dev-itpro/retail-sdk/retail-sdk-overview.md)

เพื่อสนับสนุนสถานการณ์จำลองอื่นๆ ที่ไม่ได้รับการสนับสนุนโดยตัวอย่างการรวมทางบัญชี เพื่อรวม Retail POS กับอุปกรณ์และบริการทางบัญชีอื่นๆ เพื่อครอบคลุมความต้องการของประเทศหรือเขตอื่นๆ คุณต้องขยายตัวอย่างการรวมทางบัญชีที่มีอยู่ หรือสร้างตัวอย่างใหม่โดยใช้ตัวอย่างที่มีอยู่เป็นตัวอย่าง

## <a name="fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices"></a>กระบวนการลงทะเบียนทางบัญชีและตัวอย่างการรวมทางบัญชีสำหรับอุปกรณ์ทางบัญชี

กระบวนการลงทะเบียนทางบัญชีใน Retail POS สามารถประกอบด้วยขั้นตอนอย่างน้อยหนึ่งรายการ แต่ละขั้นตอนเกี่ยวข้องกับการลงทะเบียนทางบัญชีของธุรกรรมหรือเหตุการณ์การขายปลีกเฉพาะในอุปกรณ์และบริการทางบัญชีหนึ่งรายการ ส่วนประกอบของโซลูชันต่อไปนี้มีส่วนร่วมในการลงทะเบียนทางบัญชีในอุปกรณ์ทางบัญชีที่เชื่อมต่อกับสถานีฮาร์ดแวร์:

- **ส่วนขยายรันไทม์ของ Commerce (CRT)** – องค์ประกอบนี้ทำให้ข้อมูลธุรกรรมขายปลีก/เหตุการณ์เป็นอนุกรมในรูปแบบที่ยังใช้เพื่อโต้ตอบกับอุปกรณ์ทางบัญชี แยกวิเคราะห์การตอบสนองจากอุปกรณ์ทางบัญชี และจัดเก็บการตอบสนองในฐานข้อมูลช่องทาง ส่วนขยายยังกำหนดธุรกรรมและเหตุการณ์เฉพาะที่ต้องถูกตั้งค่าคอนฟิก องค์ประกอบนี้มักจะถูกอ้างอิงถึง *ผู้ให้บริการเอกสารทางบัญชี*
- **ส่วนขยายสถานีฮาร์ดแวร์** – องค์ประกอบนี้เริ่มต้นการสื่อสารกับอุปกรณ์ทางบัญชี ส่งคำขอและคำสั่งโดยตรงไปยังอุปกรณ์ทางบัญชีที่ขึ้นกับข้อมูลธุรกรรม/เหตุการณ์การขายปลีก ซึ่งถูกแยกจากเอกสารทางบัญชีและรับการตอบสนองจากอุปกรณ์ทางบัญชี องค์ประกอบนี้มักจะถูกอ้างอิงเป็น *ตัวเชื่อมต่อทางบัญชี*

ตัวอย่างการรวมทางบัญชีสำหรับอุปกรณ์ทางบัญชีประกอบด้วยส่วนขยาย CRT และสถานีฮาร์ดแวร์สำหรับผู้ให้บริการเอกสารทางบัญชีและตัวเชื่อมต่อทางบัญชี ตามลำดับ นอกจากนี้ ยังประกอบด้วยการตั้งค่าคอนฟิกส่วนประกอบต่อไปนี้:

- **การตั้งค่าคอนฟิกผู้ให้บริการเอกสารทางบัญชี** – การตั้งค่าคอนฟิกนี้กำหนดวิธีการเอาต์พุตและรูปแบบสำหรับเอกสารทางบัญชี นอกจากนี้ ยังประกอบด้วยการแม็ปข้อมูลสำหรับภาษีและวิธีการการชำระเงิน เพื่อทำให้ข้อมูลจาก Retail POS เข้ากันได้กับค่าที่ถูกกำหนดไว้ล่วงหน้าในเฟิร์มแวร์ของอุปกรณ์ทางบัญชี
- **การตั้งค่าคอนฟิกตัวเชื่อมต่อทางบัญชี** – การตั้งค่าคอนฟิกนี้กำหนดการสื่อสารทางกายภาพกับอุปกรณ์ทางการเงินเฉพาะ

กระบวนการลงทะเบียนทางบัญชีสำหรับการลงทะเบียน POS เฉพาะ ถูกกำหนดโดยการตั้งค่าที่สอดคล้องกันในโพรไฟล์ฟังก์ชัน POS สำหรับรายละเอียดเพิ่มเติมเกี่ยวกับวิธีการตั้งค่าคอนฟิกกระบวนการลงทะเบียนทางบัญชี อัปโหลดผู้ให้บริการเอกสารทางบัญชีและการตั้งค่าคอนฟิกตัวเชื่อมต่อทางบัญชี และเปลี่ยนแปลงพารามิเตอร์ ดู [ตั้งค่ากระบวนการลงทะเบียนทางบัญชี](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).

ตัวอย่างต่อไปนี้แสดงโฟลว์การดำเนินการลงทะเบียนทางบัญชีสำหรับอุปกรณ์ทางบัญชี โฟลว์เริ่มต้นด้วยเหตุการณ์ใน POS (ตัวอย่างเช่น การสรุปของธุรกรรมการขาย) และการใช้งานลำดับของขั้นตอนต่อไปนี้

1. POS ร้องขอเอกสารทางบัญชีจาก CRT
2. CRT กำหนดว่าเหตุการณ์ปัจจุบันต้องการการลงทะเบียนทางบัญชีหรือไม่
3. โดยขึ้นกับการตั้งค่ากระบวนการลงทะเบียนทางบัญชี CRT ระบุตัวเชื่อมต่อทางบัญชีและผู้ให้บริการเอกสารทางบัญชีที่สอดคล้องกันเพื่อใช้สำหรับการลงทะเบียนทางบัญชี
4. CRT รันผู้ให้บริการเอกสารทางบัญชีที่สร้างเอกสารทางบัญชี (ตัวอย่างเช่น เอกสาร XML) ที่แสดงธุรกรรมหรือเหตุการณ์การขายปลีก
5. POS ส่งเอกสารทางบัญชีที่ CRT เตรียมให้กับสถานีฮาร์ดแวร์
6. สถานีฮาร์ดแวร์รันตัวเชื่อมต่อทางบัญชีที่ประมวลผลเอกสารทางบัญชีและสื่อสารกับอุปกรณ์หรือบริการทางบัญชี
7. POS วิเคราะห์การตอบสนองจากอุปกรณ์หรือบริการทางบัญชี เพื่อกำหนดว่าการลงทะเบียนทางบัญชีสำเร็จหรือไม่
8. CRT บันทึกการตอบสนองต่อฐานข้อมูลช่องทาง

![schema โซลูชัน](media/emea-fiscal-integration-solution.png "schema โซลูชัน")

## <a name="error-handling"></a>การจัดการข้อผิดพลาด

กรอบงานการรวมทางบัญชีให้ตัวเลือกต่อไปนี้เพื่อจัดการความล้มเหลว ในระหว่างการลงทะเบียนทางบัญชี:

- **ลองอีกครั้ง** – ตัวดำเนินการสามารถใช้ตัวเลือกนี้ได้ เมื่อความล้มเหลวถูกแก้ปัญหาอย่างรวดเร็ว และการลงทะเบียนทางบัญชีสามารถรันซ้ำได้ ตัวอย่างเช่น ตัวเลือกนี้สามารถใช้ได้เมื่ออุปกรณ์ทางบัญชีไม่ได้ถูกเชื่อมต่อ เครื่องพิมพ์ทางบัญชีไม่มีกระดาษ หรือมีกระดาษติดในเครื่องพิมพ์ทางบัญชี
- **ยกเลิก** – ตัวเลือกนี้อนุญาตให้ตัวดำเนินการเลื่อนการลงทะเบียนทางบัญชีของธุรกรรมหรือเหตุการณ์ปัจจุบัน ถ้าล้มเหลว หลังจากการลงทะเบียนถูกเลื่อน ตัวดำเนินการสามารถทพงานต่อได้ใน POS และสามารถทำให้การดำเนินการใดๆ เสร็จสมบูรณ์ ซึ่งการลงทะเบียนทางบัญชีไม่ได้ถูกร้องขอ เมื่อเหตุการณ์ใดๆ ที่ต้องการการลงทะเบียนทางบัญชีเกิดขึ้นใน POS (ตัวอย่างเช่น ธุรกรรมใหม่ถูกเปิด กล่องโต้ตอบการจัดการข้อผิดพลาด) ปรากฏโดยอัตโนมัติเพื่อแจ้งเตือนตัวดำเนินการว่า ธุรกรรมก่อนหน้าไม่ไดุ้ถูกลงทะเบียนอย่างถูกต้อง และให้ตัวเลือกการจัดการข้อผิดพลาด
- **ข้าม** – ตัวดำเนินการสามารถใช้ตัวเลือกนี้ได้ เมื่อการลงทะเบียนทางบัญชีสามารถละเว้นได้ภายใต้เงื่อนไขเฉพาะ และตัวดำเนินการปกติสามารถดำเนินการต่อได้ใน POS ตัวอย่างเช่น ตัวเลือกนี้สามารถใช้ได้เมื่อธุรกรรมการขายที่การลงทะเบียนทางบัญชีที่ล้มเหลว สามารถลงทะเบียนได้ในสมุดรายวันกระดาษพิเศษ
- **ทำเครื่องหมายเป็นลงทะเบียนแล้ว** – ตัวดำเนินการสามารถใช้ตัวเลือกนี้ได้ เมื่อมีการลงทะเบียนธุรกรรมจริงๆ ในอุปกรณ์ทางบัญชี (ตัวอย่างเช่น ใบเสร็จทางบัญชีถูกพิมพ์) แต่ความล้มเหลวที่เกิดขึ้นเมื่อการตอบสนองทางบัญขีถูกบันทึกลงในฐานข้อมูลช่องทาง

> [!NOTE]
> ตัวเลือก **ข้าม** และ **ทำเครื่องหมายเป็นลงทะเบียนแล้ว** ต้องถูกเปิดใช้งานในกระบวนการลงทะเบียนทางบัญชี ก่อนที่จะมีการใช้ นอกจากนั้น ต้องมีการมอบสิทธิ์ที่สอดคล้องกันให้กับตัวดำเนินการ

ตัวเลือก **ข้าม** และ **ทำเครื่องหมายเป็นลงทะเบียนแล้ว** เปิดใช้งานรหัสข้อมูลให้บันทึกข้อมูลเฉพาะบางอย่างเกี่ยวกับความล้มเหลว เช่น เหตุผลสำหรับความล้มเหลว หรือการให้เหตุผลสำหรับการข้ามการลงทะเบียนทางบัญชี หรือการทำเครื่องหมายธุรกรรมเป็นลงทะเบียนแล้ว สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการตั้งค่าพารามิเตอร์การจัดการข้อผิดพลาด ดู [ตั้งการตั้งค่าการจัดการข้อผิดพลาด](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings)

## <a name="storing-fiscal-response-in-fiscal-transaction"></a>การจัดเก็บการตอบสนองทางบัญชีในธุรกรรมทางบัญชี

เมื่อการลงทะเบียนทางบัญชีของธุรกรรมหรือเหตุการณ์สำเร็จ ธุรกรรมทางบัญชีถูกสร้างขึ้นในฐานข้อมูลช่องทางและเชื่อมโยงไปยังธุรกรรมหรือเหตุการณ์ดั้งเดิม ในทำนองเดียวกัน ถ้าตัวเลือก **ข้าม** หรือ **ทำเครื่องหมายเป็นลงทะเบียนแล้ว** ถูกเลือกสำหรับการลงทะเบียนทางบัญชีที่ล้มเหลว ข้อมูลนี้ถูกจัดเก็บในธุรกรรมทางบัญชี ธุรกรรมทางบัญชีเก็บการตอบสนองทางบัญชีของอุปกรณ์หรือบริการทางบัญชี ถ้ากระบวนการลงทะเบียนทางบัญชีประกอบด้วยขั้นตอนหลายขั้นตอน ธุรกรรมทางบัญชีจะถูกสร้างขึ้นสำหรับแต่ละขั้นตอนของกระบวนการที่ส่งผลต่อการลงทะเบียนที่สำเร็จหรือล้มเหลว

ธุรกรรมทางบัญชีถูกโอนย้ายไปยังสำนักงานใหญ่ของ Retail โดย *P-job* พร้อมกับธุรกรรมการขายปลีก บน FastTab **ธุรกรรมทางบัญชี** ของหน้า **ธุรกรรมร้านค้าปลีก** คุณสามารถดูธุรกรรมทางบัญชีที่เชื่อมโยงกับธุรกรรมการขายปลีกได้

ธุรกรรมทางบัญชีจัดเก็บรายละเอียดต่อไปนี้:

- รายละเอียดกระบวนการลงทะเบียนทางบัญชี (กระบวนการ กลุ่มตัวเชื่อมต่อ ตัวเชื่อมต่อ และอื่นๆ) นอกจากนี้ ยังจัดเก็บหมายเลขประจำสินค้าของอุปกรณ์ทางบัญชีในฟิลด์ **ลงทะเบียนหมายเลข** ถ้าข้อมูลนี้ถูกรวมในการตอบสนองทางบัญชี
- สถานะของการลงทะเบียนทางบัญชี: **เสร็จสมบูรณ์** สำหรับการลงทะเบียนที่สำเร็จ **ข้าม** ถ้าตัวดำเนินการเลือกตัวเลือก **ข้าม** สำหรับการลงทะเบียนที่ล้มเหลว หรือ **ทำเครื่องหมายเป็นลงทะเบียนแล้ว** ถ้าตัวดำเนินการเลือกตัวเลือก **ทำเครื่องหมายเป็นลงทะเบียนแล้ว**
- ธุรกรรมรหัสข้อมูลที่เกี่ยวข้องกับธุรกรรมทางบัญชีที่เลือก ในการดูธุรกรรมรหัสข้อมูล บน FastTab **ธุรกรรมทางบัญชี** เลือกธุรกรรมทางบัญชีที่มีสถานะเป็น **ข้าม** or **ทำเครื่องหมายเป็นลงทะเบียนแล้ว** และจากนั้นเลือก **Iธุรกรรมรหัสข้อมูล**

## <a name="fiscal-texts-for-discounts"></a>ข้อความทางบัญชีสำหรับส่วนลด

บางประเทศหรือบางเขตมีความต้องการพิเศษเกี่ยวกับข้อความเพิ่มเติมที่ต้องถูกพิมพ์ในใบเสร็จทางบัญชี เมื่อมีการนำชนิดของส่วนลดที่แตกต่างกันไปใช้ ฟังก์ชันการรวมทางการเงินอนุญาตให้คุณตั้งค่าข้อความพิเศษสำหรับส่วนลดที่ถูกพิมพ์ หลังจากรายการส่วนลดหรือใบเสร็จทางบัญชี สำหรับส่วนลดแบบกำหนดเอง คุณสามารถตั้งค่าคอนฟิกข้อความทางการเงินสำหรับรหัสข้อมูลที่ถูกระบุเป็นรหัสข้อมูล **ส่วนลดผลิตภัณฑ์** ในโพรไฟล์ฟังก์ชัน POS สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการตั้งค่าข้อความทางบัญชีสำหรับส่วนลด ดู [ตั้งค่าข้อความทางบัญชีสำหรับส่วนลด](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts)

## <a name="printing-fiscal-x-and-fiscal-z-reports"></a>การพิมพ์รายงาน X ทางบัญชี และ Z ทางบัญชี

ฟังก์ชันการรวมทางบัญชีสนับสนุนการสร้างของใบแจ้งยอดสิ้นสุดวันที่เฉพาะเจาะจงกับอุปกรณ์และบริการทางบัญชีแบบรวม:

- ปุ่มใหม่ที่รันการดำเนินการที่สอดคล้องกัน ควรถูกเพิ่มไปยังโครงร่างหน้าจอ POS สำหรับรายละเอียดเพิ่มเติม ดู [ตั้งค่ารายงาน X/Z ทางบัญชีจาก POS](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos)
- ในตัวอย่างการรวมทางบัญชี การดำเนินการเหล่านี้ควรถูกจับคู่กับการดำเนินการที่สอดคล้องกันของอุปกรณ์ทางบัญชี

## <a name="fiscal-integration-samples-in-the-retail-sdk"></a>ตัวอย่างการรวมทางบัญชีใน Retail SDK

ตัวอย่างการรวมทางบัญชีต่อไปนี้พร้อมใช้งานในขณะนี้ใน Retail SDK ที่ถูกนำออกใช้งานกับ Retail:

- [ตัวอย่างการรวมเครื่องพิมพ์ทางบัญชีสำหรับอิตาลี](emea-ita-fpi-sample.md)
- [ตัวอย่างการรวมเครื่องพิมพ์ทางบัญชีสำหรับโปแลนด์](emea-pol-fpi-sample.md)

ฟังก์ชันการรวมทางบัญชีต่อไปนี้ยังพร้อมใช้งานใน Retail SDK ด้วย แต่ขณะนี้ไม่ใช้ประโยชน์จากกรอบงานการรวมทางบัญชี การย้ายของฟังก์ชันไปยังกรอบงานการรวมทางบัญชีถูกวางแผนไว้สำหรับการปรับปรุงในภายหลัง

- [ลายเซ็นดิจิทัลสำหรับฝรั่งเศส](emea-fra-cash-registers.md)
- [ลายเซ็นดิจิทัลสำหรับนอร์เวย์](emea-nor-cash-registers.md)
- [ตัวอย่างการรวมหน่วยควบคุมสำหรับสวีเดน](../dev-itpro/retail-sdk/retail-sdk-control-unit-sample.md)
