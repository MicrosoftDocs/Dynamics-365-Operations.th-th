---
title: จำกัดการใช้โทเค็นการชำระเงิน
description: หัวข้อนี้อธิบายคุณลักษณะที่จํากัดวิธีการใช้โทเค็นการชำระเงินใน Microsoft Dynamics 365 Commerce
author: BrianShook
ms.date: 10/20/2022
ms.topic: article
audience: Application User, Developer, IT Pro
ms.reviewer: v-chgriffin
ms.search.region: Global
ms.author: brshoo
ms.search.validFrom: 2022-09-20
ms.openlocfilehash: 8092ab0724f33f21759aa84d25e0bdcb5b2ad5dd
ms.sourcegitcommit: 6bd8822f7aa781d596b70956bead834117cf302c
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 10/20/2022
ms.locfileid: "9709672"
---
# <a name="limit-payment-token-usage"></a>จำกัดการใช้โทเค็นการชำระเงิน

[!include [banner](../includes/banner.md)]
[!include [banner](../includes/preview-banner.md)]

หัวข้อนี้อธิบายคุณลักษณะที่จํากัดวิธีการใช้โทเค็นการชำระเงินใน Microsoft Dynamics 365 Commerce การใช้โทเค็นถูกควบคุมโดยขอบเขตของใบสั่งขาย หรือหากได้รับอนุญาตจากลูกค้า จะมีการจัดเก็บเป็นข้อมูลบัตร

## <a name="key-terms"></a>เงื่อนไขสำคัญ

| เงื่อนไข | คำอธิบาย |
|---|---|
| โทเค็น | XML Blob ที่อ้างอิงในระบบ Dynamics 365 ซึ่งจัดเก็บข้อมูลอ้างอิงการชำระเงินเพื่อวัตถุประสงค์ในการทำธุรกรรม |
| ข้อมูลบัตร | โทเค็นข้อมูลอ้างอิงบัตรที่บันทึกไว้ซึ่งตกลงกันสำหรับใช้ในอนาคตในระบบ Dynamics 365 หรือเกตเวย์การชำระเงินและที่ใช้กับบัญชีของลูกค้าโดยเฉพาะ |

การจํากัดการใช้โทเค็นการชำระเงินใช้กับสภาพแวดล้อมใดๆ ที่ใช้บริการเกตเวย์การชำระเงินที่มีการใช้โทเค็นที่เกิดซ้ำ [Dynamics 365 Payment Connector สำหรับ Adyen](adyen-connector.md) แบบสำเร็จรูปจะใช้โทเค็นการชำระเงินที่เกิดซ้ำเพื่อดำเนินการกับใบสั่งที่ตามมา เช่น การปรับปรุงการอนุญาตและการอนุญาตซ้ำ

เพื่อช่วยควบคุมวิธีการใช้โทเค็นการชำระเงินที่เกิดซ้ำเหล่านี้ในระบบ คุณลักษณะ **จำกัดการใช้โทเค็นการชำระเงินกับบริบทของใบสั่ง** จะจํากัดการใช้โทเค็นที่เกิดซ้ำกับขอบเขตของใบสั่งขายในระบบ เมื่อเปิดใช้งานคุณลักษณะนี้ คุณลักษณะจะแก้ไขส่วนติดต่อผู้ใช้ (UI) ของ Commerce headquarters โดยการอัปเดตหน้าข้อมูลการชำระเงินที่ป้อนและจํากัดความสามารถในการเลือกข้อมูลอ้างอิงการชำระเงินของลูกค้าที่ผ่านมาเพื่อใช้งานในอินสแตนซ์ธุรกรรมใหม่

คุณลักษณะนี้จะช่วยให้เป็นไปตามกฎการใช้สำหรับผู้ดำเนินการชำระเงินบางราย เช่น Visa ใน [กฎหลักของ Visa และกฎสำหรับผลิตภัณฑ์และบริการของ Visa](https://usa.visa.com/content/dam/VCOM/download/about-visa/visa-rules-public.pdf) Visa ระบุว่าการใช้โทเค็นการชำระเงินควรถูกจำกัดให้อยู่ในขอบเขตของธุรกรรม เว้นแต่ผู้ถือบัตรตกลงเป็นอย่างอื่น

คุณลักษณะ **จำกัดการใช้โทเค็นการชำระเงินกับบริบทของใบสั่ง** จะเกี่ยวข้องเฉพาะเมื่อคุณใช้งานบริการเกตเวย์การชำระเงินที่ใช้ข้อมูลอ้างอิงโทเค็นการชำระเงินที่เกิดซ้ำเท่านั้น

## <a name="enable-the-feature"></a>เปิดใช้งานคุณลักษณะ

เมื่อต้องการเปิดใช้งานคุณลักษณะ **จำกัดการใช้โทเค็นการชำระเงินกับบริบทของใบสั่ง** ใน Commerce headquarters สำหรับสภาพแวดล้อมของคุณ ให้ไปที่ **พื้นที่ทำงาน \> การจัดการคุณลักษณะ** ค้นหาและเลือก **จำกัดการใช้โทเค็นการชำระเงินกับบริบทของใบสั่ง** ในรายการ แล้วเลือก **เปิดใช้งานทันที**

## <a name="limit-payment-token-usage"></a>จำกัดการใช้โทเค็นการชำระเงิน

เมื่อเปิดใช้งานคุณลักษณะ หน้า Commerce headquarters ที่ใช้สำหรับการบันทึกวิธีการชำระเงินจะอัปเดตวิธีการชำระเงินของลูกค้าที่อ้างอิงวิธีการชำระเงินของลูกค้าที่เก็บไว้ของลูกค้า การอัปเดตนี้จะมีผลกระทบต่อการดําเนินงานสองส่วนหลักคือ:

- วิธีการป้อนข้อมูลบัตรลูกค้าในนามของลูกค้า
- วิธีการจัดเก็บข้อมูลการชำระเงินจากลูกค้าเป็นรายการการชำระเงินสำหรับใบสั่งขายในอนาคต

เมื่อลูกค้าทำธุรกรรมในช่องทาง Commerce รายละเอียดการชำระเงินจะถูกจัดเก็บไว้พร้อมกับบริบทใบสั่งขาย บริบทใบสั่งขายจะจํากัดโทเค็นการชำระเงินเพื่อให้ไม่ใช้เป็นข้อมูลอ้างอิงการชำระเงินกับเรกคอร์ดลูกค้าในหน้าการชำระเงินสำหรับใบสั่งขายใหม่หรือที่แก้ไขใน Commerce headquarters

### <a name="payment-form-changes"></a>การเปลี่ยนแปลงรูปแบบการชำระเงิน

เมื่อศูนย์บริการหรือ Commerce headquarters ใช้การชำระเงินของลูกค้ากับใบสั่งขาย หน้าการชำระเงินจะแสดงรายละเอียดการเลือกวิธีการชำระเงิน เมื่อเปิดใช้งานคุณลักษณะ **จำกัดการใช้โทเค็นการชำระเงินกับบริบทของใบสั่ง** หากผู้ใช้เลือกเครื่องหมายบวก (**+**) ในหน้าการชำระเงิน จะมีการแสดงเฉพาะเรกคอร์ด "ข้อมูลบัตร" ที่บันทึกไว้เท่านั้น การเปลี่ยนแปลงมีเงื่อนไขว่าศูนย์บริการหรือผู้ใช้ Commerce headquarters ต้องป้อนรายละเอียดการชำระเงินทั้งหมดที่ลูกค้าระบุไว้เมื่อกรอกข้อมูลในหน้า **ป้อนข้อมูลการชำระเงินของลูกค้า** สำหรับธุรกรรมใบสั่งขายใหม่

รายการของค่าฟิลด์ **หมายเลข** จะมีเฉพาะข้อมูลอ้างอิงบัตรที่เชื่อมโยงกับลูกค้าที่มีข้อมูลบัตรเท่านั้น โดยจะกรองข้อมูลอ้างอิงการชำระเงินใดๆ ที่ไม่ได้กำหนดขอบเขตไว้กับใบสั่งขายออก

เครื่องหมายบวก (**+**) ในฟิลด์ **หมายเลข** จะยังคงมีอยู่และสามารถใช้เพื่อป้อนข้อมูลการชำระเงินที่ลูกค้าให้ไว้สำหรับธุรกรรมที่เกี่ยวข้องกับใบสั่งขายที่จะถูกประมวลผล

### <a name="how-cards-on-file-work"></a>วิธีทำงานของข้อมูลบัตร

เมื่อเปิดใช้งานคุณลักษณะ **จำกัดการใช้โทเค็นการชำระเงินกับบริบทของใบสั่ง** ข้อมูลบัตรจะเป็นโทเค็นการชำระเงินที่เกิดซ้ำที่บันทึกไว้กับเรกคอร์ดลูกค้าและไม่มีการจำกัดขอบเขตของใบสั่งขาย ข้อมูลบัตรเปิดใช้งานการอ้างอิงด่วนระหว่างผู้ใช้ Commerce headquarters เมื่อผู้ใช้กรอกข้อมูลในหน้าการชำระเงินสำหรับใบสั่งขายใหม่ การอ้างอิงโทเค็นนี้สามารถใช้ได้กับสภาพแวดล้อม Dynamics 365 เท่านั้น สำหรับช่องทางออนไลน์ที่ใช้บริการเกตเวย์การชำระเงินที่ให้ผู้ใช้บันทึกวิธีการชำระเงินสำหรับการใช้ในอนาคตในโมดูล iFrame การชำระเงิน เกตเวย์การชำระเงินจะจัดเก็บข้อมูลอ้างอิงเหล่านี้เป็นข้อมูลอ้างอิงแยกต่างหากสำหรับข้อมูลบัตรของ Dynamics 365 ไว้อย่างปลอดภัย

ตัวอย่างเช่น หากมีการใช้ Dynamics 365 Commerce Payment Connector สำหรับ Adyen ในช่องทางออนไลน์ ลูกค้าที่ป้อนข้อมูลบัตรเครดิตของตนในโมดูล iFrame การชำระเงินจะเห็นเฉพาะข้อมูลอ้างอิงบัตรที่บันทึกไว้ของบริการเกตเวย์สำหรับการซื้อทางออนไลน์ในครั้งถัดไปเมื่อมีการรับรองความถูกต้อง พวกเขาจะไม่เห็นสภาพแวดล้อม Dynamics 365 ที่จัดเก็บข้อมูลบัตรว่าเป็นตัวเลือกในโมดูล iFrame การชำระเงิน ในลักษณะเดียวกัน เมื่อผู้ซื้อส่งใบสั่งผ่านศูนย์บริการ ข้อมูลอ้างอิงบัตรที่บันทึกไว้ทางออนไลน์ของพวกเขาจะไม่ถูกแสดงเป็นตัวเลือกให้กับผู้ใช้ของศูนย์บริการ ผู้ใช้ศูนย์บริการจะมองเห็นเฉพาะข้อมูลอ้างอิงข้อมูลบัตรก่อนหน้าจากระบบ Dynamics 365 (ตามที่ลูกค้าตกลงไว้) เพื่อบันทึกสำหรับใบสั่งในอนาคต

ผู้ใช้ Commerce headquarters สามารถบันทึกข้อมูลบัตรสำหรับลูกค้าได้โดยไปที่ **Retail และ Commerce \> ลูกค้า** และเลือกเรกคอร์ดบัญชีลูกค้า ในส่วน **ลูกค้า \> ตั้งค่า** ผู้ใช้ที่มีสิทธิ์ดำเนินการกับหน้าการชำระเงินสามารถใช้หน้ารายการข้อมูล **บัตรเครดิต** เพื่อป้อนบัตรการชำระเงินที่จะจัดเก็บไว้สำหรับธุรกรรมในอนาคต การดําเนินการนี้จะประหยัดเวลาเมื่อดำเนินการกับการชำระเงินกับใบสั่งขายในอนาคตของลูกค้า ผู้ใช้ของศูนย์บริการและ Commerce headquarters ควรป้อนรายละเอียดข้อมูลบัตรเฉพาะเมื่อลูกค้าตกลงที่จะใช้การอ้างอิงบัตรกับธุรกรรมในอนาคตเท่านั้น

กล่องกาเครื่องหมาย **บันทึกไว้เพื่อใช้ในอนาคต** ที่ด้านล่างของหน้าการชำระเงินของ Commerce headquarters ให้ผู้ใช้สามารถบันทึกข้อมูลบัตรเพื่อการใช้งานในอนาคต ควรใช้กล่องกาเครื่องหมายนี้เฉพาะเมื่อลูกค้าตกลงที่จะใช้ข้อมูลบัตรสำหรับธุรกรรมในอนาคตเท่านั้น คุณสามารถแสดงหรือจำกัดกล่องกาเครื่องหมาย **บันทึกไว้เพื่อใช้ในอนาคต** โดยใช้ตัวเลือก **อนุญาตให้เก็บข้อมูลบัตรของลูกค้า** ในแท็บ **การชำระเงิน** ของหน้า **พารามิเตอร์ศูนย์บริการ** ใน Commerce headquarters เมื่อตั้งค่าตัวเลือกนี้เป็น **ใช่** ผู้ใช้ Commerce headquarters ที่มีสิทธิ์ดำเนินการกับหน้าการชำระเงินสามารถบันทึกข้อมูลโดยใช้กล่องกาเครื่องหมาย **บันทึกไว้เพื่อใช้ในอนาคต** เมื่อตั้งค่าตัวเลือกเป็น **ไม่** กล่องกาเครื่องหมายจะไม่สามารถใช้ได้กับผู้ใช้ Commerce headquarters ที่มีสิทธิ์ดำเนินการกับหน้าการชำระเงิน ตัวเลือก **อนุญาตให้เก็บข้อมูลบัตรของลูกค้า** สามารถใช้ได้หากบริษัทของคุณต้องการจำกัดการใช้โทเค็นที่เกิดซ้ำใน Commerce headquarters แต่ยังไม่ต้องการอนุญาตให้มีการบันทึกข้อมูลบัตรหากยังไม่มีขั้นตอนในการทำให้แน่ใจว่าลูกค้าได้ให้ความยินยอมแล้ว

### <a name="commerce-headquarters-pages-where-the-recurring-token-restrictions-are-enforced"></a>หน้า Commerce headquarters ซึ่งมีการบังคับใช้ข้อจํากัดของโทเค็นที่เกิดซ้ำ

เมื่อเปิดใช้งานคุณลักษณะ การกำหนดขอบเขตการจํากัดโทเค็นจะมีผลกระทบใน Commerce headquarters ในส่วนต่อไปนี้:

- ข้อมูลการชำระเงินของลูกค้าที่ **ใบสั่งขาย \> การชำระเงิน \> ป้อนการชำระเงินของลูกค้า**
- ใบสั่งที่มีความต่อเนื่อง
- การชำระเงินแบบผ่อนชำระ
- การชำระเงินด้วยบัตรเครดิตของบัญชีลูกหนี้

### <a name="manage-payment-tokens-archiving-or-removal"></a>จัดการโทเค็นการชำระเงิน (การเก็บถาวรหรือการลบ)

โทเค็นการชำระเงินที่สร้างก่อนเปิดใช้งานค่าสถานะของคุณลักษณะ **จำกัดการใช้โทเค็นการชำระเงินกับบริบทของใบสั่ง** (หรือขณะที่ปิดใช้งานคุณลักษณะ) จะยังคง "ไม่กำหนดขอบเขต" ในระบบและสามารถอ้างอิงในรายการที่เลือกในหน้าการชำระเงินของ Commerce headquarters คุณสามารถลบโทเค็นเหล่านี้ออกเป็นประจำใน Commerce headquarters ได้สองวิธี:

- ใช้หน้า **เก็บถาวรข้อมูลธุรกรรมบัตรเครดิต** เพื่อตั้งค่างานที่ล้างข้อมูลหรือเก็บถาวรโทเค็นการชำระเงินเป็นประจำ หากคุณตั้งค่าตัวเลือก **ลบข้อมูลโดยไม่ต้องเก็บถาวร** เป็น **ใช่** โทเค็นที่ตรงกับการตั้งค่า **อายุธุรกรรมขั้นต่ำ (เป็นวัน)** จะถูกลบ สำหรับข้อมูลเพิ่มเติม ดูที่ [เก็บถาวรข้อมูลธุรกรรมบัตรเครดิต](archive-cc-data.md)
- ใช้หน้า **ล้างข้อมูลโทเค็นบัตรเครดิต** ใหม่ (**บัญชีลูกหนี้ \> การสอบถามและรายงาน \> ล้างข้อมูล \> ล้างข้อมูลโทเค็นบัตรเครดิต**) ซึ่งช่วยให้คุณสามารถเรียกใช้หรือตั้งค่าชุดงานที่จะลบโทเค็นการชำระเงิน ตั้งค่าพารามิเตอร์ดังต่อไปนี้

    - ค่า **อายุโทเค็นขั้นต่ำเป็นวัน** ต้องเป็น 90 วันหรือมากกว่า
    - การตั้งค่า **ทำงานในแบบเบื้องหลัง** สามารถใช้ในการกำหนดการตั้งค่า **การเกิดซ้ำ** หรือ **การแจ้งเตือน**
    - คุณสามารถกำหนดกลุ่มชุดงานเพื่อเรียกใช้งานกับกลุ่มที่ระบุได้
    - หากตัวเลือก **ส่วนตัว** ตั้งค่าเป็น **ใช่** มีเฉพาะผู้ใช้ที่สร้างงานเท่านั้นที่สามารถเรียกใช้งานได้
    - การตั้งค่าเป็น **ใช่** สำหรับตัวเลือก **งานสำคัญ** ช่วยให้มั่นใจว่าระบบยังคงติดตามสถานะของงานอยู่

โทเค็นที่ถูกลบจะไม่สามารถเรียกดูข้อมูลได้ ตั้งค่าฟิลด์ **อายุโทเค็นขั้นต่ำเป็นวัน** เป็นช่วงที่ตรงกับอายุธุรกรรมที่ทำงานนานที่สุดให้กับสภาพแวดล้อมของคุณ (จากการอนุญาตเพื่อบันทึกข้อมูลหรือการขอคืนเงิน)

## <a name="additional-resources"></a>ทรัพยากรเพิ่มเติม

[คำถามที่ถามบ่อยเกี่ยวกับการชำระเงิน](payments-retail.md)

[โมดูลเช็คเอาท์](../add-checkout-module.md)

[โมดูลการชำระเงิน](../payment-module.md)
