---
title: ตั้งค่าผู้เช่า B2C ใน Commerce
description: หัวข้อนี้จะอธิบายวิธีการตั้งค่าผู้เช่าของธุรกิจ-ผู้บริโภค (B2C) ของ Azure Active Directory (Azure AD) ของคุณสำหรับการตรวจสอบความถูกต้องของไซต์ของผู้ใช้ใน Dynamics 365 Commerce
author: BrianShook
manager: annbe
ms.date: 06/22/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-commerce
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: v-chgri
ms.search.scope: ''
ms.search.region: Global
ms.search.industry: retail
ms.author: brshoo
ms.search.validFrom: 2020-02-13
ms.dyn365.ops.version: ''
ms.openlocfilehash: af2ec75328b6377c5d92656d011d21576417a63f
ms.sourcegitcommit: 4bf5ae2f2f144a28e431ed574c7e8438dc5935de
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 11/13/2020
ms.locfileid: "4517391"
---
# <a name="set-up-a-b2c-tenant-in-commerce"></a>ตั้งค่าผู้เช่า B2C ใน Commerce

[!include [banner](includes/banner.md)]

หัวข้อนี้จะอธิบายวิธีการตั้งค่าผู้เช่าของธุรกิจ-ผู้บริโภค (B2C) ของ Azure Active Directory (Azure AD) ของคุณสำหรับการตรวจสอบความถูกต้องของไซต์ของผู้ใช้ใน Dynamics 365 Commerce

## <a name="overview"></a>ภาพรวม

Dynamics 365 Commerce ใช้ Azure AD B2C เพื่อสนับสนุนข้อมูลประจำตัวของผู้ใช้และขั้นตอนการตรวจสอบความถูกต้อง ผู้ใช้สามารถลงชื่อสมัคร ลงชื่อเข้าใช้ และรีเซ็ตรหัสผ่านของพวกเขาได้ผ่านขั้นตอนเหล่านี้ Azure AD B2C จัดเก็บข้อมูลการตรวจสอบความถูกต้องของผู้ใช้ที่สำคัญ เช่น ชื่อผู้ใช้ และรหัสผ่าน เรกคอร์ดผู้ใช้ในผู้เช่าของ B2C จะจัดเก็บเรกคอร์ดบัญชีเฉพาะที่ของ B2C หรือเรกคอร์ดผู้ให้บริการข้อมูลเฉพาะตัวทางสังคมของ B2C เรกคอร์ด B2C เหล่านี้จะเชื่อมโยงกลับไปยังเรกคอร์ดลูกค้าในสภาพแวดล้อม Commerce

## <a name="create-or-link-to-an-existing-aad-b2c-tenant-in-the-azure-portal"></a>สร้างหรือเชื่อมโยงกับผู้เช่า B2C ของ AAD ที่มีอยู่ในพอร์ทัล Azure

1. ลงชื่อเข้าใช้ [พอร์ทัล Azure](https://portal.azure.com/)
1. จากเมนูของพอร์ทัล Azure เลือก **สร้างทรัพยากร** ตรวจสอบให้แน่ใจว่าได้ใช้การบอกรับเป็นสมาชิกและไดเรกทอรีที่จะเชื่อมต่อกับสภาพแวดล้อม Commerce ของคุณ

    ![สร้างทรัพยากรในพอร์ทัล Azure](./media/B2CImage_1.png)

1. ไปที่ **ข้อมูลประจำตัว \> Azure Active Directory B2C**
1. เมื่อหน้า **สร้างผู้เช่า B2C ใหม่ หรือลิงค์ไปยังผู้เช่าที่มีอยู่** ให้ใช้ตัวเลือกใดตัวเลือกหนึ่งด้านล่างที่เหมาะสมกับความต้องการของบริษัทของคุณที่สุด:

    - **สร้างผู้เช่า Azure AD B2C ใหม่**: ใช้ตัวเลือกนี้เพื่อสร้างผู้เช่า B2C ของ AAD ใหม่
        1. เลือก **สร้างผู้เช่า B2C ของ Azure AD ใหม่**
        1. ภายใต้ **ชื่อองค์กร** ให้ป้อนชื่อองค์กร
        1. ภายใต้ **ชื่อโดเมนเริ่มต้น** ให้ป้อนชื่อโดเมนเริ่มต้น
        1. สำหรับ **ประเทศหรือภูมิภาค** ให้เลือกประเทศหรือภูมิภาค
        1. เลือก **สร้าง** เพื่อสร้างผู้เช่า

     ![สร้างผู้เช่า Azure AD ใหม่](./media/B2CImage_2.png)

     - **ลิงค์ผู้เช่าของ Azure AD B2C ที่มีอยู่ไปยังการบอกรับเป็นสมาชิก Azure ของฉัน**: ให้ใช้ตัวเลือกนี้ ถ้าคุณมีผู้เช่าของ Azure AD B2C ที่คุณต้องการเชื่อมโยง
        1. เลือก **ลิงค์ผู้เช่าของ Azure AD B2C ที่มีอยู่ไปยังการบอกรับเป็นสมาชิก Azure ของฉัน**
        1. สำหรับ **ผู้เช่าของ Azure AD B2C** เลือกผู้เช่า B2C ที่เหมาะสม ถ้าข้อความ "ไม่พบผู้เช่า B2C ที่มีสิทธิ์" ปรากฏขึ้นในกล่องการเลือก คุณจะไม่มีผู้เช่า B2C ที่มีสิทธิ์ที่มีอยู่ และจะต้องสร้างใหม่
        1. สำหรับ **กลุ่มทรัพยากร** ให้เลือก **สร้างใหม่** ป้อน **ชื่อ** สำหรับกลุ่มทรัพยากรที่จะมีผู้เช่า เลือก **สถานที่ของกลุ่มทรัพยากร** แล้วเลือก **สร้าง**

    ![ลิงค์ผู้เช่าของ Azure AD B2C ที่มีอยู่ไปยังการบอกรับเป็นสมาชิก Azure](./media/B2CImage_3.png)

1. หลังจากที่มีการสร้างไดเรกทอรี Azure AD B2C ใหม่ (นี่อาจใช้เวลาสักครู่) ลิงค์ไปยังไดเรกทอรีใหม่จะปรากฏขึ้นบนแดชบอร์ด ลิงค์นี้จะนำคุณไปยังหน้า "ยินดีต้อนรับสู่ Azure Active Directory B2C"

    ![ลิงค์ไปยังไดเรกทอรี AAD ใหม่](./media/B2CImage_4.png)

> [!NOTE]
> ถ้าคุณมีการบอกรับเป็นสมาชิกหลายรายภายในบัญชี Azure ของคุณ หรือตั้งค่าผู้เช่า B2C โดยไม่มีการเชื่อมโยงกับการบอกรับเป็นสมาชิกที่ใช้งานอยู่ แบนเนอร์ **แก้ไขปัญหา** จะนำคุณไปลิงค์ผู้เช่ากับการบอกรับเป็นสมาชิก เลือกข้อความการแก้ไขปัญหา และทำตามคำแนะนำเพื่อแก้ไขปัญหาการบอกรับเป็นสมาชิก

รูปภาพต่อไปนี้แสดงตัวอย่างของแบนเนอร์ **การแก้ไขปัญหา** ของ Azure AD B2C

![คำเตือนที่แสดงไดเรกทอรีไม่มีการบอกรับเป็นสมาชิกที่ใช้งานอยู่](./media/B2CImage_5.png)

## <a name="create-the-b2c-application"></a>สร้างแอพลิเคชัน B2C

เมื่อมีการสร้างผู้เช่า B2C คุณจะสร้างแอพลิเคชัน B2C ภายในผู้เช่าเพื่อโต้ตอบกับการดำเนินการ Commerce

เมื่อต้องการสร้างแอพลิเคชัน B2C ให้ทำตามขั้นตอนเหล่านี้

1. ในพอร์ทัล Azure เลือก **แอปพลิเคชัน (ดั้งเดิม)** แล้วเลือก **เพิ่ม**
1. ภายใต้ **ชื่อ** ให้ป้อนชื่อของแอพลิเคชัน B2C ของ AAD ที่ต้องการ
1. ภายใต้ **เว็บแอป/Web API** สำหรับ **รวมเว็บแอป / API เว็บ** เลือก **ใช่**
1. สำหรับ **อนุญาตขั้นตอนโดยนัย** เลือก **ใช่** (ค่าเริ่มต้น)
1. ภายใต้ **ตอบ URL** ให้ป้อน URL ตอบกลับที่จัดสรรไว้ของคุณ โปรดดูที่ [ตอบ URL](#reply-urls) ด้านล่าง สำหรับข้อมูลเกี่ยวกับ URL ตอบกลับและวิธีจัดรูปแบบไฟล์เหล่านั้นที่นี่
1. สำหรับ **รวมไคลเอนต์ดั้งเดิม** เลือก **ไม่** (ค่าเริ่มต้น)
1. เลือก **สร้าง**

### <a name="reply-urls"></a>ตอบกลับ URLs

การตอบกลับ URLs มีความสำคัญ เนื่องจากมีการอนุญาตรายการของโดเมนส่งคืน เมื่อไซต์ของคุณเรียกใช้ Azure AD B2C เพื่อตรวจสอบความถูกต้องของผู้ใช้ การอนุญาตนี้จะช่วยให้การส่งคืนของผู้ใช้ที่ได้รับการรับรองความถูกต้องสามารถกลับไปยังโดเมนที่มีการลงชื่อเข้าใช้ (โดเมนของไซต์ของคุณ) 

ในกล่อง **ตอบกลับ URL** บนหน้าจอ **Azure AD B2c - แอพลิเคชัน \> แอพลิเคชันใหม่** คุณต้องเพิ่มรายการที่แยกต่างหากสำหรับทั้งโดเมนไซต์ของคุณและ (เมื่อมีการเตรียมใช้งานสภาพแวดล้อมของคุณ) URL ที่สร้างโดย Commerce URL เหล่านี้ต้องใช้รูปแบบ URL ที่ถูกต้องเสมอ และต้องเป็น URL พื้นฐานเท่านั้น (ไม่มีเครื่องหมายสแลชหรือพาธต่อท้าย) จากนั้น สตริง ``/_msdyn365/authresp`` ต้องถูกผนวกเข้ากับ URL พื้นฐาน ตามตัวอย่างต่อไปนี้

- ``https://www.fabrikam.com/_msdyn365/authresp`` (โดเมนควรตรงกับโดเมนอีคอมเมิร์ซทั้งหมด ถ้าคุณมีหลายโดเมน คุณต้องเพิ่ม URL นี้สำหรับแต่ละโดเมน)
- ``https://fabrikam-prod.commerce.dynamics.com/_msdyn365/authresp``

## <a name="create-user-flow-policies"></a>สร้างนโยบายขั้นตอนของผู้ใช้

ขั้นตอนของผู้ใช้เป็นนโยบายที่ Azure AD B2C ใช้เพื่อให้ประสบการณ์การใช้งานของผู้ใช้ในการลงชื่อเข้าใช้ ลงชื่อสมัคร แก้ไขโพรไฟล์ และลืมรหัสผ่าน ที่มีความปลอดภัย Dynamics 365 Commerce ใช้ขั้นตอนเหล่านี้เพื่อดำเนินการกับนโยบายเพื่อโต้ตอบกับผู้เช่าของ Azure AD B2C เมื่อผู้ใช้โต้ตอบกับนโยบายเหล่านี้ จะมีการเปลี่ยนเส้นทางไปยังผู้เช่าของ Azure AD B2C เพื่อทำการดำเนินการ

Azure AD B2C มีชนิดขั้นตอนของผู้ใช้พื้นฐานสามชนิดดังนี้:
- ลงชื่อสมัครใช้และลงชื่อเข้าใช้
- การแก้ไขโพรไฟล์
- รีเซ็ตรหัสผ่านแล้ว

คุณสามารถเลือกที่จะใช้ขั้นตอนของผู้ใช้เริ่มต้นที่ระบุโดย Azure AD ซึ่งจะแสดงหน้าที่โฮสต์โดย AAD B2C อีกทางหนึ่งคือ คุณสามารถสร้างหน้า HTML เพื่อควบคุมรูปลักษณ์และความรู้สึกของประสบการณ์ขั้นตอนของผู้ใช้เหล่านี้ 

เมื่อต้องการกำหนดหน้านโยบายผู้ใช้สำหรับ Dynamics 365 Commerce ให้ดูที่ [ตั้งค่าหน้าแบบกำหนดเองสำหรับล็อกอินของผู้ใช้](custom-pages-user-logins.md) สำหรับข้อมูลเพิ่มเติม ให้ดูที่ [กำหนดค่าอินเทอร์เฟสของประสบการณ์การใช้งานของผู้ใช้ใน Azure Active Directory B2C](https://docs.microsoft.com/azure/active-directory-b2c/tutorial-customize-ui)

### <a name="create-a-sign-up-and-sign-in-user-flow-policy"></a>การสร้างนโยบายขั้นตอนของผู้ใช้ในการลงชื่อสมัครและการลงชื่อเข้าใช้

เมื่อต้องการสร้างนโยบายขั้นตอนของผู้ใช้ในการลงชื่อสมัครและการลงชื่อเข้าใช้ ให้ทำตามขั้นตอนต่อไปนี้

1. ในพอร์ทัล Azure เลือก **ขั้นตอนของผู้ใช้ (นโยบาย)** ในบานหน้าต่างนำทางด้านซ้าย
1. ในหน้า **Azure AD B2C – ขั้นตอนของผู้ใช้ (นโยบาย)** เลือก **ขั้นตอนของผู้ใช้ใหม่**
1. บนแท็บ **แนะนำ** ให้เลือก **ลงชื่อสมัครใช้และลงชื่อเข้าใช้**
1. ภายใต้ **ชื่อ** ให้ป้อนชื่อนโยบาย ชื่อนี้จะแสดงขึ้นหลังจากที่มีคำนำหน้าที่พอร์ทัลกำหนด (ตัวอย่างเช่น "B2C_1_")
1. ภายใต้ **ผู้ให้บริการข้อมูลเฉพาะตัว** เลือกกล่องกาเครื่องหมายที่เหมาะสม
1. ภายใต้ **การตรวจสอบความถูกต้องของ Multifactor** เลือกตัวเลือกที่เหมาะสมสำหรับบริษัทของคุณ 
1. ภายใต้ **แอททริบิวต์และการอ้างสิทธิ์ของผู้ใช้** เลือกตัวเลือกเพื่อรวบรวมแอททริบิวต์หรือส่งคืนการอ้างสิทธิ์ตามความเหมาะสม Commerce ต้องมีตัวเลือกเริ่มต้นต่อไปนี้:

    | **รวบรวมแอททริบิวต์** | **การอ้างสิทธิ์การส่งคืนสินค้า** |
    | ---------------------- | ----------------- |
    | ที่อยู่อีเมล          | ที่อยู่อีเมล   |
    | ชื่อที่กำหนด             | ชื่อที่กำหนด        |
    |                        | ตัวให้บริการข้อมูลเฉพาะตัว |
    | นามสกุล                | นามสกุล           |
    |                        | รหัสออบเจ็กต์ของผู้ใช้  |

1. เลือก **สร้าง**

รูปภาพต่อไปนี้เป็นตัวอย่างของการลงชื่อเข้าใช้ของ Azure AD B2C และขั้นตอนของผู้ใช้ในการลงทะเบียนและการลงชื่อเข้าใช้

![การตั้งค่านโยบายในการลงทะเบียนและการลงชื่อเข้าใช้](./media/B2CImage_11.png)

รูปภาพต่อไปนี้แสดงตัวเลือก **รันขั้นตอนของผู้ใช้** ในขั้นตอนของผู้ใช้ในการลงทะเบียนและการลงชื่อเข้าใช้ของ Azure AD B2C

![รันตัวเลือกขั้นตอนของผู้ใช้ในขั้นตอนของนโยบาย](./media/B2CImage_23.png)
   
### <a name="create-a-profile-editing-user-flow-policy"></a>สร้างนโยบายขั้นตอนของผู้ใช้ในการแก้ไขโพรไฟล์

เมื่อต้องการสร้างนโยบายขั้นตอนของผู้ใช้ในการแก้ไขโพรไฟล์ ให้ทำตามขั้นตอนต่อไปนี้

1. ในพอร์ทัล Azure เลือก **ขั้นตอนของผู้ใช้ (นโยบาย)** ในบานหน้าต่างนำทางด้านซ้าย
1. ในหน้า **Azure AD B2C – ขั้นตอนของผู้ใช้ (นโยบาย)** เลือก **ขั้นตอนของผู้ใช้ใหม่**
1. บนแท็บ **แนะนำ** ให้เลือก **การแก้ไขโพรไฟล์**
1. ภายใต้ **ชื่อ** ให้ป้อนขั้นตอนของผู้ใช้ในการแก้ไขโพรไฟล์ ชื่อนี้จะแสดงขึ้นหลังจากที่มีคำนำหน้าที่พอร์ทัลกำหนด (ตัวอย่างเช่น "B2C_1_")
1. ภายใต้ **ตัวให้บริการข้อมูลเฉพาะตัว** ให้เลือก **ลงชื่อเข้าใช้บัญชีท้องถิ่น**
1. ภายใต้ **แอททริบิวต์ของผู้ใช้** เลือกกล่องกาเครื่องหมายใดๆ ต่อไปนี้:
    - **ที่อยู่อีเมล** (**การอ้างสิทธิ์การส่งคืนสินค้า** เท่านั้น)
    - **ชื่อที่กำหนด** (**รวบรวมแอททริบิวต์** และ **การอ้างสิทธิ์การส่งคืนสินค้า**)
    - **ตัวให้บริการข้อมูลเฉพาะตัว** (**การอ้างสิทธิ์การส่งคืนสินค้า** เท่านั้น)
    - **นามสกุล** (**รวบรวมแอททริบิวต์** และ **การอ้างสิทธิ์การส่งคืนสินค้า**)
    - **รหัสออบเจ็กต์ของผู้ใช้** (**การอ้างสิทธิ์การส่งคืนสินค้า** เท่านั้น)
1. เลือก **สร้าง**

รูปภาพต่อไปนี้แสดงตัวอย่างของขั้นตอนของผู้ใช้ในการแก้ไขโพรไฟล์ของ Azure AD B2C

![สร้างนโยบายของผู้ใช้ในการแก้ไขโพรไฟล์](./media/B2CImage_12.png)

### <a name="create-a-password-reset-user-flow-policy"></a>สร้างนโยบายขั้นตอนของผู้ใช้ในการรีเซ็ตรหัสผ่าน

เมื่อต้องการสร้างนโยบายขั้นตอนของผู้ใช้ในการรีเซ็ตรหัสผ่าน ให้ทำตามขั้นตอนต่อไปนี้

1. ในพอร์ทัล Azure เลือก **ขั้นตอนของผู้ใช้ (นโยบาย)** ในบานหน้าต่างนำทางด้านซ้าย
1. ในหน้า **Azure AD B2C – ขั้นตอนของผู้ใช้ (นโยบาย)** เลือก **ขั้นตอนของผู้ใช้ใหม่**
1. บนแท็บ **แนะนำ** ให้เลือก **การรีเซ็ตรหัสผ่าน**
1. ภายใต้ **ชื่อ** ให้ป้อนชื่อสำหรับขั้นตอนของผู้ใช้ในการรีเซ็ตรหัสผ่าน
1. ภายใต้ **ตัวให้บริการข้อมูลเฉพาะ** เลือก **รีเซ็ตรหัสผ่านโดยใช้ที่อยู่อีเมล**
1. เลือก **สร้าง**
1. ภายใต้ **การเรียกร้องสิทธิ์ในแอปพลิเคชัน** เลือกกล่องกาเครื่องหมายต่อไปนี้:
    - **ที่อยู่อีเมล**
    - **ชื่อที่กำหนด**
    - **นามสกุล**
    - **รหัสออบเจ็กต์ของผู้ใช้**
1. เลือก **สร้าง**

รูปภาพต่อไปนี้แสดงตำแหน่งที่จะตั้งค่า **รีเซ็ตรหัสผ่านโดยใช้ที่อยู่อีเมล** ในขั้นตอนของผู้ใช้ในการรีเซ็ตรหัสผ่านของ Azure AD B2C

![ตั้งค่า "รีเซ็ตรหัสผ่านโดยใช้ที่อยู่อีเมล" ในนโยบายการรีเซ็ตรหัสผ่าน](./media/B2CImage_13.png)

## <a name="add-social-identity-providers-optional"></a>เพิ่มผู้ให้บริการข้อมูลประจำตัวทางสังคม (เลือกกำหนดได้)

ผู้ให้บริการข้อมูลประจำตัวทางสังคมอนุญาตให้ผู้ใช้สามารถใช้บัญชีทางสังคมของตนเพื่อตรวจสอบความถูกต้องได้ ไม่จำเป็นต้องระบุการเพิ่มการรับรองความถูกต้องของผู้ให้บริการข้อมูลประจำตัวทางสังคมใน Dynamics 365 Commerce 

ถ้าไม่มีการเพิ่มการตรวจสอบความถูกต้องของผู้ให้บริการข้อมูลประจำตัวทางสังคม โพรไฟล์ของ Azure AD B2C เริ่มต้นจะเป็นโพรไฟล์หลักสำหรับฐานผู้ใช้ของคุณ ผู้ใช้จะเลือกชื่อผู้ใช้ของตนเอง (ที่อยู่อีเมลที่ต้องการของพวกเขา) และตั้งค่ารหัสผ่าน Azure AD B2C จะตรวจสอบความถูกต้องผู้ใช้โดยตรง 

ถ้ามีการเพิ่มการตรวจสอบความถูกต้องของผู้ให้บริการข้อมูลประจำตัวทางสังคม และผู้ใช้เลือกหนึ่งในผู้ให้บริการข้อมูลประจำตัวทางสังคมที่เสนอ จะยังคงมีการสร้างเอนทิตีในผู้เช่าของ Azure AD B2C Azure AD B2C จะตรวจสอบความถูกต้องของข้อมูลประจำตัวของผู้ใช้ที่มีผู้ให้บริการข้อมูลประจำตัวทางสังคม

> [!NOTE]
> การลงชื่อเข้าใช้ของตัวให้บริการข้อมูลเฉพาะตัวจะสร้างเรกคอร์ดในผู้เช่า B2C แต่อยู่ในรูปแบบที่แตกต่างจากบัญชีภายในเครื่อง เนื่องจากจะเรียกข้อมูลอ้างอิงของผู้ให้บริการข้อมูลประจำตัวทางสังคมภายนอกสำหรับการรับรองความถูกต้อง ผู้ใช้สามารถใช้ที่อยู่อีเมลเดียวกันในผู้ให้บริการข้อมูลประจำตัวทางสังคมต่างๆ ซึ่งหมายความว่าชื่อผู้ใช้อีเมลที่ใช้สำหรับการรับรองความถูกต้องอาจไม่ซ้ำกันกับผู้เช่า Azure AD B2C จะบังคับใช้เฉพาะผู้ใช้ที่มีที่อยู่อีเมลที่ไม่ซ้ำกันบนบัญชี B2C เฉพาะที่เท่านั้น

ก่อนที่คุณจะสามารถเพิ่มผู้ให้บริการข้อมูลประจำตัวของสังคมสำหรับการรับรองความถูกต้องได้ คุณต้องไปที่เว็บไซต์ของผู้ให้บริการข้อมูลประจำตัวและตั้งค่าแอปพลิเคชันตัวให้บริการข้อมูลเฉพาะตัวตามคำสั่งในเอกสารของ Azure AD B2C มีรายการของลิงค์ไปยังเอกสารด้านล่าง

- [Amazon](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-setup-amzn-app)
- [Azure AD (ผู้เช่าเดียว)](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-setup-oidc-azure-active-directory)
- [บัญชี Microsoft](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-setup-msa-app)
- [Facebook](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-setup-fb-app)
- [GitHub](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-setup-github-app)
- [Google](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-setup-goog-app)
- [LinkedIn](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-setup-li-app)
- [OpenID Connect](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-setup-oidc-idp)
- [Twitter](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-setup-twitter-app)

### <a name="add-and-set-up-a-social-identity-provider"></a>เพิ่มและตั้งค่าผู้ให้บริการข้อมูลประจำตัวทางสังคม

เมื่อต้องการเพิ่มและตั้งค่าผู้ให้บริการข้อมูลประจำตัวทางสังคม ให้ทำตามขั้นตอนต่อไปนี้  

1. ในพอร์ทัล Azure ให้นำทางไปยัง **ผู้ให้บริการข้อมูลประจำตัว**
1. เลือก **เพิ่ม** หน้าจอ **เพิ่มผู้ให้บริการข้อมูลประจำตัว** จะปรากฏขึ้น
1. ภายใต้ **ชื่อ** ให้ป้อนชื่อที่จะแสดงให้กับผู้ใช้บนหน้าจอลงชื่อเข้าใช้ของคุณ
1. ภายใต้ **ชนิดผู้ให้บริการข้อมูลประจำตัว** เลือกผู้ให้บริการข้อมูลประจำตัวจากรายการ
1. เลือก **ตกลง**
1. เลือก **ตั้งค่าผู้ให้บริการข้อมูลประจำตัวนี้** เพื่อเข้าถึงหน้าจอ **ตั้งค่าผู้ให้บริการข้อมูลประจำตัวทางสังคม**
1. ภายใต้ **รหัสไคลเอนต์** ให้ป้อนรหัสไคลเอนต์ที่ได้รับมาจากการตั้งค่าแอปพลิเคชันของผู้ให้บริการข้อมูลประจำตัว
1. ภายใต้ **ข้อมูลลับไคลเอนต์** ให้ป้อนข้อมูลลับไคลเอนต์ที่ได้รับมาจากการตั้งค่าแอปพลิเคชันของผู้ให้บริการข้อมูลประจำตัว
1. แนบขั้นตอนของผู้ใช้สำหรับนโยบายการลงชื่อเข้าใช้และการลงชื่อสมัครใช้:
1. ไปที่ **Azure AD B2C – ขั้นตอนผู้ใช้ (นโยบาย) \> {นโยบายการลงชื่อเข้าใช้และการลงชื่อสมัครใช้ของคุณ} \> ผู้ให้บริการข้อมูลประจำตัว**
1. เมื่อต้องการแนบนโยบายขั้นตอนการลงชื่อเข้าใช้/การลงชื่อสมัครใช้ ให้เลือกผู้ให้บริการข้อมูลประจำตัวแต่ละรายการที่คุณตั้งค่าไว้สำหรับบัญชีของคุณ เมื่อต้องการทดสอบรายการเหล่านี้ ให้เลือก **รันขั้นตอนของผู้ใช้** สำหรับผู้ให้บริการข้อมูลประจำตัวแต่ละรายการ แท็บใหม่จะแสดงหน้าการลงชื่อเข้าใช้ซึ่งแสดงกล่องการเลือกผู้ให้บริการข้อมูลประจำตัวใหม่

รูปภาพต่อไปนี้แสดงตัวอย่างของ **เพิ่มผู้ให้บริการข้อมูลประจำตัว** และหน้าจอ **ตั้งค่าผู้ให้บริการข้อมูลประจำตัวทางสังคม** ใน Azure AD B2C

![การเพิ่มผู้ให้บริการข้อมูลประจำตัวทางสังคมไปยังแอพลิเคชันของคุณ](./media/B2CImage_14.png)

รูปภาพต่อไปนี้แสดงตัวอย่างของวิธีการเลือกผู้ให้บริการข้อมูลประจำตัวในหน้า **ผู้ให้บริการข้อมูลประจำตัว** ของ Azure AD B2C

![เลือกผู้ให้บริการข้อมูลประจำตัวทางสังคมแต่ละรายการเพื่อเปิดใช้งานสำหรับนโยบายของคุณ](./media/B2CImage_16.png)

รูปภาพต่อไปนี้แสดงตัวอย่างของหน้าจอการลงชื่อเข้าใช้เริ่มต้นที่มีปุ่มการลงชื่อเข้าใช้ของผู้ให้บริการข้อมูลประจำตัวทางสังคมที่แสดงอยู่

![ตัวอย่างหน้าจอล็อกอินเริ่มต้นที่มีปุ่มการลงชื่อเข้าใช้ของผู้ให้บริการข้อมูลประจำตัวทางสังคมที่แสดงอยู่](./media/B2CImage_17.png)

## <a name="update-commerce-headquarters-with-the-new-azure-ad-b2c-information"></a>อัพเดตศูนย์ควบคุม Commerce ด้วยข้อมูล Azure AD B2C ใหม่

เมื่อมีขั้นตอนการเตรียมใช้งาน Azure AD B2C ด้านบนเสร็จเรียบร้อยแล้ว แอพลิเคชัน Azure AD B2C ต้องมีการลงทะเบียนในสภาพแวดล้อม Dynamics 365 Commerce ของคุณ

เมื่อต้องการปรับปรุงศูนย์ควบคุมด้วยข้อมูล Azure AD B2C ใหม่ ให้ทำตามขั้นตอนต่อไปนี้

1. ใน Commerce ให้ไปที่ **พารามิเตอร์ที่ใช้ร่วมกันของ Commerce** และเลือก **ผู้ให้บริการข้อมูลเฉพาะตัว** ในเมนูด้านซ้าย
1. ภายใต้ **ผู้ให้บริการข้อมูลเฉพาะตัว** ให้ทำตามขั้นตอนต่อไปนี้:
    1. ในกล่อง **ผู้ออก** ให้ป้อน URL ผู้ออกของผู้ให้บริการข้อมูลเฉพาะตัว ในการค้นหา URL ของผู้ออกของคุณ โปรดดูที่ [รับ URL ของผู้ออก](#obtain-issuer-url) ด้านล่าง
    1. ในกล่อง **ชื่อ** ให้ป้อนชื่อสำหรับเรกคอร์ดผู้ออกของคุณ
    1. ในกล่อง **ชนิด** ให้ป้อน **Azure AD B2C (id_token)**
1. ภายใต้ **บริษัทที่เกี่ยวข้อง** ที่มีรายการของผู้ให้บริการข้อมูลเฉพาะตัวของ B2C ที่เลือก ให้ทำตามขั้นตอนต่อไปนี้:
    1. ในกล่อง **รหัสไคลแอนต์** ให้ป้อนรหัสแอพลิเคชัน B2C ของคุณ คุณสามารถค้นหาข้อมูลนี้ได้ในกล่อง **รหัสแอพลิเคชัน** ของหน้าคุณสมบัติของแอพลิเคชัน B2C ของคุณ
    1. ในกล่อง **ชนิด** ให้ป้อน **สาธารณะ**
    1. ในกล่อง **ชนิดผู้ใช้** ให้ป้อน **ลูกค้า**
1. บนบานหน้าต่างการดำเนินการ เลือก **บันทึก**
1. ในกล่องค้นหา Commerce ให้ค้นหา **กำหนดการการกระจาย**
1. ในเมนูนำทางด้านซ้ายของหน้า **กำหนดการการกระจาย** ให้เลือกงาน **1110 การตั้งค่าคอนฟิกส่วนกลาง**
1. บนบานหน้าต่างการดำเนินการ เลือก **รันตอนนี้**

### <a name="obtain-issuer-url"></a>รับ URL ของผู้ออก

เมื่อต้องการได้รับ URL ผู้ออกของผู้ให้บริการข้อมูลเฉพาะตัวของคุณ ให้ทำตามขั้นตอนต่อไปนี้

1. สร้าง URL ที่อยู่ข้อมูลเมตาในรูปแบบต่อไปนี้โดยใช้ผู้เช่า B2C และนโยบายของคุณ: ``https://<B2CTENANTNAME>.b2clogin.com/<B2CTENANTNAME>.onmicrosoft.com/v2.0/.well-known/openid-configuration?p=<B2CSIGN-INPOLICY>``
    - ตัวอย่าง: ``https://d365plc.b2clogin.com/d365plc.onmicrosoft.com/v2.0/.well-known/openid-configuration?p=B2C_1_signinup``
1. ป้อน URL ที่อยู่ของข้อมูลเมตาลงในแถบที่อยู่ของเบราว์เซอร์
1. ในข้อมูลเมตา คัดลอก URL ผู้ออกของผู้ให้บริการข้อมูลประจำตัว (ค่าสำหรับ **"ผู้ออก"**)
    - ตัวอย่าง: ``https://login.fabrikam.com/073405c3-0113-4f43-b5e2-df01266e24ae/v2.0/``

## <a name="configure-your-b2c-tenant-in-commerce-site-builder"></a>ตั้งค่าคอนฟิกผู้เช่า B2C ของคุณในโปรแกรมสร้างไซต์ Commerce

เมื่อการตั้งค่าของผู้เช่า Azure AD B2C ของคุณเสร็จสมบูรณ์แล้ว คุณต้องตั้งค่าคอนฟิกผู้เช่า B2c ในโปรแกรมสร้างไซต์ Commerce ขั้นตอนการตั้งค่าคอนฟิกรวมถึงการรวบรวมข้อมูลแอพลิเคชัน B2C จากพอร์ทัล Azure การป้อนข้อมูลแอพลิเคชัน B2C ลงในโปรแกรมสร้างไซต์ และจากนั้น เชื่อมโยงแอพลิเคชัน B2C กับไซต์และช่องทางของคุณ

### <a name="collect-the-required-application-information"></a>รวบรวมข้อมูลแอพลิเคชันที่จำเป็น

เมื่อต้องการรวบรวมข้อมูลแอพลิเคชันที่จำเป็น ให้ทำตามขั้นตอนต่อไปนี้

1. ในพอร์ทัล Azure ให้ไปที่ **หน้าหลัก \> Azure AD B2C - แอพลิเคชัน**
1. เลือกแอพลิเคชันของคุณ และจากนั้น ในบานหน้าต่างนำทางด้านซ้าย เลือก **คุณสมบัติ** เพื่อดูรายละเอียดแอพลิเคชัน
1. จากกล่อง **รหัสแอพลิเคชัน** ให้รวบรวมรหัสแอพลิเคชันของแอพลิเคชัน B2C ที่สร้างขึ้นในผู้เช่า B2C ของคุณ นี่จะถูกป้อนเป็น **GUID ของไคลเอนต์** ในโปรแกรมสร้างไซต์ในภายหลัง
1. ภายใต้ **ตอบกลับ URL** ให้รวบรวมการตอบกลับ URL
1. ไปที่ **หน้าหลัก \> Azure AD B2C – ขั้นตอนผู้ใช้ (นโยบาย)** แล้วรวบรวมชื่อของนโยบายขั้นตอนของผู้ใช้แต่ละรายการ

รูปภาพต่อไปนี้แสดงตัวอย่างของหน้า **Azure AD B2C - แอพลิเคชัน**

![นำทางไปยังแอพลิเคชัน B2C ภายในผู้เช่าของคุณ](./media/B2CImage_19.png)

รูปภาพต่อไปนี้แสดงตัวอย่างของหน้า **คุณสมบัติ** ของแอพลิเคชันใน Azure AD B2C 

![คัดลอกรหัสของแอพลิเคชันจากคุณสมบัติของแอพลิเคชัน B2C](./media/B2CImage_21.png)

รูปภาพต่อไปนี้แสดงตัวอย่างของนโยบายขั้นตอนของผู้ใช้ในหน้า **Azure AD B2C – ขั้นตอนผู้ใช้ (นโยบาย)**

![รวบรวมชื่อของขั้นตอนของนโยบาย B2C แต่ละรายการ](./media/B2CImage_22.png)

### <a name="enter-your-aad-b2c-tenant-application-information-into-commerce"></a>ป้อนข้อมูลแอพลิเคชันของผู้เช่า AAD B2C ของคุณลงใน Commerce

คุณต้องป้อนรายละเอียดของผู้เช่า Azure AD ผู้เช่า ลงในโปรแกรมสร้างไซต์ Commerce ก่อนที่จะเชื่อมโยงผู้เช่า B2C กับไซต์ของคุณ

เมื่อต้องการเพิ่มข้อมูลแอพลิเคชันของผู้เช่า AAD B2C ลงใน Commerce ให้ทำตามขั้นตอนเหล่านี้

1. ลงชื่อเข้าใช้ในฐานะผู้ดูแลระบบในโปรแกรมสร้างไซต์ Commerce สำหรับสภาพแวดล้อมของคุณ
1. ในบานหน้าต่างนำทางด้านซ้าย ให้เลือก **การตั้งค่าผู้เช่า** เพื่อขยาย
1. ภายใต้ **การตั้งค่าผู้เช่า** ให้เลือก **การตั้งค่า B2C** 
1. ในหน้าต่างหลักถัดจาก **แอพลิเคชัน B2C** เลือก **จัดการ** (ถ้าผู้เช่าของคุณปรากฎในรายการแอพลิเคชัน B2C แสดงว่ามีการเพิ่มโดยผู้ดูแลระบบแล้ว ตรวจสอบว่าสินค้าในขั้นตอนที่ 6 ข้างล่างนี้ตรงกับแอพลิเคชัน B2C ของคุณ)
1. เลือก **เพิ่มแอพลิเคชัน B2C**
1. ป้อนรายการที่จำเป็นต่อไปนี้ในฟอร์มที่แสดง โดยใช้ค่าจากผู้เช่า B2C และแอพลิเคชันของคุณ ฟิลด์ที่ไม่จำเป็น (ฟิลด์ที่ไม่มีเครื่องหมายดอกจัน) อาจถูกปล่อยว่างไว้

    - **ชื่อแอพลิเคชัน**: ชื่อสำหรับแอพลิเคชัน B2C ของคุณ ตัวอย่างเช่น "Fabrikam B2C"
    - **ชื่อผู้เช่า**: ชื่อของผู้เช่า B2C ของคุณ (ตัวอย่างเช่น ใช้ "fabrikam" ถ้าโดเมนปรากฏเป็น "fabrikam.onmicrosoft.com" สำหรับผู้เช่า B2C) 
    - **รหัสนโยบายของการลืมรหัสผ่าน**: รหัสนโยบายของขั้นตอนผู้ใช้ในการลืมรหัสผ่าน ตัวอย่างเช่น "B2C_1_PasswordReset"
    - **รหัสนโยบายของการลงทะเบียนและการลงชื่อเข้าใช้** รหัสนโยบายของขั้นตอนผู้ใช้ในการลงทะเบียนและการลงชื่อเข้าใช้ ตัวอย่างเช่น "B2C_1_signup_signin"
    - **GUID ของไคลเอนต์**: รหัสแอพลิเคชัน B2C ตัวอย่างเช่น "22290eb2-c52e-42e9-8b35-a2b0a3bcb9e6"
    - **รหัสนโยบายของการแก้ไขโพรไฟล์**: รหัสนโยบายของขั้นตอนของผู้ใช้ในการแก้ไขโพรไฟล์ ตัวอย่างเช่น "B2C_1A_ProfileEdit"

1. เลือก **ตกลง** ขณะนี้คุณควรดูชื่อของแอพลิเคชัน B2C ของคุณที่ปรากฏในรายการ
1. เลือก **บันทึก** เพื่อบันทึกการเปลี่ยนแปลงของคุณ

### <a name="associate-the-b2c-application-to-your-site-and-channel"></a>เชื่อมโยงแอพลิเคชัน B2C กับไซต์และช่องทางของคุณ

> [!WARNING]
> ถ้าไซต์ของคุณเชื่อมโยงกับแอพลิเคชัน B2C อยู่แล้ว การเปลี่ยนไปยังแอพลิเคชัน B2C อื่นจะลบการอ้างอิงปัจจุบันที่สร้างขึ้นสำหรับผู้ใช้ที่ลงชื่อสมัครในสภาพแวดล้อมนี้แล้ว ถ้ามีการเปลี่ยนแปลง ข้อมูลประจำตัวใดๆ ที่เชื่อมโยงกับแอพลิเคชัน B2C ที่กำหนดไว้ในปัจจุบันจะไม่พร้อมใช้งานสำหรับผู้ใช้ 
> 
> ปรับปรุงเฉพาะแอพลิเคชัน B2C ถ้าคุณกำลังตั้งค่าแอพลิเคชัน B2C ของช่องทางเป็นครั้งแรก หรือถ้าคุณต้องการให้ผู้ใช้ลงชื่อสมัครใหม่โดยใช้ข้อมูลประจำตัวใหม่ไปยังช่องทางนี้กับแอพลิเคชัน B2C ใหม่ ใช้ความระมัดระวังเมื่อเชื่อมโยงช่องทางไปยังแอพลิเคชัน B2C และมีการระบุชื่อแอพลิเคชันอย่างชัดแจ้ง ถ้าช่องทางไม่เชื่อมโยงกับแอพลิเคชัน B2C ในขั้นตอนด้านล่าง ผู้ใช้ที่ลงชื่อเข้าใช้ในช่องทางดังกล่าวสำหรับไซต์ของคุณจะถูกป้อนลงในแอพลิเคชัน B2C ที่แสดงเป็น **ค่าเริ่มต้น** ในรายการ **การตั้งค่าผู้เช่า \> การตั้งค่า B2C** ของแอพลิเคชัน

เพื่อเชื่อมโยงแอพลิเคชัน B2C กับไซต์และช่องทางของคุณ ให้ทำตามขั้นตอนเหล่านี้

1. นำทางไปยังไซต์ของคุณในโปรแกรมสร้างไซต์ Commerce
1. ในบานหน้าต่างนำทางด้านซ้าย ให้เลือก **การตั้งค่าไซต์** เพื่อขยาย
1. ด้านล่าง **การตั้งค่าไซต์** เลือก **ช่องทาง**
1. ในหน้าต่างหลักภายใต้ **ช่องทาง** เลือกช่องทางของคุณ
1. ในบานหน้าต่างคุณสมบัติช่องทางทางด้านขวา ให้เลือกชื่อแอพลิเคชัน B2C ของคุณจากเมนูแบบหล่นลงของ **เลือกแอพลิเคชัน B2C**
1. เลือก **ปิด** แล้วเลือก **บันทึกและเผยแพร่**

## <a name="additional-b2c-information"></a>ข้อมูล B2C เพิ่มเติม

### <a name="customer-migration"></a>การโยกย้ายลูกค้า

ถ้าคุณกำลังพิจารณาการย้ายเรกคอร์ดลูกค้าจากแพลตฟอร์มของผู้ให้บริการข้อมูลประจำตัวก่อนหน้า โปรดทำงานกับทีม Dynamics 365 Commerce เพื่อตรวจสอบความต้องการการโยกย้ายลูกค้าของคุณ

สำหรับเอกสาร Azure AD B2C เพิ่มเติมสำหรับการโยกย้ายลูกค้า โปรดดู [โยกย้ายผู้ใช้ไปยัง Azure Active Directory B2C](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-user-migration)การ B2C

### <a name="custom-policies"></a>นโยบายที่กำหนดเอง

สำหรับข้อมูลเพิ่มเติมเกี่ยวกับการปรับแต่งการโต้ตอบ Azure AD B2C และขั้นตอนนโยบายนอกเหนือจากที่มีนำเสนอโดยนโยบายมาตรฐานของ B2C โปรดดู [นโยบายที่กำหนดเองใน Azure Active Directory B2C](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-overview-custom) 

### <a name="secondary-admin"></a>ผู้ดูแลระบบรอง

คุณสามารถเพิ่มบัญชีผู้ดูแลระบบรองหรือไม่ก็ได้ในส่วน **ผู้ใช้** ของผู้เช่า B2C ของคุณ นี่อาจเป็นบัญชีโดยตรงหรือบัญชีทั่วไป ถ้าคุณต้องการแบ่งปันบัญชีระหว่างทรัพยากรทีมร่วมกัน ยังสามารถสร้างบัญชีทั่วไปได้ด้วย เนื่องจากความสำคัญของข้อมูลที่จัดเก็บไว้ใน Azure AD B2C ควรมีการตรวจสอบความถูกต้องของบัญชีทั่วไปอย่างใกล้ชิดตามแนวทางปฏิบัติด้านความปลอดภัยของบริษัทของคุณ

## <a name="additional-resources"></a>ทรัพยากรเพิ่มเติม

[ตั้งค่าคอนฟิกชื่อโดเมนของคุณ](configure-your-domain-name.md)

[ปรับใช้ผู้เช่าอีคอมเมิร์ซใหม่](deploy-ecommerce-site.md)

[สร้างไซต์อีคอมเมิร์ซ](create-ecommerce-site.md)

[เชื่อมโยงไซต์ Dynamics 365 Commerce กับช่องทางออนไลน์](associate-site-online-store.md)

[จัดการไฟล์ robots.txt](manage-robots-txt-files.md)

[การอัปโหลดการเปลี่ยนเส้นทาง URL จำนวนมาก](upload-bulk-redirects.md)เชื่อมโยงไซต์ Dynamics 365 Commerce กับช่องทางออนไลน์

[ตั้งค่าหน้าแบบกำหนดเองสำหรับการล็อกอินของผู้ใช้](custom-pages-user-logins.md)

[ตั้งค่าคอนฟิกผู้เช่า B2C หลายรายในสภาพแวดล้อม Commerce](configure-multi-B2C-tenants.md)

[เพิ่มการสนับสนุนสำหรับเครือข่ายการจัดส่งเนื้อหา (CDN)](add-cdn-support.md)

[เปิดใช้งานการตรวจหาร้านค้าตามตำแหน่งที่ตั้ง](enable-store-detection.md)


[!INCLUDE[footer-include](../includes/footer-banner.md)]