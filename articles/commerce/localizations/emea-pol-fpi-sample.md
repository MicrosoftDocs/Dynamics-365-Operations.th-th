---
title: ตัวอย่างการรวมเครื่องพิมพ์ทางการเงินสำหรับโปแลนด์
description: บทความนี้อธิบายภาพรวมของตัวอย่างการรวมทางบัญชีสำหรับโปแลนด์ใน Microsoft Dynamics 365 Commerce
author: EvgenyPopovMBS
ms.date: 10/04/2022
ms.topic: article
audience: Application User, Developer, IT Pro
ms.reviewer: v-chgriffin
ms.search.region: Global
ms.author: josaw
ms.search.validFrom: 2019-02-01.
ms.openlocfilehash: 2f27e5fdcd2b26a0a1651f21436cb4caad501cf8
ms.sourcegitcommit: 2bc6680dc6b12d20532d383a0edb84d180885b62
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 10/06/2022
ms.locfileid: "9631383"
---
# <a name="fiscal-printer-integration-sample-for-poland"></a>ตัวอย่างการรวมเครื่องพิมพ์ทางการเงินสำหรับโปแลนด์

[!include [banner](../includes/banner.md)]

บทความนี้อธิบายภาพรวมของตัวอย่างการรวมทางบัญชีสำหรับโปแลนด์ใน Microsoft Dynamics 365 Commerce

ฟังก์ชัน Dynamics 365 Commerce สำหรับโปแลนด์รวมการรวมตัวอย่างของการขายหน้าร้าน (POS) กับเครื่องพิมพ์ทางการเงิน ตัวอย่างจะขยาย [ฟังก์ชันการรวมทางการเงิน](fiscal-integration-for-retail-channel.md) และสนับสนุนโปรโทคอล POSNET THERMAL HD 2.02 ให้กับเครื่องพิมพ์ทางการเงินจาก [Posnet Polska S.A.](https://www.posnet.com.pl) ตัวอย่างช่วยให้สามารถสื่อสารกับเครื่องพิมพ์ทางการเงินที่เชื่อมต่อผ่านพอร์ต COM โดยใช้ไดรเวอร์ซอฟต์แวร์ดั้งเดิม ซึ่งใช้งานและทดสอบโดยใช้ตัวเลียนแบบแอปซอฟต์แวร์ที่ Posnet จัดเตรียมไว้ให้กับเครื่องพิมพ์ทางการเงิน Posnet Thermal HD FV EJ ตัวอย่างมีให้ในรูปแบบของรหัสต้นฉบับ และเป็นส่วนหนึ่งของชุดการพัฒนาซอฟต์แวร์ (SDK) ของ Commerce

Microsoft ไม่ได้ปล่อยฮาร์ดแวร์ ซอฟต์แวร์ หรือเอกสารใดๆ จาก Posnet หากต้องการทราบข้อมูลเพิ่มเติมเกี่ยวกับวิธีใช้งานเครื่องพิมพ์ทางการเงินและดําเนินการ โปรดติดต่อ [Posnet Polska S.A.](https://www.posnet.com.pl)

## <a name="scenarios"></a>สถานการณ์จำลอง

สถานการณ์ต่อไปนี้ครอบคลุมอยู่ในตัวอย่างการรวมเครื่องพิมพ์ทางการเงินสำหรับโปแลนด์:

- สถานการณ์การขาย:

    - พิมพ์ใบเสร็จทางการเงินของการขายเงินสดและการขนส่งและการส่งกลับสินค้า
    - จัดเก็บการตอบสนองจากเครื่องพิมพ์ทางการเงิน และจัดเก็บการตอบสนองนั้นในฐานข้อมูลช่องทาง
    - ภาษี:

        - แมปไปยังรหัสภาษีของเครื่องพิมพ์ทางการเงิน (แผนก)
        - โอนย้ายข้อมูลภาษีที่แมปไปยังเครื่องพิมพ์ทางการเงิน

    - การชำระเงิน:

        - แมปกับวิธีการจ่ายเงินของเครื่องพิมพ์ทางการเงิน
        - พิมพ์การชำระบนใบเสร็จทางการเงิน
        - พิมพ์ข้อมูลการเปลี่ยนแปลง

    - พิมพ์ส่วนลดต่อรายการสินค้า
    - บัตรของขวัญ:

        - แยกรายการบัตรของขวัญที่ออก/คิดค่าธรรมเนียมใหม่ออกจากใบเสร็จทางการเงินสำหรับการขาย
        - พิมพ์การชำระเงินที่ใช้บัตรของขวัญเป็นวิธีการชำระเงินแบบปกติ

    - พิมพ์ใบเสร็จทางการเงินสำหรับการดําเนินงานตามใบสั่งของลูกค้า:

        - ใบเสร็จทางการเงินไม่มีการพิมพ์สำหรับการมัดจำเงินตามใบสั่งของลูกค้า
        - พิมพ์ใบเสร็จทางการเงินสำหรับบรรทัดดำเนินการของใบสั่งของลูกค้าไฮบริด
        - พิมพ์ใบเสร็จทางการเงินสำหรับการดําเนินงานเบิกสินค้าสำหรับใบสั่งของลูกค้า
        - พิมพ์ใบเสร็จทางการเงินสำหรับคำสั่งซื้อที่คืนสินค้า

    - พิมพ์ [ข้อมูลลูกค้า](emea-pol-customer-information.md) ที่ระบุไว้เกี่ยวกับธุรกรรมการขายบนใบเสร็จทางการเงิน ตัวอย่างของข้อมูลนี้คือหมายเลข VAT ของลูกค้า

- รายงานสิ้นสุดวัน (รายงาน X ทางการเงินและ Z ทางการเงิน)
- การจัดการข้อผิดพลาด เช่น ตัวเลือกต่อไปนี้:

    - ลองลงทะเบียนทางการเงินอีกครั้งถ้าสามารถลองใหม่ได้ เช่น ถ้าเครื่องพิมพ์ทางการเงินไม่ได้เชื่อมต่อ ไม่พร้อม หรือไม่ตอบสนอง เครื่องพิมพ์ไม่มีกระดาษ หรือมีกระดาษติด
    - เลื่อนการลงทะเบียนทางการเงิน
    - ข้ามการลงทะเบียนทางการเงิน หรือเลือกธุรกรรมเป็นลงทะเบียนแล้ว และรวมรหัสข้อมูลเพื่อรวบรวมข้อมูลเหตุผลของความล้มเหลวและข้อมูลเพิ่มเติม
    - ตรวจสอบความพร้อมใช้งานของเครื่องพิมพ์ทางการเงินก่อนที่จะเปิดธุรกรรมการขายใหม่ หรือสรุปธุรกรรมการขายแล้ว

### <a name="gift-cards"></a>บัตรของขวัญ

ตัวอย่างการรวมเครื่องพิมพ์ทางการเงินจะใช้กฎต่อไปนี้ที่เกี่ยวข้องกับบัตรของขวัญ:

- แยกรายการขายที่เกี่ยวข้องกับ *บัตรของขวัญที่ออก* และการดําเนินงาน *เพิ่มลงในบัตรของขวัญ* จากใบเสร็จทางการเงิน
- อย่าพิมพ์ใบเสร็จทางการเงินถ้าใบเสร็จประกอบด้วยรายการบัตรของขวัญเท่านั้น
- หักยอดเงินรวมของบัตรของขวัญที่ออกหรือคิดค่าธรรมเนียมใหม่ในธุรกรรมจากรายการชำระเงินของใบเสร็จทางการเงิน
- บันทึกการปรับปรุงที่คํานวณได้ของรายการการชำระเงินในฐานข้อมูลช่องทางด้วยการอ้างอิงไปยังธุรกรรมทางการเงินที่สอดคล้องกัน
- การชำระเงินด้วยบัตรของขวัญถือเป็นการชำระเงินปกติ

### <a name="customer-deposits-and-customer-order-deposits"></a>การฝากเงินของลูกค้าและการฝากเงินตามใบสั่งของลูกค้า

ตัวอย่างการรวมเครื่องพิมพ์ทางการเงินจะใช้กฎต่อไปนี้ที่เกี่ยวข้องกับการฝากเงินของลูกค้าและการฝากเงินตามใบสั่งของลูกค้า:

- อย่าพิมพ์ใบเสร็จทางการเงินถ้าธุรกรรมคือการฝากเงินของลูกค้า
- อย่าพิมพ์ใบเสร็จทางการเงินหากธุรกรรมมีเฉพาะการฝากเงินตามใบสั่งของลูกค้าหรือการขอคืนเงินในการฝากเงินตามใบสั่งของลูกค้า
- พิมพ์ยอดเงินของเงินฝากที่ชําระไว้ก่อนหน้านี้ในใบเสร็จทางการเงินของการดําเนินงานเบิกสินค้าตามใบสั่งของลูกค้า
- หักจํานวนเงินในเงินฝากตามใบสั่งของลูกค้าจากรายการการชำระเงินเมื่อสร้างใบสั่งของลูกค้าใหม่
- บันทึกการปรับปรุงที่คํานวณได้ของรายการการชำระเงินในฐานข้อมูลช่องทางด้วยการอ้างอิงไปยังธุรกรรมทางการเงินที่สำหรับใบสั่งของลูกค้าแบบไฮบริด

### <a name="limitations-of-the-sample"></a>ข้อจํากัดของตัวอย่าง

- เครื่องพิมพ์ทางการเงินสนับสนุนเฉพาะสถานการณ์ที่ภาษีขายรวมอยู่ในราคาเท่านั้น ดังนั้น ต้องตั้งค่าตัวเลือก **ราคารวมภาษีขาย** เป็น **ใช่** ให้กับทั้งร้านค้าและลูกค้า
- รายงานรายวัน (X ทางการเงินและ Z ทางการเงิน) จะถูกพิมพ์โดยใช้รูปแบบ *รายงานกะ* แบบฝัง
- การพิมพ์บาร์โค้ดบนใบเสร็จทางการเงินถือเป็นการกำหนดเองที่เป็นไปได้ เนื่องจากคุณลักษณะนี้ไม่ได้รับการสนับสนุนในรูปแบบแบบฝังและสามารถใช้งานได้เฉพาะเมื่อใช้รายงาน **รูปแบบพิเศษ** ที่เลือกได้เท่านั้น
- เครื่องพิมพ์ทางการเงินไม่สนับสนุนธุรกรรมผสม ควรตั้งค่าตัวเลือก **ห้ามไม่ให้มีการตั้งค่าการขายและการส่งคืนสินค้าผสมในใบเสร็จเดียว** เป็น **ใช่** ในโปรไฟล์ฟังก์ชันของ POS

## <a name="set-up-fiscal-integration-for-poland"></a>ตั้งค่าการรวมทางการเงินสำหรับโปแลนด์

ตัวอย่างการรวมเครื่องพิมพ์ทางการเงินของโปแลนด์ยึดตาม [ฟังก์ชันการรวมทางการเงิน](fiscal-integration-for-retail-channel.md) และเป็นส่วนหนึ่งของ Commerce SDK ตัวอย่างอยู่ในโฟลเดอร์ **src\\FiscalIntegration\\Posnet** ของที่เก็บ [โซลูชัน Dynamics 365 Commerce](https://github.com/microsoft/Dynamics365Commerce.Solutions/) [ตัวอย่าง](fiscal-integration-for-retail-channel.md#fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices-and-services) ประกอบด้วยตัวให้บริการเอกสารทางการเงิน ซึ่งเป็นส่วนขยายของ Commerce Runtime (CRT) และตัวเชื่อมต่อทางการเงิน ซึ่งเป็นส่วนขยายของ Commerce Hardware Station สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการใช้ Commerce SDK ให้ดูที่ [ดาวน์โหลดตัวอย่าง Commerce SDK และแพคเกจการอ้างอิงจาก GitHub NuGet](../dev-itpro/retail-sdk/sdk-github.md) และ [ตั้งค่าไปป์ไลน์การสร้างให้กับ SDK การจัดทำแพคเกจแบบอิสระ](../dev-itpro/build-pipeline.md)

> [!NOTE]
> ตัวอย่างการรวมเครื่องพิมพ์ทางการเงินของโปแลนด์มีอยู่ใน Commerce SDK ณ Commerce เวอร์ชัน 10.0.29 ใน Commerce เวอร์ชัน 10.0.28 หรือก่อนหน้านั้น คุณต้องใช้รุ่นก่อนหน้าของ Retail SDK บนเครื่องเสมือนของนักพัฒนา (VM) ใน Microsoft Dynamics Lifecycle Services (LCS) หากต้องการข้อมูลเพิ่มเติม โปรดดูที่ [แนวทางการปรับใช้งานตัวอย่างการรวมเครื่องพิมพ์ทางการเงินของโปแลนด์ (ดั้งเดิม)](emea-pol-fpi-sample-sdk.md)

ปฏิบัติตามขั้นตอนการตั้งค่าการรวมทางการเงินตามที่อธิบายไว้ใน [การตั้งค่าการรวมทางการเงินของช่องทาง Commerce](setting-up-fiscal-integration-for-retail-channel.md)

1. [ตั้งค่ากระบวนการการลงทะเบียนทางการเงิน](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process) นอกจากนี้ ให้จดบันทึกการตั้งค่าต่างๆ ของกระบวนการลงทะเบียนทางการเงินที่ใช้กับ [ตัวอย่างการรวมเครื่องพิมพ์ทางการเงินนี้โดยเฉพาะ](#set-up-the-registration-process)
1. [กำหนดการตั้งค่าการจัดการข้อผิดพลาด](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings)
1. [ตั้งค่ารายงาน X/Z ทางการเงินจาก POS](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos)
1. [เปิดใช้งานการดำเนินการด้วยตนเองของการลงทะเบียนทางการเงินที่ถูกเลื่อน](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-deferred-fiscal-registration)
1. [ตั้งค่าคอนฟิกส่วนประกอบช่องทาง](#configure-channel-components)

### <a name="set-up-the-registration-process"></a>ตั้งค่ากระบวนการลงทะเบียน

เมื่อต้องการเปิดใช้งานกระบวนการการลงทะเบียน ให้ทําตามขั้นตอนต่อไปนี้เพื่อตั้งค่า Commerce headquarters สำหรับข้อมูลเพิ่มเติม ดูที่ [ตั้งค่าการรวมทางการเงินสำหรับช่องทาง Commerce](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process)

1. ดาวน์โหลดไฟล์การตั้งค่าคอนฟิกสำหรับผู้ให้บริการเอกสารทางการเงินและตัวเชื่อมต่อทางการเงิน:

    1. เปิดที่เก็บ [โซลูชัน Dynamics 365 Commerce](https://github.com/microsoft/Dynamics365Commerce.Solutions/)
    1. เลือกรุ่นสาขาที่นำออกใช้ที่ถูกต้องตามรุ่น SDK/แอปพลิเคชันของคุณ
    1. เปิด **src \> FiscalIntegration \> Posnet**
    1. ดาวน์โหลดไฟล์การตั้งค่าคอนฟิกผู้ให้บริการเอกสารทางการเงินที่ **CommerceRuntime \> DocumentProvider.PosnetSample \> Configuration \> DocumentProviderPosnetSample.xml**
    1. ดาวน์โหลดไฟล์การตั้งค่าคอนฟิกตัวเชื่อมต่อทางการเงินที่ **HardwareStation \> ThermalDeviceSample \> Configuration \> ConnectorPosnetThermalFVEJ.xml**

    > [!NOTE]
    > ใน Commerce เวอร์ชัน 10.0.28 หรือก่อนหน้า คุณต้องใช้เวอร์ชันก่อนหน้าของ Retail SDK บน VM สำหรับนักพัฒนาใน LCS ไฟล์การตั้งค่าคอนฟิกของตัวอย่างการรวมทางการเงินนี้อยู่ในโฟลเดอร์ต่อไปนี้ของ Retail SDK บน VM สำหรับนักพัฒนาใน LCS:
    >
    > - **ไฟล์การตั้งค่าคอนฟิกผู้ให้บริการเอกสารทางการเงิน:** RetailSdk\\SampleExtensions\\CommerceRuntime\\Extension.DocumentProvider.PosnetSample\\Configuration\\DocumentProviderPosnetSample.xml
    > - **ไฟล์การตั้งค่าคอนฟิกตัวเชื่อมต่อทางการเงิน:** RetailSdk\\SampleExtensions\\HardwareStation\\Extension.Posnet.ThermalDeviceSample\\Configuration\\ConnectorPosnetThermalFVEJ.xml

1. ไปที่ **Retail และ Commerce \> การตั้งค่าศูนย์ควบคุม \> พารามิเตอร์ \> พารามิเตอร์ที่ใช้ร่วมกันของ Commerce** บนแท็บ **ทั่วไป** ให้ตั้งค่าตัวเลือก **เปิดใช้งานการรวมทางการเงิน** เป็น **ใช่**
1. ไปที่ **การขายปลีกและการค้า \> การตั้งค่าช่องทาง \> การรวมทางการเงิน \> ผู้ให้บริการเอกสารทางการเงิน** และโหลดไฟล์การตั้งค่าคอนฟิกผู้ให้บริการเอกสารทางการเงินที่คุณดาวน์โหลดก่อนหน้านี้
1. ไปที่ **การขายปลีกและการค้า \> การตั้งค่าช่องทาง \> การรวมทางการเงิน \> ตัวเชื่อมต่อทางการเงิน** และโหลดไฟล์การตั้งค่าคอนฟิกตัวเชื่อมต่อทางการเงินที่คุณดาวน์โหลดก่อนหน้านี้
1. ไปที่ **การขายปลีกและการพาณิชย์ \> การตั้งค่าช่องทางการขาย \> การรวมทางการเงิน \> โปรไฟล์ฟังก์ชันของตัวเชื่อมต่อ** สร้างโปรไฟล์ฟังก์ชันของตัวเชื่อมต่อใหม่ เลือกผู้ให้บริการเอกสารและตัวเชื่อมต่อที่คุณโหลดไว้ก่อนหน้านี้ อัปเดต [การตั้งค่าการแมปข้อมูล](#default-data-mapping) ตามที่ต้องการ
1. ไปที่ **การขายปลีกและการพาณิชย์ \> การตั้งค่าช่องทางการขาย \> การรวมทางการเงิน \> โปรไฟล์ทางเทคนิคของตัวเชื่อมต่อ** สร้างโปรไฟล์ทางเทคนิคของตัวเชื่อมต่อใหม่ และเลือกตัวเชื่อมต่อทางการเงินที่คุณโหลดไว้ก่อนหน้านี้ อัปเดต [การตั้งค่าตัวเชื่อมต่อ](#fiscal-connector-settings) ตามที่ต้องการ
6. ไปที่ **การขายปลีกและการพาณิชย์ \> การตั้งค่าช่องทางการขาย \> การรวมทางการเงิน \> กลุ่มตัวเชื่อมต่อทางการเงิน** สร้างกลุ่มตัวเชื่อมต่อทางการเงินใหม่สำหรับโปรไฟล์ฟังก์ชันของตัวเชื่อมต่อที่คุณสร้างไว้ก่อนหน้านี้
7. ไปที่ **การขายปลีกและการพาณิชย์ \> การตั้งค่าช่องทางการขาย \> การรวมทางการเงิน \> กระบวนการลงทะเบียนทางการเงิน** สร้างกระบวนการลงทะเบียนทางการเงินใหม่และขั้นตอนกระบวนการลงทะเบียนทางการเงิน และเลือกกลุ่มตัวเชื่อมต่อทางการเงินที่คุณสร้างก่อนหน้านี้
8. ไปที่ **การขายปลีกและการค้า \> การตั้งค่าช่องทาง \> การตั้งค่า POS \> โพรไฟล์POS \> โพรไฟล์ฟังก์ชัน** เลือกโปรไฟล์ฟังก์ชันที่เชื่อมโยงกับร้านค้าที่ควรมีการเรียกใช้งานกระบวนการลงทะเบียน บน FastTab **กระบวนการลงทะเบียนทางการเงิน** ให้เลือกกระบวนการลงทะเบียนทางการเงินที่คุณสร้างไว้ก่อนหน้านี้
9. ไปที่ **การขายปลีกและการค้า \> การตั้งค่าช่องทาง \> การตั้งค่า POS \> โพรไฟล์POS \> โปรไฟล์ฮาร์ดแวร์** เลือกโปรไฟล์ฮาร์ดแวร์ที่เชื่อมโยงกับสถานีฮาร์ดแวร์ที่เครื่องพิมพ์ทางการเงินจะเชื่อมต่อด้วย บน FastTab **อุปกรณ์ต่อพ่วงทางการเงิน** ให้เลือกโปรไฟล์ทางเทคนิคของตัวเชื่อมต่อที่คุณสร้างก่อนหน้านี้
10. เปิดกำหนดการจัดจำหน่าย (**การขายปลีกและการค้า \> การขายปลีกและการค้าไอที \> กำหนดการจัดจำหน่าย**) และเลือกงาน **1070** และ **1090** เพื่อโอนย้ายข้อมูลไปยังฐานข้อมูลช่องทาง

#### <a name="default-data-mapping"></a>การแมปข้อมูลเริ่มต้น

การแมปข้อมูลเริ่มต้นต่อไปนี้รวมอยู่ในการตั้งค่าคอนฟิกผู้ให้บริการเอกสารทางการเงินที่ให้ไว้โดยเป็นส่วนหนึ่งของตัวอย่างการรวมทางการเงิน:

- **การแมปอัตราภาษีมูลค่าเพิ่ม (VAT)** – การแมปมูลค่าเปอร์เซ็นต์ภาษีที่ตั้งค่าไว้ให้กับรหัสภาษีขายกับอัตรา VAT เฉพาะเครื่องพิมพ์ทางการเงิน ต่อไปนี้เป็นการแมปเริ่มต้น:

    ```
    0 : 23.00 ; 1 : 8.00 ; 2 : 5.00 ; 3 : 0.00
    ```

    ส่วนประกอบแรกในแต่ละคู่แสดงหมายเลขอัตรา VAT ที่ตั้งค่าคอนฟิกในเครื่องพิมพ์ทางการเงิน ส่วนประกอบที่สองจะแสดงถึงอัตรา VAT ที่เกี่ยวข้อง หากต้องการทราบข้อมูลเพิ่มเติมเกี่ยวกับการตั้งค่าคอนฟิกอัตรา VAT ของเครื่องพิมพ์ทางการเงิน โปรดดูที่คู่มือไดรเวอร์ POSNET

- **การแมปชนิดการชำระเงิน** – การแมปวิธีการชำระเงินที่ตั้งค่าคอนฟิกไว้ให้กับร้านค้ากับฟอร์มการชำระเงินที่สนับสนุนโดยเครื่องพิมพ์ทางการเงิน ต่อไปนี้เป็นการแมปเริ่มต้น:

    ```
    0 : 0 ; 1 : 0 ; 2 : 2 ; 3 : 2 ; 4 : 0 ; 5 : 0 ; 6 : 0 ; 7 : 2 ; 8 : 0
    ```

    ส่วนประกอบแรกในแต่ละคู่แสดงวิธีการชำระเงินที่ตั้งค่าไว้ให้กับร้านค้า ส่วนประกอบที่สองจะแสดงถึงฟอร์มการชำระเงินที่ตรงกันซึ่งเครื่องพิมพ์ทางการเงินสนับสนุน หากต้องการทราบข้อมูลเพิ่มเติมเกี่ยวกับฟอร์มการชำระเงินที่เครื่องพิมพ์ทางการเงินรองรับ โปรดดูที่คู่มือไดรเวอร์ POSNET คุณต้องปรับเปลี่ยนการแมปตัวอย่างตามวิธีการชำระเงินที่ตั้งค่าคอนฟิกในแอปพลิเคชันของคุณ

#### <a name="fiscal-connector-settings"></a>การตั้งค่าตัวเชื่อมต่อทางการเงิน

การตั้งค่าต่อไปนี้รวมอยู่ในการตั้งค่าคอนฟิกตัวเชื่อมต่อทางการเงินที่ให้ไว้โดยเป็นส่วนหนึ่งของตัวอย่างการรวมทางการเงิน:

- **สตริงการเชื่อมต่อ** – สตริงที่อธิบายรายละเอียดของการเชื่อมต่อกับอุปกรณ์ในรูปแบบที่พนักงานขับรถสนับสนุน สำหรับข้อมูลเพิ่มเติม ให้ดูที่คู่มือไดรเวอร์ POSNET
- **วันที่และเวลาของการซิงโครไนส์** – ค่าที่ระบุว่าวันที่และเวลาของเครื่องพิมพ์ต้องถูกซิงค์กับสถานีฮาร์ดแวร์ที่เชื่อมต่อหรือไม่
- **การหมดเวลาของอุปกรณ์** – จํานวนเวลาเป็นมิลลิวินาที ซึ่งพนักงานขับรถจะรอการตอบสนองจากอุปกรณ์ สำหรับข้อมูลเพิ่มเติม ให้ดูที่คู่มือไดรเวอร์ POSNET

### <a name="configure-channel-components"></a>ตั้งค่าคอนฟิกส่วนประกอบช่องทาง

> [!NOTE]
> - ตัวอย่างการรวมเครื่องพิมพ์ทางการเงินของโปแลนด์มีอยู่ใน Commerce SDK ณ Commerce เวอร์ชัน 10.0.29 ใน Commerce เวอร์ชัน 10.0.28 หรือก่อนหน้า คุณต้องใช้เวอร์ชันก่อนหน้าของ Retail SDK บน VM สำหรับนักพัฒนาใน LCS หากต้องการข้อมูลเพิ่มเติม โปรดดูที่ [แนวทางการปรับใช้งานตัวอย่างการรวมเครื่องพิมพ์ทางการเงินของโปแลนด์ (ดั้งเดิม)](emea-pol-fpi-sample-sdk.md)
> - ตัวอย่าง Commerce ที่มีการปรับใช้ในสภาพแวดล้อมของคุณ ไม่ได้รับการอัปเดตโดยอัตโนมัติเมื่อคุณใช้การอัปเดตบริการหรือคุณภาพกับส่วนประกอบของ Commerce คุณต้องอัปเดตตัวอย่างที่ต้องใช้ด้วยตนเอง

#### <a name="set-up-the-development-environment"></a>ตั้งค่าสภาพแวดล้อมการพัฒนา

หากต้องการตั้งค่าสภาพแวดล้อมการพัฒนาเพื่อทดสอบและขยายตัวอย่าง ให้ปฏิบัติตามขั้นตอนต่อไปนี้

1. ลอกแบบหรือดาวน์โหลดที่เก็บ [โซลูชัน Dynamics 365 Commerce](https://github.com/microsoft/Dynamics365Commerce.Solutions) เลือกรุ่นสาขาที่นำออกใช้ที่ถูกต้องตามรุ่น SDK/แอปพลิเคชันของคุณ สำหรับข้อมูลเพิ่มเติม โปรดดูที่ [ดาวน์โหลดตัวอย่าง Commerce SDK และแพคเกจอ้างอิงจาก GitHub และ NuGet](../dev-itpro/retail-sdk/sdk-github.md)
1. เปิดโซลูชันการรวมเครื่องพิมพ์ทางการเงินที่ **Dynamics365Commerce.Solutions\\FiscalIntegration\\Posnet\\Posnet.sln** และสร้าง
1. ติดตั้งส่วนขยาย CRT:

    1. ค้นหาตัวติดตั้งส่วนขยาย CRT:

        - **Commerce Scale Unit:** ในโฟลเดอร์ **Posnet\\ScaleUnit\\ScaleUnit.Posnet.Installer\\bin\\Debug\\net461** ให้ค้นหาตัวติดตั้ง **ScaleUnit.Posnet.Installer**
        - **CRT เฉพาะที่บน Modern POS:** ในโฟลเดอร์ **Posnet\\ModernPOS\\ModernPOS.Posnet.Installer\\bin\\Debug\\net461** ให้ค้นหาตัวติดตั้ง **ModernPOS.Posnet.Installer**

    1. เริ่มต้นตัวติดตั้งส่วนขยาย CRT จากบรรทัดใบสั่ง:

        - **Commerce Scale Unit:**

            ```Console
            ScaleUnit.Posnet.Installer.exe install --verbosity 0
            ```

        - **CRT เฉพาะที่บน Modern POS:**

            ```Console
            ModernPOS.Posnet.Installer.exe install --verbosity 0
            ```

1. ติดตั้งส่วนขยายสถานีฮาร์ดแวร์:

    1. ในโฟลเดอร์ **Posnet\\HardwareStation\\HardwareStation.PosnetThermalFVFiscalPrinter.Installer\\bin\\Debug\\net461** ให้ค้นหาตัวติดตั้ง **HardwareStation.PosnetThermalFVFiscalPrinter.Installer**
    1. เริ่มต้นตัวติดตั้งส่วนขยายจากบรรทัดใบสั่ง:

        ```Console
        HardwareStation.PosnetThermalFVFiscalPrinter.Installer.exe install --verbosity 0
        ```

#### <a name="production-environment"></a>สภาพแวดล้อมการทำงานจริง

ปฏิบัติตามขั้นตอนต่างๆ ใน [การตั้งค่าไปป์ไลน์การสร้างตัวอย่างการรวมทางการเงิน](fiscal-integration-sample-build-pipeline.md) เพื่อสร้างและปล่อย Cloud Scale Unit และแพคเกจที่ปรับใช้ได้แบบบริการตนเองในตัวอย่างการรวมทางการเงิน ไฟล์ YAML เทมเพลต **Posnet build-pipeline.yml** สามารถพบได้ในโฟลเดอร์ **Pipeline\\YAML_Files** ของที่เก็บ [Dynamics 365 Commerce Solutions](https://github.com/microsoft/Dynamics365Commerce.Solutions)

## <a name="design-of-extensions"></a>การออกแบบของส่วนขยาย

ตัวอย่างการรวมเครื่องพิมพ์ทางการเงินของโปแลนด์ยึดตาม [ฟังก์ชันการรวมทางการเงิน](fiscal-integration-for-retail-channel.md) และเป็นส่วนหนึ่งของ Commerce SDK ตัวอย่างอยู่ในโฟลเดอร์ **src\\FiscalIntegration\\Posnet** ของที่เก็บ [โซลูชัน Dynamics 365 Commerce](https://github.com/microsoft/Dynamics365Commerce.Solutions/) [ตัวอย่าง](fiscal-integration-for-retail-channel.md#fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices-and-services) ประกอบด้วยตัวให้บริการเอกสารทางการเงิน ซึ่งเป็นส่วนขยายของ CRT และตัวเชื่อมต่อทางการเงิน ซึ่งเป็นส่วนขยายของ Commerce Hardware Station สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการใช้ Commerce SDK ให้ดูที่ [ดาวน์โหลดตัวอย่าง Commerce SDK และแพคเกจการอ้างอิงจาก GitHub NuGet](../dev-itpro/retail-sdk/sdk-github.md) และ [ตั้งค่าไปป์ไลน์การสร้างให้กับ SDK การจัดทำแพคเกจแบบอิสระ](../dev-itpro/build-pipeline.md)

> [!NOTE]
> ตัวอย่างการรวมเครื่องพิมพ์ทางการเงินของโปแลนด์มีอยู่ใน Commerce SDK ณ Commerce เวอร์ชัน 10.0.29 ใน Commerce เวอร์ชัน 10.0.28 หรือก่อนหน้า คุณต้องใช้เวอร์ชันก่อนหน้าของ Retail SDK บน VM สำหรับนักพัฒนาใน LCS หากต้องการข้อมูลเพิ่มเติม โปรดดูที่ [แนวทางการปรับใช้งานตัวอย่างการรวมเครื่องพิมพ์ทางการเงินของโปแลนด์ (ดั้งเดิม)](emea-pol-fpi-sample-sdk.md)

### <a name="commerce-runtime-extension-design"></a>การออกแบบส่วนขยาย Commerce Runtime

วัตถุประสงค์ของส่วนขยายที่เป็นผู้ให้บริการเอกสารทางการเงินคือการสร้างเอกสารเฉพาะเครื่องพิมพ์ และจัดการการตอบสนองจากเครื่องพิมพ์ทางการเงิน ส่วนขยายนี้จะสร้างชุดของคำสั่งเฉพาะเครื่องพิมพ์ในรูปแบบ JavaScript Object Notation (JSON) ที่กําหนดโดยข้อกําหนด POSNET 19-3678

#### <a name="request-handler"></a>ตัวจัดการคำขอ

ตัวจัดการคำขอ **DocumentProviderPosnetProtocol** เป็นจุดป้อนข้อมูลของคำขอในการสร้างเอกสารจากเครื่องพิมพ์ทางการเงิน

ตัวจัดการสืบทอดมาจากอินเทอร์เฟส **INamedRequestHandler** วิธีการ **HandlerName** จะรับผิดชอบการส่งคืนชื่อของตัวจัดการ ชื่อตัวจัดการควรตรงกับชื่อผู้ให้บริการเอกสารตัวเชื่อมต่อที่ระบุใน Commerce headquarters

ตัวเชื่อมต่อสนับสนุนคำขอต่อไปนี้:

- **GetFiscalDocumentDocumentProviderRequest** – คำขอนี้จะมีข้อมูลเกี่ยวกับเอกสารใดที่ควรถูกสร้างขึ้น โดยจะส่งคืนเอกสารเฉพาะเครื่องพิมพ์ที่ควรลงทะเบียนในเครื่องพิมพ์ทางการเงิน
- **GetSupportedRegistrableEventsDocumentProviderRequest** – คำขอนี้จะส่งคืนรายการเหตุการณ์ที่จะสมัครเป็นสมาชิก ปัจจุบัน เหตุการณ์ต่อไปนี้ได้รับการสนับสนุน: การขาย การพิมพ์รายงาน X และการพิมพ์รายงาน Z

#### <a name="configuration"></a>การกำหนดค่า

ไฟล์การตั้งค่าคอนฟิกสำหรับผู้ให้บริการเอกสารทางการเงินอยู่ที่ **src\\FiscalIntegration\\Posnet\\CommerceRuntime\\DocumentProvider.PosnetSample\\Configuration\\DocumentProviderPosnetSample.xml** ในที่เก็บ [โซลูชัน Dynamics 365 Commerce](https://github.com/microsoft/Dynamics365Commerce.Solutions/) วัตถุประสงค์ของไฟล์คือเพื่อเปิดใช้งานการตั้งค่าของผู้ให้บริการเอกสารทางการเงินที่จะตั้งค่าคอนฟิกจาก Commerce headquarters รูปแบบไฟล์จะสอดคล้องกับข้อกําหนดของการตั้งค่าคอนฟิกการรวมทางการเงิน

### <a name="hardware-station-extension-design"></a>การออกแบบส่วนขยายสถานีฮาร์ดแวร์

วัตถุประสงค์ของส่วนขยายที่เป็นตัวเชื่อมต่อทางการเงินคือเพื่อสื่อสารกับเครื่องพิมพ์ทางการเงิน ส่วนขยายนี้จะเรียกฟังก์ชันของไดรเวอร์ POSNET เพื่อส่งคำสั่งที่ส่วนขยาย CRT สร้างขึ้นไปยังเครื่องพิมพ์ทางการเงิน และยังจัดการข้อผิดพลาดของอุปกรณ์ด้วย

#### <a name="request-handler"></a>ตัวจัดการคำขอ

ตัวจัดการคำขอ **FiscalPrinterHandler** คือจุดเข้าใช้งานที่จะจัดการคำขอไปยังอุปกรณ์ต่อพ่วงทางการเงิน

ตัวจัดการสืบทอดมาจากอินเทอร์เฟส **INamedRequestHandler** วิธีการ **HandlerName** จะรับผิดชอบการส่งคืนชื่อของตัวจัดการ ชื่อตัวจัดการควรตรงกับชื่อตัวเชื่อมต่อทางการเงินที่ระบุใน Commerce headquarters

ตัวเชื่อมต่อสนับสนุนคำขอต่อไปนี้:

- **SubmitDocumentFiscalDeviceRequest** – คำขอนี้จะส่งเอกสารไปยังเครื่องพิมพ์และส่งคืนการตอบสนองจากเครื่องพิมพ์ทางการเงิน
- **IsReadyFiscalDeviceRequest** – คำขอนี้ใช้เพื่อตรวจสอบความสมบูรณ์ของอุปกรณ์
- **InitializeFiscalDeviceRequest** – คำขอนี้ใช้สำหรับการเริ่มต้นเครื่องพิมพ์

#### <a name="configuration"></a>การกำหนดค่า

ไฟล์การตั้งค่าคอนฟิกของตัวเชื่อมต่อทางการเงินอยู่ที่ **src\\FiscalIntegration\\Posnet\\HardwareStation\\ThermalDeviceSample\\Configuration\\ConnectorPosnetThermalFVEJ.xml** ในที่เก็บ [โซลูชัน Dynamics 365 Commerce](https://github.com/microsoft/Dynamics365Commerce.Solutions/) วัตถุประสงค์ของไฟล์คือเพื่อเปิดใช้งานการตั้งค่าของตัวเชื่อมต่อทางการเงินที่จะตั้งค่าคอนฟิกจาก Commerce headquarters รูปแบบไฟล์จะสอดคล้องกับข้อกําหนดของการตั้งค่าคอนฟิกการรวมทางการเงิน

[!INCLUDE[footer-include](../../includes/footer-banner.md)]
