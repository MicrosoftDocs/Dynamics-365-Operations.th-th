---
title: โพรไฟล์ใบรับรองที่ผู้ใช้กำหนดสำหรับร้านค้าปลีก
description: หัวข้อนี้แสดงภาพรวมเกี่ยวกับวิธีใช้ใบรับรองในร้านค้าปลีก
author: josaw
ms.date: 10/09/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: RetailFormLayout, RetailParameters
audience: Application User
ms.reviewer: josaw
ms.search.region: Global
ms.search.industry: Retail
ms.author: epopov
ms.search.validFrom: 2020-10-09
ms.dyn365.ops.version: 10.0.15
ms.openlocfilehash: 9cb82a6d6336bb69fe818fb33e04ad621382b383055b24a4e79eee5ddff217ac
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 08/05/2021
ms.locfileid: "6719941"
---
# <a name="user-defined-certificate-profiles-for-retail-stores"></a>โพรไฟล์ใบรับรองที่ผู้ใช้กำหนดสำหรับร้านค้าปลีก

[!include [banner](../includes/banner.md)]


## <a name="overview"></a>ภาพรวม

หัวข้อนี้อธิบายภาพรวมของโพรไฟล์ใบรับรองที่พร้อมใช้งานใน Microsoft Dynamics 365 Commerce ฟังก์ชันนี้ขยายคุณลักษณะ [จัดการความลับสำหรับช่องทางการขายปลีก](../dev-itpro/manage-secrets.md) โดยการเพิ่มการสนับสนุนสำหรับใบรับรองเฉพาะที่

ในขณะที่การขายหน้าร้าน (POS) กำลังรันอยู่ในโหมดออฟไลน์ จะไม่สามารถเข้าถึงใบรับรองที่จัดเก็บอยู่ใน Key Vault ควรใช้ใบรับรองเฉพาะที่แทน ระบบสนับสนุนความสามารถต่อไปนี้:

- การใช้ใบรับรองเฉพาะที่ในสถานการณ์จำลองที่ย้อนกลับ Key Vault
- การใช้ใบรับรองเฉพาะที่โดยไม่มี Key Vault (ตัวอย่างเช่น ในการติดตั้งในสถานที่)
- การอัพเดตในใบรับรองแบบค่อยเป็นค่อยไป มีร้านค้าและเทอร์มินัลบางร้านใช้ใบรับรองรุ่นใหม่ แต่ร้านค้าและเทอร์มินัลอื่นๆ ยังคงใช้รุ่นก่อนหน้านี้

ฟังก์ชันของโพรไฟล์ใบรับรองช่วยให้คุณสามารถระบุใบรับรองเริ่มต้นและตั้งค่าใบสั่งที่ใบรับรองในโพรไฟล์ใบรับรองเดียวกันจะถูกค้นหา ฟังก์ชันนี้ยังมีวิธีการตั้งค่าที่คล้ายกันสำหรับใบรับรองเฉพาะที่และใบรับรอง Key Vault คุณสามารถเพิ่มการตั้งค่าเฉพาะบริษัทสำหรับใบรับรอง แต่จะมีการใช้ตัวระบุข้ามบริษัทเฉพาะสำหรับใบรับรองแต่ละใบในช่องทาง Commerce

### <a name="scenarios"></a>สถานการณ์

ฟังก์ชันของโพรไฟล์ใบรับรองสนับสนุนสถานการณ์ต่อไปนี้ในช่องทาง Commerce:

- ใช้ใบรับรองเฉพาะที่ในสถานการณ์จำลองที่ย้อนกลับ Key Vault ต่อไปนี้เป็นตัวอย่างของสถานการณ์จำลองย้อนกลับเหล่านี้:

    - ไม่สามารถเข้าถึงพื้นที่เก็บข้อมูลของ Key Vault ได้
    - ไม่พบใบรับรองในที่เก็บ Key Vault
    - POS กำลังรันอยู่ในโหมดออฟไลน์

- ใช้ใบรับรองเฉพาะที่ แต่ไม่มีการเก็บใบรับรองใน Key Vault (ตัวอย่างเช่น ในการติดตั้งในสถานที่)
- ทำการปรับปรุงใบรับรองแบบค่อยเป็นค่อยไป ที่ซึ่งใช้ใบรับรองรุ่นใหม่เท่านั้นในร้านค้าหรือบนเทอร์มินัลที่มีรุ่นใหม่พร้อมใช้งานอยู่แล้ว
- ใช้ใบรับรองเดียวกันในหลายบริษัท

## <a name="set-up-certificate-profiles"></a>การตั้งค่าโพรไฟล์ใบรับรอง

กระบวนงานต่อไปนี้อธิบายวิธีการตั้งค่าโพรไฟล์ใบรับรอง ก่อนที่คุณจะใช้โพรไฟล์ใบรับรองในช่องทาง Commerce ให้ทำตามขั้นตอนต่อไปนี้เพื่อตั้งค่าคอนฟิกการตั้งค่า

1. ในพื้นที่ทำงาน **การจัดการคุณลักษณะ** ให้เปิดคุณลักษณะ **โพรไฟล์ใบรับรองที่กำหนดโดยผู้ใช้สำหรับร้านค้าปลีก**
2. ไปที่ **การจัดการระบบ \> การตั้งค่า \> โพรไฟล์ใบรับรอง**
3. สร้างเรกคอร์ดและตั้งค่า **โพรไฟล์ใบรับรอง** **ชื่อ** และฟิลด์ **คำอธิบาย** สำหรับใบรับรอง

    > [!NOTE]
    > โพรไฟล์ใบรับรองเป็นตัวระบุเฉพาะของใบรับรองระหว่างบริษัทและส่วนประกอบ Commerce ทั้งหมด

3. บนแท็บ **นิติบุคคล** ให้เพิ่มบรรทัด และเลือกนิติบุคคล (บริษัท) ที่ควรใช้โพรไฟล์ใบรับรองปัจจุบัน ถ้าควรใช้โพรไฟล์ใบรับรองสำหรับนิติบุคคลหลายราย ให้ทำซ้ำขั้นตอนนี้เพื่อเพิ่มบรรทัดสำหรับแต่ละนิติบุคคลเพิ่มเติม
4. เลือก **การตั้งค่า** เพื่อเปิดหน้า **การตั้งค่าโพรไฟล์ใบรับรอง** ซึ่งคุณสามารถป้อนการตั้งค่าเฉพาะบริษัทสำหรับโพรไฟล์ใบรับรอง

### <a name="certificate-profile-settings"></a>การตั้งค่าโพรไฟล์ใบรับรอง

เมื่อคุณเลือก **การตั้งค่า** สำหรับบรรทัดโพรไฟล์ใบรับรอง หน้า **การตั้งค่าโพรไฟล์ใบรับรอง** จะปรากฏขึ้น หน้านี้จะช่วยให้คุณสามารถระบุว่าจะใช้ใบรับรองใดเมื่อเรียกใช้โพรไฟล์ใบรับรองปัจจุบันในช่องทาง Commerce นอกจากนี้คุณยังสามารถระบุใบสั่งที่ควรใช้ในการค้นหาใบรับรอง

> [!NOTE]
> ฟิลด์ **ลำดับความสำคัญ** จะถูกตั้งค่าโดยอัตโนมัติ ค่าของ **1** แสดงถึงระดับความสำคัญสูงสุด เมื่อมีการเพิ่มบรรทัดใหม่บนหน้า **การตั้งค่าโพรไฟล์ใบรับรอง** ระดับความสำคัญจะถูกตั้งค่าเป็นหมายเลขที่มากกว่าระดับความสำคัญของบรรทัดก่อนหน้านี้ เมื่อต้องการเปลี่ยนระดับความสำคัญของบรรทัดที่ระบุ ให้เลือกบรรทัด แล้วเลือก **เลื่อนขึ้น** เพื่อเพิ่มระดับความสำคัญหรือ **เลื่อนลง** เพื่อลดระดับความสำคัญ

เมื่อคุณเพิ่มบรรทัดใหม่ลงในหน้า **การตั้งค่าโพรไฟล์ใบรับรอง** ให้ตั้งค่าฟิลด์ต่อไปนี้:

- **ชนิดของสถานที่** – เลือกสถานที่เก็บที่มีการจัดเก็บใบรับรอง ฟิลด์นี้มีค่าที่เป็นไปได้ที่เป็นไปได้สองค่า: **ใบรับรองเฉพาะที่** และ **Key Vault**
- **ใบรับรอง Key Vault** – จำเป็นต้องใช้ฟิลด์นี้ถ้าคุณตั้งค่าฟิลด์ **ชนิดของสถานที่ที่** เป็น **Key Vault** ใช้เพื่อระบุความลับของใบรับรอง Key Vault

    > [!NOTE]
    > ก่อนที่คุณจะใช้ใบรับรอง Key Vault ในโพรไฟล์ใบรับรอง ให้ตรวจสอบให้แน่ใจว่าได้อัพโหลดใบรับรองไปยังที่เก็บ Key Vault และทำตามคำแนะนำใน [การตั้งค่าไคลเอนต์ Key Vault ของ Azure](../../finance/localizations/setting-up-azure-key-vault-client.md)

- **ชื่อร้านค้า** – ฟิลด์นี้เป็นฟิลด์ที่ไม่จำเป็นต้องระบุและจะพร้อมใช้งานเฉพาะเมื่อคุณตั้งค่าฟิลด์ **ชนิดสถานที่** เป็น **ใบรับรองเฉพาะที่** เท่านั้น ใช้เพื่อระบุชื่อร้านค้าเริ่มต้นที่ควรใช้ในการค้นหาใบรับรองเฉพาะที่
- **ที่ตั้งร้านค้า** – ฟิลด์นี้เป็นฟิลด์ที่ไม่จำเป็นต้องระบุและจะพร้อมใช้งานเฉพาะเมื่อคุณตั้งค่าฟิลด์ **ชนิดสถานที่** เป็น **ใบรับรองเฉพาะที่** เท่านั้น ใช้เพื่อระบุที่ตั้งร้านค้าเริ่มต้นที่ควรใช้ในการค้นหาใบรับรองเฉพาะที่

    > [!NOTE]
    > ชื่อร้านค้าเริ่มต้นและที่ตั้งร้านค้าจะถูกเพิ่มเพื่อทำให้กระบวนการของการค้นหาใบรับรองเฉพาะที่ใน Commerce Runtime เป็นไปได้ง่ายขึ้น X509StoreProvider มีรายการของโฟลเดอร์ที่จัดเก็บใบรับรอง ถ้าไม่ได้ระบุชื่อร้านค้าเริ่มต้นและที่ตั้งร้านค้าเริ่มต้น X509StoreProvider จะพยายามค้นหาใบรับรองในโฟลเดอร์อื่นในรายการ

- **รหัสประจำตัว** – ฟิลด์นี้เป็นฟิลด์ที่จำเป็นต้องระบุและจะพร้อมใช้งานเฉพาะเมื่อคุณตั้งค่าฟิลด์ **ชนิดสถานที่** เป็น **ใบรับรองเฉพาะที่** เท่านั้น ใช้เพื่อระบุรหัสประจำตัวของใบรับรอง
- **ข้อคิดเห็น** – ฟิลด์นี้ไม่จำเป็นต้องระบุและให้ผู้ใช้ป้อนหมายเหตุ

### <a name="workflow-searching-certificates-in-the-commerce-runtime"></a>ลำดับงาน: กำลังค้นหาใบรับรองใน Commerce Runtime

ต่อไปนี้เป็นลำดับงานพื้นฐานที่ใช้ในการค้นหาใบรับรองเมื่อมีการเรียกใช้โพรไฟล์ใบรับรองใน Commerce Runtime

1. ระบบระบุว่าโพรไฟล์ใบรับรองมีการตั้งค่าเฉพาะบริษัทสำหรับนิติบุคคลปัจจุบันหรือไม่
1. ระบบพยายามค้นหาใบรับรองโดยใช้ค่าในหน้า **การตั้งค่าโพรไฟล์ใบรับรอง** สำหรับบรรทัดที่ฟิลด์ **ระดับความสำคัญ** ถูกตั้งค่าเป็น **1**

    - ถ้าฟิลด์ **ชนิดของสถานที่** ถูกตั้งค่าเป็น **Key Vault** ค่าของฟิลด์ **ความลับของใบรับรอง Key Vault** จะใช้ในการค้นหาใบรับรองบนหน้า **พารามิเตอร์ของ Key Vault** จากนั้นจะมีการค้นหาใบรับรองในที่เก็บ Key Vault
    - ถ้าฟิลด์ **ชนิดของสถานที่** ถูกตั้งค่าเป็น **ใบรับรองเฉพาะที่** X509StoreProvider จะค้นหาใบรับรองเป็นอันดับแรก โดยใช้ชื่อร้านค้าและที่ตั้งร้านค้าเริ่มต้น ถ้ามีการระบุพารามิเตอร์เหล่านี้ แล้วค้นหาในโฟลเดอร์อื่นๆ ทั้งหมดในรายการของโฟลเดอร์

1. ถ้าไม่พบใบรับรอง กระบวนการจะถูกทำซ้ำสำหรับบรรทัดที่ฟิลด์ **ระดับความสำคัญ** ถูกตั้งค่าเป็น **2** และต่อไป

> [!NOTE]
> ถ้าโพรไฟล์ใบรับรองไม่มีการตั้งค่าสำหรับนิติบุคคลปัจจุบัน หรือถ้าการค้นหาใบรับรองไม่สำเร็จสำหรับบรรทัดทั้งหมดในหน้า **การตั้งค่าโพรไฟล์ใบรับรอง** จะไม่พบใบรับรอง

#### <a name="caching-the-results-of-certificate-searches"></a>การแคชผลลัพธ์ของการค้นหาใบรับรอง

ผลลัพธ์ของการค้นหาใบรับรองถูกแคช เวลาหมดอายุเริ่มต้นสำหรับแคชเป็นหนึ่งชั่วโมง อย่างไรก็ตาม คุณสามารถปรับแต่งเวลานี้และสามารถตั้งค่าสูงสุดได้ 24 ชั่วโมง

### <a name="gradual-update"></a>ปรับปรุงแบบค่อยเป็นค่อยไป

ถ้ามีการนำใบรับรองรุ่นใหม่ไปใช้ แต่จะไม่สามารถอัพเดตในร้านค้าทั้งหมดในเวลาเดียวกัน ฟังก์ชันของโพรไฟล์ใบรับรองเปิดใช้งานใบรับรองจะถูกอัพเดตแบบค่อยเป็นค่อยไป

1. ค้นหาโพรไฟล์ใบรับรองและบรรทัดที่ควรได้รับการอัพเดต แล้วเลือก **การตั้งค่า**
1. เพิ่มบรรทัด และระบุการตั้งค่าที่เกี่ยวข้องกับใบรับรองรุ่นล่าสุด
1. เพิ่มค่า **ระดับความสำคัญ** ของบรรทัดใหม่ ใช้ปุ่ม **เลื่อนขึ้น** เพื่อเลื่อนบรรทัดเพื่อให้อยู่เหนือบรรทัดสำหรับใบรับรองเดียวกันกับรุ่นก่อนหน้านี้

> [!NOTE]
> ใน Commerce Runtime ใบรับรองรุ่นใหม่จะถูกเรียกก่อน ถ้าใบรับรองยังไม่ได้รับการอัพเดตบนร้านค้าหรือบนเทอร์มินัลเฉพาะหนึ่งๆ จะมีการเรียกรุ่นก่อนหน้านี้


[!INCLUDE[footer-include](../../includes/footer-banner.md)]