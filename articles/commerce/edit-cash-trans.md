---
title: แก้ไขและตรวจสอบธุรกรรมเงินสดและการขนส่งและการจัดการเงินสด
description: หัวข้อนี้อธิบายวิธีการแก้ไขและตรวจสอบธุรกรรมเงินสดและการขนส่งและการจัดการเงินสดใน Microsoft Dynamics 365 Commerce
author: josaw1
manager: AnnBe
ms.date: 11/04/2020
ms.topic: index-page
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Application User
ms.reviewer: v-chgri
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2018-11-15
ms.dyn365.ops.version: ''
ms.openlocfilehash: c809f379dbd6824542d0b1768cfbf44f37461f4c
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 01/15/2021
ms.locfileid: "5010210"
---
# <a name="edit-and-audit-cash-and-carry-and-cash-management-transactions"></a>แก้ไขและตรวจสอบธุรกรรมเงินสดและการขนส่งและการจัดการเงินสด

[!include [banner](../includes/banner.md)]

หัวข้อนี้อธิบายวิธีการแก้ไขและตรวจสอบธุรกรรมเงินสดและการขนส่งและการจัดการเงินสดใน Microsoft Dynamics 365 Commerce

## <a name="overview"></a>ภาพรวม

ลูกค้า Dynamics 365 Commerce จะใช้งานแอปพลิเคชันการขายหน้าร้านของ (POS) ของ Microsoft และแอปพลิเคชัน POS ของบริษัทอื่น ในกรณีที่ใช้แอปพลิเคชันของ Microsoft ธุรกรรมของร้านค้าจะถูกดึงลงในศูนย์ควบคุม Commerce จากช่องทางต่างๆ ผ่านกระบวนการชุดงาน ในกรณีที่ใช้แอปพลิเคชันของบริษัทอื่น ธุรกรรมจะถูกดึงลงในศูนย์ควบคุม Commerce ผ่านทางการรวม ในทั้งสองกรณี หลังจากธุรกรรมถูกดึงลงในศูนย์ควบคุม Commerce แล้ว ต้องมีการดำเนินกระบวนการตรวจสอบความสอดคล้องกัน กระบวนการนี้จะเรียกใช้การตรวจสอบความถูกต้องหลายครั้งในธุรกรรม และเฉพาะธุรกรรมที่ผ่านการตรวจสอบความถูกต้องแล้วเท่านั้นที่จะมีการดึงลงในใบแจ้งยอดเพื่อให้สามารถลงรายการบัญชีในศูนย์ควบคุม Commerce ได้

ธุรกรรม Commerce ไม่ผ่านการตรวจสอบความถูกต้องด้วยหลายสาเหตุ ข้อบกพร่องในโค้ดการรวมหรือในแอปพลิเคชัน POS อาจทําให้เกิดข้อมูลที่ไม่สอดคล้องกัน หรือข้อผิดพลาดของผู้ใช้อาจทําให้เกิดข้อมูลที่ไม่สอดคล้องกัน ตัวอย่างเช่น ผู้ใช้ลบผลิตภัณฑ์หลังจากที่ซิงค์กับช่องทาง หรือผู้ใช้ปิดรอบระยะเวลาทางบัญชีโดยไม่ลงรายการบัญชีธุรกรรมสําหรับรอบระยะเวลานั้น แม้ว่าธุรกรรมเหล่านี้จะได้รับการตั้งค่าสถานะและไม่รวมอยู่ในใบแจ้งยอด แต่ธุรกรรมดังกล่าวอาจขัดขวางกระบวนการรายวันของลูกค้าในการลงรายการบัญชีการขายประจำวันให้กับฝ่ายการเงิน ใน Commerce คุณสามารถแก้ไขธุรกรรมเฉพาะที่ไม่ผ่านการตรวจสอบความถูกต้องขณะที่คุณรักษาการตรวจสอบการเปลี่ยนแปลงทั้งหมดได้ด้วย

## <a name="edit-transactions"></a>แก้ไขธุรกรรม

ใน Commerce รุ่น 10.0.5 ธุรกรรมที่สามารถแก้ไขได้มีเฉพาะธุรกรรมเงินสดและการขนส่ง เช่น การขายและการส่งคืนเท่านั้น ใบสั่งของลูกค้าและใบสั่งออนไลน์ไม่สามารถแก้ไขได้ ใน Commerce รุ่น 10.0.6 และใหม่กว่า ธุรกรรมการจัดการเงินสดสามารถแก้ไขได้

เมื่อต้องการแก้ไขธุรกรรมใบสั่งในศูนย์ควบคุม Commerce ให้ทําตามขั้นตอนต่อไปนี้

1. ติดตั้ง [Microsoft Dynamics Office Add-in](https://appsource.microsoft.com/product/office/WA104379629?tab=Overview)
1. ในศูนย์ควบคุม Commerce ให้เปิดพื้นที่ทํางาน **การเงินของร้านค้า** ไทล์ **ความล้มเหลวในการตรวจสอบความถูกต้องของธุรกรรม** แสดงมุมมองที่กรองไว้ล่วงหน้าของหน้าธุรกรรมที่ล้มเหลวสำหรับกฎการตรวจสอบความถูกต้องอย่างน้อยหนึ่งรายการ
1. เปิดหน้าธุรกรรม เลือกเรกคอร์ดที่ไม่ผ่านการตรวจสอบความถูกต้อง เลือก **Office Add-in** แล้วเลือก **แก้ไขธุรกรรมที่เลือก** ไฟล์ Excel ที่แสดงรายละเอียดของธุรกรรมที่เลือกจะถูกเปิด ไฟล์นี้มีเวิร์กชีตต่อไปนี้:

    - **รายการ** – เวิร์กชีตนี้มีรายการส่วนหัวและผลิตภัณฑ์ของธุรกรรมและข้อมูลที่เกี่ยวข้องของธุรกรรม
    - **การชำระเงิน** – เวิร์กชีตนี้มีรายละเอียดของรายการชำระเงินของธุรกรรม
    - **ส่วนลด** – เวิร์กชีตนี้มีมีรายละเอียดที่เกี่ยวข้องกับส่วนลดของธุรกรรม
    - **ภาษี** – เวิร์กชีตนี้มีรายละเอียดที่เกี่ยวข้องกับภาษีของธุรกรรม
    - **ค่าธรรมเนียม** – เวิร์กชีตนี้มีมีข้อมูลที่เกี่ยวข้องกับค่าธรรมเนียมของธุรกรรม

1. ในไฟล์ Excel ให้ปรับเปลี่ยนฟิลด์ที่เหมาะสมแล้วอัปโหลดข้อมูลกลับเข้าไปในศูนย์ควบคุม Commerce โดยใช้ฟังก์ชันการเผยแพร่ของ Dynamics Excel Add-in หลังจากที่เผยแพร่ข้อมูล การเปลี่ยนแปลงจะปรากฏในระบบ ระหว่างการเผยแพร่ จะไม่มีการตรวจสอบความถูกต้องสำหรับการเปลี่ยนแปลงที่ผู้ใช้ทำ
1. คุณสามารถดูบันทึกการตรวจสอบบัญชีที่สมบูรณ์ของการเปลี่ยนแปลงได้โดยการเลือก **ดูบันทึกการตรวจสอบ** ในหัวข้อ **ธุรกรรมการขายปลีก** สำหรับการเปลี่ยนแปลงในระดับหัวข้อและในส่วนและเรกคอร์ดที่เกี่ยวข้องในหน้าธุรกรรมที่เหมาะสม ตัวอย่างเช่น การเปลี่ยนแปลงทั้งหมดที่เกี่ยวข้องกับรายการขายจะแสดงขึ้นบนหน้า **ธุรกรรมการขาย** และการเปลี่ยนแปลงทั้งหมดที่เกี่ยวข้องกับการชําระเงินจะแสดงขึ้น **ธุรกรรมการชำระเงิน** รายละเอียดการตรวจสอบต่อไปนี้ได้รับการรักษาไว้สําหรับการเปลี่ยนแปลง:

    - วันที่และเวลาที่แก้ไข
    - ฟิลด์
    - ค่าเก่า
    - ค่าใหม่
    - ปรับเปลี่ยนโดย

1. หลังจากที่คุณทำการเปลี่ยนแปลงและเผยแพร่แล้ว ให้เรียกใช้ **ตรวจสอบความถูกต้องของธุรกรรมร้านค้า** เพื่อตรวจสอบว่าการเปลี่ยนแปลงเหล่านั้นมีความสอดคล้องกันและถูกต้อง

> [!NOTE]
> คุณสามารถแก้ไขได้เฉพาะธุรกรรมที่ไม่ผ่านการตรวจสอบความถูกต้องเท่านั้น หากคุณต้องการแก้ไขธุรกรรมที่ผ่านการตรวจสอบความถูกต้อง ให้เปลี่ยนสถานะการตรวจสอบความถูกต้องของธุรกรรมที่คุณต้องการเปลี่ยนเป็น **ผิดพลาด** หรือ **ไม่มี** แล้วเผยแพร่การเปลี่ยนแปลง จากนั้นคุณสามารถแก้ไขข้อมูลในส่วนหัวหรือในเรกคอร์ดรองอื่นๆ ของธุรกรรม และเผยแพร่ส่วนหัวหรือเรกคอร์ดได้

## <a name="bulk-edit-transactions-that-are-linked-to-a-statement"></a>การแก้ไขธุรกรรมจํานวนมากที่เชื่อมโยงกับใบแจ้งยอด

ใน Commerce รุ่น10.0.6 ขึ้นไปรองรับการแก้ไขธุรกรรมจำนวนมากที่ระดับใบแจ้งยอด

เมื่อต้องการแก้ไขธุรกรรมจํานวนมากที่เชื่อมโยงกับใบแจ้งยอดในศูนย์ควบคุม Commerce ให้ทําตามขั้นตอนเหล่านี้

1. เปิดหน้า **ใบแจ้งยอด** แล้วเลือกใบแจ้งยอดที่มีธุรกรรมที่ต้องแก้ไข
1. เลือกปุ่ม **เปิดใน Microsoft Office**
1. เลือกตัวเลือกใดตัวเลือกหนึ่งต่อไปนี้ โดยขึ้นอยู่กับสิ่งที่ต้องแก้ไข

    - **แก้ไขธุรกรรมเงินสดและการขนส่ง** – ตัวเลือกนี้ช่วยให้คุณสามารถแก้ไขธุรกรรมเงินสดและการขนส่งทั้งหมดที่รวมอยู่ในใบแจ้งยอดได้ เวิร์กชีต Excel ที่พร้อมใช้งานมีดังต่อไปนี้:

        - **ธุรกรรม** – เวิร์กชีตนี้มีข้อมูลระดับส่วนหัวทั้งหมดสำหรับธุรกรรมการขาย
        - **ธุรกรรมการขาย** – เวิร์กชีตนี้มีข้อมูลระดับรายการทั้งหมดสำหรับธุรกรรมการขาย
        - **ธุรกรรมการชำระเงิน** – เวิร์กชีตนี้มีข้อมูลรายการการชำระเงินทั้งหมดสำหรับธุรกรรมการขาย
        - **ธุรกรรมส่วนลด** – เวิร์กชีตนี้มีข้อมูลรายการส่วนลดทั้งหมดสำหรับธุรกรรมการขาย
        - **ธุรกรรมภาษี** – เวิร์กชีตนี้มีข้อมูลรายการภาษีทั้งหมดสำหรับธุรกรรมการขาย
        - **ธุรกรรมค่าธรรมเนียม** – เวิร์กชีตนี้มีข้อมูลรายการค่าธรรมเนียมทั้งหมดสำหรับธุรกรรมการขาย

    - **แก้ไขธุรกรรมการจัดการเงินสด** – ตัวเลือกนี้ช่วยให้คุณสามารถแก้ไขธุรกรรมการจัดการเงินสดทั้งหมดที่รวมอยู่ในใบแจ้งยอดได้ เวิร์กชีต Excel ที่พร้อมใช้งานมีดังต่อไปนี้:

        - **ธุรกรรม** – เวิร์กชีตนี้มีข้อมูลระดับส่วนหัวทั้งหมดสำหรับธุรกรรมการจัดการเงินสด
        - **ธุรกรรมการชำระเงินธนาคาร** – เวิร์กชีตนี้มีรายละเอียดธุรกรรมการนำเงินฝากธนาคารทั้งหมด
        - **ธุรกรรมการชำระเงินที่เข้าเซฟ** – เวิร์กชีตนี้มีรายละเอียดธุรกรรมการนำเงินฝากเข้าเซฟทั้งหมด
        - **การตรวจนับเงิน** – เวิร์กชีตนี้มีรายละเอียดธุรกรรมการตรวจนับเงินทั้งหมด
        - **ธุรกรรมรายได้-ค่าใช้จ่าย** – เวิร์กชีตนี้มีรายละเอียดรายละเอียดรายละเอียดของรายการธุรกรรมรายได้-ค่าใช้จ่ายทั้งหมด
        - **ธุรกรรมการชำระเงิน** – เวิร์กชีตนี้มีข้อมูลที่เกี่ยวข้องกับการชำระเงินสำหรับการดำเนินการ **ชำระเงินตามใบแจ้งหนี้** และธุรกรรมธุรกรรมรายได้-ค่าใช้จ่าย

1. แก้ไขธุรกรรมที่จําเป็น

    > [!NOTE]
    > การตรวจสอบความถูกต้องไม่มีการดำเนินการเมื่อคุณเผยแพร่ธุรกรรมที่แก้ไขจำนวนมาก คุณต้องตรวจสอบให้แน่ใจว่าการแก้ไขทั้งหมดของคุณถูกต้องและความถูกต้องของข้อมูลในเวิร์กชีตมีการรักษาไว้ ตัวอย่างเช่น หากคุณต้องการเปลี่ยนแปลงวันที่ของธุรกรรมเพื่อให้คุณสามารถจัดการสถานการณ์ที่มีการปิดรอบระยะเวลาทางบัญชีหรือสินค้าคงคลังสำหรับธุรกรรมที่เปิดค้างไว้ คุณต้องเปลี่ยนวันที่ในเวิร์กชีต Excel ทั้งหมดที่มีคอลัมน์ **วันที่ทำการ** เมื่อต้องการตรวจสอบความถูกต้องของธุรกรรมหลังจากแก้ไขแล้ว คุณสามารถเลือก **ตรวจสอบความถูกต้องของธุรกรรมซ้ำ** ในหน้า **ใบแจ้งยอด** รอให้งานการตรวจสอบความถูกต้องเสร็จสิ้นลงก่อนที่คุณจะลงรายการบัญชีใบแจ้งยอด

1. ถ้ามีการสร้างการรวมไว้ออยู่แล้ว ให้เปิดหน้า **ธุรกรรมที่มีการรวม** แล้วเลือก **สร้าง xml ใบสั่งขายใหม่**

## <a name="bulk-edit-transactions-that-arent-linked-to-a-statement"></a>การแก้ไขธุรกรรมจํานวนมากที่ไม่เชื่อมโยงกับใบแจ้งยอด

Commerce รุ่น 10.0.10 และที่ใหม่กว่ารองรับตัวเลือกสำหรับธุรกรรมการแก้ไขจำนวนมากซึ่งไม่ผ่านการตรวจสอบความถูกต้องแต่ไม่ได้เชื่อมโยงกับใบแจ้งยอด

เมื่อต้องการแก้ไขธุรกรรมจํานวนมากที่ไม่ได้เชื่อมโยงกับใบแจ้งยอดในศูนย์ควบคุม Commerce ให้ทําตามขั้นตอนเหล่านี้

1. เปิดหน้า **ร้านค้าทั้งหมด** แล้วเลือกร้านค้าที่ต้องแก้ไขธุรกรรม
1. เลือกปุ่ม **เปิดใน Microsoft Office** แล้วเลือก **แก้ไขธุรกรรมเงินสดและการขนส่ง**
1. แก้ไขธุรกรรมที่จำเป็นแล้วเผยแพร่

## <a name="additional-resources"></a>แหล่งข้อมูลเพิ่มเติม

[แก้ไขและตรวจสอบธุรกรรมใบสั่งออนไลน์และใบสั่งของลูกค้าแบบอะซิงโครนัส](edit-order-trans.md)

[แก้ไขมิติทางการเงินสำหรับธุรกรรมการขายปลีก](edit-financial-dim.md)

[สร้างเวิร์กบุ๊ก Excel เพื่อแก้ไขธุรกรรมการขายปลีก](create-excel-edit.md)

[เพิ่มฟิลด์ลงในเวิร์กบุ๊ก Excel เพื่อแก้ไขธุรกรรมการขายปลีก](add-fields-excel.md)
