---
title: แอป PowerApps แบบฝัง
description: หัวข้อนี้อธิบายวิธีการฝัง PowerApps ไปยังไคลเอนต์ Finance and Operations เพื่อเสริมฟังก์ชันของผลิตภัณฑ์
author: jasongre
manager: AnnBe
ms.date: 09/04/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: FormRunConfigurationAddPAControl, FormRunConfigurationEditPAControl
audience: Application User, Developer, IT Pro
ms.search.scope: Operations, Core
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2018-02-28
ms.dyn365.ops.version: Platform update 14
ms.openlocfilehash: 262d34cbc50251595d22c27387fbd3f1045d1fbb
ms.sourcegitcommit: 0f530e5f72a40f383868957a6b5cb0e446e4c795
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 01/29/2019
ms.locfileid: "334162"
---
# <a name="embed-powerapps-apps"></a>ฝังแอป PowerApps

[!include [banner](../includes/banner.md)]

ในการปรับปรุงแพลตฟอร์ม 14 Microsoft Dynamics 365 for Finance and Operations สนับสนุนการรวมกับ Microsoft PowerApps บริการสำหรับนักพัฒนาและผู้ใช้ที่ไม่ใช่ทางเทคนิค เพื่อสร้างแอปธุรกิจแบบกำหนดเองสำหรับอุปกรณ์มือถือ แท็บเล็ต และเว็บ โดยไม่ต้องเขียนรหัส จากนั้น PowerApps ที่พัฒนาโดยคุณ องค์กรของคุณ หรือระบบแวดล้อมที่กว้างขึ้นในไคลเอนต์ สามารถถูกฝังได้ในไคลเอนต์ Finance and Operations เพื่อเสริมฟังก์ชันของผลิตภัณฑ์ ตัวอย่างเช่น คุณอาจสร้าง PowerApp เพื่อสนับสนุน Finance and Operations พร้อมด้วยข้อมูลที่ดึงมาจากระบบอื่น

เพื่อเรียนรู้เพิ่มเติมเกี่ยวกับ PowerApps ที่ฝัง ดูวิดีโอสั้นๆ [วิธีการฝัง PowerApps ใน Dynamics 365 for Finance and Operations](https://www.youtube.com/watch?v=x3qyA1bH-NY)

## <a name="adding-an-embedded-powerapp-to-a-page"></a>การเพิ่ม PowerApp ที่ฝังตัวไปยังหน้า

### <a name="overview"></a>ภาพรวม

ก่อนที่จะฝัง PowerApp ลงในไคลเอนต์ Finance and Operations ก่อนอื่นคุณต้องค้นหาหรือสร้าง PowerApp พร้อมกับภาพที่ต้องการและ/หรือฟังก์ชัน เราจะไม่อธิบายกระบวนการโดยละเอียดสำหรับการสร้าง PowerApp ที่นี่ หัวข้อ [บทนำไปยัง PowerApps](https://docs.microsoft.com/powerapps/getting-started) คือจุดเริ่มต้นที่ดี ถ้าคุณใหม่กับ PowerApps

เมื่อคุณพร้อมที่จะฝัง PowerApp เฉพาะ คุณสามารถเลือกระหว่างวิธีสองวิธีในการเข้าถึง PowerApp บนหน้า กระบวนการผลิตใดก็ตามที่พอดีกับสถานการณ์ของคุณมากกว่า วิธีการแรกคือ โดยผ่านปุ่ม PowerApps ที่ได้ถูกเพิ่มลงในบานหน้าต่างการดำเนินการมาตรฐาน PowerApps ที่ถูกเพิ่มโดยใช้กลไกนี้ จะปรากฏขึ้นเป็นรายการเมนูภายในปุ่มเมนู PowerApps เมื่อมีการเลือก รายการเมนูเหล่านี้แต่ละรายการจะเปิดบานหน้าต่างด้านข้างที่ประกอบด้วย PowerApp ที่ฝังอยู่ อีกทางหนึ่งคือ คุณอาจเลือกที่จะแสดง PowerApp โดยตรงบนหน้าเป็นแท็บใหม่ FastTab blade หรือเป็นส่วนใหม่ในพื้นที่ทำงาน

เมื่อตั้งค่าคอนฟิก PowerApp ที่ฝังอยู่ของคุณใน Finance and Operations คุณสามารถเลือกฟิลด์เดียวที่คุณต้องการส่งเป็นข้อมูลป้อนเข้าไป PowerApp ซึ่งช่วยให้ PowerApp ตอบสนองโดยยึดตามข้อมูลที่คุณกำลังดูใน Finance and Operations

### <a name="details"></a>รายละเอียด

คำแนะนำต่อไปนี้แสดงวิธีการฝัง PowerApp ลงในเว็บไคลเอนต์ Finance and Operations

1. ไปยังหน้าที่คุณต้องการฝัง PowerApp นี่จะเป็นหน้าเดียวกันที่ประกอบด้วยข้อมูลใดๆ ที่จำเป็นต้องถูกส่งผ่านไปยัง PowerApp เป็นอินพุท
2. เปิดบานหน้าต่าง **แทรก PowerApp** :

    - คลิก **ตัวเลือก** แล้วจากนั้นเลือก **กำหนดแบบฟอร์มนี้เป็นแบบส่วนบุคคล** ภายใต้เมนู **แทรก** เลือก **PowerApp** ในตอนท้าย เลือกภูมิภาคที่คุณต้องการเพิ่ม PowerApp ถ้าคุณต้องการฝัง PowerApp ภายใต้ปุ่มเมนู PowerApps เลือกบานหน้าต่างการดำเนินการ ถ้าคุณต้องการฝัง PowerApp โดยตรงลงบนหน้า เลือกแท็บที่เหมาะสม FastTab blade หรือส่วน (ถ้าคุณอยู่ในพื้นที่ทำงาน)
    - ถ้าจะเข้าถึง PowerApp โดยใช้ปุ่มเมนู PowerApps อีกทางหนึ่งคือ คุณสามารถคลิกปุ่มเมนู **PowerApps** ในบานหน้าต่างการดำเนินการมาตรฐาน และจากนั้น **แทรก PowerApp**

3. ตั้งค่าคอนฟิก PowerApp ที่ฝังตัว:

    - ฟิลด์ **ชื่อ** บ่งชี้ข้อความที่แสดงสำหรับปุ่มหรือแท็บที่จะประกอบด้วย PowerApp ที่ฝังอยู่ ส่วนมาก คุณอาจต้องทำซ้ำชื่อของ PowerApp ในฟิลด์นี้
    - **รหัสแอพลิเคชัน** เป็น GUID สำหรับ PowerApp ที่คุณต้องการให้ฝังตัว ในการดึงข้อมูลค่านี้ ค้นหา PowerApp บน [web.powerapps.com](https://web.powerapps.com) แล้วจากนั้น ระบุตำแหน่งฟิลด์ **รหัสแอพลิเคชัน** ภายใต้ **รายละเอียด**
    - สำหรับ **ป้อนข้อมูลสำหรับ PowerApp** คุณสามารถเลือกฟิลด์ที่ประกอบด้วยข้อมูลที่คุณต้องการส่งผ่านไปยัง PowerApp เป็นข้อมูลป้อนเข้าได้ ดูส่วนต่อไปในหัวข้อนี้ที่ชื่อ [การสร้าง PowerApp ที่ใช้ประโยชน์ข้อมูลจาก Finance and Operations](#building-a-powerapp-that-leverages-data-sent-from-finance-and-operations) สำหรับรายละเอียดเกี่ยวกับวิธีการที่ PowerApp สามารถเข้าถึงข้อมูลที่ส่งจาก Finance and Operations
    - เลือก **ขนาดแอพลิเคชัน** ที่ตรงกับชนิดของ PowerApp ที่คุณกำลังฝัง เลือก **บาง** สำหรับ PowerApps ที่สร้างขึ้นสำหรับอุปกรณ์เคลื่อนที่ และ **กว้าง** สำหรับ PowerApps ที่สร้างขึ้นสำหรับเล็ต ซึ่งช่วยให้มั่นใจว่าจำนวนพื้นที่ว่างที่เพียงพอจะถูกจัดสรรให้สำหรับ PowerApp ที่ฝัง
    - FastTab **นิติบุคคล** มีความสามารถในการเลือกนิติบุคคลที่ PowerApp จะพร้อมใช้งาน ค่าเริ่มต้นเป็นการแสดง PowerApp ในนิติบุคคลทั้งหมด

4. หลังจากการยืนยันว่าการตั้งค่าคอนฟิกถูกต้อง คลิก **แทรก** เพื่อฝัง PowerApp บนหน้า คุณจะได้รับการพร้อมท์เพื่อรีเฟรชเบราเซอร์เพื่อดู PowerApp ที่ฝัง

## <a name="sharing-an-embedded-powerapp"></a>การแบ่งปัน PowerApp ที่ฝัง

หลังจากที่คุณได้ฝัง PowerApp บนหน้าและยืนยันว่าทำงานกับบริบทข้อมูลใดๆ ที่ส่งผ่านจากหน้าได้อย่างถูกต้องแล้ว คุณอาจต้องการแบ่งปัน PowerApp ที่ฝังอยู่นี้กับผู้ใช้อื่นในระบบ ซึ่งสามารถทำได้ในสองวิธีที่แตกต่างกัน โดยใช้ความสามารถในการตั้งค่าส่วนบุคคลของผลิตภัณฑ์:

- สถานการณ์จำลองที่แนะนำคือ ผ่านผู้ดูแลระบบ ผู้ซึ่งสามารถกำหนดการตั้งค่าส่วนบุคคลให้กับผู้ใช้ทั้งหมดหรือชุดย่อยของผู้ใช้ได้
- อีกทางหนึ่งคือ คุณสามารถส่งออกการกำหนดเป็นแบบส่วนบุคคลของหน้าของคุณได้ ส่งไปยังผู้ใช้อย่างน้อยหนึ่งราย และให้ผู้ใช้ดังกล่าวแต่ละรายนำเข้าการเปลี่ยนแปลงเหล่านั้น ตัวเลือก จัดการ บนแถบเครื่องมือการตั้งค่าส่วนบุคคล ช่วยให้คุณสามารถส่งออกและนำเข้าการตั้งค่าส่วนบุคคลได้

ดู [กำหนดประสบการณ์ผู้ใช้เป็นแบบส่วนบุคคล](personalize-user-experience.md) สำหรับรายละเอียดเพิ่มเติมเกี่ยวกับความสามารถในการกำหนดประสบการณ์ผู้ใช้เป็นแบบส่วนบุคคลในผลิตภัณฑ์และวิธีการใช้

## <a name="building-a-powerapp-that-leverages-data-sent-from-finance-and-operations"></a>การสร้าง PowerApp ที่ใช้ประโยชน์ข้อมูลที่ส่งจาก Finance and Operations

ส่วนสำคัญของการสร้าง PowerApp ที่จะถูกฝังอยู่ใน Finance and Operations ใช้ข้อมูลที่ป้อนเข้าจาก Finance and Operations ภายใน PowerApp ที่สามารถเข้าถึงข้อมูลที่ป้อนได้โดยใช้ตัวแปร Param("EntityId")

ตัวอย่างเช่น ในฟังก์ชัน OnStart ของ PowerApp คุณสามารถตั้งค่าข้อมูลป้อนเข้าจาก Finance and Operations เป็นตัวแปรดังนี้:

```
If(!IsBlank(Param("EntityId")), Set(FinOpsInput, Param("EntityId")), Set(FinOpsInput, ""));
```

## <a name="viewing-an-embedded-powerapp"></a>การดู PowerApp ที่ฝัง

เมื่อต้องการดู PowerApp ที่ฝังอยู่ในหน้าใน Finance and Operations เพียงแค่ไปยังหน้าที่มี PowerApp ที่ฝังอยู่ เรียกคืนที่ซึ่ง PowerApps สามารถเข้าถึงผ่านปุ่ม PowerApps ในบานหน้าต่างการดำเนินการมาตรฐาน หรือสามารถปรากฏโดยตรงบนหน้าเป็นแท็บใหม่ FastTab blade หรือส่วนใหม่ในพื้นที่ทำงาน เมื่อผู้ใช้พยายามโหลด PowerApp บนหน้าเป็นอันดับแรก เขาหรือเธอจะได้รับการพร้อมท์เพื่อเข้าสู่ PowerApps เพื่อให้แน่ใจว่า ผู้ใช้มีสิทธิ์ที่เหมาะสมเพื่อใช้ PowerApp

## <a name="editing-an-embedded-powerapp"></a>การแก้ไข PowerApp ที่ฝัง

หลังจากที่มีการฝัง PowerApp ลงบนหน้า คุณอาจต้องทำการเปลี่ยนแปลงบางอย่างเพื่อตั้งค่าคอนฟิก PowerApp นั้น ตัวอย่างเช่น บางทีคุณอาจต้องการแก้ไขป้ายชื่อที่เกี่ยวข้องกับ PowerApp ที่ฝัง หรือเวอร์ชันใหม่ของ PowerApp ที่ฝัง ที่ได้มีการการสร้าง และคุณจำเป็นต้องอัพเดตรหัสแอพลิเคชันเพื่อบ่งชี้ PowerApp ล่าสุด

ทำตามขั้นตอนเหล่านี้เพื่อแก้ไขการตั้งค่าคอนฟิกของ PowerApp ที่ฝังอยู่:

1. ไปที่บานหน้าต่าง **แก้ไข PowerApp**

    - ถ้าจะเข้าถึง PowerApp ที่ฝังผ่านทางปุ่มเมนู PowerApps คลิกขวาบนปุ่มเมนู PowerApps และเลือก **กำหนดเป็นแบบส่วนบุคคล** เลือก PowerApp ที่คุณต้องการตั้งค่าคอนฟิกจากเมนูแบบหล่นลง **เลือก PowerApp**
    - ถ้า PowerApp ที่ฝังปรากฏบนหน้า **ตัวเลือก**โดยตรง แล้วจากนั้นเลือก **กำหนดแบบฟอร์มนี้เป็นแบบส่วนบุคคล** การใช้เครื่องมือ **เลือก** คลิก PowerApp ที่ฝังอยู่

2. ทำการแก้ไขที่ต้องการไปยังการตั้งค่าคอนฟิก PowerApps และจากนั้น คลิก **บันทึก**

## <a name="removing-an-embedded-powerapp"></a>การลบ PowerApp ที่ฝัง

หลังจากที่มีการฝัง PowerApp ลงบนหน้า มีวิธีอยู่สองวิธีในการลบ ถ้าจำเป็น:

- ไปยังบานหน้าต่าง **แก้ไข PowerApp** โดยใช้คำแนะนำจากส่วน [การแก้ไข PowerApp ที่ฝังอยู่](#editing-an-embedded-powerapp) ก่อนหน้านี้ในหัวข้อนี้ ยืนยันว่า บานหน้าต่างแสดงข้อมูลสำหรับ PowerApp ที่ฝังซึ่งคุณต้องการลบ แล้วจากนั้น คลิกปุ่ม **ลบ**
- เนื่องจาก PowerApp ที่ฝังอยู่ถูกบันทึกเป็นข้อมูลการตั้งค่าส่วนบุคคล การล้างการตั้งค่าส่วนบุคคลของเพจจะลบ PowerApps ที่ฝังอยู่ใดๆ บนหน้านั้นด้วย โปรดทราบว่า การล้างการตั้งค่าส่วนบุคคลของเพจเป็นแบบถาวร และไม่สามารถยกเลิกได้ เมื่อต้องการลบการตั้งค่าส่วนบุคคลของคุณในหน้า เลือก **ตัวเลือก** แล้วจากนั้น คลิก **กำหนดแบบฟอร์มนี้เป็นแบบส่วนบุคคล** ภายใต้เมนู **จัดการ** เลือกปุ่ม **ล้าง** หลังจากการรีเฟรชเบราเซอร์ของคุณ การกำหนดเป็นแบบส่วนบุคคลก่อนหน้านี้ทั้งหมดสำหรับหน้านี้จะถูกเอาออก ดู [กำหนดประสบการณ์ผู้ใช้นี้เป็นแบบส่วนบุคคล](personalize-user-experience.md) สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการปรับปรุงหน้าโดยใช้การกำหนดเป็นแบบส่วนบุคคล

## <a name="appendix"></a>ภาคผนวก

### <a name="developer-control-over-where-a-powerapp-can-be-embedded"></a>นักพัฒนาควบคุมที่ซึ่งสามารถฝัง PowerApp ได้

โดยค่าเริ่มต้น ผู้ใช้สามารถฝัง PowerApps บนหน้าใดๆ ภายใต้ปุ่มเมนู PowerApps หรือบนหน้าโดยตรงให้เป็นแท็บ FastTab blade หรือส่วนใหม่ในพื้นที่ทำงาน อย่างไรก็ตาม ถ้าจำเป็น นักพัฒนายังสามารถกำหนดค่าคุณลักษณะนี้เพื่ออนุญาตให้เฉพาะการฝังของ PowerApps บนหน้าบางหน้าโดยใช้วิธีต่อไปนี้:

- **isPowerAppPersonalizationEnabled** – ถ้าวิธีการนี้ส่งกลับค่าเท็จสำหรับหน้าเฉพาะ จากนั้น จะไม่มีการแสดงปุ่มเมนู PowerApps และผู้ใช้จะไม่สามารถฝัง PowerApps ที่ใดก็ตามบนหน้านี้ ซึ่งรวมถึงแบบเป็นแท็บ
- **isPowerAppTabPersonalizationEnabled** – ถ้าวิธีการนี้ส่งกลับค่าเท็จสำหรับหน้าเฉพาะ จากนั้น ผู้ใช้จะไม่สามารถฝัง PowerApps โดยตรงบนหน้าเป็นแท็บ FastTab หรือส่วนพาโนรามาได้ ผู้ใช้จะยังคงสามารถฝัง PowerApps โดยใช้ปุ่มเมนู PowerApps ถ้าการฝังได้รับอนุญาตบนหน้า

ตัวอย่างต่อไปนี้แสดงคลาสใหม่ที่มีสองวิธีที่จำเป็นสำหรับการตั้งค่าคอนฟิกที่ซึ่งสามารถฝัง PowerApps ได้

```
[ExtensionOf(classStr(FormRunConfigurationPowerAppsConfiguration))]

public final class ClassTest_Extension
{
    public static boolean isPowerAppPersonalizationEnabled(str pageName)
    {
        var result = next isPowerAppPersonalizationEnabled(pageName);
        return true;
    }
    public static boolean isPowerAppTabPersonalizationEnabled(str pageName)
    {
        var result = next isPowerAppTabPersonalizationEnabled(pageName);
        return true;
    }
}
```
